var Nv=g=>{throw TypeError(g)};var id=(g,t,e)=>t.has(g)||Nv("Cannot "+e);var ii=(g,t,e)=>(id(g,t,"read from private field"),e?e.call(g):t.get(g)),Jn=(g,t,e)=>t.has(g)?Nv("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(g):t.set(g,e),on=(g,t,e,i)=>(id(g,t,"write to private field"),i?i.call(g,e):t.set(g,e),e),ts=(g,t,e)=>(id(g,t,"access private method"),e);var Ov=(g,t,e,i)=>({set _(s){on(g,t,s,e)},get _(){return ii(g,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var Bn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ur(g){return g&&g.__esModule&&Object.prototype.hasOwnProperty.call(g,"default")?g.default:g}var nd={exports:{}},Ro={};var kv;function b1(){if(kv)return Ro;kv=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,s,a){var o=null;if(a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),"key"in s){a={};for(var u in s)u!=="key"&&(a[u]=s[u])}else a=s;return s=a.ref,{$$typeof:g,type:i,key:o,ref:s!==void 0?s:null,props:a}}return Ro.Fragment=t,Ro.jsx=e,Ro.jsxs=e,Ro}var Mv;function A1(){return Mv||(Mv=1,nd.exports=b1()),nd.exports}var te=A1(),sd={exports:{}},re={};var Lv;function _1(){if(Lv)return re;Lv=1;var g=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),v=Symbol.iterator;function A(j){return j===null||typeof j!="object"?null:(j=v&&j[v]||j["@@iterator"],typeof j=="function"?j:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function _(j,$,gt){this.props=j,this.context=$,this.refs=b,this.updater=gt||C}_.prototype.isReactComponent={},_.prototype.setState=function(j,$){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,$,"setState")},_.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function x(){}x.prototype=_.prototype;function D(j,$,gt){this.props=j,this.context=$,this.refs=b,this.updater=gt||C}var M=D.prototype=new x;M.constructor=D,w(M,_.prototype),M.isPureReactComponent=!0;var T=Array.isArray;function O(){}var k={H:null,A:null,T:null,S:null},z=Object.prototype.hasOwnProperty;function B(j,$,gt){var yt=gt.ref;return{$$typeof:g,type:j,key:$,ref:yt!==void 0?yt:null,props:gt}}function H(j,$){return B(j.type,$,j.props)}function V(j){return typeof j=="object"&&j!==null&&j.$$typeof===g}function Z(j){var $={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(gt){return $[gt]})}var rt=/\/+/g;function ft(j,$){return typeof j=="object"&&j!==null&&j.key!=null?Z(""+j.key):$.toString(36)}function mt(j){switch(j.status){case"fulfilled":return j.value;case"rejected":throw j.reason;default:switch(typeof j.status=="string"?j.then(O,O):(j.status="pending",j.then(function($){j.status==="pending"&&(j.status="fulfilled",j.value=$)},function($){j.status==="pending"&&(j.status="rejected",j.reason=$)})),j.status){case"fulfilled":return j.value;case"rejected":throw j.reason}}throw j}function G(j,$,gt,yt,Dt){var zt=typeof j;(zt==="undefined"||zt==="boolean")&&(j=null);var kt=!1;if(j===null)kt=!0;else switch(zt){case"bigint":case"string":case"number":kt=!0;break;case"object":switch(j.$$typeof){case g:case t:kt=!0;break;case f:return kt=j._init,G(kt(j._payload),$,gt,yt,Dt)}}if(kt)return Dt=Dt(j),kt=yt===""?"."+ft(j,0):yt,T(Dt)?(gt="",kt!=null&&(gt=kt.replace(rt,"$&/")+"/"),G(Dt,$,gt,"",function(ye){return ye})):Dt!=null&&(V(Dt)&&(Dt=H(Dt,gt+(Dt.key==null||j&&j.key===Dt.key?"":(""+Dt.key).replace(rt,"$&/")+"/")+kt)),$.push(Dt)),1;kt=0;var Lt=yt===""?".":yt+":";if(T(j))for(var Gt=0;Gt<j.length;Gt++)yt=j[Gt],zt=Lt+ft(yt,Gt),kt+=G(yt,$,gt,zt,Dt);else if(Gt=A(j),typeof Gt=="function")for(j=Gt.call(j),Gt=0;!(yt=j.next()).done;)yt=yt.value,zt=Lt+ft(yt,Gt++),kt+=G(yt,$,gt,zt,Dt);else if(zt==="object"){if(typeof j.then=="function")return G(mt(j),$,gt,yt,Dt);throw $=String(j),Error("Objects are not valid as a React child (found: "+($==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":$)+"). If you meant to render a collection of children, use an array instead.")}return kt}function W(j,$,gt){if(j==null)return j;var yt=[],Dt=0;return G(j,yt,"","",function(zt){return $.call(gt,zt,Dt++)}),yt}function st(j){if(j._status===-1){var $=j._result;$=$(),$.then(function(gt){(j._status===0||j._status===-1)&&(j._status=1,j._result=gt)},function(gt){(j._status===0||j._status===-1)&&(j._status=2,j._result=gt)}),j._status===-1&&(j._status=0,j._result=$)}if(j._status===1)return j._result.default;throw j._result}var bt=typeof reportError=="function"?reportError:function(j){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var $=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof j=="object"&&j!==null&&typeof j.message=="string"?String(j.message):String(j),error:j});if(!window.dispatchEvent($))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",j);return}console.error(j)},Nt={map:W,forEach:function(j,$,gt){W(j,function(){$.apply(this,arguments)},gt)},count:function(j){var $=0;return W(j,function(){$++}),$},toArray:function(j){return W(j,function($){return $})||[]},only:function(j){if(!V(j))throw Error("React.Children.only expected to receive a single React element child.");return j}};return re.Activity=p,re.Children=Nt,re.Component=_,re.Fragment=e,re.Profiler=s,re.PureComponent=D,re.StrictMode=i,re.Suspense=h,re.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,re.__COMPILER_RUNTIME={__proto__:null,c:function(j){return k.H.useMemoCache(j)}},re.cache=function(j){return function(){return j.apply(null,arguments)}},re.cacheSignal=function(){return null},re.cloneElement=function(j,$,gt){if(j==null)throw Error("The argument must be a React element, but you passed "+j+".");var yt=w({},j.props),Dt=j.key;if($!=null)for(zt in $.key!==void 0&&(Dt=""+$.key),$)!z.call($,zt)||zt==="key"||zt==="__self"||zt==="__source"||zt==="ref"&&$.ref===void 0||(yt[zt]=$[zt]);var zt=arguments.length-2;if(zt===1)yt.children=gt;else if(1<zt){for(var kt=Array(zt),Lt=0;Lt<zt;Lt++)kt[Lt]=arguments[Lt+2];yt.children=kt}return B(j.type,Dt,yt)},re.createContext=function(j){return j={$$typeof:o,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null},j.Provider=j,j.Consumer={$$typeof:a,_context:j},j},re.createElement=function(j,$,gt){var yt,Dt={},zt=null;if($!=null)for(yt in $.key!==void 0&&(zt=""+$.key),$)z.call($,yt)&&yt!=="key"&&yt!=="__self"&&yt!=="__source"&&(Dt[yt]=$[yt]);var kt=arguments.length-2;if(kt===1)Dt.children=gt;else if(1<kt){for(var Lt=Array(kt),Gt=0;Gt<kt;Gt++)Lt[Gt]=arguments[Gt+2];Dt.children=Lt}if(j&&j.defaultProps)for(yt in kt=j.defaultProps,kt)Dt[yt]===void 0&&(Dt[yt]=kt[yt]);return B(j,zt,Dt)},re.createRef=function(){return{current:null}},re.forwardRef=function(j){return{$$typeof:u,render:j}},re.isValidElement=V,re.lazy=function(j){return{$$typeof:f,_payload:{_status:-1,_result:j},_init:st}},re.memo=function(j,$){return{$$typeof:d,type:j,compare:$===void 0?null:$}},re.startTransition=function(j){var $=k.T,gt={};k.T=gt;try{var yt=j(),Dt=k.S;Dt!==null&&Dt(gt,yt),typeof yt=="object"&&yt!==null&&typeof yt.then=="function"&&yt.then(O,bt)}catch(zt){bt(zt)}finally{$!==null&&gt.types!==null&&($.types=gt.types),k.T=$}},re.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},re.use=function(j){return k.H.use(j)},re.useActionState=function(j,$,gt){return k.H.useActionState(j,$,gt)},re.useCallback=function(j,$){return k.H.useCallback(j,$)},re.useContext=function(j){return k.H.useContext(j)},re.useDebugValue=function(){},re.useDeferredValue=function(j,$){return k.H.useDeferredValue(j,$)},re.useEffect=function(j,$){return k.H.useEffect(j,$)},re.useEffectEvent=function(j){return k.H.useEffectEvent(j)},re.useId=function(){return k.H.useId()},re.useImperativeHandle=function(j,$,gt){return k.H.useImperativeHandle(j,$,gt)},re.useInsertionEffect=function(j,$){return k.H.useInsertionEffect(j,$)},re.useLayoutEffect=function(j,$){return k.H.useLayoutEffect(j,$)},re.useMemo=function(j,$){return k.H.useMemo(j,$)},re.useOptimistic=function(j,$){return k.H.useOptimistic(j,$)},re.useReducer=function(j,$,gt){return k.H.useReducer(j,$,gt)},re.useRef=function(j){return k.H.useRef(j)},re.useState=function(j){return k.H.useState(j)},re.useSyncExternalStore=function(j,$,gt){return k.H.useSyncExternalStore(j,$,gt)},re.useTransition=function(){return k.H.useTransition()},re.version="19.2.4",re}var Bv;function Cf(){return Bv||(Bv=1,sd.exports=_1()),sd.exports}var ln=Cf();const w1=ur(ln);var rd={exports:{}},No={},ad={exports:{}},od={};var Iv;function E1(){return Iv||(Iv=1,(function(g){function t(G,W){var st=G.length;G.push(W);t:for(;0<st;){var bt=st-1>>>1,Nt=G[bt];if(0<s(Nt,W))G[bt]=W,G[st]=Nt,st=bt;else break t}}function e(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var W=G[0],st=G.pop();if(st!==W){G[0]=st;t:for(var bt=0,Nt=G.length,j=Nt>>>1;bt<j;){var $=2*(bt+1)-1,gt=G[$],yt=$+1,Dt=G[yt];if(0>s(gt,st))yt<Nt&&0>s(Dt,gt)?(G[bt]=Dt,G[yt]=st,bt=yt):(G[bt]=gt,G[$]=st,bt=$);else if(yt<Nt&&0>s(Dt,st))G[bt]=Dt,G[yt]=st,bt=yt;else break t}}return W}function s(G,W){var st=G.sortIndex-W.sortIndex;return st!==0?st:G.id-W.id}if(g.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;g.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();g.unstable_now=function(){return o.now()-u}}var h=[],d=[],f=1,p=null,v=3,A=!1,C=!1,w=!1,b=!1,_=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,D=typeof setImmediate<"u"?setImmediate:null;function M(G){for(var W=e(d);W!==null;){if(W.callback===null)i(d);else if(W.startTime<=G)i(d),W.sortIndex=W.expirationTime,t(h,W);else break;W=e(d)}}function T(G){if(w=!1,M(G),!C)if(e(h)!==null)C=!0,O||(O=!0,Z());else{var W=e(d);W!==null&&mt(T,W.startTime-G)}}var O=!1,k=-1,z=5,B=-1;function H(){return b?!0:!(g.unstable_now()-B<z)}function V(){if(b=!1,O){var G=g.unstable_now();B=G;var W=!0;try{t:{C=!1,w&&(w=!1,x(k),k=-1),A=!0;var st=v;try{e:{for(M(G),p=e(h);p!==null&&!(p.expirationTime>G&&H());){var bt=p.callback;if(typeof bt=="function"){p.callback=null,v=p.priorityLevel;var Nt=bt(p.expirationTime<=G);if(G=g.unstable_now(),typeof Nt=="function"){p.callback=Nt,M(G),W=!0;break e}p===e(h)&&i(h),M(G)}else i(h);p=e(h)}if(p!==null)W=!0;else{var j=e(d);j!==null&&mt(T,j.startTime-G),W=!1}}break t}finally{p=null,v=st,A=!1}W=void 0}}finally{W?Z():O=!1}}}var Z;if(typeof D=="function")Z=function(){D(V)};else if(typeof MessageChannel<"u"){var rt=new MessageChannel,ft=rt.port2;rt.port1.onmessage=V,Z=function(){ft.postMessage(null)}}else Z=function(){_(V,0)};function mt(G,W){k=_(function(){G(g.unstable_now())},W)}g.unstable_IdlePriority=5,g.unstable_ImmediatePriority=1,g.unstable_LowPriority=4,g.unstable_NormalPriority=3,g.unstable_Profiling=null,g.unstable_UserBlockingPriority=2,g.unstable_cancelCallback=function(G){G.callback=null},g.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<G?Math.floor(1e3/G):5},g.unstable_getCurrentPriorityLevel=function(){return v},g.unstable_next=function(G){switch(v){case 1:case 2:case 3:var W=3;break;default:W=v}var st=v;v=W;try{return G()}finally{v=st}},g.unstable_requestPaint=function(){b=!0},g.unstable_runWithPriority=function(G,W){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var st=v;v=G;try{return W()}finally{v=st}},g.unstable_scheduleCallback=function(G,W,st){var bt=g.unstable_now();switch(typeof st=="object"&&st!==null?(st=st.delay,st=typeof st=="number"&&0<st?bt+st:bt):st=bt,G){case 1:var Nt=-1;break;case 2:Nt=250;break;case 5:Nt=1073741823;break;case 4:Nt=1e4;break;default:Nt=5e3}return Nt=st+Nt,G={id:f++,callback:W,priorityLevel:G,startTime:st,expirationTime:Nt,sortIndex:-1},st>bt?(G.sortIndex=st,t(d,G),e(h)===null&&G===e(d)&&(w?(x(k),k=-1):w=!0,mt(T,st-bt))):(G.sortIndex=Nt,t(h,G),C||A||(C=!0,O||(O=!0,Z()))),G},g.unstable_shouldYield=H,g.unstable_wrapCallback=function(G){var W=v;return function(){var st=v;v=W;try{return G.apply(this,arguments)}finally{v=st}}}})(od)),od}var zv;function S1(){return zv||(zv=1,ad.exports=E1()),ad.exports}var ld={exports:{}},Yi={};var Fv;function x1(){if(Fv)return Yi;Fv=1;var g=Cf();function t(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)d+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},s=Symbol.for("react.portal");function a(h,d,f){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:p==null?null:""+p,children:h,containerInfo:d,implementation:f}}var o=g.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Yi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Yi.createPortal=function(h,d){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return a(h,d,null,f)},Yi.flushSync=function(h){var d=o.T,f=i.p;try{if(o.T=null,i.p=2,h)return h()}finally{o.T=d,i.p=f,i.d.f()}},Yi.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(h,d))},Yi.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},Yi.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var f=d.as,p=u(f,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,A=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;f==="style"?i.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:A}):f==="script"&&i.d.X(h,{crossOrigin:p,integrity:v,fetchPriority:A,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Yi.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var f=u(d.as,d.crossOrigin);i.d.M(h,{crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(h)},Yi.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var f=d.as,p=u(f,d.crossOrigin);i.d.L(h,f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Yi.preloadModule=function(h,d){if(typeof h=="string")if(d){var f=u(d.as,d.crossOrigin);i.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:f,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(h)},Yi.requestFormReset=function(h){i.d.r(h)},Yi.unstable_batchedUpdates=function(h,d){return h(d)},Yi.useFormState=function(h,d,f){return o.H.useFormState(h,d,f)},Yi.useFormStatus=function(){return o.H.useHostTransitionStatus()},Yi.version="19.2.4",Yi}var Pv;function C1(){if(Pv)return ld.exports;Pv=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),ld.exports=x1(),ld.exports}var Uv;function T1(){if(Uv)return No;Uv=1;var g=S1(),t=Cf(),e=C1();function i(n){var r="https://react.dev/errors/"+n;if(1<arguments.length){r+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)r+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+n+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function a(n){var r=n,l=n;if(n.alternate)for(;r.return;)r=r.return;else{n=r;do r=n,(r.flags&4098)!==0&&(l=r.return),n=r.return;while(n)}return r.tag===3?l:null}function o(n){if(n.tag===13){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function u(n){if(n.tag===31){var r=n.memoizedState;if(r===null&&(n=n.alternate,n!==null&&(r=n.memoizedState)),r!==null)return r.dehydrated}return null}function h(n){if(a(n)!==n)throw Error(i(188))}function d(n){var r=n.alternate;if(!r){if(r=a(n),r===null)throw Error(i(188));return r!==n?null:n}for(var l=n,c=r;;){var m=l.return;if(m===null)break;var y=m.alternate;if(y===null){if(c=m.return,c!==null){l=c;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===l)return h(m),n;if(y===c)return h(m),r;y=y.sibling}throw Error(i(188))}if(l.return!==c.return)l=m,c=y;else{for(var R=!1,I=m.child;I;){if(I===l){R=!0,l=m,c=y;break}if(I===c){R=!0,c=m,l=y;break}I=I.sibling}if(!R){for(I=y.child;I;){if(I===l){R=!0,l=y,c=m;break}if(I===c){R=!0,c=y,l=m;break}I=I.sibling}if(!R)throw Error(i(189))}}if(l.alternate!==c)throw Error(i(190))}if(l.tag!==3)throw Error(i(188));return l.stateNode.current===l?n:r}function f(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n;for(n=n.child;n!==null;){if(r=f(n),r!==null)return r;n=n.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),C=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),_=Symbol.for("react.profiler"),x=Symbol.for("react.consumer"),D=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),z=Symbol.for("react.lazy"),B=Symbol.for("react.activity"),H=Symbol.for("react.memo_cache_sentinel"),V=Symbol.iterator;function Z(n){return n===null||typeof n!="object"?null:(n=V&&n[V]||n["@@iterator"],typeof n=="function"?n:null)}var rt=Symbol.for("react.client.reference");function ft(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===rt?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case w:return"Fragment";case _:return"Profiler";case b:return"StrictMode";case T:return"Suspense";case O:return"SuspenseList";case B:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case C:return"Portal";case D:return n.displayName||"Context";case x:return(n._context.displayName||"Context")+".Consumer";case M:var r=n.render;return n=n.displayName,n||(n=r.displayName||r.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case k:return r=n.displayName||null,r!==null?r:ft(n.type)||"Memo";case z:r=n._payload,n=n._init;try{return ft(n(r))}catch{}}return null}var mt=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,W=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st={pending:!1,data:null,method:null,action:null},bt=[],Nt=-1;function j(n){return{current:n}}function $(n){0>Nt||(n.current=bt[Nt],bt[Nt]=null,Nt--)}function gt(n,r){Nt++,bt[Nt]=n.current,n.current=r}var yt=j(null),Dt=j(null),zt=j(null),kt=j(null);function Lt(n,r){switch(gt(zt,r),gt(Dt,n),gt(yt,null),r.nodeType){case 9:case 11:n=(n=r.documentElement)&&(n=n.namespaceURI)?Jm(n):0;break;default:if(n=r.tagName,r=r.namespaceURI)r=Jm(r),n=tv(r,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}$(yt),gt(yt,n)}function Gt(){$(yt),$(Dt),$(zt)}function ye(n){n.memoizedState!==null&&gt(kt,n);var r=yt.current,l=tv(r,n.type);r!==l&&(gt(Dt,n),gt(yt,l))}function Yt(n){Dt.current===n&&($(yt),$(Dt)),kt.current===n&&($(kt),xo._currentValue=st)}var ee,ie;function ne(n){if(ee===void 0)try{throw Error()}catch(l){var r=l.stack.trim().match(/\n( *(at )?)/);ee=r&&r[1]||"",ie=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ee+n+ie}var Re=!1;function be(n,r){if(!n||Re)return"";Re=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(r){var wt=function(){throw Error()};if(Object.defineProperty(wt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(wt,[])}catch(pt){var dt=pt}Reflect.construct(n,[],wt)}else{try{wt.call()}catch(pt){dt=pt}n.call(wt.prototype)}}else{try{throw Error()}catch(pt){dt=pt}(wt=n())&&typeof wt.catch=="function"&&wt.catch(function(){})}}catch(pt){if(pt&&dt&&typeof pt.stack=="string")return[pt.stack,dt.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var m=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");m&&m.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var y=c.DetermineComponentFrameRoot(),R=y[0],I=y[1];if(R&&I){var X=R.split(`
`),ct=I.split(`
`);for(m=c=0;c<X.length&&!X[c].includes("DetermineComponentFrameRoot");)c++;for(;m<ct.length&&!ct[m].includes("DetermineComponentFrameRoot");)m++;if(c===X.length||m===ct.length)for(c=X.length-1,m=ct.length-1;1<=c&&0<=m&&X[c]!==ct[m];)m--;for(;1<=c&&0<=m;c--,m--)if(X[c]!==ct[m]){if(c!==1||m!==1)do if(c--,m--,0>m||X[c]!==ct[m]){var vt=`
`+X[c].replace(" at new "," at ");return n.displayName&&vt.includes("<anonymous>")&&(vt=vt.replace("<anonymous>",n.displayName)),vt}while(1<=c&&0<=m);break}}}finally{Re=!1,Error.prepareStackTrace=l}return(l=n?n.displayName||n.name:"")?ne(l):""}function fe(n,r){switch(n.tag){case 26:case 27:case 5:return ne(n.type);case 16:return ne("Lazy");case 13:return n.child!==r&&r!==null?ne("Suspense Fallback"):ne("Suspense");case 19:return ne("SuspenseList");case 0:case 15:return be(n.type,!1);case 11:return be(n.type.render,!1);case 1:return be(n.type,!0);case 31:return ne("Activity");default:return""}}function Ve(n){try{var r="",l=null;do r+=fe(n,l),l=n,n=n.return;while(n);return r}catch(c){return`
Error generating stack: `+c.message+`
`+c.stack}}var Je=Object.prototype.hasOwnProperty,Ke=g.unstable_scheduleCallback,Wt=g.unstable_cancelCallback,Jt=g.unstable_shouldYield,Kt=g.unstable_requestPaint,De=g.unstable_now,Wi=g.unstable_getCurrentPriorityLevel,Di=g.unstable_ImmediatePriority,si=g.unstable_UserBlockingPriority,ki=g.unstable_NormalPriority,ji=g.unstable_LowPriority,fi=g.unstable_IdlePriority,qi=g.log,Mi=g.unstable_setDisableYieldValue,Pe=null,Me=null;function yi(n){if(typeof qi=="function"&&Mi(n),Me&&typeof Me.setStrictMode=="function")try{Me.setStrictMode(Pe,n)}catch{}}var U=Math.clz32?Math.clz32:It,Et=Math.log,Ct=Math.LN2;function It(n){return n>>>=0,n===0?32:31-(Et(n)/Ct|0)|0}var Q=256,N=262144,E=4194304;function F(n){var r=n&42;if(r!==0)return r;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function tt(n,r,l){var c=n.pendingLanes;if(c===0)return 0;var m=0,y=n.suspendedLanes,R=n.pingedLanes;n=n.warmLanes;var I=c&134217727;return I!==0?(c=I&~y,c!==0?m=F(c):(R&=I,R!==0?m=F(R):l||(l=I&~n,l!==0&&(m=F(l))))):(I=c&~y,I!==0?m=F(I):R!==0?m=F(R):l||(l=c&~n,l!==0&&(m=F(l)))),m===0?0:r!==0&&r!==m&&(r&y)===0&&(y=m&-m,l=r&-r,y>=l||y===32&&(l&4194048)!==0)?r:m}function S(n,r){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&r)===0}function it(n,r){switch(n){case 1:case 2:case 4:case 8:case 64:return r+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function lt(){var n=E;return E<<=1,(E&62914560)===0&&(E=4194304),n}function L(n){for(var r=[],l=0;31>l;l++)r.push(n);return r}function Y(n,r){n.pendingLanes|=r,r!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function ut(n,r,l,c,m,y){var R=n.pendingLanes;n.pendingLanes=l,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=l,n.entangledLanes&=l,n.errorRecoveryDisabledLanes&=l,n.shellSuspendCounter=0;var I=n.entanglements,X=n.expirationTimes,ct=n.hiddenUpdates;for(l=R&~l;0<l;){var vt=31-U(l),wt=1<<vt;I[vt]=0,X[vt]=-1;var dt=ct[vt];if(dt!==null)for(ct[vt]=null,vt=0;vt<dt.length;vt++){var pt=dt[vt];pt!==null&&(pt.lane&=-536870913)}l&=~wt}c!==0&&Ft(n,c,0),y!==0&&m===0&&n.tag!==0&&(n.suspendedLanes|=y&~(R&~r))}function Ft(n,r,l){n.pendingLanes|=r,n.suspendedLanes&=~r;var c=31-U(r);n.entangledLanes|=r,n.entanglements[c]=n.entanglements[c]|1073741824|l&261930}function Ot(n,r){var l=n.entangledLanes|=r;for(n=n.entanglements;l;){var c=31-U(l),m=1<<c;m&r|n[c]&r&&(n[c]|=r),l&=~m}}function Mt(n,r){var l=r&-r;return l=(l&42)!==0?1:$t(l),(l&(n.suspendedLanes|r))!==0?0:l}function $t(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Ze(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function we(){var n=W.p;return n!==0?n:(n=window.event,n===void 0?32:Ev(n.type))}function se(n,r){var l=W.p;try{return W.p=n,r()}finally{W.p=l}}var Qt=Math.random().toString(36).slice(2),de="__reactFiber$"+Qt,pe="__reactProps$"+Qt,Gi="__reactContainer$"+Qt,Yn="__reactEvents$"+Qt,ti="__reactListeners$"+Qt,Vi="__reactHandles$"+Qt,li="__reactResources$"+Qt,Li="__reactMarker$"+Qt;function Xi(n){delete n[de],delete n[pe],delete n[Yn],delete n[ti],delete n[Vi]}function zn(n){var r=n[de];if(r)return r;for(var l=n.parentNode;l;){if(r=l[Gi]||l[de]){if(l=r.alternate,r.child!==null||l!==null&&l.child!==null)for(n=ov(n);n!==null;){if(l=n[de])return l;n=ov(n)}return r}n=l,l=n.parentNode}return null}function Os(n){if(n=n[de]||n[Gi]){var r=n.tag;if(r===5||r===6||r===13||r===31||r===26||r===27||r===3)return n}return null}function ks(n){var r=n.tag;if(r===5||r===26||r===27||r===6)return n.stateNode;throw Error(i(33))}function _n(n){var r=n[li];return r||(r=n[li]={hoistableStyles:new Map,hoistableScripts:new Map}),r}function pi(n){n[Li]=!0}var ls=new Set,nl={};function wn(n,r){Wn(n,r),Wn(n+"Capture",r)}function Wn(n,r){for(nl[n]=r,n=0;n<r.length;n++)ls.add(r[n])}var Qu=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),sl={},Br={};function Ju(n){return Je.call(Br,n)?!0:Je.call(sl,n)?!1:Qu.test(n)?Br[n]=!0:(sl[n]=!0,!1)}function Ir(n,r,l){if(Ju(r))if(l===null)n.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":n.removeAttribute(r);return;case"boolean":var c=r.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){n.removeAttribute(r);return}}n.setAttribute(r,""+l)}}function P(n,r,l){if(l===null)n.removeAttribute(r);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(r);return}n.setAttribute(r,""+l)}}function K(n,r,l,c){if(c===null)n.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(l);return}n.setAttributeNS(r,l,""+c)}}function q(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function nt(n){var r=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ot(n,r,l){var c=Object.getOwnPropertyDescriptor(n.constructor.prototype,r);if(!n.hasOwnProperty(r)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var m=c.get,y=c.set;return Object.defineProperty(n,r,{configurable:!0,get:function(){return m.call(this)},set:function(R){l=""+R,y.call(this,R)}}),Object.defineProperty(n,r,{enumerable:c.enumerable}),{getValue:function(){return l},setValue:function(R){l=""+R},stopTracking:function(){n._valueTracker=null,delete n[r]}}}}function et(n){if(!n._valueTracker){var r=nt(n)?"checked":"value";n._valueTracker=ot(n,r,""+n[r])}}function At(n){if(!n)return!1;var r=n._valueTracker;if(!r)return!0;var l=r.getValue(),c="";return n&&(c=nt(n)?n.checked?"true":"false":n.value),n=c,n!==l?(r.setValue(n),!0):!1}function St(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Tt=/[\n"\\]/g;function xt(n){return n.replace(Tt,function(r){return"\\"+r.charCodeAt(0).toString(16)+" "})}function Rt(n,r,l,c,m,y,R,I){n.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?n.type=R:n.removeAttribute("type"),r!=null?R==="number"?(r===0&&n.value===""||n.value!=r)&&(n.value=""+q(r)):n.value!==""+q(r)&&(n.value=""+q(r)):R!=="submit"&&R!=="reset"||n.removeAttribute("value"),r!=null?ue(n,R,q(r)):l!=null?ue(n,R,q(l)):c!=null&&n.removeAttribute("value"),m==null&&y!=null&&(n.defaultChecked=!!y),m!=null&&(n.checked=m&&typeof m!="function"&&typeof m!="symbol"),I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?n.name=""+q(I):n.removeAttribute("name")}function jt(n,r,l,c,m,y,R,I){if(y!=null&&typeof y!="function"&&typeof y!="symbol"&&typeof y!="boolean"&&(n.type=y),r!=null||l!=null){if(!(y!=="submit"&&y!=="reset"||r!=null)){et(n);return}l=l!=null?""+q(l):"",r=r!=null?""+q(r):l,I||r===n.value||(n.value=r),n.defaultValue=r}c=c??m,c=typeof c!="function"&&typeof c!="symbol"&&!!c,n.checked=I?n.checked:!!c,n.defaultChecked=!!c,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(n.name=R),et(n)}function ue(n,r,l){r==="number"&&St(n.ownerDocument)===n||n.defaultValue===""+l||(n.defaultValue=""+l)}function ge(n,r,l,c){if(n=n.options,r){r={};for(var m=0;m<l.length;m++)r["$"+l[m]]=!0;for(l=0;l<n.length;l++)m=r.hasOwnProperty("$"+n[l].value),n[l].selected!==m&&(n[l].selected=m),m&&c&&(n[l].defaultSelected=!0)}else{for(l=""+q(l),r=null,m=0;m<n.length;m++){if(n[m].value===l){n[m].selected=!0,c&&(n[m].defaultSelected=!0);return}r!==null||n[m].disabled||(r=n[m])}r!==null&&(r.selected=!0)}}function Ne(n,r,l){if(r!=null&&(r=""+q(r),r!==n.value&&(n.value=r),l==null)){n.defaultValue!==r&&(n.defaultValue=r);return}n.defaultValue=l!=null?""+q(l):""}function ri(n,r,l,c){if(r==null){if(c!=null){if(l!=null)throw Error(i(92));if(mt(c)){if(1<c.length)throw Error(i(93));c=c[0]}l=c}l==null&&(l=""),r=l}l=q(r),n.defaultValue=l,c=n.textContent,c===l&&c!==""&&c!==null&&(n.value=c),et(n)}function Ue(n,r){if(r){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=r;return}}n.textContent=r}var Ji=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Ms(n,r,l){var c=r.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?n.setProperty(r,""):r==="float"?n.cssFloat="":n[r]="":c?n.setProperty(r,l):typeof l!="number"||l===0||Ji.has(r)?r==="float"?n.cssFloat=l:n[r]=(""+l).trim():n[r]=l+"px"}function zr(n,r,l){if(r!=null&&typeof r!="object")throw Error(i(62));if(n=n.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||r!=null&&r.hasOwnProperty(c)||(c.indexOf("--")===0?n.setProperty(c,""):c==="float"?n.cssFloat="":n[c]="");for(var m in r)c=r[m],r.hasOwnProperty(m)&&l[m]!==c&&Ms(n,m,c)}else for(var y in r)r.hasOwnProperty(y)&&Ms(n,y,r[y])}function Pa(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ua=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),$f=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fr(n){return $f.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function Fn(){}var Pr=null;function th(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ur=null,Hr=null;function Qf(n){var r=Os(n);if(r&&(n=r.stateNode)){var l=n[pe]||null;t:switch(n=r.stateNode,r.type){case"input":if(Rt(n,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),r=l.name,l.type==="radio"&&r!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+xt(""+r)+'"][type="radio"]'),r=0;r<l.length;r++){var c=l[r];if(c!==n&&c.form===n.form){var m=c[pe]||null;if(!m)throw Error(i(90));Rt(c,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name)}}for(r=0;r<l.length;r++)c=l[r],c.form===n.form&&At(c)}break t;case"textarea":Ne(n,l.value,l.defaultValue);break t;case"select":r=l.value,r!=null&&ge(n,!!l.multiple,r,!1)}}}var eh=!1;function Jf(n,r,l){if(eh)return n(r,l);eh=!0;try{var c=n(r);return c}finally{if(eh=!1,(Ur!==null||Hr!==null)&&(Vl(),Ur&&(r=Ur,n=Hr,Hr=Ur=null,Qf(r),n)))for(r=0;r<n.length;r++)Qf(n[r])}}function Ha(n,r){var l=n.stateNode;if(l===null)return null;var c=l[pe]||null;if(c===null)return null;l=c[r];t:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(n=n.type,c=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!c;break t;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(i(231,r,typeof l));return l}var us=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ih=!1;if(us)try{var ja={};Object.defineProperty(ja,"passive",{get:function(){ih=!0}}),window.addEventListener("test",ja,ja),window.removeEventListener("test",ja,ja)}catch{ih=!1}var Ls=null,nh=null,rl=null;function tp(){if(rl)return rl;var n,r=nh,l=r.length,c,m="value"in Ls?Ls.value:Ls.textContent,y=m.length;for(n=0;n<l&&r[n]===m[n];n++);var R=l-n;for(c=1;c<=R&&r[l-c]===m[y-c];c++);return rl=m.slice(n,1<c?1-c:void 0)}function al(n){var r=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&r===13&&(n=13)):n=r,n===10&&(n=13),32<=n||n===13?n:0}function ol(){return!0}function ep(){return!1}function tn(n){function r(l,c,m,y,R){this._reactName=l,this._targetInst=m,this.type=c,this.nativeEvent=y,this.target=R,this.currentTarget=null;for(var I in n)n.hasOwnProperty(I)&&(l=n[I],this[I]=l?l(y):y[I]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?ol:ep,this.isPropagationStopped=ep,this}return p(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=ol)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=ol)},persist:function(){},isPersistent:ol}),r}var hr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ll=tn(hr),qa=p({},hr,{view:0,detail:0}),vb=tn(qa),sh,rh,Ga,ul=p({},qa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oh,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ga&&(Ga&&n.type==="mousemove"?(sh=n.screenX-Ga.screenX,rh=n.screenY-Ga.screenY):rh=sh=0,Ga=n),sh)},movementY:function(n){return"movementY"in n?n.movementY:rh}}),ip=tn(ul),yb=p({},ul,{dataTransfer:0}),bb=tn(yb),Ab=p({},qa,{relatedTarget:0}),ah=tn(Ab),_b=p({},hr,{animationName:0,elapsedTime:0,pseudoElement:0}),wb=tn(_b),Eb=p({},hr,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Sb=tn(Eb),xb=p({},hr,{data:0}),np=tn(xb),Cb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Tb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Db={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rb(n){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(n):(n=Db[n])?!!r[n]:!1}function oh(){return Rb}var Nb=p({},qa,{key:function(n){if(n.key){var r=Cb[n.key]||n.key;if(r!=="Unidentified")return r}return n.type==="keypress"?(n=al(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Tb[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oh,charCode:function(n){return n.type==="keypress"?al(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?al(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ob=tn(Nb),kb=p({},ul,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sp=tn(kb),Mb=p({},qa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oh}),Lb=tn(Mb),Bb=p({},hr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ib=tn(Bb),zb=p({},ul,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Fb=tn(zb),Pb=p({},hr,{newState:0,oldState:0}),Ub=tn(Pb),Hb=[9,13,27,32],lh=us&&"CompositionEvent"in window,Va=null;us&&"documentMode"in document&&(Va=document.documentMode);var jb=us&&"TextEvent"in window&&!Va,rp=us&&(!lh||Va&&8<Va&&11>=Va),ap=" ",op=!1;function lp(n,r){switch(n){case"keyup":return Hb.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function up(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var jr=!1;function qb(n,r){switch(n){case"compositionend":return up(r);case"keypress":return r.which!==32?null:(op=!0,ap);case"textInput":return n=r.data,n===ap&&op?null:n;default:return null}}function Gb(n,r){if(jr)return n==="compositionend"||!lh&&lp(n,r)?(n=tp(),rl=nh=Ls=null,jr=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return rp&&r.locale!=="ko"?null:r.data;default:return null}}var Vb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function hp(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r==="input"?!!Vb[n.type]:r==="textarea"}function cp(n,r,l,c){Ur?Hr?Hr.push(c):Hr=[c]:Ur=c,r=Ql(r,"onChange"),0<r.length&&(l=new ll("onChange","change",null,l,c),n.push({event:l,listeners:r}))}var Xa=null,Ya=null;function Xb(n){Ym(n,0)}function hl(n){var r=ks(n);if(At(r))return n}function dp(n,r){if(n==="change")return r}var fp=!1;if(us){var uh;if(us){var hh="oninput"in document;if(!hh){var pp=document.createElement("div");pp.setAttribute("oninput","return;"),hh=typeof pp.oninput=="function"}uh=hh}else uh=!1;fp=uh&&(!document.documentMode||9<document.documentMode)}function gp(){Xa&&(Xa.detachEvent("onpropertychange",mp),Ya=Xa=null)}function mp(n){if(n.propertyName==="value"&&hl(Ya)){var r=[];cp(r,Ya,n,th(n)),Jf(Xb,r)}}function Yb(n,r,l){n==="focusin"?(gp(),Xa=r,Ya=l,Xa.attachEvent("onpropertychange",mp)):n==="focusout"&&gp()}function Wb(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return hl(Ya)}function Zb(n,r){if(n==="click")return hl(r)}function Kb(n,r){if(n==="input"||n==="change")return hl(r)}function $b(n,r){return n===r&&(n!==0||1/n===1/r)||n!==n&&r!==r}var cn=typeof Object.is=="function"?Object.is:$b;function Wa(n,r){if(cn(n,r))return!0;if(typeof n!="object"||n===null||typeof r!="object"||r===null)return!1;var l=Object.keys(n),c=Object.keys(r);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var m=l[c];if(!Je.call(r,m)||!cn(n[m],r[m]))return!1}return!0}function vp(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function yp(n,r){var l=vp(n);n=0;for(var c;l;){if(l.nodeType===3){if(c=n+l.textContent.length,n<=r&&c>=r)return{node:l,offset:r-n};n=c}t:{for(;l;){if(l.nextSibling){l=l.nextSibling;break t}l=l.parentNode}l=void 0}l=vp(l)}}function bp(n,r){return n&&r?n===r?!0:n&&n.nodeType===3?!1:r&&r.nodeType===3?bp(n,r.parentNode):"contains"in n?n.contains(r):n.compareDocumentPosition?!!(n.compareDocumentPosition(r)&16):!1:!1}function Ap(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var r=St(n.document);r instanceof n.HTMLIFrameElement;){try{var l=typeof r.contentWindow.location.href=="string"}catch{l=!1}if(l)n=r.contentWindow;else break;r=St(n.document)}return r}function ch(n){var r=n&&n.nodeName&&n.nodeName.toLowerCase();return r&&(r==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||r==="textarea"||n.contentEditable==="true")}var Qb=us&&"documentMode"in document&&11>=document.documentMode,qr=null,dh=null,Za=null,fh=!1;function _p(n,r,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;fh||qr==null||qr!==St(c)||(c=qr,"selectionStart"in c&&ch(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Za&&Wa(Za,c)||(Za=c,c=Ql(dh,"onSelect"),0<c.length&&(r=new ll("onSelect","select",null,r,l),n.push({event:r,listeners:c}),r.target=qr)))}function cr(n,r){var l={};return l[n.toLowerCase()]=r.toLowerCase(),l["Webkit"+n]="webkit"+r,l["Moz"+n]="moz"+r,l}var Gr={animationend:cr("Animation","AnimationEnd"),animationiteration:cr("Animation","AnimationIteration"),animationstart:cr("Animation","AnimationStart"),transitionrun:cr("Transition","TransitionRun"),transitionstart:cr("Transition","TransitionStart"),transitioncancel:cr("Transition","TransitionCancel"),transitionend:cr("Transition","TransitionEnd")},ph={},wp={};us&&(wp=document.createElement("div").style,"AnimationEvent"in window||(delete Gr.animationend.animation,delete Gr.animationiteration.animation,delete Gr.animationstart.animation),"TransitionEvent"in window||delete Gr.transitionend.transition);function dr(n){if(ph[n])return ph[n];if(!Gr[n])return n;var r=Gr[n],l;for(l in r)if(r.hasOwnProperty(l)&&l in wp)return ph[n]=r[l];return n}var Ep=dr("animationend"),Sp=dr("animationiteration"),xp=dr("animationstart"),Jb=dr("transitionrun"),t2=dr("transitionstart"),e2=dr("transitioncancel"),Cp=dr("transitionend"),Tp=new Map,gh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");gh.push("scrollEnd");function Pn(n,r){Tp.set(n,r),wn(r,[n])}var cl=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var r=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(r))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},En=[],Vr=0,mh=0;function dl(){for(var n=Vr,r=mh=Vr=0;r<n;){var l=En[r];En[r++]=null;var c=En[r];En[r++]=null;var m=En[r];En[r++]=null;var y=En[r];if(En[r++]=null,c!==null&&m!==null){var R=c.pending;R===null?m.next=m:(m.next=R.next,R.next=m),c.pending=m}y!==0&&Dp(l,m,y)}}function fl(n,r,l,c){En[Vr++]=n,En[Vr++]=r,En[Vr++]=l,En[Vr++]=c,mh|=c,n.lanes|=c,n=n.alternate,n!==null&&(n.lanes|=c)}function vh(n,r,l,c){return fl(n,r,l,c),pl(n)}function fr(n,r){return fl(n,null,null,r),pl(n)}function Dp(n,r,l){n.lanes|=l;var c=n.alternate;c!==null&&(c.lanes|=l);for(var m=!1,y=n.return;y!==null;)y.childLanes|=l,c=y.alternate,c!==null&&(c.childLanes|=l),y.tag===22&&(n=y.stateNode,n===null||n._visibility&1||(m=!0)),n=y,y=y.return;return n.tag===3?(y=n.stateNode,m&&r!==null&&(m=31-U(l),n=y.hiddenUpdates,c=n[m],c===null?n[m]=[r]:c.push(r),r.lane=l|536870912),y):null}function pl(n){if(50<yo)throw yo=0,Cc=null,Error(i(185));for(var r=n.return;r!==null;)n=r,r=n.return;return n.tag===3?n.stateNode:null}var Xr={};function i2(n,r,l,c){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function dn(n,r,l,c){return new i2(n,r,l,c)}function yh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function hs(n,r){var l=n.alternate;return l===null?(l=dn(n.tag,r,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=r,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&65011712,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,r=n.dependencies,l.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l.refCleanup=n.refCleanup,l}function Rp(n,r){n.flags&=65011714;var l=n.alternate;return l===null?(n.childLanes=0,n.lanes=r,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=l.childLanes,n.lanes=l.lanes,n.child=l.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=l.memoizedProps,n.memoizedState=l.memoizedState,n.updateQueue=l.updateQueue,n.type=l.type,r=l.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),n}function gl(n,r,l,c,m,y){var R=0;if(c=n,typeof n=="function")yh(n)&&(R=1);else if(typeof n=="string")R=o1(n,l,yt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case B:return n=dn(31,l,r,m),n.elementType=B,n.lanes=y,n;case w:return pr(l.children,m,y,r);case b:R=8,m|=24;break;case _:return n=dn(12,l,r,m|2),n.elementType=_,n.lanes=y,n;case T:return n=dn(13,l,r,m),n.elementType=T,n.lanes=y,n;case O:return n=dn(19,l,r,m),n.elementType=O,n.lanes=y,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case D:R=10;break t;case x:R=9;break t;case M:R=11;break t;case k:R=14;break t;case z:R=16,c=null;break t}R=29,l=Error(i(130,n===null?"null":typeof n,"")),c=null}return r=dn(R,l,r,m),r.elementType=n,r.type=c,r.lanes=y,r}function pr(n,r,l,c){return n=dn(7,n,c,r),n.lanes=l,n}function bh(n,r,l){return n=dn(6,n,null,r),n.lanes=l,n}function Np(n){var r=dn(18,null,null,0);return r.stateNode=n,r}function Ah(n,r,l){return r=dn(4,n.children!==null?n.children:[],n.key,r),r.lanes=l,r.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},r}var Op=new WeakMap;function Sn(n,r){if(typeof n=="object"&&n!==null){var l=Op.get(n);return l!==void 0?l:(r={value:n,source:r,stack:Ve(r)},Op.set(n,r),r)}return{value:n,source:r,stack:Ve(r)}}var Yr=[],Wr=0,ml=null,Ka=0,xn=[],Cn=0,Bs=null,Zn=1,Kn="";function cs(n,r){Yr[Wr++]=Ka,Yr[Wr++]=ml,ml=n,Ka=r}function kp(n,r,l){xn[Cn++]=Zn,xn[Cn++]=Kn,xn[Cn++]=Bs,Bs=n;var c=Zn;n=Kn;var m=32-U(c)-1;c&=~(1<<m),l+=1;var y=32-U(r)+m;if(30<y){var R=m-m%5;y=(c&(1<<R)-1).toString(32),c>>=R,m-=R,Zn=1<<32-U(r)+m|l<<m|c,Kn=y+n}else Zn=1<<y|l<<m|c,Kn=n}function _h(n){n.return!==null&&(cs(n,1),kp(n,1,0))}function wh(n){for(;n===ml;)ml=Yr[--Wr],Yr[Wr]=null,Ka=Yr[--Wr],Yr[Wr]=null;for(;n===Bs;)Bs=xn[--Cn],xn[Cn]=null,Kn=xn[--Cn],xn[Cn]=null,Zn=xn[--Cn],xn[Cn]=null}function Mp(n,r){xn[Cn++]=Zn,xn[Cn++]=Kn,xn[Cn++]=Bs,Zn=r.id,Kn=r.overflow,Bs=n}var Bi=null,$e=null,Ee=!1,Is=null,Tn=!1,Eh=Error(i(519));function zs(n){var r=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw $a(Sn(r,n)),Eh}function Lp(n){var r=n.stateNode,l=n.type,c=n.memoizedProps;switch(r[de]=n,r[pe]=c,l){case"dialog":ve("cancel",r),ve("close",r);break;case"iframe":case"object":case"embed":ve("load",r);break;case"video":case"audio":for(l=0;l<Ao.length;l++)ve(Ao[l],r);break;case"source":ve("error",r);break;case"img":case"image":case"link":ve("error",r),ve("load",r);break;case"details":ve("toggle",r);break;case"input":ve("invalid",r),jt(r,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0);break;case"select":ve("invalid",r);break;case"textarea":ve("invalid",r),ri(r,c.value,c.defaultValue,c.children)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||r.textContent===""+l||c.suppressHydrationWarning===!0||$m(r.textContent,l)?(c.popover!=null&&(ve("beforetoggle",r),ve("toggle",r)),c.onScroll!=null&&ve("scroll",r),c.onScrollEnd!=null&&ve("scrollend",r),c.onClick!=null&&(r.onclick=Fn),r=!0):r=!1,r||zs(n,!0)}function Bp(n){for(Bi=n.return;Bi;)switch(Bi.tag){case 5:case 31:case 13:Tn=!1;return;case 27:case 3:Tn=!0;return;default:Bi=Bi.return}}function Zr(n){if(n!==Bi)return!1;if(!Ee)return Bp(n),Ee=!0,!1;var r=n.tag,l;if((l=r!==3&&r!==27)&&((l=r===5)&&(l=n.type,l=!(l!=="form"&&l!=="button")||Hc(n.type,n.memoizedProps)),l=!l),l&&$e&&zs(n),Bp(n),r===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));$e=av(n)}else if(r===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));$e=av(n)}else r===27?(r=$e,$s(n.type)?(n=Xc,Xc=null,$e=n):$e=r):$e=Bi?Rn(n.stateNode.nextSibling):null;return!0}function gr(){$e=Bi=null,Ee=!1}function Sh(){var n=Is;return n!==null&&(rn===null?rn=n:rn.push.apply(rn,n),Is=null),n}function $a(n){Is===null?Is=[n]:Is.push(n)}var xh=j(null),mr=null,ds=null;function Fs(n,r,l){gt(xh,r._currentValue),r._currentValue=l}function fs(n){n._currentValue=xh.current,$(xh)}function Ch(n,r,l){for(;n!==null;){var c=n.alternate;if((n.childLanes&r)!==r?(n.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),n===l)break;n=n.return}}function Th(n,r,l,c){var m=n.child;for(m!==null&&(m.return=n);m!==null;){var y=m.dependencies;if(y!==null){var R=m.child;y=y.firstContext;t:for(;y!==null;){var I=y;y=m;for(var X=0;X<r.length;X++)if(I.context===r[X]){y.lanes|=l,I=y.alternate,I!==null&&(I.lanes|=l),Ch(y.return,l,n),c||(R=null);break t}y=I.next}}else if(m.tag===18){if(R=m.return,R===null)throw Error(i(341));R.lanes|=l,y=R.alternate,y!==null&&(y.lanes|=l),Ch(R,l,n),R=null}else R=m.child;if(R!==null)R.return=m;else for(R=m;R!==null;){if(R===n){R=null;break}if(m=R.sibling,m!==null){m.return=R.return,R=m;break}R=R.return}m=R}}function Kr(n,r,l,c){n=null;for(var m=r,y=!1;m!==null;){if(!y){if((m.flags&524288)!==0)y=!0;else if((m.flags&262144)!==0)break}if(m.tag===10){var R=m.alternate;if(R===null)throw Error(i(387));if(R=R.memoizedProps,R!==null){var I=m.type;cn(m.pendingProps.value,R.value)||(n!==null?n.push(I):n=[I])}}else if(m===kt.current){if(R=m.alternate,R===null)throw Error(i(387));R.memoizedState.memoizedState!==m.memoizedState.memoizedState&&(n!==null?n.push(xo):n=[xo])}m=m.return}n!==null&&Th(r,n,l,c),r.flags|=262144}function vl(n){for(n=n.firstContext;n!==null;){if(!cn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function vr(n){mr=n,ds=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ii(n){return Ip(mr,n)}function yl(n,r){return mr===null&&vr(n),Ip(n,r)}function Ip(n,r){var l=r._currentValue;if(r={context:r,memoizedValue:l,next:null},ds===null){if(n===null)throw Error(i(308));ds=r,n.dependencies={lanes:0,firstContext:r},n.flags|=524288}else ds=ds.next=r;return l}var n2=typeof AbortController<"u"?AbortController:function(){var n=[],r=this.signal={aborted:!1,addEventListener:function(l,c){n.push(c)}};this.abort=function(){r.aborted=!0,n.forEach(function(l){return l()})}},s2=g.unstable_scheduleCallback,r2=g.unstable_NormalPriority,bi={$$typeof:D,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Dh(){return{controller:new n2,data:new Map,refCount:0}}function Qa(n){n.refCount--,n.refCount===0&&s2(r2,function(){n.controller.abort()})}var Ja=null,Rh=0,$r=0,Qr=null;function a2(n,r){if(Ja===null){var l=Ja=[];Rh=0,$r=kc(),Qr={status:"pending",value:void 0,then:function(c){l.push(c)}}}return Rh++,r.then(zp,zp),r}function zp(){if(--Rh===0&&Ja!==null){Qr!==null&&(Qr.status="fulfilled");var n=Ja;Ja=null,$r=0,Qr=null;for(var r=0;r<n.length;r++)(0,n[r])()}}function o2(n,r){var l=[],c={status:"pending",value:null,reason:null,then:function(m){l.push(m)}};return n.then(function(){c.status="fulfilled",c.value=r;for(var m=0;m<l.length;m++)(0,l[m])(r)},function(m){for(c.status="rejected",c.reason=m,m=0;m<l.length;m++)(0,l[m])(void 0)}),c}var Fp=G.S;G.S=function(n,r){_m=De(),typeof r=="object"&&r!==null&&typeof r.then=="function"&&a2(n,r),Fp!==null&&Fp(n,r)};var yr=j(null);function Nh(){var n=yr.current;return n!==null?n:Xe.pooledCache}function bl(n,r){r===null?gt(yr,yr.current):gt(yr,r.pool)}function Pp(){var n=Nh();return n===null?null:{parent:bi._currentValue,pool:n}}var Jr=Error(i(460)),Oh=Error(i(474)),Al=Error(i(542)),_l={then:function(){}};function Up(n){return n=n.status,n==="fulfilled"||n==="rejected"}function Hp(n,r,l){switch(l=n[l],l===void 0?n.push(r):l!==r&&(r.then(Fn,Fn),r=l),r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,qp(n),n;default:if(typeof r.status=="string")r.then(Fn,Fn);else{if(n=Xe,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=r,n.status="pending",n.then(function(c){if(r.status==="pending"){var m=r;m.status="fulfilled",m.value=c}},function(c){if(r.status==="pending"){var m=r;m.status="rejected",m.reason=c}})}switch(r.status){case"fulfilled":return r.value;case"rejected":throw n=r.reason,qp(n),n}throw Ar=r,Jr}}function br(n){try{var r=n._init;return r(n._payload)}catch(l){throw l!==null&&typeof l=="object"&&typeof l.then=="function"?(Ar=l,Jr):l}}var Ar=null;function jp(){if(Ar===null)throw Error(i(459));var n=Ar;return Ar=null,n}function qp(n){if(n===Jr||n===Al)throw Error(i(483))}var ta=null,to=0;function wl(n){var r=to;return to+=1,ta===null&&(ta=[]),Hp(ta,n,r)}function eo(n,r){r=r.props.ref,n.ref=r!==void 0?r:null}function El(n,r){throw r.$$typeof===v?Error(i(525)):(n=Object.prototype.toString.call(r),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)))}function Gp(n){function r(at,J){if(n){var ht=at.deletions;ht===null?(at.deletions=[J],at.flags|=16):ht.push(J)}}function l(at,J){if(!n)return null;for(;J!==null;)r(at,J),J=J.sibling;return null}function c(at){for(var J=new Map;at!==null;)at.key!==null?J.set(at.key,at):J.set(at.index,at),at=at.sibling;return J}function m(at,J){return at=hs(at,J),at.index=0,at.sibling=null,at}function y(at,J,ht){return at.index=ht,n?(ht=at.alternate,ht!==null?(ht=ht.index,ht<J?(at.flags|=67108866,J):ht):(at.flags|=67108866,J)):(at.flags|=1048576,J)}function R(at){return n&&at.alternate===null&&(at.flags|=67108866),at}function I(at,J,ht,_t){return J===null||J.tag!==6?(J=bh(ht,at.mode,_t),J.return=at,J):(J=m(J,ht),J.return=at,J)}function X(at,J,ht,_t){var Vt=ht.type;return Vt===w?vt(at,J,ht.props.children,_t,ht.key):J!==null&&(J.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===z&&br(Vt)===J.type)?(J=m(J,ht.props),eo(J,ht),J.return=at,J):(J=gl(ht.type,ht.key,ht.props,null,at.mode,_t),eo(J,ht),J.return=at,J)}function ct(at,J,ht,_t){return J===null||J.tag!==4||J.stateNode.containerInfo!==ht.containerInfo||J.stateNode.implementation!==ht.implementation?(J=Ah(ht,at.mode,_t),J.return=at,J):(J=m(J,ht.children||[]),J.return=at,J)}function vt(at,J,ht,_t,Vt){return J===null||J.tag!==7?(J=pr(ht,at.mode,_t,Vt),J.return=at,J):(J=m(J,ht),J.return=at,J)}function wt(at,J,ht){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=bh(""+J,at.mode,ht),J.return=at,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case A:return ht=gl(J.type,J.key,J.props,null,at.mode,ht),eo(ht,J),ht.return=at,ht;case C:return J=Ah(J,at.mode,ht),J.return=at,J;case z:return J=br(J),wt(at,J,ht)}if(mt(J)||Z(J))return J=pr(J,at.mode,ht,null),J.return=at,J;if(typeof J.then=="function")return wt(at,wl(J),ht);if(J.$$typeof===D)return wt(at,yl(at,J),ht);El(at,J)}return null}function dt(at,J,ht,_t){var Vt=J!==null?J.key:null;if(typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint")return Vt!==null?null:I(at,J,""+ht,_t);if(typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case A:return ht.key===Vt?X(at,J,ht,_t):null;case C:return ht.key===Vt?ct(at,J,ht,_t):null;case z:return ht=br(ht),dt(at,J,ht,_t)}if(mt(ht)||Z(ht))return Vt!==null?null:vt(at,J,ht,_t,null);if(typeof ht.then=="function")return dt(at,J,wl(ht),_t);if(ht.$$typeof===D)return dt(at,J,yl(at,ht),_t);El(at,ht)}return null}function pt(at,J,ht,_t,Vt){if(typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint")return at=at.get(ht)||null,I(J,at,""+_t,Vt);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case A:return at=at.get(_t.key===null?ht:_t.key)||null,X(J,at,_t,Vt);case C:return at=at.get(_t.key===null?ht:_t.key)||null,ct(J,at,_t,Vt);case z:return _t=br(_t),pt(at,J,ht,_t,Vt)}if(mt(_t)||Z(_t))return at=at.get(ht)||null,vt(J,at,_t,Vt,null);if(typeof _t.then=="function")return pt(at,J,ht,wl(_t),Vt);if(_t.$$typeof===D)return pt(at,J,ht,yl(J,_t),Vt);El(J,_t)}return null}function Ht(at,J,ht,_t){for(var Vt=null,Oe=null,qt=J,ce=J=0,_e=null;qt!==null&&ce<ht.length;ce++){qt.index>ce?(_e=qt,qt=null):_e=qt.sibling;var ke=dt(at,qt,ht[ce],_t);if(ke===null){qt===null&&(qt=_e);break}n&&qt&&ke.alternate===null&&r(at,qt),J=y(ke,J,ce),Oe===null?Vt=ke:Oe.sibling=ke,Oe=ke,qt=_e}if(ce===ht.length)return l(at,qt),Ee&&cs(at,ce),Vt;if(qt===null){for(;ce<ht.length;ce++)qt=wt(at,ht[ce],_t),qt!==null&&(J=y(qt,J,ce),Oe===null?Vt=qt:Oe.sibling=qt,Oe=qt);return Ee&&cs(at,ce),Vt}for(qt=c(qt);ce<ht.length;ce++)_e=pt(qt,at,ce,ht[ce],_t),_e!==null&&(n&&_e.alternate!==null&&qt.delete(_e.key===null?ce:_e.key),J=y(_e,J,ce),Oe===null?Vt=_e:Oe.sibling=_e,Oe=_e);return n&&qt.forEach(function(ir){return r(at,ir)}),Ee&&cs(at,ce),Vt}function Zt(at,J,ht,_t){if(ht==null)throw Error(i(151));for(var Vt=null,Oe=null,qt=J,ce=J=0,_e=null,ke=ht.next();qt!==null&&!ke.done;ce++,ke=ht.next()){qt.index>ce?(_e=qt,qt=null):_e=qt.sibling;var ir=dt(at,qt,ke.value,_t);if(ir===null){qt===null&&(qt=_e);break}n&&qt&&ir.alternate===null&&r(at,qt),J=y(ir,J,ce),Oe===null?Vt=ir:Oe.sibling=ir,Oe=ir,qt=_e}if(ke.done)return l(at,qt),Ee&&cs(at,ce),Vt;if(qt===null){for(;!ke.done;ce++,ke=ht.next())ke=wt(at,ke.value,_t),ke!==null&&(J=y(ke,J,ce),Oe===null?Vt=ke:Oe.sibling=ke,Oe=ke);return Ee&&cs(at,ce),Vt}for(qt=c(qt);!ke.done;ce++,ke=ht.next())ke=pt(qt,at,ce,ke.value,_t),ke!==null&&(n&&ke.alternate!==null&&qt.delete(ke.key===null?ce:ke.key),J=y(ke,J,ce),Oe===null?Vt=ke:Oe.sibling=ke,Oe=ke);return n&&qt.forEach(function(y1){return r(at,y1)}),Ee&&cs(at,ce),Vt}function qe(at,J,ht,_t){if(typeof ht=="object"&&ht!==null&&ht.type===w&&ht.key===null&&(ht=ht.props.children),typeof ht=="object"&&ht!==null){switch(ht.$$typeof){case A:t:{for(var Vt=ht.key;J!==null;){if(J.key===Vt){if(Vt=ht.type,Vt===w){if(J.tag===7){l(at,J.sibling),_t=m(J,ht.props.children),_t.return=at,at=_t;break t}}else if(J.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===z&&br(Vt)===J.type){l(at,J.sibling),_t=m(J,ht.props),eo(_t,ht),_t.return=at,at=_t;break t}l(at,J);break}else r(at,J);J=J.sibling}ht.type===w?(_t=pr(ht.props.children,at.mode,_t,ht.key),_t.return=at,at=_t):(_t=gl(ht.type,ht.key,ht.props,null,at.mode,_t),eo(_t,ht),_t.return=at,at=_t)}return R(at);case C:t:{for(Vt=ht.key;J!==null;){if(J.key===Vt)if(J.tag===4&&J.stateNode.containerInfo===ht.containerInfo&&J.stateNode.implementation===ht.implementation){l(at,J.sibling),_t=m(J,ht.children||[]),_t.return=at,at=_t;break t}else{l(at,J);break}else r(at,J);J=J.sibling}_t=Ah(ht,at.mode,_t),_t.return=at,at=_t}return R(at);case z:return ht=br(ht),qe(at,J,ht,_t)}if(mt(ht))return Ht(at,J,ht,_t);if(Z(ht)){if(Vt=Z(ht),typeof Vt!="function")throw Error(i(150));return ht=Vt.call(ht),Zt(at,J,ht,_t)}if(typeof ht.then=="function")return qe(at,J,wl(ht),_t);if(ht.$$typeof===D)return qe(at,J,yl(at,ht),_t);El(at,ht)}return typeof ht=="string"&&ht!==""||typeof ht=="number"||typeof ht=="bigint"?(ht=""+ht,J!==null&&J.tag===6?(l(at,J.sibling),_t=m(J,ht),_t.return=at,at=_t):(l(at,J),_t=bh(ht,at.mode,_t),_t.return=at,at=_t),R(at)):l(at,J)}return function(at,J,ht,_t){try{to=0;var Vt=qe(at,J,ht,_t);return ta=null,Vt}catch(qt){if(qt===Jr||qt===Al)throw qt;var Oe=dn(29,qt,null,at.mode);return Oe.lanes=_t,Oe.return=at,Oe}}}var _r=Gp(!0),Vp=Gp(!1),Ps=!1;function kh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Mh(n,r){n=n.updateQueue,r.updateQueue===n&&(r.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Us(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Hs(n,r,l){var c=n.updateQueue;if(c===null)return null;if(c=c.shared,(Le&2)!==0){var m=c.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),c.pending=r,r=pl(n),Dp(n,null,l),r}return fl(n,c,r,l),pl(n)}function io(n,r,l){if(r=r.updateQueue,r!==null&&(r=r.shared,(l&4194048)!==0)){var c=r.lanes;c&=n.pendingLanes,l|=c,r.lanes=l,Ot(n,l)}}function Lh(n,r){var l=n.updateQueue,c=n.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var m=null,y=null;if(l=l.firstBaseUpdate,l!==null){do{var R={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};y===null?m=y=R:y=y.next=R,l=l.next}while(l!==null);y===null?m=y=r:y=y.next=r}else m=y=r;l={baseState:c.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:c.shared,callbacks:c.callbacks},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=r:n.next=r,l.lastBaseUpdate=r}var Bh=!1;function no(){if(Bh){var n=Qr;if(n!==null)throw n}}function so(n,r,l,c){Bh=!1;var m=n.updateQueue;Ps=!1;var y=m.firstBaseUpdate,R=m.lastBaseUpdate,I=m.shared.pending;if(I!==null){m.shared.pending=null;var X=I,ct=X.next;X.next=null,R===null?y=ct:R.next=ct,R=X;var vt=n.alternate;vt!==null&&(vt=vt.updateQueue,I=vt.lastBaseUpdate,I!==R&&(I===null?vt.firstBaseUpdate=ct:I.next=ct,vt.lastBaseUpdate=X))}if(y!==null){var wt=m.baseState;R=0,vt=ct=X=null,I=y;do{var dt=I.lane&-536870913,pt=dt!==I.lane;if(pt?(Ae&dt)===dt:(c&dt)===dt){dt!==0&&dt===$r&&(Bh=!0),vt!==null&&(vt=vt.next={lane:0,tag:I.tag,payload:I.payload,callback:null,next:null});t:{var Ht=n,Zt=I;dt=r;var qe=l;switch(Zt.tag){case 1:if(Ht=Zt.payload,typeof Ht=="function"){wt=Ht.call(qe,wt,dt);break t}wt=Ht;break t;case 3:Ht.flags=Ht.flags&-65537|128;case 0:if(Ht=Zt.payload,dt=typeof Ht=="function"?Ht.call(qe,wt,dt):Ht,dt==null)break t;wt=p({},wt,dt);break t;case 2:Ps=!0}}dt=I.callback,dt!==null&&(n.flags|=64,pt&&(n.flags|=8192),pt=m.callbacks,pt===null?m.callbacks=[dt]:pt.push(dt))}else pt={lane:dt,tag:I.tag,payload:I.payload,callback:I.callback,next:null},vt===null?(ct=vt=pt,X=wt):vt=vt.next=pt,R|=dt;if(I=I.next,I===null){if(I=m.shared.pending,I===null)break;pt=I,I=pt.next,pt.next=null,m.lastBaseUpdate=pt,m.shared.pending=null}}while(!0);vt===null&&(X=wt),m.baseState=X,m.firstBaseUpdate=ct,m.lastBaseUpdate=vt,y===null&&(m.shared.lanes=0),Xs|=R,n.lanes=R,n.memoizedState=wt}}function Xp(n,r){if(typeof n!="function")throw Error(i(191,n));n.call(r)}function Yp(n,r){var l=n.callbacks;if(l!==null)for(n.callbacks=null,n=0;n<l.length;n++)Xp(l[n],r)}var ea=j(null),Sl=j(0);function Wp(n,r){n=ws,gt(Sl,n),gt(ea,r),ws=n|r.baseLanes}function Ih(){gt(Sl,ws),gt(ea,ea.current)}function zh(){ws=Sl.current,$(ea),$(Sl)}var fn=j(null),Dn=null;function js(n){var r=n.alternate;gt(gi,gi.current&1),gt(fn,n),Dn===null&&(r===null||ea.current!==null||r.memoizedState!==null)&&(Dn=n)}function Fh(n){gt(gi,gi.current),gt(fn,n),Dn===null&&(Dn=n)}function Zp(n){n.tag===22?(gt(gi,gi.current),gt(fn,n),Dn===null&&(Dn=n)):qs()}function qs(){gt(gi,gi.current),gt(fn,fn.current)}function pn(n){$(fn),Dn===n&&(Dn=null),$(gi)}var gi=j(0);function xl(n){for(var r=n;r!==null;){if(r.tag===13){var l=r.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||Gc(l)||Vc(l)))return r}else if(r.tag===19&&(r.memoizedProps.revealOrder==="forwards"||r.memoizedProps.revealOrder==="backwards"||r.memoizedProps.revealOrder==="unstable_legacy-backwards"||r.memoizedProps.revealOrder==="together")){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var ps=0,he=null,He=null,Ai=null,Cl=!1,ia=!1,wr=!1,Tl=0,ro=0,na=null,l2=0;function ui(){throw Error(i(321))}function Ph(n,r){if(r===null)return!1;for(var l=0;l<r.length&&l<n.length;l++)if(!cn(n[l],r[l]))return!1;return!0}function Uh(n,r,l,c,m,y){return ps=y,he=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,G.H=n===null||n.memoizedState===null?kg:ec,wr=!1,y=l(c,m),wr=!1,ia&&(y=$p(r,l,c,m)),Kp(n),y}function Kp(n){G.H=lo;var r=He!==null&&He.next!==null;if(ps=0,Ai=He=he=null,Cl=!1,ro=0,na=null,r)throw Error(i(300));n===null||_i||(n=n.dependencies,n!==null&&vl(n)&&(_i=!0))}function $p(n,r,l,c){he=n;var m=0;do{if(ia&&(na=null),ro=0,ia=!1,25<=m)throw Error(i(301));if(m+=1,Ai=He=null,n.updateQueue!=null){var y=n.updateQueue;y.lastEffect=null,y.events=null,y.stores=null,y.memoCache!=null&&(y.memoCache.index=0)}G.H=Mg,y=r(l,c)}while(ia);return y}function u2(){var n=G.H,r=n.useState()[0];return r=typeof r.then=="function"?ao(r):r,n=n.useState()[0],(He!==null?He.memoizedState:null)!==n&&(he.flags|=1024),r}function Hh(){var n=Tl!==0;return Tl=0,n}function jh(n,r,l){r.updateQueue=n.updateQueue,r.flags&=-2053,n.lanes&=~l}function qh(n){if(Cl){for(n=n.memoizedState;n!==null;){var r=n.queue;r!==null&&(r.pending=null),n=n.next}Cl=!1}ps=0,Ai=He=he=null,ia=!1,ro=Tl=0,na=null}function Zi(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ai===null?he.memoizedState=Ai=n:Ai=Ai.next=n,Ai}function mi(){if(He===null){var n=he.alternate;n=n!==null?n.memoizedState:null}else n=He.next;var r=Ai===null?he.memoizedState:Ai.next;if(r!==null)Ai=r,He=n;else{if(n===null)throw he.alternate===null?Error(i(467)):Error(i(310));He=n,n={memoizedState:He.memoizedState,baseState:He.baseState,baseQueue:He.baseQueue,queue:He.queue,next:null},Ai===null?he.memoizedState=Ai=n:Ai=Ai.next=n}return Ai}function Dl(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ao(n){var r=ro;return ro+=1,na===null&&(na=[]),n=Hp(na,n,r),r=he,(Ai===null?r.memoizedState:Ai.next)===null&&(r=r.alternate,G.H=r===null||r.memoizedState===null?kg:ec),n}function Rl(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return ao(n);if(n.$$typeof===D)return Ii(n)}throw Error(i(438,String(n)))}function Gh(n){var r=null,l=he.updateQueue;if(l!==null&&(r=l.memoCache),r==null){var c=he.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(r={data:c.data.map(function(m){return m.slice()}),index:0})))}if(r==null&&(r={data:[],index:0}),l===null&&(l=Dl(),he.updateQueue=l),l.memoCache=r,l=r.data[r.index],l===void 0)for(l=r.data[r.index]=Array(n),c=0;c<n;c++)l[c]=H;return r.index++,l}function gs(n,r){return typeof r=="function"?r(n):r}function Nl(n){var r=mi();return Vh(r,He,n)}function Vh(n,r,l){var c=n.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=l;var m=n.baseQueue,y=c.pending;if(y!==null){if(m!==null){var R=m.next;m.next=y.next,y.next=R}r.baseQueue=m=y,c.pending=null}if(y=n.baseState,m===null)n.memoizedState=y;else{r=m.next;var I=R=null,X=null,ct=r,vt=!1;do{var wt=ct.lane&-536870913;if(wt!==ct.lane?(Ae&wt)===wt:(ps&wt)===wt){var dt=ct.revertLane;if(dt===0)X!==null&&(X=X.next={lane:0,revertLane:0,gesture:null,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null}),wt===$r&&(vt=!0);else if((ps&dt)===dt){ct=ct.next,dt===$r&&(vt=!0);continue}else wt={lane:0,revertLane:ct.revertLane,gesture:null,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},X===null?(I=X=wt,R=y):X=X.next=wt,he.lanes|=dt,Xs|=dt;wt=ct.action,wr&&l(y,wt),y=ct.hasEagerState?ct.eagerState:l(y,wt)}else dt={lane:wt,revertLane:ct.revertLane,gesture:ct.gesture,action:ct.action,hasEagerState:ct.hasEagerState,eagerState:ct.eagerState,next:null},X===null?(I=X=dt,R=y):X=X.next=dt,he.lanes|=wt,Xs|=wt;ct=ct.next}while(ct!==null&&ct!==r);if(X===null?R=y:X.next=I,!cn(y,n.memoizedState)&&(_i=!0,vt&&(l=Qr,l!==null)))throw l;n.memoizedState=y,n.baseState=R,n.baseQueue=X,c.lastRenderedState=y}return m===null&&(c.lanes=0),[n.memoizedState,c.dispatch]}function Xh(n){var r=mi(),l=r.queue;if(l===null)throw Error(i(311));l.lastRenderedReducer=n;var c=l.dispatch,m=l.pending,y=r.memoizedState;if(m!==null){l.pending=null;var R=m=m.next;do y=n(y,R.action),R=R.next;while(R!==m);cn(y,r.memoizedState)||(_i=!0),r.memoizedState=y,r.baseQueue===null&&(r.baseState=y),l.lastRenderedState=y}return[y,c]}function Qp(n,r,l){var c=he,m=mi(),y=Ee;if(y){if(l===void 0)throw Error(i(407));l=l()}else l=r();var R=!cn((He||m).memoizedState,l);if(R&&(m.memoizedState=l,_i=!0),m=m.queue,Zh(eg.bind(null,c,m,n),[n]),m.getSnapshot!==r||R||Ai!==null&&Ai.memoizedState.tag&1){if(c.flags|=2048,sa(9,{destroy:void 0},tg.bind(null,c,m,l,r),null),Xe===null)throw Error(i(349));y||(ps&127)!==0||Jp(c,r,l)}return l}function Jp(n,r,l){n.flags|=16384,n={getSnapshot:r,value:l},r=he.updateQueue,r===null?(r=Dl(),he.updateQueue=r,r.stores=[n]):(l=r.stores,l===null?r.stores=[n]:l.push(n))}function tg(n,r,l,c){r.value=l,r.getSnapshot=c,ig(r)&&ng(n)}function eg(n,r,l){return l(function(){ig(r)&&ng(n)})}function ig(n){var r=n.getSnapshot;n=n.value;try{var l=r();return!cn(n,l)}catch{return!0}}function ng(n){var r=fr(n,2);r!==null&&an(r,n,2)}function Yh(n){var r=Zi();if(typeof n=="function"){var l=n;if(n=l(),wr){yi(!0);try{l()}finally{yi(!1)}}}return r.memoizedState=r.baseState=n,r.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:n},r}function sg(n,r,l,c){return n.baseState=l,Vh(n,He,typeof c=="function"?c:gs)}function h2(n,r,l,c,m){if(Ml(n))throw Error(i(485));if(n=r.action,n!==null){var y={payload:m,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){y.listeners.push(R)}};G.T!==null?l(!0):y.isTransition=!1,c(y),l=r.pending,l===null?(y.next=r.pending=y,rg(r,y)):(y.next=l.next,r.pending=l.next=y)}}function rg(n,r){var l=r.action,c=r.payload,m=n.state;if(r.isTransition){var y=G.T,R={};G.T=R;try{var I=l(m,c),X=G.S;X!==null&&X(R,I),ag(n,r,I)}catch(ct){Wh(n,r,ct)}finally{y!==null&&R.types!==null&&(y.types=R.types),G.T=y}}else try{y=l(m,c),ag(n,r,y)}catch(ct){Wh(n,r,ct)}}function ag(n,r,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){og(n,r,c)},function(c){return Wh(n,r,c)}):og(n,r,l)}function og(n,r,l){r.status="fulfilled",r.value=l,lg(r),n.state=l,r=n.pending,r!==null&&(l=r.next,l===r?n.pending=null:(l=l.next,r.next=l,rg(n,l)))}function Wh(n,r,l){var c=n.pending;if(n.pending=null,c!==null){c=c.next;do r.status="rejected",r.reason=l,lg(r),r=r.next;while(r!==c)}n.action=null}function lg(n){n=n.listeners;for(var r=0;r<n.length;r++)(0,n[r])()}function ug(n,r){return r}function hg(n,r){if(Ee){var l=Xe.formState;if(l!==null){t:{var c=he;if(Ee){if($e){e:{for(var m=$e,y=Tn;m.nodeType!==8;){if(!y){m=null;break e}if(m=Rn(m.nextSibling),m===null){m=null;break e}}y=m.data,m=y==="F!"||y==="F"?m:null}if(m){$e=Rn(m.nextSibling),c=m.data==="F!";break t}}zs(c)}c=!1}c&&(r=l[0])}}return l=Zi(),l.memoizedState=l.baseState=r,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ug,lastRenderedState:r},l.queue=c,l=Rg.bind(null,he,c),c.dispatch=l,c=Yh(!1),y=tc.bind(null,he,!1,c.queue),c=Zi(),m={state:r,dispatch:null,action:n,pending:null},c.queue=m,l=h2.bind(null,he,m,y,l),m.dispatch=l,c.memoizedState=n,[r,l,!1]}function cg(n){var r=mi();return dg(r,He,n)}function dg(n,r,l){if(r=Vh(n,r,ug)[0],n=Nl(gs)[0],typeof r=="object"&&r!==null&&typeof r.then=="function")try{var c=ao(r)}catch(R){throw R===Jr?Al:R}else c=r;r=mi();var m=r.queue,y=m.dispatch;return l!==r.memoizedState&&(he.flags|=2048,sa(9,{destroy:void 0},c2.bind(null,m,l),null)),[c,y,n]}function c2(n,r){n.action=r}function fg(n){var r=mi(),l=He;if(l!==null)return dg(r,l,n);mi(),r=r.memoizedState,l=mi();var c=l.queue.dispatch;return l.memoizedState=n,[r,c,!1]}function sa(n,r,l,c){return n={tag:n,create:l,deps:c,inst:r,next:null},r=he.updateQueue,r===null&&(r=Dl(),he.updateQueue=r),l=r.lastEffect,l===null?r.lastEffect=n.next=n:(c=l.next,l.next=n,n.next=c,r.lastEffect=n),n}function pg(){return mi().memoizedState}function Ol(n,r,l,c){var m=Zi();he.flags|=n,m.memoizedState=sa(1|r,{destroy:void 0},l,c===void 0?null:c)}function kl(n,r,l,c){var m=mi();c=c===void 0?null:c;var y=m.memoizedState.inst;He!==null&&c!==null&&Ph(c,He.memoizedState.deps)?m.memoizedState=sa(r,y,l,c):(he.flags|=n,m.memoizedState=sa(1|r,y,l,c))}function gg(n,r){Ol(8390656,8,n,r)}function Zh(n,r){kl(2048,8,n,r)}function d2(n){he.flags|=4;var r=he.updateQueue;if(r===null)r=Dl(),he.updateQueue=r,r.events=[n];else{var l=r.events;l===null?r.events=[n]:l.push(n)}}function mg(n){var r=mi().memoizedState;return d2({ref:r,nextImpl:n}),function(){if((Le&2)!==0)throw Error(i(440));return r.impl.apply(void 0,arguments)}}function vg(n,r){return kl(4,2,n,r)}function yg(n,r){return kl(4,4,n,r)}function bg(n,r){if(typeof r=="function"){n=n();var l=r(n);return function(){typeof l=="function"?l():r(null)}}if(r!=null)return n=n(),r.current=n,function(){r.current=null}}function Ag(n,r,l){l=l!=null?l.concat([n]):null,kl(4,4,bg.bind(null,r,n),l)}function Kh(){}function _g(n,r){var l=mi();r=r===void 0?null:r;var c=l.memoizedState;return r!==null&&Ph(r,c[1])?c[0]:(l.memoizedState=[n,r],n)}function wg(n,r){var l=mi();r=r===void 0?null:r;var c=l.memoizedState;if(r!==null&&Ph(r,c[1]))return c[0];if(c=n(),wr){yi(!0);try{n()}finally{yi(!1)}}return l.memoizedState=[c,r],c}function $h(n,r,l){return l===void 0||(ps&1073741824)!==0&&(Ae&261930)===0?n.memoizedState=r:(n.memoizedState=l,n=Em(),he.lanes|=n,Xs|=n,l)}function Eg(n,r,l,c){return cn(l,r)?l:ea.current!==null?(n=$h(n,l,c),cn(n,r)||(_i=!0),n):(ps&42)===0||(ps&1073741824)!==0&&(Ae&261930)===0?(_i=!0,n.memoizedState=l):(n=Em(),he.lanes|=n,Xs|=n,r)}function Sg(n,r,l,c,m){var y=W.p;W.p=y!==0&&8>y?y:8;var R=G.T,I={};G.T=I,tc(n,!1,r,l);try{var X=m(),ct=G.S;if(ct!==null&&ct(I,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var vt=o2(X,c);oo(n,r,vt,vn(n))}else oo(n,r,c,vn(n))}catch(wt){oo(n,r,{then:function(){},status:"rejected",reason:wt},vn())}finally{W.p=y,R!==null&&I.types!==null&&(R.types=I.types),G.T=R}}function f2(){}function Qh(n,r,l,c){if(n.tag!==5)throw Error(i(476));var m=xg(n).queue;Sg(n,m,r,st,l===null?f2:function(){return Cg(n),l(c)})}function xg(n){var r=n.memoizedState;if(r!==null)return r;r={memoizedState:st,baseState:st,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:st},next:null};var l={};return r.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gs,lastRenderedState:l},next:null},n.memoizedState=r,n=n.alternate,n!==null&&(n.memoizedState=r),r}function Cg(n){var r=xg(n);r.next===null&&(r=n.alternate.memoizedState),oo(n,r.next.queue,{},vn())}function Jh(){return Ii(xo)}function Tg(){return mi().memoizedState}function Dg(){return mi().memoizedState}function p2(n){for(var r=n.return;r!==null;){switch(r.tag){case 24:case 3:var l=vn();n=Us(l);var c=Hs(r,n,l);c!==null&&(an(c,r,l),io(c,r,l)),r={cache:Dh()},n.payload=r;return}r=r.return}}function g2(n,r,l){var c=vn();l={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null},Ml(n)?Ng(r,l):(l=vh(n,r,l,c),l!==null&&(an(l,n,c),Og(l,r,c)))}function Rg(n,r,l){var c=vn();oo(n,r,l,c)}function oo(n,r,l,c){var m={lane:c,revertLane:0,gesture:null,action:l,hasEagerState:!1,eagerState:null,next:null};if(Ml(n))Ng(r,m);else{var y=n.alternate;if(n.lanes===0&&(y===null||y.lanes===0)&&(y=r.lastRenderedReducer,y!==null))try{var R=r.lastRenderedState,I=y(R,l);if(m.hasEagerState=!0,m.eagerState=I,cn(I,R))return fl(n,r,m,0),Xe===null&&dl(),!1}catch{}if(l=vh(n,r,m,c),l!==null)return an(l,n,c),Og(l,r,c),!0}return!1}function tc(n,r,l,c){if(c={lane:2,revertLane:kc(),gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ml(n)){if(r)throw Error(i(479))}else r=vh(n,l,c,2),r!==null&&an(r,n,2)}function Ml(n){var r=n.alternate;return n===he||r!==null&&r===he}function Ng(n,r){ia=Cl=!0;var l=n.pending;l===null?r.next=r:(r.next=l.next,l.next=r),n.pending=r}function Og(n,r,l){if((l&4194048)!==0){var c=r.lanes;c&=n.pendingLanes,l|=c,r.lanes=l,Ot(n,l)}}var lo={readContext:Ii,use:Rl,useCallback:ui,useContext:ui,useEffect:ui,useImperativeHandle:ui,useLayoutEffect:ui,useInsertionEffect:ui,useMemo:ui,useReducer:ui,useRef:ui,useState:ui,useDebugValue:ui,useDeferredValue:ui,useTransition:ui,useSyncExternalStore:ui,useId:ui,useHostTransitionStatus:ui,useFormState:ui,useActionState:ui,useOptimistic:ui,useMemoCache:ui,useCacheRefresh:ui};lo.useEffectEvent=ui;var kg={readContext:Ii,use:Rl,useCallback:function(n,r){return Zi().memoizedState=[n,r===void 0?null:r],n},useContext:Ii,useEffect:gg,useImperativeHandle:function(n,r,l){l=l!=null?l.concat([n]):null,Ol(4194308,4,bg.bind(null,r,n),l)},useLayoutEffect:function(n,r){return Ol(4194308,4,n,r)},useInsertionEffect:function(n,r){Ol(4,2,n,r)},useMemo:function(n,r){var l=Zi();r=r===void 0?null:r;var c=n();if(wr){yi(!0);try{n()}finally{yi(!1)}}return l.memoizedState=[c,r],c},useReducer:function(n,r,l){var c=Zi();if(l!==void 0){var m=l(r);if(wr){yi(!0);try{l(r)}finally{yi(!1)}}}else m=r;return c.memoizedState=c.baseState=m,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:m},c.queue=n,n=n.dispatch=g2.bind(null,he,n),[c.memoizedState,n]},useRef:function(n){var r=Zi();return n={current:n},r.memoizedState=n},useState:function(n){n=Yh(n);var r=n.queue,l=Rg.bind(null,he,r);return r.dispatch=l,[n.memoizedState,l]},useDebugValue:Kh,useDeferredValue:function(n,r){var l=Zi();return $h(l,n,r)},useTransition:function(){var n=Yh(!1);return n=Sg.bind(null,he,n.queue,!0,!1),Zi().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,r,l){var c=he,m=Zi();if(Ee){if(l===void 0)throw Error(i(407));l=l()}else{if(l=r(),Xe===null)throw Error(i(349));(Ae&127)!==0||Jp(c,r,l)}m.memoizedState=l;var y={value:l,getSnapshot:r};return m.queue=y,gg(eg.bind(null,c,y,n),[n]),c.flags|=2048,sa(9,{destroy:void 0},tg.bind(null,c,y,l,r),null),l},useId:function(){var n=Zi(),r=Xe.identifierPrefix;if(Ee){var l=Kn,c=Zn;l=(c&~(1<<32-U(c)-1)).toString(32)+l,r="_"+r+"R_"+l,l=Tl++,0<l&&(r+="H"+l.toString(32)),r+="_"}else l=l2++,r="_"+r+"r_"+l.toString(32)+"_";return n.memoizedState=r},useHostTransitionStatus:Jh,useFormState:hg,useActionState:hg,useOptimistic:function(n){var r=Zi();r.memoizedState=r.baseState=n;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return r.queue=l,r=tc.bind(null,he,!0,l),l.dispatch=r,[n,r]},useMemoCache:Gh,useCacheRefresh:function(){return Zi().memoizedState=p2.bind(null,he)},useEffectEvent:function(n){var r=Zi(),l={impl:n};return r.memoizedState=l,function(){if((Le&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}},ec={readContext:Ii,use:Rl,useCallback:_g,useContext:Ii,useEffect:Zh,useImperativeHandle:Ag,useInsertionEffect:vg,useLayoutEffect:yg,useMemo:wg,useReducer:Nl,useRef:pg,useState:function(){return Nl(gs)},useDebugValue:Kh,useDeferredValue:function(n,r){var l=mi();return Eg(l,He.memoizedState,n,r)},useTransition:function(){var n=Nl(gs)[0],r=mi().memoizedState;return[typeof n=="boolean"?n:ao(n),r]},useSyncExternalStore:Qp,useId:Tg,useHostTransitionStatus:Jh,useFormState:cg,useActionState:cg,useOptimistic:function(n,r){var l=mi();return sg(l,He,n,r)},useMemoCache:Gh,useCacheRefresh:Dg};ec.useEffectEvent=mg;var Mg={readContext:Ii,use:Rl,useCallback:_g,useContext:Ii,useEffect:Zh,useImperativeHandle:Ag,useInsertionEffect:vg,useLayoutEffect:yg,useMemo:wg,useReducer:Xh,useRef:pg,useState:function(){return Xh(gs)},useDebugValue:Kh,useDeferredValue:function(n,r){var l=mi();return He===null?$h(l,n,r):Eg(l,He.memoizedState,n,r)},useTransition:function(){var n=Xh(gs)[0],r=mi().memoizedState;return[typeof n=="boolean"?n:ao(n),r]},useSyncExternalStore:Qp,useId:Tg,useHostTransitionStatus:Jh,useFormState:fg,useActionState:fg,useOptimistic:function(n,r){var l=mi();return He!==null?sg(l,He,n,r):(l.baseState=n,[n,l.queue.dispatch])},useMemoCache:Gh,useCacheRefresh:Dg};Mg.useEffectEvent=mg;function ic(n,r,l,c){r=n.memoizedState,l=l(c,r),l=l==null?r:p({},r,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var nc={enqueueSetState:function(n,r,l){n=n._reactInternals;var c=vn(),m=Us(c);m.payload=r,l!=null&&(m.callback=l),r=Hs(n,m,c),r!==null&&(an(r,n,c),io(r,n,c))},enqueueReplaceState:function(n,r,l){n=n._reactInternals;var c=vn(),m=Us(c);m.tag=1,m.payload=r,l!=null&&(m.callback=l),r=Hs(n,m,c),r!==null&&(an(r,n,c),io(r,n,c))},enqueueForceUpdate:function(n,r){n=n._reactInternals;var l=vn(),c=Us(l);c.tag=2,r!=null&&(c.callback=r),r=Hs(n,c,l),r!==null&&(an(r,n,l),io(r,n,l))}};function Lg(n,r,l,c,m,y,R){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(c,y,R):r.prototype&&r.prototype.isPureReactComponent?!Wa(l,c)||!Wa(m,y):!0}function Bg(n,r,l,c){n=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(l,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(l,c),r.state!==n&&nc.enqueueReplaceState(r,r.state,null)}function Er(n,r){var l=r;if("ref"in r){l={};for(var c in r)c!=="ref"&&(l[c]=r[c])}if(n=n.defaultProps){l===r&&(l=p({},l));for(var m in n)l[m]===void 0&&(l[m]=n[m])}return l}function Ig(n){cl(n)}function zg(n){console.error(n)}function Fg(n){cl(n)}function Ll(n,r){try{var l=n.onUncaughtError;l(r.value,{componentStack:r.stack})}catch(c){setTimeout(function(){throw c})}}function Pg(n,r,l){try{var c=n.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:r.tag===1?r.stateNode:null})}catch(m){setTimeout(function(){throw m})}}function sc(n,r,l){return l=Us(l),l.tag=3,l.payload={element:null},l.callback=function(){Ll(n,r)},l}function Ug(n){return n=Us(n),n.tag=3,n}function Hg(n,r,l,c){var m=l.type.getDerivedStateFromError;if(typeof m=="function"){var y=c.value;n.payload=function(){return m(y)},n.callback=function(){Pg(r,l,c)}}var R=l.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(n.callback=function(){Pg(r,l,c),typeof m!="function"&&(Ys===null?Ys=new Set([this]):Ys.add(this));var I=c.stack;this.componentDidCatch(c.value,{componentStack:I!==null?I:""})})}function m2(n,r,l,c,m){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(r=l.alternate,r!==null&&Kr(r,l,m,!0),l=fn.current,l!==null){switch(l.tag){case 31:case 13:return Dn===null?Xl():l.alternate===null&&hi===0&&(hi=3),l.flags&=-257,l.flags|=65536,l.lanes=m,c===_l?l.flags|=16384:(r=l.updateQueue,r===null?l.updateQueue=new Set([c]):r.add(c),Rc(n,c,m)),!1;case 22:return l.flags|=65536,c===_l?l.flags|=16384:(r=l.updateQueue,r===null?(r={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=r):(l=r.retryQueue,l===null?r.retryQueue=new Set([c]):l.add(c)),Rc(n,c,m)),!1}throw Error(i(435,l.tag))}return Rc(n,c,m),Xl(),!1}if(Ee)return r=fn.current,r!==null?((r.flags&65536)===0&&(r.flags|=256),r.flags|=65536,r.lanes=m,c!==Eh&&(n=Error(i(422),{cause:c}),$a(Sn(n,l)))):(c!==Eh&&(r=Error(i(423),{cause:c}),$a(Sn(r,l))),n=n.current.alternate,n.flags|=65536,m&=-m,n.lanes|=m,c=Sn(c,l),m=sc(n.stateNode,c,m),Lh(n,m),hi!==4&&(hi=2)),!1;var y=Error(i(520),{cause:c});if(y=Sn(y,l),vo===null?vo=[y]:vo.push(y),hi!==4&&(hi=2),r===null)return!0;c=Sn(c,l),l=r;do{switch(l.tag){case 3:return l.flags|=65536,n=m&-m,l.lanes|=n,n=sc(l.stateNode,c,n),Lh(l,n),!1;case 1:if(r=l.type,y=l.stateNode,(l.flags&128)===0&&(typeof r.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ys===null||!Ys.has(y))))return l.flags|=65536,m&=-m,l.lanes|=m,m=Ug(m),Hg(m,n,l,c),Lh(l,m),!1}l=l.return}while(l!==null);return!1}var rc=Error(i(461)),_i=!1;function zi(n,r,l,c){r.child=n===null?Vp(r,null,l,c):_r(r,n.child,l,c)}function jg(n,r,l,c,m){l=l.render;var y=r.ref;if("ref"in c){var R={};for(var I in c)I!=="ref"&&(R[I]=c[I])}else R=c;return vr(r),c=Uh(n,r,l,R,y,m),I=Hh(),n!==null&&!_i?(jh(n,r,m),ms(n,r,m)):(Ee&&I&&_h(r),r.flags|=1,zi(n,r,c,m),r.child)}function qg(n,r,l,c,m){if(n===null){var y=l.type;return typeof y=="function"&&!yh(y)&&y.defaultProps===void 0&&l.compare===null?(r.tag=15,r.type=y,Gg(n,r,y,c,m)):(n=gl(l.type,null,c,r,r.mode,m),n.ref=r.ref,n.return=r,r.child=n)}if(y=n.child,!fc(n,m)){var R=y.memoizedProps;if(l=l.compare,l=l!==null?l:Wa,l(R,c)&&n.ref===r.ref)return ms(n,r,m)}return r.flags|=1,n=hs(y,c),n.ref=r.ref,n.return=r,r.child=n}function Gg(n,r,l,c,m){if(n!==null){var y=n.memoizedProps;if(Wa(y,c)&&n.ref===r.ref)if(_i=!1,r.pendingProps=c=y,fc(n,m))(n.flags&131072)!==0&&(_i=!0);else return r.lanes=n.lanes,ms(n,r,m)}return ac(n,r,l,c,m)}function Vg(n,r,l,c){var m=c.children,y=n!==null?n.memoizedState:null;if(n===null&&r.stateNode===null&&(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),c.mode==="hidden"){if((r.flags&128)!==0){if(y=y!==null?y.baseLanes|l:l,n!==null){for(c=r.child=n.child,m=0;c!==null;)m=m|c.lanes|c.childLanes,c=c.sibling;c=m&~y}else c=0,r.child=null;return Xg(n,r,y,l,c)}if((l&536870912)!==0)r.memoizedState={baseLanes:0,cachePool:null},n!==null&&bl(r,y!==null?y.cachePool:null),y!==null?Wp(r,y):Ih(),Zp(r);else return c=r.lanes=536870912,Xg(n,r,y!==null?y.baseLanes|l:l,l,c)}else y!==null?(bl(r,y.cachePool),Wp(r,y),qs(),r.memoizedState=null):(n!==null&&bl(r,null),Ih(),qs());return zi(n,r,m,l),r.child}function uo(n,r){return n!==null&&n.tag===22||r.stateNode!==null||(r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.sibling}function Xg(n,r,l,c,m){var y=Nh();return y=y===null?null:{parent:bi._currentValue,pool:y},r.memoizedState={baseLanes:l,cachePool:y},n!==null&&bl(r,null),Ih(),Zp(r),n!==null&&Kr(n,r,c,!0),r.childLanes=m,null}function Bl(n,r){return r=zl({mode:r.mode,children:r.children},n.mode),r.ref=n.ref,n.child=r,r.return=n,r}function Yg(n,r,l){return _r(r,n.child,null,l),n=Bl(r,r.pendingProps),n.flags|=2,pn(r),r.memoizedState=null,n}function v2(n,r,l){var c=r.pendingProps,m=(r.flags&128)!==0;if(r.flags&=-129,n===null){if(Ee){if(c.mode==="hidden")return n=Bl(r,c),r.lanes=536870912,uo(null,n);if(Fh(r),(n=$e)?(n=rv(n,Tn),n=n!==null&&n.data==="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Bs!==null?{id:Zn,overflow:Kn}:null,retryLane:536870912,hydrationErrors:null},l=Np(n),l.return=r,r.child=l,Bi=r,$e=null)):n=null,n===null)throw zs(r);return r.lanes=536870912,null}return Bl(r,c)}var y=n.memoizedState;if(y!==null){var R=y.dehydrated;if(Fh(r),m)if(r.flags&256)r.flags&=-257,r=Yg(n,r,l);else if(r.memoizedState!==null)r.child=n.child,r.flags|=128,r=null;else throw Error(i(558));else if(_i||Kr(n,r,l,!1),m=(l&n.childLanes)!==0,_i||m){if(c=Xe,c!==null&&(R=Mt(c,l),R!==0&&R!==y.retryLane))throw y.retryLane=R,fr(n,R),an(c,n,R),rc;Xl(),r=Yg(n,r,l)}else n=y.treeContext,$e=Rn(R.nextSibling),Bi=r,Ee=!0,Is=null,Tn=!1,n!==null&&Mp(r,n),r=Bl(r,c),r.flags|=4096;return r}return n=hs(n.child,{mode:c.mode,children:c.children}),n.ref=r.ref,r.child=n,n.return=r,n}function Il(n,r){var l=r.ref;if(l===null)n!==null&&n.ref!==null&&(r.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(i(284));(n===null||n.ref!==l)&&(r.flags|=4194816)}}function ac(n,r,l,c,m){return vr(r),l=Uh(n,r,l,c,void 0,m),c=Hh(),n!==null&&!_i?(jh(n,r,m),ms(n,r,m)):(Ee&&c&&_h(r),r.flags|=1,zi(n,r,l,m),r.child)}function Wg(n,r,l,c,m,y){return vr(r),r.updateQueue=null,l=$p(r,c,l,m),Kp(n),c=Hh(),n!==null&&!_i?(jh(n,r,y),ms(n,r,y)):(Ee&&c&&_h(r),r.flags|=1,zi(n,r,l,y),r.child)}function Zg(n,r,l,c,m){if(vr(r),r.stateNode===null){var y=Xr,R=l.contextType;typeof R=="object"&&R!==null&&(y=Ii(R)),y=new l(c,y),r.memoizedState=y.state!==null&&y.state!==void 0?y.state:null,y.updater=nc,r.stateNode=y,y._reactInternals=r,y=r.stateNode,y.props=c,y.state=r.memoizedState,y.refs={},kh(r),R=l.contextType,y.context=typeof R=="object"&&R!==null?Ii(R):Xr,y.state=r.memoizedState,R=l.getDerivedStateFromProps,typeof R=="function"&&(ic(r,l,R,c),y.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof y.getSnapshotBeforeUpdate=="function"||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(R=y.state,typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount(),R!==y.state&&nc.enqueueReplaceState(y,y.state,null),so(r,c,y,m),no(),y.state=r.memoizedState),typeof y.componentDidMount=="function"&&(r.flags|=4194308),c=!0}else if(n===null){y=r.stateNode;var I=r.memoizedProps,X=Er(l,I);y.props=X;var ct=y.context,vt=l.contextType;R=Xr,typeof vt=="object"&&vt!==null&&(R=Ii(vt));var wt=l.getDerivedStateFromProps;vt=typeof wt=="function"||typeof y.getSnapshotBeforeUpdate=="function",I=r.pendingProps!==I,vt||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(I||ct!==R)&&Bg(r,y,c,R),Ps=!1;var dt=r.memoizedState;y.state=dt,so(r,c,y,m),no(),ct=r.memoizedState,I||dt!==ct||Ps?(typeof wt=="function"&&(ic(r,l,wt,c),ct=r.memoizedState),(X=Ps||Lg(r,l,X,c,dt,ct,R))?(vt||typeof y.UNSAFE_componentWillMount!="function"&&typeof y.componentWillMount!="function"||(typeof y.componentWillMount=="function"&&y.componentWillMount(),typeof y.UNSAFE_componentWillMount=="function"&&y.UNSAFE_componentWillMount()),typeof y.componentDidMount=="function"&&(r.flags|=4194308)):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=ct),y.props=c,y.state=ct,y.context=R,c=X):(typeof y.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{y=r.stateNode,Mh(n,r),R=r.memoizedProps,vt=Er(l,R),y.props=vt,wt=r.pendingProps,dt=y.context,ct=l.contextType,X=Xr,typeof ct=="object"&&ct!==null&&(X=Ii(ct)),I=l.getDerivedStateFromProps,(ct=typeof I=="function"||typeof y.getSnapshotBeforeUpdate=="function")||typeof y.UNSAFE_componentWillReceiveProps!="function"&&typeof y.componentWillReceiveProps!="function"||(R!==wt||dt!==X)&&Bg(r,y,c,X),Ps=!1,dt=r.memoizedState,y.state=dt,so(r,c,y,m),no();var pt=r.memoizedState;R!==wt||dt!==pt||Ps||n!==null&&n.dependencies!==null&&vl(n.dependencies)?(typeof I=="function"&&(ic(r,l,I,c),pt=r.memoizedState),(vt=Ps||Lg(r,l,vt,c,dt,pt,X)||n!==null&&n.dependencies!==null&&vl(n.dependencies))?(ct||typeof y.UNSAFE_componentWillUpdate!="function"&&typeof y.componentWillUpdate!="function"||(typeof y.componentWillUpdate=="function"&&y.componentWillUpdate(c,pt,X),typeof y.UNSAFE_componentWillUpdate=="function"&&y.UNSAFE_componentWillUpdate(c,pt,X)),typeof y.componentDidUpdate=="function"&&(r.flags|=4),typeof y.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof y.componentDidUpdate!="function"||R===n.memoizedProps&&dt===n.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||R===n.memoizedProps&&dt===n.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=pt),y.props=c,y.state=pt,y.context=X,c=vt):(typeof y.componentDidUpdate!="function"||R===n.memoizedProps&&dt===n.memoizedState||(r.flags|=4),typeof y.getSnapshotBeforeUpdate!="function"||R===n.memoizedProps&&dt===n.memoizedState||(r.flags|=1024),c=!1)}return y=c,Il(n,r),c=(r.flags&128)!==0,y||c?(y=r.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:y.render(),r.flags|=1,n!==null&&c?(r.child=_r(r,n.child,null,m),r.child=_r(r,null,l,m)):zi(n,r,l,m),r.memoizedState=y.state,n=r.child):n=ms(n,r,m),n}function Kg(n,r,l,c){return gr(),r.flags|=256,zi(n,r,l,c),r.child}var oc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function lc(n){return{baseLanes:n,cachePool:Pp()}}function uc(n,r,l){return n=n!==null?n.childLanes&~l:0,r&&(n|=mn),n}function $g(n,r,l){var c=r.pendingProps,m=!1,y=(r.flags&128)!==0,R;if((R=y)||(R=n!==null&&n.memoizedState===null?!1:(gi.current&2)!==0),R&&(m=!0,r.flags&=-129),R=(r.flags&32)!==0,r.flags&=-33,n===null){if(Ee){if(m?js(r):qs(),(n=$e)?(n=rv(n,Tn),n=n!==null&&n.data!=="&"?n:null,n!==null&&(r.memoizedState={dehydrated:n,treeContext:Bs!==null?{id:Zn,overflow:Kn}:null,retryLane:536870912,hydrationErrors:null},l=Np(n),l.return=r,r.child=l,Bi=r,$e=null)):n=null,n===null)throw zs(r);return Vc(n)?r.lanes=32:r.lanes=536870912,null}var I=c.children;return c=c.fallback,m?(qs(),m=r.mode,I=zl({mode:"hidden",children:I},m),c=pr(c,m,l,null),I.return=r,c.return=r,I.sibling=c,r.child=I,c=r.child,c.memoizedState=lc(l),c.childLanes=uc(n,R,l),r.memoizedState=oc,uo(null,c)):(js(r),hc(r,I))}var X=n.memoizedState;if(X!==null&&(I=X.dehydrated,I!==null)){if(y)r.flags&256?(js(r),r.flags&=-257,r=cc(n,r,l)):r.memoizedState!==null?(qs(),r.child=n.child,r.flags|=128,r=null):(qs(),I=c.fallback,m=r.mode,c=zl({mode:"visible",children:c.children},m),I=pr(I,m,l,null),I.flags|=2,c.return=r,I.return=r,c.sibling=I,r.child=c,_r(r,n.child,null,l),c=r.child,c.memoizedState=lc(l),c.childLanes=uc(n,R,l),r.memoizedState=oc,r=uo(null,c));else if(js(r),Vc(I)){if(R=I.nextSibling&&I.nextSibling.dataset,R)var ct=R.dgst;R=ct,c=Error(i(419)),c.stack="",c.digest=R,$a({value:c,source:null,stack:null}),r=cc(n,r,l)}else if(_i||Kr(n,r,l,!1),R=(l&n.childLanes)!==0,_i||R){if(R=Xe,R!==null&&(c=Mt(R,l),c!==0&&c!==X.retryLane))throw X.retryLane=c,fr(n,c),an(R,n,c),rc;Gc(I)||Xl(),r=cc(n,r,l)}else Gc(I)?(r.flags|=192,r.child=n.child,r=null):(n=X.treeContext,$e=Rn(I.nextSibling),Bi=r,Ee=!0,Is=null,Tn=!1,n!==null&&Mp(r,n),r=hc(r,c.children),r.flags|=4096);return r}return m?(qs(),I=c.fallback,m=r.mode,X=n.child,ct=X.sibling,c=hs(X,{mode:"hidden",children:c.children}),c.subtreeFlags=X.subtreeFlags&65011712,ct!==null?I=hs(ct,I):(I=pr(I,m,l,null),I.flags|=2),I.return=r,c.return=r,c.sibling=I,r.child=c,uo(null,c),c=r.child,I=n.child.memoizedState,I===null?I=lc(l):(m=I.cachePool,m!==null?(X=bi._currentValue,m=m.parent!==X?{parent:X,pool:X}:m):m=Pp(),I={baseLanes:I.baseLanes|l,cachePool:m}),c.memoizedState=I,c.childLanes=uc(n,R,l),r.memoizedState=oc,uo(n.child,c)):(js(r),l=n.child,n=l.sibling,l=hs(l,{mode:"visible",children:c.children}),l.return=r,l.sibling=null,n!==null&&(R=r.deletions,R===null?(r.deletions=[n],r.flags|=16):R.push(n)),r.child=l,r.memoizedState=null,l)}function hc(n,r){return r=zl({mode:"visible",children:r},n.mode),r.return=n,n.child=r}function zl(n,r){return n=dn(22,n,null,r),n.lanes=0,n}function cc(n,r,l){return _r(r,n.child,null,l),n=hc(r,r.pendingProps.children),n.flags|=2,r.memoizedState=null,n}function Qg(n,r,l){n.lanes|=r;var c=n.alternate;c!==null&&(c.lanes|=r),Ch(n.return,r,l)}function dc(n,r,l,c,m,y){var R=n.memoizedState;R===null?n.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:m,treeForkCount:y}:(R.isBackwards=r,R.rendering=null,R.renderingStartTime=0,R.last=c,R.tail=l,R.tailMode=m,R.treeForkCount=y)}function Jg(n,r,l){var c=r.pendingProps,m=c.revealOrder,y=c.tail;c=c.children;var R=gi.current,I=(R&2)!==0;if(I?(R=R&1|2,r.flags|=128):R&=1,gt(gi,R),zi(n,r,c,l),c=Ee?Ka:0,!I&&n!==null&&(n.flags&128)!==0)t:for(n=r.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Qg(n,l,r);else if(n.tag===19)Qg(n,l,r);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break t;for(;n.sibling===null;){if(n.return===null||n.return===r)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(m){case"forwards":for(l=r.child,m=null;l!==null;)n=l.alternate,n!==null&&xl(n)===null&&(m=l),l=l.sibling;l=m,l===null?(m=r.child,r.child=null):(m=l.sibling,l.sibling=null),dc(r,!1,m,l,y,c);break;case"backwards":case"unstable_legacy-backwards":for(l=null,m=r.child,r.child=null;m!==null;){if(n=m.alternate,n!==null&&xl(n)===null){r.child=m;break}n=m.sibling,m.sibling=l,l=m,m=n}dc(r,!0,l,null,y,c);break;case"together":dc(r,!1,null,null,void 0,c);break;default:r.memoizedState=null}return r.child}function ms(n,r,l){if(n!==null&&(r.dependencies=n.dependencies),Xs|=r.lanes,(l&r.childLanes)===0)if(n!==null){if(Kr(n,r,l,!1),(l&r.childLanes)===0)return null}else return null;if(n!==null&&r.child!==n.child)throw Error(i(153));if(r.child!==null){for(n=r.child,l=hs(n,n.pendingProps),r.child=l,l.return=r;n.sibling!==null;)n=n.sibling,l=l.sibling=hs(n,n.pendingProps),l.return=r;l.sibling=null}return r.child}function fc(n,r){return(n.lanes&r)!==0?!0:(n=n.dependencies,!!(n!==null&&vl(n)))}function y2(n,r,l){switch(r.tag){case 3:Lt(r,r.stateNode.containerInfo),Fs(r,bi,n.memoizedState.cache),gr();break;case 27:case 5:ye(r);break;case 4:Lt(r,r.stateNode.containerInfo);break;case 10:Fs(r,r.type,r.memoizedProps.value);break;case 31:if(r.memoizedState!==null)return r.flags|=128,Fh(r),null;break;case 13:var c=r.memoizedState;if(c!==null)return c.dehydrated!==null?(js(r),r.flags|=128,null):(l&r.child.childLanes)!==0?$g(n,r,l):(js(r),n=ms(n,r,l),n!==null?n.sibling:null);js(r);break;case 19:var m=(n.flags&128)!==0;if(c=(l&r.childLanes)!==0,c||(Kr(n,r,l,!1),c=(l&r.childLanes)!==0),m){if(c)return Jg(n,r,l);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),gt(gi,gi.current),c)break;return null;case 22:return r.lanes=0,Vg(n,r,l,r.pendingProps);case 24:Fs(r,bi,n.memoizedState.cache)}return ms(n,r,l)}function tm(n,r,l){if(n!==null)if(n.memoizedProps!==r.pendingProps)_i=!0;else{if(!fc(n,l)&&(r.flags&128)===0)return _i=!1,y2(n,r,l);_i=(n.flags&131072)!==0}else _i=!1,Ee&&(r.flags&1048576)!==0&&kp(r,Ka,r.index);switch(r.lanes=0,r.tag){case 16:t:{var c=r.pendingProps;if(n=br(r.elementType),r.type=n,typeof n=="function")yh(n)?(c=Er(n,c),r.tag=1,r=Zg(null,r,n,c,l)):(r.tag=0,r=ac(null,r,n,c,l));else{if(n!=null){var m=n.$$typeof;if(m===M){r.tag=11,r=jg(null,r,n,c,l);break t}else if(m===k){r.tag=14,r=qg(null,r,n,c,l);break t}}throw r=ft(n)||n,Error(i(306,r,""))}}return r;case 0:return ac(n,r,r.type,r.pendingProps,l);case 1:return c=r.type,m=Er(c,r.pendingProps),Zg(n,r,c,m,l);case 3:t:{if(Lt(r,r.stateNode.containerInfo),n===null)throw Error(i(387));c=r.pendingProps;var y=r.memoizedState;m=y.element,Mh(n,r),so(r,c,null,l);var R=r.memoizedState;if(c=R.cache,Fs(r,bi,c),c!==y.cache&&Th(r,[bi],l,!0),no(),c=R.element,y.isDehydrated)if(y={element:c,isDehydrated:!1,cache:R.cache},r.updateQueue.baseState=y,r.memoizedState=y,r.flags&256){r=Kg(n,r,c,l);break t}else if(c!==m){m=Sn(Error(i(424)),r),$a(m),r=Kg(n,r,c,l);break t}else for(n=r.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,$e=Rn(n.firstChild),Bi=r,Ee=!0,Is=null,Tn=!0,l=Vp(r,null,c,l),r.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(gr(),c===m){r=ms(n,r,l);break t}zi(n,r,c,l)}r=r.child}return r;case 26:return Il(n,r),n===null?(l=cv(r.type,null,r.pendingProps,null))?r.memoizedState=l:Ee||(l=r.type,n=r.pendingProps,c=Jl(zt.current).createElement(l),c[de]=r,c[pe]=n,Fi(c,l,n),pi(c),r.stateNode=c):r.memoizedState=cv(r.type,n.memoizedProps,r.pendingProps,n.memoizedState),null;case 27:return ye(r),n===null&&Ee&&(c=r.stateNode=lv(r.type,r.pendingProps,zt.current),Bi=r,Tn=!0,m=$e,$s(r.type)?(Xc=m,$e=Rn(c.firstChild)):$e=m),zi(n,r,r.pendingProps.children,l),Il(n,r),n===null&&(r.flags|=4194304),r.child;case 5:return n===null&&Ee&&((m=c=$e)&&(c=W2(c,r.type,r.pendingProps,Tn),c!==null?(r.stateNode=c,Bi=r,$e=Rn(c.firstChild),Tn=!1,m=!0):m=!1),m||zs(r)),ye(r),m=r.type,y=r.pendingProps,R=n!==null?n.memoizedProps:null,c=y.children,Hc(m,y)?c=null:R!==null&&Hc(m,R)&&(r.flags|=32),r.memoizedState!==null&&(m=Uh(n,r,u2,null,null,l),xo._currentValue=m),Il(n,r),zi(n,r,c,l),r.child;case 6:return n===null&&Ee&&((n=l=$e)&&(l=Z2(l,r.pendingProps,Tn),l!==null?(r.stateNode=l,Bi=r,$e=null,n=!0):n=!1),n||zs(r)),null;case 13:return $g(n,r,l);case 4:return Lt(r,r.stateNode.containerInfo),c=r.pendingProps,n===null?r.child=_r(r,null,c,l):zi(n,r,c,l),r.child;case 11:return jg(n,r,r.type,r.pendingProps,l);case 7:return zi(n,r,r.pendingProps,l),r.child;case 8:return zi(n,r,r.pendingProps.children,l),r.child;case 12:return zi(n,r,r.pendingProps.children,l),r.child;case 10:return c=r.pendingProps,Fs(r,r.type,c.value),zi(n,r,c.children,l),r.child;case 9:return m=r.type._context,c=r.pendingProps.children,vr(r),m=Ii(m),c=c(m),r.flags|=1,zi(n,r,c,l),r.child;case 14:return qg(n,r,r.type,r.pendingProps,l);case 15:return Gg(n,r,r.type,r.pendingProps,l);case 19:return Jg(n,r,l);case 31:return v2(n,r,l);case 22:return Vg(n,r,l,r.pendingProps);case 24:return vr(r),c=Ii(bi),n===null?(m=Nh(),m===null&&(m=Xe,y=Dh(),m.pooledCache=y,y.refCount++,y!==null&&(m.pooledCacheLanes|=l),m=y),r.memoizedState={parent:c,cache:m},kh(r),Fs(r,bi,m)):((n.lanes&l)!==0&&(Mh(n,r),so(r,null,null,l),no()),m=n.memoizedState,y=r.memoizedState,m.parent!==c?(m={parent:c,cache:c},r.memoizedState=m,r.lanes===0&&(r.memoizedState=r.updateQueue.baseState=m),Fs(r,bi,c)):(c=y.cache,Fs(r,bi,c),c!==m.cache&&Th(r,[bi],l,!0))),zi(n,r,r.pendingProps.children,l),r.child;case 29:throw r.pendingProps}throw Error(i(156,r.tag))}function vs(n){n.flags|=4}function pc(n,r,l,c,m){if((r=(n.mode&32)!==0)&&(r=!1),r){if(n.flags|=16777216,(m&335544128)===m)if(n.stateNode.complete)n.flags|=8192;else if(Tm())n.flags|=8192;else throw Ar=_l,Oh}else n.flags&=-16777217}function em(n,r){if(r.type!=="stylesheet"||(r.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!mv(r))if(Tm())n.flags|=8192;else throw Ar=_l,Oh}function Fl(n,r){r!==null&&(n.flags|=4),n.flags&16384&&(r=n.tag!==22?lt():536870912,n.lanes|=r,la|=r)}function ho(n,r){if(!Ee)switch(n.tailMode){case"hidden":r=n.tail;for(var l=null;r!==null;)r.alternate!==null&&(l=r),r=r.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?r||n.tail===null?n.tail=null:n.tail.sibling=null:c.sibling=null}}function Qe(n){var r=n.alternate!==null&&n.alternate.child===n.child,l=0,c=0;if(r)for(var m=n.child;m!==null;)l|=m.lanes|m.childLanes,c|=m.subtreeFlags&65011712,c|=m.flags&65011712,m.return=n,m=m.sibling;else for(m=n.child;m!==null;)l|=m.lanes|m.childLanes,c|=m.subtreeFlags,c|=m.flags,m.return=n,m=m.sibling;return n.subtreeFlags|=c,n.childLanes=l,r}function b2(n,r,l){var c=r.pendingProps;switch(wh(r),r.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qe(r),null;case 1:return Qe(r),null;case 3:return l=r.stateNode,c=null,n!==null&&(c=n.memoizedState.cache),r.memoizedState.cache!==c&&(r.flags|=2048),fs(bi),Gt(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(n===null||n.child===null)&&(Zr(r)?vs(r):n===null||n.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,Sh())),Qe(r),null;case 26:var m=r.type,y=r.memoizedState;return n===null?(vs(r),y!==null?(Qe(r),em(r,y)):(Qe(r),pc(r,m,null,c,l))):y?y!==n.memoizedState?(vs(r),Qe(r),em(r,y)):(Qe(r),r.flags&=-16777217):(n=n.memoizedProps,n!==c&&vs(r),Qe(r),pc(r,m,n,c,l)),null;case 27:if(Yt(r),l=zt.current,m=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&vs(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Qe(r),null}n=yt.current,Zr(r)?Lp(r):(n=lv(m,c,l),r.stateNode=n,vs(r))}return Qe(r),null;case 5:if(Yt(r),m=r.type,n!==null&&r.stateNode!=null)n.memoizedProps!==c&&vs(r);else{if(!c){if(r.stateNode===null)throw Error(i(166));return Qe(r),null}if(y=yt.current,Zr(r))Lp(r);else{var R=Jl(zt.current);switch(y){case 1:y=R.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:y=R.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":y=R.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":y=R.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":y=R.createElement("div"),y.innerHTML="<script><\/script>",y=y.removeChild(y.firstChild);break;case"select":y=typeof c.is=="string"?R.createElement("select",{is:c.is}):R.createElement("select"),c.multiple?y.multiple=!0:c.size&&(y.size=c.size);break;default:y=typeof c.is=="string"?R.createElement(m,{is:c.is}):R.createElement(m)}}y[de]=r,y[pe]=c;t:for(R=r.child;R!==null;){if(R.tag===5||R.tag===6)y.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===r)break t;for(;R.sibling===null;){if(R.return===null||R.return===r)break t;R=R.return}R.sibling.return=R.return,R=R.sibling}r.stateNode=y;t:switch(Fi(y,m,c),m){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break t;case"img":c=!0;break t;default:c=!1}c&&vs(r)}}return Qe(r),pc(r,r.type,n===null?null:n.memoizedProps,r.pendingProps,l),null;case 6:if(n&&r.stateNode!=null)n.memoizedProps!==c&&vs(r);else{if(typeof c!="string"&&r.stateNode===null)throw Error(i(166));if(n=zt.current,Zr(r)){if(n=r.stateNode,l=r.memoizedProps,c=null,m=Bi,m!==null)switch(m.tag){case 27:case 5:c=m.memoizedProps}n[de]=r,n=!!(n.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||$m(n.nodeValue,l)),n||zs(r,!0)}else n=Jl(n).createTextNode(c),n[de]=r,r.stateNode=n}return Qe(r),null;case 31:if(l=r.memoizedState,n===null||n.memoizedState!==null){if(c=Zr(r),l!==null){if(n===null){if(!c)throw Error(i(318));if(n=r.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[de]=r}else gr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qe(r),n=!1}else l=Sh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=l),n=!0;if(!n)return r.flags&256?(pn(r),r):(pn(r),null);if((r.flags&128)!==0)throw Error(i(558))}return Qe(r),null;case 13:if(c=r.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(m=Zr(r),c!==null&&c.dehydrated!==null){if(n===null){if(!m)throw Error(i(318));if(m=r.memoizedState,m=m!==null?m.dehydrated:null,!m)throw Error(i(317));m[de]=r}else gr(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;Qe(r),m=!1}else m=Sh(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=m),m=!0;if(!m)return r.flags&256?(pn(r),r):(pn(r),null)}return pn(r),(r.flags&128)!==0?(r.lanes=l,r):(l=c!==null,n=n!==null&&n.memoizedState!==null,l&&(c=r.child,m=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(m=c.alternate.memoizedState.cachePool.pool),y=null,c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(y=c.memoizedState.cachePool.pool),y!==m&&(c.flags|=2048)),l!==n&&l&&(r.child.flags|=8192),Fl(r,r.updateQueue),Qe(r),null);case 4:return Gt(),n===null&&Ic(r.stateNode.containerInfo),Qe(r),null;case 10:return fs(r.type),Qe(r),null;case 19:if($(gi),c=r.memoizedState,c===null)return Qe(r),null;if(m=(r.flags&128)!==0,y=c.rendering,y===null)if(m)ho(c,!1);else{if(hi!==0||n!==null&&(n.flags&128)!==0)for(n=r.child;n!==null;){if(y=xl(n),y!==null){for(r.flags|=128,ho(c,!1),n=y.updateQueue,r.updateQueue=n,Fl(r,n),r.subtreeFlags=0,n=l,l=r.child;l!==null;)Rp(l,n),l=l.sibling;return gt(gi,gi.current&1|2),Ee&&cs(r,c.treeForkCount),r.child}n=n.sibling}c.tail!==null&&De()>ql&&(r.flags|=128,m=!0,ho(c,!1),r.lanes=4194304)}else{if(!m)if(n=xl(y),n!==null){if(r.flags|=128,m=!0,n=n.updateQueue,r.updateQueue=n,Fl(r,n),ho(c,!0),c.tail===null&&c.tailMode==="hidden"&&!y.alternate&&!Ee)return Qe(r),null}else 2*De()-c.renderingStartTime>ql&&l!==536870912&&(r.flags|=128,m=!0,ho(c,!1),r.lanes=4194304);c.isBackwards?(y.sibling=r.child,r.child=y):(n=c.last,n!==null?n.sibling=y:r.child=y,c.last=y)}return c.tail!==null?(n=c.tail,c.rendering=n,c.tail=n.sibling,c.renderingStartTime=De(),n.sibling=null,l=gi.current,gt(gi,m?l&1|2:l&1),Ee&&cs(r,c.treeForkCount),n):(Qe(r),null);case 22:case 23:return pn(r),zh(),c=r.memoizedState!==null,n!==null?n.memoizedState!==null!==c&&(r.flags|=8192):c&&(r.flags|=8192),c?(l&536870912)!==0&&(r.flags&128)===0&&(Qe(r),r.subtreeFlags&6&&(r.flags|=8192)):Qe(r),l=r.updateQueue,l!==null&&Fl(r,l.retryQueue),l=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),c=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(c=r.memoizedState.cachePool.pool),c!==l&&(r.flags|=2048),n!==null&&$(yr),null;case 24:return l=null,n!==null&&(l=n.memoizedState.cache),r.memoizedState.cache!==l&&(r.flags|=2048),fs(bi),Qe(r),null;case 25:return null;case 30:return null}throw Error(i(156,r.tag))}function A2(n,r){switch(wh(r),r.tag){case 1:return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 3:return fs(bi),Gt(),n=r.flags,(n&65536)!==0&&(n&128)===0?(r.flags=n&-65537|128,r):null;case 26:case 27:case 5:return Yt(r),null;case 31:if(r.memoizedState!==null){if(pn(r),r.alternate===null)throw Error(i(340));gr()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 13:if(pn(r),n=r.memoizedState,n!==null&&n.dehydrated!==null){if(r.alternate===null)throw Error(i(340));gr()}return n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 19:return $(gi),null;case 4:return Gt(),null;case 10:return fs(r.type),null;case 22:case 23:return pn(r),zh(),n!==null&&$(yr),n=r.flags,n&65536?(r.flags=n&-65537|128,r):null;case 24:return fs(bi),null;case 25:return null;default:return null}}function im(n,r){switch(wh(r),r.tag){case 3:fs(bi),Gt();break;case 26:case 27:case 5:Yt(r);break;case 4:Gt();break;case 31:r.memoizedState!==null&&pn(r);break;case 13:pn(r);break;case 19:$(gi);break;case 10:fs(r.type);break;case 22:case 23:pn(r),zh(),n!==null&&$(yr);break;case 24:fs(bi)}}function co(n,r){try{var l=r.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var m=c.next;l=m;do{if((l.tag&n)===n){c=void 0;var y=l.create,R=l.inst;c=y(),R.destroy=c}l=l.next}while(l!==m)}}catch(I){Fe(r,r.return,I)}}function Gs(n,r,l){try{var c=r.updateQueue,m=c!==null?c.lastEffect:null;if(m!==null){var y=m.next;c=y;do{if((c.tag&n)===n){var R=c.inst,I=R.destroy;if(I!==void 0){R.destroy=void 0,m=r;var X=l,ct=I;try{ct()}catch(vt){Fe(m,X,vt)}}}c=c.next}while(c!==y)}}catch(vt){Fe(r,r.return,vt)}}function nm(n){var r=n.updateQueue;if(r!==null){var l=n.stateNode;try{Yp(r,l)}catch(c){Fe(n,n.return,c)}}}function sm(n,r,l){l.props=Er(n.type,n.memoizedProps),l.state=n.memoizedState;try{l.componentWillUnmount()}catch(c){Fe(n,r,c)}}function fo(n,r){try{var l=n.ref;if(l!==null){switch(n.tag){case 26:case 27:case 5:var c=n.stateNode;break;case 30:c=n.stateNode;break;default:c=n.stateNode}typeof l=="function"?n.refCleanup=l(c):l.current=c}}catch(m){Fe(n,r,m)}}function $n(n,r){var l=n.ref,c=n.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(m){Fe(n,r,m)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(m){Fe(n,r,m)}else l.current=null}function rm(n){var r=n.type,l=n.memoizedProps,c=n.stateNode;try{t:switch(r){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break t;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(m){Fe(n,n.return,m)}}function gc(n,r,l){try{var c=n.stateNode;j2(c,n.type,l,r),c[pe]=r}catch(m){Fe(n,n.return,m)}}function am(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&$s(n.type)||n.tag===4}function mc(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||am(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&$s(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function vc(n,r,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(n,r):(r=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,r.appendChild(n),l=l._reactRootContainer,l!=null||r.onclick!==null||(r.onclick=Fn));else if(c!==4&&(c===27&&$s(n.type)&&(l=n.stateNode,r=null),n=n.child,n!==null))for(vc(n,r,l),n=n.sibling;n!==null;)vc(n,r,l),n=n.sibling}function Pl(n,r,l){var c=n.tag;if(c===5||c===6)n=n.stateNode,r?l.insertBefore(n,r):l.appendChild(n);else if(c!==4&&(c===27&&$s(n.type)&&(l=n.stateNode),n=n.child,n!==null))for(Pl(n,r,l),n=n.sibling;n!==null;)Pl(n,r,l),n=n.sibling}function om(n){var r=n.stateNode,l=n.memoizedProps;try{for(var c=n.type,m=r.attributes;m.length;)r.removeAttributeNode(m[0]);Fi(r,c,l),r[de]=n,r[pe]=l}catch(y){Fe(n,n.return,y)}}var ys=!1,wi=!1,yc=!1,lm=typeof WeakSet=="function"?WeakSet:Set,Ri=null;function _2(n,r){if(n=n.containerInfo,Pc=au,n=Ap(n),ch(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else t:{l=(l=n.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var m=c.anchorOffset,y=c.focusNode;c=c.focusOffset;try{l.nodeType,y.nodeType}catch{l=null;break t}var R=0,I=-1,X=-1,ct=0,vt=0,wt=n,dt=null;e:for(;;){for(var pt;wt!==l||m!==0&&wt.nodeType!==3||(I=R+m),wt!==y||c!==0&&wt.nodeType!==3||(X=R+c),wt.nodeType===3&&(R+=wt.nodeValue.length),(pt=wt.firstChild)!==null;)dt=wt,wt=pt;for(;;){if(wt===n)break e;if(dt===l&&++ct===m&&(I=R),dt===y&&++vt===c&&(X=R),(pt=wt.nextSibling)!==null)break;wt=dt,dt=wt.parentNode}wt=pt}l=I===-1||X===-1?null:{start:I,end:X}}else l=null}l=l||{start:0,end:0}}else l=null;for(Uc={focusedElem:n,selectionRange:l},au=!1,Ri=r;Ri!==null;)if(r=Ri,n=r.child,(r.subtreeFlags&1028)!==0&&n!==null)n.return=r,Ri=n;else for(;Ri!==null;){switch(r=Ri,y=r.alternate,n=r.flags,r.tag){case 0:if((n&4)!==0&&(n=r.updateQueue,n=n!==null?n.events:null,n!==null))for(l=0;l<n.length;l++)m=n[l],m.ref.impl=m.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&y!==null){n=void 0,l=r,m=y.memoizedProps,y=y.memoizedState,c=l.stateNode;try{var Ht=Er(l.type,m);n=c.getSnapshotBeforeUpdate(Ht,y),c.__reactInternalSnapshotBeforeUpdate=n}catch(Zt){Fe(l,l.return,Zt)}}break;case 3:if((n&1024)!==0){if(n=r.stateNode.containerInfo,l=n.nodeType,l===9)qc(n);else if(l===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":qc(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=r.sibling,n!==null){n.return=r.return,Ri=n;break}Ri=r.return}}function um(n,r,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:As(n,l),c&4&&co(5,l);break;case 1:if(As(n,l),c&4)if(n=l.stateNode,r===null)try{n.componentDidMount()}catch(R){Fe(l,l.return,R)}else{var m=Er(l.type,r.memoizedProps);r=r.memoizedState;try{n.componentDidUpdate(m,r,n.__reactInternalSnapshotBeforeUpdate)}catch(R){Fe(l,l.return,R)}}c&64&&nm(l),c&512&&fo(l,l.return);break;case 3:if(As(n,l),c&64&&(n=l.updateQueue,n!==null)){if(r=null,l.child!==null)switch(l.child.tag){case 27:case 5:r=l.child.stateNode;break;case 1:r=l.child.stateNode}try{Yp(n,r)}catch(R){Fe(l,l.return,R)}}break;case 27:r===null&&c&4&&om(l);case 26:case 5:As(n,l),r===null&&c&4&&rm(l),c&512&&fo(l,l.return);break;case 12:As(n,l);break;case 31:As(n,l),c&4&&dm(n,l);break;case 13:As(n,l),c&4&&fm(n,l),c&64&&(n=l.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(l=N2.bind(null,l),K2(n,l))));break;case 22:if(c=l.memoizedState!==null||ys,!c){r=r!==null&&r.memoizedState!==null||wi,m=ys;var y=wi;ys=c,(wi=r)&&!y?_s(n,l,(l.subtreeFlags&8772)!==0):As(n,l),ys=m,wi=y}break;case 30:break;default:As(n,l)}}function hm(n){var r=n.alternate;r!==null&&(n.alternate=null,hm(r)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(r=n.stateNode,r!==null&&Xi(r)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var ei=null,en=!1;function bs(n,r,l){for(l=l.child;l!==null;)cm(n,r,l),l=l.sibling}function cm(n,r,l){if(Me&&typeof Me.onCommitFiberUnmount=="function")try{Me.onCommitFiberUnmount(Pe,l)}catch{}switch(l.tag){case 26:wi||$n(l,r),bs(n,r,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:wi||$n(l,r);var c=ei,m=en;$s(l.type)&&(ei=l.stateNode,en=!1),bs(n,r,l),wo(l.stateNode),ei=c,en=m;break;case 5:wi||$n(l,r);case 6:if(c=ei,m=en,ei=null,bs(n,r,l),ei=c,en=m,ei!==null)if(en)try{(ei.nodeType===9?ei.body:ei.nodeName==="HTML"?ei.ownerDocument.body:ei).removeChild(l.stateNode)}catch(y){Fe(l,r,y)}else try{ei.removeChild(l.stateNode)}catch(y){Fe(l,r,y)}break;case 18:ei!==null&&(en?(n=ei,nv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,l.stateNode),ma(n)):nv(ei,l.stateNode));break;case 4:c=ei,m=en,ei=l.stateNode.containerInfo,en=!0,bs(n,r,l),ei=c,en=m;break;case 0:case 11:case 14:case 15:Gs(2,l,r),wi||Gs(4,l,r),bs(n,r,l);break;case 1:wi||($n(l,r),c=l.stateNode,typeof c.componentWillUnmount=="function"&&sm(l,r,c)),bs(n,r,l);break;case 21:bs(n,r,l);break;case 22:wi=(c=wi)||l.memoizedState!==null,bs(n,r,l),wi=c;break;default:bs(n,r,l)}}function dm(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{ma(n)}catch(l){Fe(r,r.return,l)}}}function fm(n,r){if(r.memoizedState===null&&(n=r.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{ma(n)}catch(l){Fe(r,r.return,l)}}function w2(n){switch(n.tag){case 31:case 13:case 19:var r=n.stateNode;return r===null&&(r=n.stateNode=new lm),r;case 22:return n=n.stateNode,r=n._retryCache,r===null&&(r=n._retryCache=new lm),r;default:throw Error(i(435,n.tag))}}function Ul(n,r){var l=w2(n);r.forEach(function(c){if(!l.has(c)){l.add(c);var m=O2.bind(null,n,c);c.then(m,m)}})}function nn(n,r){var l=r.deletions;if(l!==null)for(var c=0;c<l.length;c++){var m=l[c],y=n,R=r,I=R;t:for(;I!==null;){switch(I.tag){case 27:if($s(I.type)){ei=I.stateNode,en=!1;break t}break;case 5:ei=I.stateNode,en=!1;break t;case 3:case 4:ei=I.stateNode.containerInfo,en=!0;break t}I=I.return}if(ei===null)throw Error(i(160));cm(y,R,m),ei=null,en=!1,y=m.alternate,y!==null&&(y.return=null),m.return=null}if(r.subtreeFlags&13886)for(r=r.child;r!==null;)pm(r,n),r=r.sibling}var Un=null;function pm(n,r){var l=n.alternate,c=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:nn(r,n),sn(n),c&4&&(Gs(3,n,n.return),co(3,n),Gs(5,n,n.return));break;case 1:nn(r,n),sn(n),c&512&&(wi||l===null||$n(l,l.return)),c&64&&ys&&(n=n.updateQueue,n!==null&&(c=n.callbacks,c!==null&&(l=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var m=Un;if(nn(r,n),sn(n),c&512&&(wi||l===null||$n(l,l.return)),c&4){var y=l!==null?l.memoizedState:null;if(c=n.memoizedState,l===null)if(c===null)if(n.stateNode===null){t:{c=n.type,l=n.memoizedProps,m=m.ownerDocument||m;e:switch(c){case"title":y=m.getElementsByTagName("title")[0],(!y||y[Li]||y[de]||y.namespaceURI==="http://www.w3.org/2000/svg"||y.hasAttribute("itemprop"))&&(y=m.createElement(c),m.head.insertBefore(y,m.querySelector("head > title"))),Fi(y,c,l),y[de]=n,pi(y),c=y;break t;case"link":var R=pv("link","href",m).get(c+(l.href||""));if(R){for(var I=0;I<R.length;I++)if(y=R[I],y.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&y.getAttribute("rel")===(l.rel==null?null:l.rel)&&y.getAttribute("title")===(l.title==null?null:l.title)&&y.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){R.splice(I,1);break e}}y=m.createElement(c),Fi(y,c,l),m.head.appendChild(y);break;case"meta":if(R=pv("meta","content",m).get(c+(l.content||""))){for(I=0;I<R.length;I++)if(y=R[I],y.getAttribute("content")===(l.content==null?null:""+l.content)&&y.getAttribute("name")===(l.name==null?null:l.name)&&y.getAttribute("property")===(l.property==null?null:l.property)&&y.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&y.getAttribute("charset")===(l.charSet==null?null:l.charSet)){R.splice(I,1);break e}}y=m.createElement(c),Fi(y,c,l),m.head.appendChild(y);break;default:throw Error(i(468,c))}y[de]=n,pi(y),c=y}n.stateNode=c}else gv(m,n.type,n.stateNode);else n.stateNode=fv(m,c,n.memoizedProps);else y!==c?(y===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):y.count--,c===null?gv(m,n.type,n.stateNode):fv(m,c,n.memoizedProps)):c===null&&n.stateNode!==null&&gc(n,n.memoizedProps,l.memoizedProps)}break;case 27:nn(r,n),sn(n),c&512&&(wi||l===null||$n(l,l.return)),l!==null&&c&4&&gc(n,n.memoizedProps,l.memoizedProps);break;case 5:if(nn(r,n),sn(n),c&512&&(wi||l===null||$n(l,l.return)),n.flags&32){m=n.stateNode;try{Ue(m,"")}catch(Ht){Fe(n,n.return,Ht)}}c&4&&n.stateNode!=null&&(m=n.memoizedProps,gc(n,m,l!==null?l.memoizedProps:m)),c&1024&&(yc=!0);break;case 6:if(nn(r,n),sn(n),c&4){if(n.stateNode===null)throw Error(i(162));c=n.memoizedProps,l=n.stateNode;try{l.nodeValue=c}catch(Ht){Fe(n,n.return,Ht)}}break;case 3:if(iu=null,m=Un,Un=tu(r.containerInfo),nn(r,n),Un=m,sn(n),c&4&&l!==null&&l.memoizedState.isDehydrated)try{ma(r.containerInfo)}catch(Ht){Fe(n,n.return,Ht)}yc&&(yc=!1,gm(n));break;case 4:c=Un,Un=tu(n.stateNode.containerInfo),nn(r,n),sn(n),Un=c;break;case 12:nn(r,n),sn(n);break;case 31:nn(r,n),sn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Ul(n,c)));break;case 13:nn(r,n),sn(n),n.child.flags&8192&&n.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(jl=De()),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Ul(n,c)));break;case 22:m=n.memoizedState!==null;var X=l!==null&&l.memoizedState!==null,ct=ys,vt=wi;if(ys=ct||m,wi=vt||X,nn(r,n),wi=vt,ys=ct,sn(n),c&8192)t:for(r=n.stateNode,r._visibility=m?r._visibility&-2:r._visibility|1,m&&(l===null||X||ys||wi||Sr(n)),l=null,r=n;;){if(r.tag===5||r.tag===26){if(l===null){X=l=r;try{if(y=X.stateNode,m)R=y.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{I=X.stateNode;var wt=X.memoizedProps.style,dt=wt!=null&&wt.hasOwnProperty("display")?wt.display:null;I.style.display=dt==null||typeof dt=="boolean"?"":(""+dt).trim()}}catch(Ht){Fe(X,X.return,Ht)}}}else if(r.tag===6){if(l===null){X=r;try{X.stateNode.nodeValue=m?"":X.memoizedProps}catch(Ht){Fe(X,X.return,Ht)}}}else if(r.tag===18){if(l===null){X=r;try{var pt=X.stateNode;m?sv(pt,!0):sv(X.stateNode,!1)}catch(Ht){Fe(X,X.return,Ht)}}}else if((r.tag!==22&&r.tag!==23||r.memoizedState===null||r===n)&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break t;for(;r.sibling===null;){if(r.return===null||r.return===n)break t;l===r&&(l=null),r=r.return}l===r&&(l=null),r.sibling.return=r.return,r=r.sibling}c&4&&(c=n.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,Ul(n,l))));break;case 19:nn(r,n),sn(n),c&4&&(c=n.updateQueue,c!==null&&(n.updateQueue=null,Ul(n,c)));break;case 30:break;case 21:break;default:nn(r,n),sn(n)}}function sn(n){var r=n.flags;if(r&2){try{for(var l,c=n.return;c!==null;){if(am(c)){l=c;break}c=c.return}if(l==null)throw Error(i(160));switch(l.tag){case 27:var m=l.stateNode,y=mc(n);Pl(n,y,m);break;case 5:var R=l.stateNode;l.flags&32&&(Ue(R,""),l.flags&=-33);var I=mc(n);Pl(n,I,R);break;case 3:case 4:var X=l.stateNode.containerInfo,ct=mc(n);vc(n,ct,X);break;default:throw Error(i(161))}}catch(vt){Fe(n,n.return,vt)}n.flags&=-3}r&4096&&(n.flags&=-4097)}function gm(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var r=n;gm(r),r.tag===5&&r.flags&1024&&r.stateNode.reset(),n=n.sibling}}function As(n,r){if(r.subtreeFlags&8772)for(r=r.child;r!==null;)um(n,r.alternate,r),r=r.sibling}function Sr(n){for(n=n.child;n!==null;){var r=n;switch(r.tag){case 0:case 11:case 14:case 15:Gs(4,r,r.return),Sr(r);break;case 1:$n(r,r.return);var l=r.stateNode;typeof l.componentWillUnmount=="function"&&sm(r,r.return,l),Sr(r);break;case 27:wo(r.stateNode);case 26:case 5:$n(r,r.return),Sr(r);break;case 22:r.memoizedState===null&&Sr(r);break;case 30:Sr(r);break;default:Sr(r)}n=n.sibling}}function _s(n,r,l){for(l=l&&(r.subtreeFlags&8772)!==0,r=r.child;r!==null;){var c=r.alternate,m=n,y=r,R=y.flags;switch(y.tag){case 0:case 11:case 15:_s(m,y,l),co(4,y);break;case 1:if(_s(m,y,l),c=y,m=c.stateNode,typeof m.componentDidMount=="function")try{m.componentDidMount()}catch(ct){Fe(c,c.return,ct)}if(c=y,m=c.updateQueue,m!==null){var I=c.stateNode;try{var X=m.shared.hiddenCallbacks;if(X!==null)for(m.shared.hiddenCallbacks=null,m=0;m<X.length;m++)Xp(X[m],I)}catch(ct){Fe(c,c.return,ct)}}l&&R&64&&nm(y),fo(y,y.return);break;case 27:om(y);case 26:case 5:_s(m,y,l),l&&c===null&&R&4&&rm(y),fo(y,y.return);break;case 12:_s(m,y,l);break;case 31:_s(m,y,l),l&&R&4&&dm(m,y);break;case 13:_s(m,y,l),l&&R&4&&fm(m,y);break;case 22:y.memoizedState===null&&_s(m,y,l),fo(y,y.return);break;case 30:break;default:_s(m,y,l)}r=r.sibling}}function bc(n,r){var l=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(l=n.memoizedState.cachePool.pool),n=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(n=r.memoizedState.cachePool.pool),n!==l&&(n!=null&&n.refCount++,l!=null&&Qa(l))}function Ac(n,r){n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Qa(n))}function Hn(n,r,l,c){if(r.subtreeFlags&10256)for(r=r.child;r!==null;)mm(n,r,l,c),r=r.sibling}function mm(n,r,l,c){var m=r.flags;switch(r.tag){case 0:case 11:case 15:Hn(n,r,l,c),m&2048&&co(9,r);break;case 1:Hn(n,r,l,c);break;case 3:Hn(n,r,l,c),m&2048&&(n=null,r.alternate!==null&&(n=r.alternate.memoizedState.cache),r=r.memoizedState.cache,r!==n&&(r.refCount++,n!=null&&Qa(n)));break;case 12:if(m&2048){Hn(n,r,l,c),n=r.stateNode;try{var y=r.memoizedProps,R=y.id,I=y.onPostCommit;typeof I=="function"&&I(R,r.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(X){Fe(r,r.return,X)}}else Hn(n,r,l,c);break;case 31:Hn(n,r,l,c);break;case 13:Hn(n,r,l,c);break;case 23:break;case 22:y=r.stateNode,R=r.alternate,r.memoizedState!==null?y._visibility&2?Hn(n,r,l,c):po(n,r):y._visibility&2?Hn(n,r,l,c):(y._visibility|=2,ra(n,r,l,c,(r.subtreeFlags&10256)!==0||!1)),m&2048&&bc(R,r);break;case 24:Hn(n,r,l,c),m&2048&&Ac(r.alternate,r);break;default:Hn(n,r,l,c)}}function ra(n,r,l,c,m){for(m=m&&((r.subtreeFlags&10256)!==0||!1),r=r.child;r!==null;){var y=n,R=r,I=l,X=c,ct=R.flags;switch(R.tag){case 0:case 11:case 15:ra(y,R,I,X,m),co(8,R);break;case 23:break;case 22:var vt=R.stateNode;R.memoizedState!==null?vt._visibility&2?ra(y,R,I,X,m):po(y,R):(vt._visibility|=2,ra(y,R,I,X,m)),m&&ct&2048&&bc(R.alternate,R);break;case 24:ra(y,R,I,X,m),m&&ct&2048&&Ac(R.alternate,R);break;default:ra(y,R,I,X,m)}r=r.sibling}}function po(n,r){if(r.subtreeFlags&10256)for(r=r.child;r!==null;){var l=n,c=r,m=c.flags;switch(c.tag){case 22:po(l,c),m&2048&&bc(c.alternate,c);break;case 24:po(l,c),m&2048&&Ac(c.alternate,c);break;default:po(l,c)}r=r.sibling}}var go=8192;function aa(n,r,l){if(n.subtreeFlags&go)for(n=n.child;n!==null;)vm(n,r,l),n=n.sibling}function vm(n,r,l){switch(n.tag){case 26:aa(n,r,l),n.flags&go&&n.memoizedState!==null&&l1(l,Un,n.memoizedState,n.memoizedProps);break;case 5:aa(n,r,l);break;case 3:case 4:var c=Un;Un=tu(n.stateNode.containerInfo),aa(n,r,l),Un=c;break;case 22:n.memoizedState===null&&(c=n.alternate,c!==null&&c.memoizedState!==null?(c=go,go=16777216,aa(n,r,l),go=c):aa(n,r,l));break;default:aa(n,r,l)}}function ym(n){var r=n.alternate;if(r!==null&&(n=r.child,n!==null)){r.child=null;do r=n.sibling,n.sibling=null,n=r;while(n!==null)}}function mo(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];Ri=c,Am(c,n)}ym(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)bm(n),n=n.sibling}function bm(n){switch(n.tag){case 0:case 11:case 15:mo(n),n.flags&2048&&Gs(9,n,n.return);break;case 3:mo(n);break;case 12:mo(n);break;case 22:var r=n.stateNode;n.memoizedState!==null&&r._visibility&2&&(n.return===null||n.return.tag!==13)?(r._visibility&=-3,Hl(n)):mo(n);break;default:mo(n)}}function Hl(n){var r=n.deletions;if((n.flags&16)!==0){if(r!==null)for(var l=0;l<r.length;l++){var c=r[l];Ri=c,Am(c,n)}ym(n)}for(n=n.child;n!==null;){switch(r=n,r.tag){case 0:case 11:case 15:Gs(8,r,r.return),Hl(r);break;case 22:l=r.stateNode,l._visibility&2&&(l._visibility&=-3,Hl(r));break;default:Hl(r)}n=n.sibling}}function Am(n,r){for(;Ri!==null;){var l=Ri;switch(l.tag){case 0:case 11:case 15:Gs(8,l,r);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Qa(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Ri=c;else t:for(l=n;Ri!==null;){c=Ri;var m=c.sibling,y=c.return;if(hm(c),c===l){Ri=null;break t}if(m!==null){m.return=y,Ri=m;break t}Ri=y}}}var E2={getCacheForType:function(n){var r=Ii(bi),l=r.data.get(n);return l===void 0&&(l=n(),r.data.set(n,l)),l},cacheSignal:function(){return Ii(bi).controller.signal}},S2=typeof WeakMap=="function"?WeakMap:Map,Le=0,Xe=null,me=null,Ae=0,ze=0,gn=null,Vs=!1,oa=!1,_c=!1,ws=0,hi=0,Xs=0,xr=0,wc=0,mn=0,la=0,vo=null,rn=null,Ec=!1,jl=0,_m=0,ql=1/0,Gl=null,Ys=null,xi=0,Ws=null,ua=null,Es=0,Sc=0,xc=null,wm=null,yo=0,Cc=null;function vn(){return(Le&2)!==0&&Ae!==0?Ae&-Ae:G.T!==null?kc():we()}function Em(){if(mn===0)if((Ae&536870912)===0||Ee){var n=N;N<<=1,(N&3932160)===0&&(N=262144),mn=n}else mn=536870912;return n=fn.current,n!==null&&(n.flags|=32),mn}function an(n,r,l){(n===Xe&&(ze===2||ze===9)||n.cancelPendingCommit!==null)&&(ha(n,0),Zs(n,Ae,mn,!1)),Y(n,l),((Le&2)===0||n!==Xe)&&(n===Xe&&((Le&2)===0&&(xr|=l),hi===4&&Zs(n,Ae,mn,!1)),Qn(n))}function Sm(n,r,l){if((Le&6)!==0)throw Error(i(327));var c=!l&&(r&127)===0&&(r&n.expiredLanes)===0||S(n,r),m=c?T2(n,r):Dc(n,r,!0),y=c;do{if(m===0){oa&&!c&&Zs(n,r,0,!1);break}else{if(l=n.current.alternate,y&&!x2(l)){m=Dc(n,r,!1),y=!1;continue}if(m===2){if(y=r,n.errorRecoveryDisabledLanes&y)var R=0;else R=n.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){r=R;t:{var I=n;m=vo;var X=I.current.memoizedState.isDehydrated;if(X&&(ha(I,R).flags|=256),R=Dc(I,R,!1),R!==2){if(_c&&!X){I.errorRecoveryDisabledLanes|=y,xr|=y,m=4;break t}y=rn,rn=m,y!==null&&(rn===null?rn=y:rn.push.apply(rn,y))}m=R}if(y=!1,m!==2)continue}}if(m===1){ha(n,0),Zs(n,r,0,!0);break}t:{switch(c=n,y=m,y){case 0:case 1:throw Error(i(345));case 4:if((r&4194048)!==r)break;case 6:Zs(c,r,mn,!Vs);break t;case 2:rn=null;break;case 3:case 5:break;default:throw Error(i(329))}if((r&62914560)===r&&(m=jl+300-De(),10<m)){if(Zs(c,r,mn,!Vs),tt(c,0,!0)!==0)break t;Es=r,c.timeoutHandle=ev(xm.bind(null,c,l,rn,Gl,Ec,r,mn,xr,la,Vs,y,"Throttled",-0,0),m);break t}xm(c,l,rn,Gl,Ec,r,mn,xr,la,Vs,y,null,-0,0)}}break}while(!0);Qn(n)}function xm(n,r,l,c,m,y,R,I,X,ct,vt,wt,dt,pt){if(n.timeoutHandle=-1,wt=r.subtreeFlags,wt&8192||(wt&16785408)===16785408){wt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Fn},vm(r,y,wt);var Ht=(y&62914560)===y?jl-De():(y&4194048)===y?_m-De():0;if(Ht=u1(wt,Ht),Ht!==null){Es=y,n.cancelPendingCommit=Ht(Mm.bind(null,n,r,y,l,c,m,R,I,X,vt,wt,null,dt,pt)),Zs(n,y,R,!ct);return}}Mm(n,r,y,l,c,m,R,I,X)}function x2(n){for(var r=n;;){var l=r.tag;if((l===0||l===11||l===15)&&r.flags&16384&&(l=r.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var m=l[c],y=m.getSnapshot;m=m.value;try{if(!cn(y(),m))return!1}catch{return!1}}if(l=r.child,r.subtreeFlags&16384&&l!==null)l.return=r,r=l;else{if(r===n)break;for(;r.sibling===null;){if(r.return===null||r.return===n)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Zs(n,r,l,c){r&=~wc,r&=~xr,n.suspendedLanes|=r,n.pingedLanes&=~r,c&&(n.warmLanes|=r),c=n.expirationTimes;for(var m=r;0<m;){var y=31-U(m),R=1<<y;c[y]=-1,m&=~R}l!==0&&Ft(n,l,r)}function Vl(){return(Le&6)===0?(bo(0),!1):!0}function Tc(){if(me!==null){if(ze===0)var n=me.return;else n=me,ds=mr=null,qh(n),ta=null,to=0,n=me;for(;n!==null;)im(n.alternate,n),n=n.return;me=null}}function ha(n,r){var l=n.timeoutHandle;l!==-1&&(n.timeoutHandle=-1,V2(l)),l=n.cancelPendingCommit,l!==null&&(n.cancelPendingCommit=null,l()),Es=0,Tc(),Xe=n,me=l=hs(n.current,null),Ae=r,ze=0,gn=null,Vs=!1,oa=S(n,r),_c=!1,la=mn=wc=xr=Xs=hi=0,rn=vo=null,Ec=!1,(r&8)!==0&&(r|=r&32);var c=n.entangledLanes;if(c!==0)for(n=n.entanglements,c&=r;0<c;){var m=31-U(c),y=1<<m;r|=n[m],c&=~y}return ws=r,dl(),l}function Cm(n,r){he=null,G.H=lo,r===Jr||r===Al?(r=jp(),ze=3):r===Oh?(r=jp(),ze=4):ze=r===rc?8:r!==null&&typeof r=="object"&&typeof r.then=="function"?6:1,gn=r,me===null&&(hi=1,Ll(n,Sn(r,n.current)))}function Tm(){var n=fn.current;return n===null?!0:(Ae&4194048)===Ae?Dn===null:(Ae&62914560)===Ae||(Ae&536870912)!==0?n===Dn:!1}function Dm(){var n=G.H;return G.H=lo,n===null?lo:n}function Rm(){var n=G.A;return G.A=E2,n}function Xl(){hi=4,Vs||(Ae&4194048)!==Ae&&fn.current!==null||(oa=!0),(Xs&134217727)===0&&(xr&134217727)===0||Xe===null||Zs(Xe,Ae,mn,!1)}function Dc(n,r,l){var c=Le;Le|=2;var m=Dm(),y=Rm();(Xe!==n||Ae!==r)&&(Gl=null,ha(n,r)),r=!1;var R=hi;t:do try{if(ze!==0&&me!==null){var I=me,X=gn;switch(ze){case 8:Tc(),R=6;break t;case 3:case 2:case 9:case 6:fn.current===null&&(r=!0);var ct=ze;if(ze=0,gn=null,ca(n,I,X,ct),l&&oa){R=0;break t}break;default:ct=ze,ze=0,gn=null,ca(n,I,X,ct)}}C2(),R=hi;break}catch(vt){Cm(n,vt)}while(!0);return r&&n.shellSuspendCounter++,ds=mr=null,Le=c,G.H=m,G.A=y,me===null&&(Xe=null,Ae=0,dl()),R}function C2(){for(;me!==null;)Nm(me)}function T2(n,r){var l=Le;Le|=2;var c=Dm(),m=Rm();Xe!==n||Ae!==r?(Gl=null,ql=De()+500,ha(n,r)):oa=S(n,r);t:do try{if(ze!==0&&me!==null){r=me;var y=gn;e:switch(ze){case 1:ze=0,gn=null,ca(n,r,y,1);break;case 2:case 9:if(Up(y)){ze=0,gn=null,Om(r);break}r=function(){ze!==2&&ze!==9||Xe!==n||(ze=7),Qn(n)},y.then(r,r);break t;case 3:ze=7;break t;case 4:ze=5;break t;case 7:Up(y)?(ze=0,gn=null,Om(r)):(ze=0,gn=null,ca(n,r,y,7));break;case 5:var R=null;switch(me.tag){case 26:R=me.memoizedState;case 5:case 27:var I=me;if(R?mv(R):I.stateNode.complete){ze=0,gn=null;var X=I.sibling;if(X!==null)me=X;else{var ct=I.return;ct!==null?(me=ct,Yl(ct)):me=null}break e}}ze=0,gn=null,ca(n,r,y,5);break;case 6:ze=0,gn=null,ca(n,r,y,6);break;case 8:Tc(),hi=6;break t;default:throw Error(i(462))}}D2();break}catch(vt){Cm(n,vt)}while(!0);return ds=mr=null,G.H=c,G.A=m,Le=l,me!==null?0:(Xe=null,Ae=0,dl(),hi)}function D2(){for(;me!==null&&!Jt();)Nm(me)}function Nm(n){var r=tm(n.alternate,n,ws);n.memoizedProps=n.pendingProps,r===null?Yl(n):me=r}function Om(n){var r=n,l=r.alternate;switch(r.tag){case 15:case 0:r=Wg(l,r,r.pendingProps,r.type,void 0,Ae);break;case 11:r=Wg(l,r,r.pendingProps,r.type.render,r.ref,Ae);break;case 5:qh(r);default:im(l,r),r=me=Rp(r,ws),r=tm(l,r,ws)}n.memoizedProps=n.pendingProps,r===null?Yl(n):me=r}function ca(n,r,l,c){ds=mr=null,qh(r),ta=null,to=0;var m=r.return;try{if(m2(n,m,r,l,Ae)){hi=1,Ll(n,Sn(l,n.current)),me=null;return}}catch(y){if(m!==null)throw me=m,y;hi=1,Ll(n,Sn(l,n.current)),me=null;return}r.flags&32768?(Ee||c===1?n=!0:oa||(Ae&536870912)!==0?n=!1:(Vs=n=!0,(c===2||c===9||c===3||c===6)&&(c=fn.current,c!==null&&c.tag===13&&(c.flags|=16384))),km(r,n)):Yl(r)}function Yl(n){var r=n;do{if((r.flags&32768)!==0){km(r,Vs);return}n=r.return;var l=b2(r.alternate,r,ws);if(l!==null){me=l;return}if(r=r.sibling,r!==null){me=r;return}me=r=n}while(r!==null);hi===0&&(hi=5)}function km(n,r){do{var l=A2(n.alternate,n);if(l!==null){l.flags&=32767,me=l;return}if(l=n.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!r&&(n=n.sibling,n!==null)){me=n;return}me=n=l}while(n!==null);hi=6,me=null}function Mm(n,r,l,c,m,y,R,I,X){n.cancelPendingCommit=null;do Wl();while(xi!==0);if((Le&6)!==0)throw Error(i(327));if(r!==null){if(r===n.current)throw Error(i(177));if(y=r.lanes|r.childLanes,y|=mh,ut(n,l,y,R,I,X),n===Xe&&(me=Xe=null,Ae=0),ua=r,Ws=n,Es=l,Sc=y,xc=m,wm=c,(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,k2(ki,function(){return Fm(),null})):(n.callbackNode=null,n.callbackPriority=0),c=(r.flags&13878)!==0,(r.subtreeFlags&13878)!==0||c){c=G.T,G.T=null,m=W.p,W.p=2,R=Le,Le|=4;try{_2(n,r,l)}finally{Le=R,W.p=m,G.T=c}}xi=1,Lm(),Bm(),Im()}}function Lm(){if(xi===1){xi=0;var n=Ws,r=ua,l=(r.flags&13878)!==0;if((r.subtreeFlags&13878)!==0||l){l=G.T,G.T=null;var c=W.p;W.p=2;var m=Le;Le|=4;try{pm(r,n);var y=Uc,R=Ap(n.containerInfo),I=y.focusedElem,X=y.selectionRange;if(R!==I&&I&&I.ownerDocument&&bp(I.ownerDocument.documentElement,I)){if(X!==null&&ch(I)){var ct=X.start,vt=X.end;if(vt===void 0&&(vt=ct),"selectionStart"in I)I.selectionStart=ct,I.selectionEnd=Math.min(vt,I.value.length);else{var wt=I.ownerDocument||document,dt=wt&&wt.defaultView||window;if(dt.getSelection){var pt=dt.getSelection(),Ht=I.textContent.length,Zt=Math.min(X.start,Ht),qe=X.end===void 0?Zt:Math.min(X.end,Ht);!pt.extend&&Zt>qe&&(R=qe,qe=Zt,Zt=R);var at=yp(I,Zt),J=yp(I,qe);if(at&&J&&(pt.rangeCount!==1||pt.anchorNode!==at.node||pt.anchorOffset!==at.offset||pt.focusNode!==J.node||pt.focusOffset!==J.offset)){var ht=wt.createRange();ht.setStart(at.node,at.offset),pt.removeAllRanges(),Zt>qe?(pt.addRange(ht),pt.extend(J.node,J.offset)):(ht.setEnd(J.node,J.offset),pt.addRange(ht))}}}}for(wt=[],pt=I;pt=pt.parentNode;)pt.nodeType===1&&wt.push({element:pt,left:pt.scrollLeft,top:pt.scrollTop});for(typeof I.focus=="function"&&I.focus(),I=0;I<wt.length;I++){var _t=wt[I];_t.element.scrollLeft=_t.left,_t.element.scrollTop=_t.top}}au=!!Pc,Uc=Pc=null}finally{Le=m,W.p=c,G.T=l}}n.current=r,xi=2}}function Bm(){if(xi===2){xi=0;var n=Ws,r=ua,l=(r.flags&8772)!==0;if((r.subtreeFlags&8772)!==0||l){l=G.T,G.T=null;var c=W.p;W.p=2;var m=Le;Le|=4;try{um(n,r.alternate,r)}finally{Le=m,W.p=c,G.T=l}}xi=3}}function Im(){if(xi===4||xi===3){xi=0,Kt();var n=Ws,r=ua,l=Es,c=wm;(r.subtreeFlags&10256)!==0||(r.flags&10256)!==0?xi=5:(xi=0,ua=Ws=null,zm(n,n.pendingLanes));var m=n.pendingLanes;if(m===0&&(Ys=null),Ze(l),r=r.stateNode,Me&&typeof Me.onCommitFiberRoot=="function")try{Me.onCommitFiberRoot(Pe,r,void 0,(r.current.flags&128)===128)}catch{}if(c!==null){r=G.T,m=W.p,W.p=2,G.T=null;try{for(var y=n.onRecoverableError,R=0;R<c.length;R++){var I=c[R];y(I.value,{componentStack:I.stack})}}finally{G.T=r,W.p=m}}(Es&3)!==0&&Wl(),Qn(n),m=n.pendingLanes,(l&261930)!==0&&(m&42)!==0?n===Cc?yo++:(yo=0,Cc=n):yo=0,bo(0)}}function zm(n,r){(n.pooledCacheLanes&=r)===0&&(r=n.pooledCache,r!=null&&(n.pooledCache=null,Qa(r)))}function Wl(){return Lm(),Bm(),Im(),Fm()}function Fm(){if(xi!==5)return!1;var n=Ws,r=Sc;Sc=0;var l=Ze(Es),c=G.T,m=W.p;try{W.p=32>l?32:l,G.T=null,l=xc,xc=null;var y=Ws,R=Es;if(xi=0,ua=Ws=null,Es=0,(Le&6)!==0)throw Error(i(331));var I=Le;if(Le|=4,bm(y.current),mm(y,y.current,R,l),Le=I,bo(0,!1),Me&&typeof Me.onPostCommitFiberRoot=="function")try{Me.onPostCommitFiberRoot(Pe,y)}catch{}return!0}finally{W.p=m,G.T=c,zm(n,r)}}function Pm(n,r,l){r=Sn(l,r),r=sc(n.stateNode,r,2),n=Hs(n,r,2),n!==null&&(Y(n,2),Qn(n))}function Fe(n,r,l){if(n.tag===3)Pm(n,n,l);else for(;r!==null;){if(r.tag===3){Pm(r,n,l);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ys===null||!Ys.has(c))){n=Sn(l,n),l=Ug(2),c=Hs(r,l,2),c!==null&&(Hg(l,c,r,n),Y(c,2),Qn(c));break}}r=r.return}}function Rc(n,r,l){var c=n.pingCache;if(c===null){c=n.pingCache=new S2;var m=new Set;c.set(r,m)}else m=c.get(r),m===void 0&&(m=new Set,c.set(r,m));m.has(l)||(_c=!0,m.add(l),n=R2.bind(null,n,r,l),r.then(n,n))}function R2(n,r,l){var c=n.pingCache;c!==null&&c.delete(r),n.pingedLanes|=n.suspendedLanes&l,n.warmLanes&=~l,Xe===n&&(Ae&l)===l&&(hi===4||hi===3&&(Ae&62914560)===Ae&&300>De()-jl?(Le&2)===0&&ha(n,0):wc|=l,la===Ae&&(la=0)),Qn(n)}function Um(n,r){r===0&&(r=lt()),n=fr(n,r),n!==null&&(Y(n,r),Qn(n))}function N2(n){var r=n.memoizedState,l=0;r!==null&&(l=r.retryLane),Um(n,l)}function O2(n,r){var l=0;switch(n.tag){case 31:case 13:var c=n.stateNode,m=n.memoizedState;m!==null&&(l=m.retryLane);break;case 19:c=n.stateNode;break;case 22:c=n.stateNode._retryCache;break;default:throw Error(i(314))}c!==null&&c.delete(r),Um(n,l)}function k2(n,r){return Ke(n,r)}var Zl=null,da=null,Nc=!1,Kl=!1,Oc=!1,Ks=0;function Qn(n){n!==da&&n.next===null&&(da===null?Zl=da=n:da=da.next=n),Kl=!0,Nc||(Nc=!0,L2())}function bo(n,r){if(!Oc&&Kl){Oc=!0;do for(var l=!1,c=Zl;c!==null;){if(n!==0){var m=c.pendingLanes;if(m===0)var y=0;else{var R=c.suspendedLanes,I=c.pingedLanes;y=(1<<31-U(42|n)+1)-1,y&=m&~(R&~I),y=y&201326741?y&201326741|1:y?y|2:0}y!==0&&(l=!0,Gm(c,y))}else y=Ae,y=tt(c,c===Xe?y:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(y&3)===0||S(c,y)||(l=!0,Gm(c,y));c=c.next}while(l);Oc=!1}}function M2(){Hm()}function Hm(){Kl=Nc=!1;var n=0;Ks!==0&&G2()&&(n=Ks);for(var r=De(),l=null,c=Zl;c!==null;){var m=c.next,y=jm(c,r);y===0?(c.next=null,l===null?Zl=m:l.next=m,m===null&&(da=l)):(l=c,(n!==0||(y&3)!==0)&&(Kl=!0)),c=m}xi!==0&&xi!==5||bo(n),Ks!==0&&(Ks=0)}function jm(n,r){for(var l=n.suspendedLanes,c=n.pingedLanes,m=n.expirationTimes,y=n.pendingLanes&-62914561;0<y;){var R=31-U(y),I=1<<R,X=m[R];X===-1?((I&l)===0||(I&c)!==0)&&(m[R]=it(I,r)):X<=r&&(n.expiredLanes|=I),y&=~I}if(r=Xe,l=Ae,l=tt(n,n===r?l:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c=n.callbackNode,l===0||n===r&&(ze===2||ze===9)||n.cancelPendingCommit!==null)return c!==null&&c!==null&&Wt(c),n.callbackNode=null,n.callbackPriority=0;if((l&3)===0||S(n,l)){if(r=l&-l,r===n.callbackPriority)return r;switch(c!==null&&Wt(c),Ze(l)){case 2:case 8:l=si;break;case 32:l=ki;break;case 268435456:l=fi;break;default:l=ki}return c=qm.bind(null,n),l=Ke(l,c),n.callbackPriority=r,n.callbackNode=l,r}return c!==null&&c!==null&&Wt(c),n.callbackPriority=2,n.callbackNode=null,2}function qm(n,r){if(xi!==0&&xi!==5)return n.callbackNode=null,n.callbackPriority=0,null;var l=n.callbackNode;if(Wl()&&n.callbackNode!==l)return null;var c=Ae;return c=tt(n,n===Xe?c:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),c===0?null:(Sm(n,c,r),jm(n,De()),n.callbackNode!=null&&n.callbackNode===l?qm.bind(null,n):null)}function Gm(n,r){if(Wl())return null;Sm(n,r,!0)}function L2(){X2(function(){(Le&6)!==0?Ke(Di,M2):Hm()})}function kc(){if(Ks===0){var n=$r;n===0&&(n=Q,Q<<=1,(Q&261888)===0&&(Q=256)),Ks=n}return Ks}function Vm(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Fr(""+n)}function Xm(n,r){var l=r.ownerDocument.createElement("input");return l.name=r.name,l.value=r.value,n.id&&l.setAttribute("form",n.id),r.parentNode.insertBefore(l,r),n=new FormData(n),l.parentNode.removeChild(l),n}function B2(n,r,l,c,m){if(r==="submit"&&l&&l.stateNode===m){var y=Vm((m[pe]||null).action),R=c.submitter;R&&(r=(r=R[pe]||null)?Vm(r.formAction):R.getAttribute("formAction"),r!==null&&(y=r,R=null));var I=new ll("action","action",null,c,m);n.push({event:I,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(Ks!==0){var X=R?Xm(m,R):new FormData(m);Qh(l,{pending:!0,data:X,method:m.method,action:y},null,X)}}else typeof y=="function"&&(I.preventDefault(),X=R?Xm(m,R):new FormData(m),Qh(l,{pending:!0,data:X,method:m.method,action:y},y,X))},currentTarget:m}]})}}for(var Mc=0;Mc<gh.length;Mc++){var Lc=gh[Mc],I2=Lc.toLowerCase(),z2=Lc[0].toUpperCase()+Lc.slice(1);Pn(I2,"on"+z2)}Pn(Ep,"onAnimationEnd"),Pn(Sp,"onAnimationIteration"),Pn(xp,"onAnimationStart"),Pn("dblclick","onDoubleClick"),Pn("focusin","onFocus"),Pn("focusout","onBlur"),Pn(Jb,"onTransitionRun"),Pn(t2,"onTransitionStart"),Pn(e2,"onTransitionCancel"),Pn(Cp,"onTransitionEnd"),Wn("onMouseEnter",["mouseout","mouseover"]),Wn("onMouseLeave",["mouseout","mouseover"]),Wn("onPointerEnter",["pointerout","pointerover"]),Wn("onPointerLeave",["pointerout","pointerover"]),wn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),wn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),wn("onBeforeInput",["compositionend","keypress","textInput","paste"]),wn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),wn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),wn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ao="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),F2=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ao));function Ym(n,r){r=(r&4)!==0;for(var l=0;l<n.length;l++){var c=n[l],m=c.event;c=c.listeners;t:{var y=void 0;if(r)for(var R=c.length-1;0<=R;R--){var I=c[R],X=I.instance,ct=I.currentTarget;if(I=I.listener,X!==y&&m.isPropagationStopped())break t;y=I,m.currentTarget=ct;try{y(m)}catch(vt){cl(vt)}m.currentTarget=null,y=X}else for(R=0;R<c.length;R++){if(I=c[R],X=I.instance,ct=I.currentTarget,I=I.listener,X!==y&&m.isPropagationStopped())break t;y=I,m.currentTarget=ct;try{y(m)}catch(vt){cl(vt)}m.currentTarget=null,y=X}}}}function ve(n,r){var l=r[Yn];l===void 0&&(l=r[Yn]=new Set);var c=n+"__bubble";l.has(c)||(Wm(r,n,2,!1),l.add(c))}function Bc(n,r,l){var c=0;r&&(c|=4),Wm(l,n,c,r)}var $l="_reactListening"+Math.random().toString(36).slice(2);function Ic(n){if(!n[$l]){n[$l]=!0,ls.forEach(function(l){l!=="selectionchange"&&(F2.has(l)||Bc(l,!1,n),Bc(l,!0,n))});var r=n.nodeType===9?n:n.ownerDocument;r===null||r[$l]||(r[$l]=!0,Bc("selectionchange",!1,r))}}function Wm(n,r,l,c){switch(Ev(r)){case 2:var m=d1;break;case 8:m=f1;break;default:m=$c}l=m.bind(null,r,l,n),m=void 0,!ih||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),c?m!==void 0?n.addEventListener(r,l,{capture:!0,passive:m}):n.addEventListener(r,l,!0):m!==void 0?n.addEventListener(r,l,{passive:m}):n.addEventListener(r,l,!1)}function zc(n,r,l,c,m){var y=c;if((r&1)===0&&(r&2)===0&&c!==null)t:for(;;){if(c===null)return;var R=c.tag;if(R===3||R===4){var I=c.stateNode.containerInfo;if(I===m)break;if(R===4)for(R=c.return;R!==null;){var X=R.tag;if((X===3||X===4)&&R.stateNode.containerInfo===m)return;R=R.return}for(;I!==null;){if(R=zn(I),R===null)return;if(X=R.tag,X===5||X===6||X===26||X===27){c=y=R;continue t}I=I.parentNode}}c=c.return}Jf(function(){var ct=y,vt=th(l),wt=[];t:{var dt=Tp.get(n);if(dt!==void 0){var pt=ll,Ht=n;switch(n){case"keypress":if(al(l)===0)break t;case"keydown":case"keyup":pt=Ob;break;case"focusin":Ht="focus",pt=ah;break;case"focusout":Ht="blur",pt=ah;break;case"beforeblur":case"afterblur":pt=ah;break;case"click":if(l.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":pt=ip;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":pt=bb;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":pt=Lb;break;case Ep:case Sp:case xp:pt=wb;break;case Cp:pt=Ib;break;case"scroll":case"scrollend":pt=vb;break;case"wheel":pt=Fb;break;case"copy":case"cut":case"paste":pt=Sb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":pt=sp;break;case"toggle":case"beforetoggle":pt=Ub}var Zt=(r&4)!==0,qe=!Zt&&(n==="scroll"||n==="scrollend"),at=Zt?dt!==null?dt+"Capture":null:dt;Zt=[];for(var J=ct,ht;J!==null;){var _t=J;if(ht=_t.stateNode,_t=_t.tag,_t!==5&&_t!==26&&_t!==27||ht===null||at===null||(_t=Ha(J,at),_t!=null&&Zt.push(_o(J,_t,ht))),qe)break;J=J.return}0<Zt.length&&(dt=new pt(dt,Ht,null,l,vt),wt.push({event:dt,listeners:Zt}))}}if((r&7)===0){t:{if(dt=n==="mouseover"||n==="pointerover",pt=n==="mouseout"||n==="pointerout",dt&&l!==Pr&&(Ht=l.relatedTarget||l.fromElement)&&(zn(Ht)||Ht[Gi]))break t;if((pt||dt)&&(dt=vt.window===vt?vt:(dt=vt.ownerDocument)?dt.defaultView||dt.parentWindow:window,pt?(Ht=l.relatedTarget||l.toElement,pt=ct,Ht=Ht?zn(Ht):null,Ht!==null&&(qe=a(Ht),Zt=Ht.tag,Ht!==qe||Zt!==5&&Zt!==27&&Zt!==6)&&(Ht=null)):(pt=null,Ht=ct),pt!==Ht)){if(Zt=ip,_t="onMouseLeave",at="onMouseEnter",J="mouse",(n==="pointerout"||n==="pointerover")&&(Zt=sp,_t="onPointerLeave",at="onPointerEnter",J="pointer"),qe=pt==null?dt:ks(pt),ht=Ht==null?dt:ks(Ht),dt=new Zt(_t,J+"leave",pt,l,vt),dt.target=qe,dt.relatedTarget=ht,_t=null,zn(vt)===ct&&(Zt=new Zt(at,J+"enter",Ht,l,vt),Zt.target=ht,Zt.relatedTarget=qe,_t=Zt),qe=_t,pt&&Ht)e:{for(Zt=P2,at=pt,J=Ht,ht=0,_t=at;_t;_t=Zt(_t))ht++;_t=0;for(var Vt=J;Vt;Vt=Zt(Vt))_t++;for(;0<ht-_t;)at=Zt(at),ht--;for(;0<_t-ht;)J=Zt(J),_t--;for(;ht--;){if(at===J||J!==null&&at===J.alternate){Zt=at;break e}at=Zt(at),J=Zt(J)}Zt=null}else Zt=null;pt!==null&&Zm(wt,dt,pt,Zt,!1),Ht!==null&&qe!==null&&Zm(wt,qe,Ht,Zt,!0)}}t:{if(dt=ct?ks(ct):window,pt=dt.nodeName&&dt.nodeName.toLowerCase(),pt==="select"||pt==="input"&&dt.type==="file")var Oe=dp;else if(hp(dt))if(fp)Oe=Kb;else{Oe=Wb;var qt=Yb}else pt=dt.nodeName,!pt||pt.toLowerCase()!=="input"||dt.type!=="checkbox"&&dt.type!=="radio"?ct&&Pa(ct.elementType)&&(Oe=dp):Oe=Zb;if(Oe&&(Oe=Oe(n,ct))){cp(wt,Oe,l,vt);break t}qt&&qt(n,dt,ct),n==="focusout"&&ct&&dt.type==="number"&&ct.memoizedProps.value!=null&&ue(dt,"number",dt.value)}switch(qt=ct?ks(ct):window,n){case"focusin":(hp(qt)||qt.contentEditable==="true")&&(qr=qt,dh=ct,Za=null);break;case"focusout":Za=dh=qr=null;break;case"mousedown":fh=!0;break;case"contextmenu":case"mouseup":case"dragend":fh=!1,_p(wt,l,vt);break;case"selectionchange":if(Qb)break;case"keydown":case"keyup":_p(wt,l,vt)}var ce;if(lh)t:{switch(n){case"compositionstart":var _e="onCompositionStart";break t;case"compositionend":_e="onCompositionEnd";break t;case"compositionupdate":_e="onCompositionUpdate";break t}_e=void 0}else jr?lp(n,l)&&(_e="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(_e="onCompositionStart");_e&&(rp&&l.locale!=="ko"&&(jr||_e!=="onCompositionStart"?_e==="onCompositionEnd"&&jr&&(ce=tp()):(Ls=vt,nh="value"in Ls?Ls.value:Ls.textContent,jr=!0)),qt=Ql(ct,_e),0<qt.length&&(_e=new np(_e,n,null,l,vt),wt.push({event:_e,listeners:qt}),ce?_e.data=ce:(ce=up(l),ce!==null&&(_e.data=ce)))),(ce=jb?qb(n,l):Gb(n,l))&&(_e=Ql(ct,"onBeforeInput"),0<_e.length&&(qt=new np("onBeforeInput","beforeinput",null,l,vt),wt.push({event:qt,listeners:_e}),qt.data=ce)),B2(wt,n,ct,l,vt)}Ym(wt,r)})}function _o(n,r,l){return{instance:n,listener:r,currentTarget:l}}function Ql(n,r){for(var l=r+"Capture",c=[];n!==null;){var m=n,y=m.stateNode;if(m=m.tag,m!==5&&m!==26&&m!==27||y===null||(m=Ha(n,l),m!=null&&c.unshift(_o(n,m,y)),m=Ha(n,r),m!=null&&c.push(_o(n,m,y))),n.tag===3)return c;n=n.return}return[]}function P2(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Zm(n,r,l,c,m){for(var y=r._reactName,R=[];l!==null&&l!==c;){var I=l,X=I.alternate,ct=I.stateNode;if(I=I.tag,X!==null&&X===c)break;I!==5&&I!==26&&I!==27||ct===null||(X=ct,m?(ct=Ha(l,y),ct!=null&&R.unshift(_o(l,ct,X))):m||(ct=Ha(l,y),ct!=null&&R.push(_o(l,ct,X)))),l=l.return}R.length!==0&&n.push({event:r,listeners:R})}var U2=/\r\n?/g,H2=/\u0000|\uFFFD/g;function Km(n){return(typeof n=="string"?n:""+n).replace(U2,`
`).replace(H2,"")}function $m(n,r){return r=Km(r),Km(n)===r}function je(n,r,l,c,m,y){switch(l){case"children":typeof c=="string"?r==="body"||r==="textarea"&&c===""||Ue(n,c):(typeof c=="number"||typeof c=="bigint")&&r!=="body"&&Ue(n,""+c);break;case"className":P(n,"class",c);break;case"tabIndex":P(n,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":P(n,l,c);break;case"style":zr(n,c,y);break;case"data":if(r!=="object"){P(n,"data",c);break}case"src":case"href":if(c===""&&(r!=="a"||l!=="href")){n.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=Fr(""+c),n.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){n.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof y=="function"&&(l==="formAction"?(r!=="input"&&je(n,r,"name",m.name,m,null),je(n,r,"formEncType",m.formEncType,m,null),je(n,r,"formMethod",m.formMethod,m,null),je(n,r,"formTarget",m.formTarget,m,null)):(je(n,r,"encType",m.encType,m,null),je(n,r,"method",m.method,m,null),je(n,r,"target",m.target,m,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){n.removeAttribute(l);break}c=Fr(""+c),n.setAttribute(l,c);break;case"onClick":c!=null&&(n.onclick=Fn);break;case"onScroll":c!=null&&ve("scroll",n);break;case"onScrollEnd":c!=null&&ve("scrollend",n);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"multiple":n.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":n.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){n.removeAttribute("xlink:href");break}l=Fr(""+c),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""+c):n.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,""):n.removeAttribute(l);break;case"capture":case"download":c===!0?n.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?n.setAttribute(l,c):n.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?n.setAttribute(l,c):n.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?n.removeAttribute(l):n.setAttribute(l,c);break;case"popover":ve("beforetoggle",n),ve("toggle",n),Ir(n,"popover",c);break;case"xlinkActuate":K(n,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":K(n,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":K(n,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":K(n,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":K(n,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":K(n,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":K(n,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":K(n,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":K(n,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Ir(n,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Ua.get(l)||l,Ir(n,l,c))}}function Fc(n,r,l,c,m,y){switch(l){case"style":zr(n,c,y);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(i(61));if(l=c.__html,l!=null){if(m.children!=null)throw Error(i(60));n.innerHTML=l}}break;case"children":typeof c=="string"?Ue(n,c):(typeof c=="number"||typeof c=="bigint")&&Ue(n,""+c);break;case"onScroll":c!=null&&ve("scroll",n);break;case"onScrollEnd":c!=null&&ve("scrollend",n);break;case"onClick":c!=null&&(n.onclick=Fn);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nl.hasOwnProperty(l))t:{if(l[0]==="o"&&l[1]==="n"&&(m=l.endsWith("Capture"),r=l.slice(2,m?l.length-7:void 0),y=n[pe]||null,y=y!=null?y[l]:null,typeof y=="function"&&n.removeEventListener(r,y,m),typeof c=="function")){typeof y!="function"&&y!==null&&(l in n?n[l]=null:n.hasAttribute(l)&&n.removeAttribute(l)),n.addEventListener(r,c,m);break t}l in n?n[l]=c:c===!0?n.setAttribute(l,""):Ir(n,l,c)}}}function Fi(n,r,l){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ve("error",n),ve("load",n);var c=!1,m=!1,y;for(y in l)if(l.hasOwnProperty(y)){var R=l[y];if(R!=null)switch(y){case"src":c=!0;break;case"srcSet":m=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:je(n,r,y,R,l,null)}}m&&je(n,r,"srcSet",l.srcSet,l,null),c&&je(n,r,"src",l.src,l,null);return;case"input":ve("invalid",n);var I=y=R=m=null,X=null,ct=null;for(c in l)if(l.hasOwnProperty(c)){var vt=l[c];if(vt!=null)switch(c){case"name":m=vt;break;case"type":R=vt;break;case"checked":X=vt;break;case"defaultChecked":ct=vt;break;case"value":y=vt;break;case"defaultValue":I=vt;break;case"children":case"dangerouslySetInnerHTML":if(vt!=null)throw Error(i(137,r));break;default:je(n,r,c,vt,l,null)}}jt(n,y,I,X,ct,R,m,!1);return;case"select":ve("invalid",n),c=R=y=null;for(m in l)if(l.hasOwnProperty(m)&&(I=l[m],I!=null))switch(m){case"value":y=I;break;case"defaultValue":R=I;break;case"multiple":c=I;default:je(n,r,m,I,l,null)}r=y,l=R,n.multiple=!!c,r!=null?ge(n,!!c,r,!1):l!=null&&ge(n,!!c,l,!0);return;case"textarea":ve("invalid",n),y=m=c=null;for(R in l)if(l.hasOwnProperty(R)&&(I=l[R],I!=null))switch(R){case"value":c=I;break;case"defaultValue":m=I;break;case"children":y=I;break;case"dangerouslySetInnerHTML":if(I!=null)throw Error(i(91));break;default:je(n,r,R,I,l,null)}ri(n,c,m,y);return;case"option":for(X in l)l.hasOwnProperty(X)&&(c=l[X],c!=null)&&(X==="selected"?n.selected=c&&typeof c!="function"&&typeof c!="symbol":je(n,r,X,c,l,null));return;case"dialog":ve("beforetoggle",n),ve("toggle",n),ve("cancel",n),ve("close",n);break;case"iframe":case"object":ve("load",n);break;case"video":case"audio":for(c=0;c<Ao.length;c++)ve(Ao[c],n);break;case"image":ve("error",n),ve("load",n);break;case"details":ve("toggle",n);break;case"embed":case"source":case"link":ve("error",n),ve("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ct in l)if(l.hasOwnProperty(ct)&&(c=l[ct],c!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,r));default:je(n,r,ct,c,l,null)}return;default:if(Pa(r)){for(vt in l)l.hasOwnProperty(vt)&&(c=l[vt],c!==void 0&&Fc(n,r,vt,c,l,void 0));return}}for(I in l)l.hasOwnProperty(I)&&(c=l[I],c!=null&&je(n,r,I,c,l,null))}function j2(n,r,l,c){switch(r){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var m=null,y=null,R=null,I=null,X=null,ct=null,vt=null;for(pt in l){var wt=l[pt];if(l.hasOwnProperty(pt)&&wt!=null)switch(pt){case"checked":break;case"value":break;case"defaultValue":X=wt;default:c.hasOwnProperty(pt)||je(n,r,pt,null,c,wt)}}for(var dt in c){var pt=c[dt];if(wt=l[dt],c.hasOwnProperty(dt)&&(pt!=null||wt!=null))switch(dt){case"type":y=pt;break;case"name":m=pt;break;case"checked":ct=pt;break;case"defaultChecked":vt=pt;break;case"value":R=pt;break;case"defaultValue":I=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(i(137,r));break;default:pt!==wt&&je(n,r,dt,pt,c,wt)}}Rt(n,R,I,X,ct,vt,y,m);return;case"select":pt=R=I=dt=null;for(y in l)if(X=l[y],l.hasOwnProperty(y)&&X!=null)switch(y){case"value":break;case"multiple":pt=X;default:c.hasOwnProperty(y)||je(n,r,y,null,c,X)}for(m in c)if(y=c[m],X=l[m],c.hasOwnProperty(m)&&(y!=null||X!=null))switch(m){case"value":dt=y;break;case"defaultValue":I=y;break;case"multiple":R=y;default:y!==X&&je(n,r,m,y,c,X)}r=I,l=R,c=pt,dt!=null?ge(n,!!l,dt,!1):!!c!=!!l&&(r!=null?ge(n,!!l,r,!0):ge(n,!!l,l?[]:"",!1));return;case"textarea":pt=dt=null;for(I in l)if(m=l[I],l.hasOwnProperty(I)&&m!=null&&!c.hasOwnProperty(I))switch(I){case"value":break;case"children":break;default:je(n,r,I,null,c,m)}for(R in c)if(m=c[R],y=l[R],c.hasOwnProperty(R)&&(m!=null||y!=null))switch(R){case"value":dt=m;break;case"defaultValue":pt=m;break;case"children":break;case"dangerouslySetInnerHTML":if(m!=null)throw Error(i(91));break;default:m!==y&&je(n,r,R,m,c,y)}Ne(n,dt,pt);return;case"option":for(var Ht in l)dt=l[Ht],l.hasOwnProperty(Ht)&&dt!=null&&!c.hasOwnProperty(Ht)&&(Ht==="selected"?n.selected=!1:je(n,r,Ht,null,c,dt));for(X in c)dt=c[X],pt=l[X],c.hasOwnProperty(X)&&dt!==pt&&(dt!=null||pt!=null)&&(X==="selected"?n.selected=dt&&typeof dt!="function"&&typeof dt!="symbol":je(n,r,X,dt,c,pt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Zt in l)dt=l[Zt],l.hasOwnProperty(Zt)&&dt!=null&&!c.hasOwnProperty(Zt)&&je(n,r,Zt,null,c,dt);for(ct in c)if(dt=c[ct],pt=l[ct],c.hasOwnProperty(ct)&&dt!==pt&&(dt!=null||pt!=null))switch(ct){case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(i(137,r));break;default:je(n,r,ct,dt,c,pt)}return;default:if(Pa(r)){for(var qe in l)dt=l[qe],l.hasOwnProperty(qe)&&dt!==void 0&&!c.hasOwnProperty(qe)&&Fc(n,r,qe,void 0,c,dt);for(vt in c)dt=c[vt],pt=l[vt],!c.hasOwnProperty(vt)||dt===pt||dt===void 0&&pt===void 0||Fc(n,r,vt,dt,c,pt);return}}for(var at in l)dt=l[at],l.hasOwnProperty(at)&&dt!=null&&!c.hasOwnProperty(at)&&je(n,r,at,null,c,dt);for(wt in c)dt=c[wt],pt=l[wt],!c.hasOwnProperty(wt)||dt===pt||dt==null&&pt==null||je(n,r,wt,dt,c,pt)}function Qm(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function q2(){if(typeof performance.getEntriesByType=="function"){for(var n=0,r=0,l=performance.getEntriesByType("resource"),c=0;c<l.length;c++){var m=l[c],y=m.transferSize,R=m.initiatorType,I=m.duration;if(y&&I&&Qm(R)){for(R=0,I=m.responseEnd,c+=1;c<l.length;c++){var X=l[c],ct=X.startTime;if(ct>I)break;var vt=X.transferSize,wt=X.initiatorType;vt&&Qm(wt)&&(X=X.responseEnd,R+=vt*(X<I?1:(I-ct)/(X-ct)))}if(--c,r+=8*(y+R)/(m.duration/1e3),n++,10<n)break}}if(0<n)return r/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Pc=null,Uc=null;function Jl(n){return n.nodeType===9?n:n.ownerDocument}function Jm(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tv(n,r){if(n===0)switch(r){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&r==="foreignObject"?0:n}function Hc(n,r){return n==="textarea"||n==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.children=="bigint"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var jc=null;function G2(){var n=window.event;return n&&n.type==="popstate"?n===jc?!1:(jc=n,!0):(jc=null,!1)}var ev=typeof setTimeout=="function"?setTimeout:void 0,V2=typeof clearTimeout=="function"?clearTimeout:void 0,iv=typeof Promise=="function"?Promise:void 0,X2=typeof queueMicrotask=="function"?queueMicrotask:typeof iv<"u"?function(n){return iv.resolve(null).then(n).catch(Y2)}:ev;function Y2(n){setTimeout(function(){throw n})}function $s(n){return n==="head"}function nv(n,r){var l=r,c=0;do{var m=l.nextSibling;if(n.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"||l==="/&"){if(c===0){n.removeChild(m),ma(r);return}c--}else if(l==="$"||l==="$?"||l==="$~"||l==="$!"||l==="&")c++;else if(l==="html")wo(n.ownerDocument.documentElement);else if(l==="head"){l=n.ownerDocument.head,wo(l);for(var y=l.firstChild;y;){var R=y.nextSibling,I=y.nodeName;y[Li]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&y.rel.toLowerCase()==="stylesheet"||l.removeChild(y),y=R}}else l==="body"&&wo(n.ownerDocument.body);l=m}while(l);ma(r)}function sv(n,r){var l=n;n=0;do{var c=l.nextSibling;if(l.nodeType===1?r?(l._stashedDisplay=l.style.display,l.style.display="none"):(l.style.display=l._stashedDisplay||"",l.getAttribute("style")===""&&l.removeAttribute("style")):l.nodeType===3&&(r?(l._stashedText=l.nodeValue,l.nodeValue=""):l.nodeValue=l._stashedText||""),c&&c.nodeType===8)if(l=c.data,l==="/$"){if(n===0)break;n--}else l!=="$"&&l!=="$?"&&l!=="$~"&&l!=="$!"||n++;l=c}while(l)}function qc(n){var r=n.firstChild;for(r&&r.nodeType===10&&(r=r.nextSibling);r;){var l=r;switch(r=r.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":qc(l),Xi(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}n.removeChild(l)}}function W2(n,r,l,c){for(;n.nodeType===1;){var m=l;if(n.nodeName.toLowerCase()!==r.toLowerCase()){if(!c&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(c){if(!n[Li])switch(r){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(y=n.getAttribute("rel"),y==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(y!==m.rel||n.getAttribute("href")!==(m.href==null||m.href===""?null:m.href)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin)||n.getAttribute("title")!==(m.title==null?null:m.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(y=n.getAttribute("src"),(y!==(m.src==null?null:m.src)||n.getAttribute("type")!==(m.type==null?null:m.type)||n.getAttribute("crossorigin")!==(m.crossOrigin==null?null:m.crossOrigin))&&y&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(r==="input"&&n.type==="hidden"){var y=m.name==null?null:""+m.name;if(m.type==="hidden"&&n.getAttribute("name")===y)return n}else return n;if(n=Rn(n.nextSibling),n===null)break}return null}function Z2(n,r,l){if(r==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!l||(n=Rn(n.nextSibling),n===null))return null;return n}function rv(n,r){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!r||(n=Rn(n.nextSibling),n===null))return null;return n}function Gc(n){return n.data==="$?"||n.data==="$~"}function Vc(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function K2(n,r){var l=n.ownerDocument;if(n.data==="$~")n._reactRetry=r;else if(n.data!=="$?"||l.readyState!=="loading")r();else{var c=function(){r(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),n._reactRetry=c}}function Rn(n){for(;n!=null;n=n.nextSibling){var r=n.nodeType;if(r===1||r===3)break;if(r===8){if(r=n.data,r==="$"||r==="$!"||r==="$?"||r==="$~"||r==="&"||r==="F!"||r==="F")break;if(r==="/$"||r==="/&")return null}}return n}var Xc=null;function av(n){n=n.nextSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"||l==="/&"){if(r===0)return Rn(n.nextSibling);r--}else l!=="$"&&l!=="$!"&&l!=="$?"&&l!=="$~"&&l!=="&"||r++}n=n.nextSibling}return null}function ov(n){n=n.previousSibling;for(var r=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"){if(r===0)return n;r--}else l!=="/$"&&l!=="/&"||r++}n=n.previousSibling}return null}function lv(n,r,l){switch(r=Jl(l),n){case"html":if(n=r.documentElement,!n)throw Error(i(452));return n;case"head":if(n=r.head,!n)throw Error(i(453));return n;case"body":if(n=r.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function wo(n){for(var r=n.attributes;r.length;)n.removeAttributeNode(r[0]);Xi(n)}var Nn=new Map,uv=new Set;function tu(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var Ss=W.d;W.d={f:$2,r:Q2,D:J2,C:t1,L:e1,m:i1,X:s1,S:n1,M:r1};function $2(){var n=Ss.f(),r=Vl();return n||r}function Q2(n){var r=Os(n);r!==null&&r.tag===5&&r.type==="form"?Cg(r):Ss.r(n)}var fa=typeof document>"u"?null:document;function hv(n,r,l){var c=fa;if(c&&typeof r=="string"&&r){var m=xt(r);m='link[rel="'+n+'"][href="'+m+'"]',typeof l=="string"&&(m+='[crossorigin="'+l+'"]'),uv.has(m)||(uv.add(m),n={rel:n,crossOrigin:l,href:r},c.querySelector(m)===null&&(r=c.createElement("link"),Fi(r,"link",n),pi(r),c.head.appendChild(r)))}}function J2(n){Ss.D(n),hv("dns-prefetch",n,null)}function t1(n,r){Ss.C(n,r),hv("preconnect",n,r)}function e1(n,r,l){Ss.L(n,r,l);var c=fa;if(c&&n&&r){var m='link[rel="preload"][as="'+xt(r)+'"]';r==="image"&&l&&l.imageSrcSet?(m+='[imagesrcset="'+xt(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(m+='[imagesizes="'+xt(l.imageSizes)+'"]')):m+='[href="'+xt(n)+'"]';var y=m;switch(r){case"style":y=pa(n);break;case"script":y=ga(n)}Nn.has(y)||(n=p({rel:"preload",href:r==="image"&&l&&l.imageSrcSet?void 0:n,as:r},l),Nn.set(y,n),c.querySelector(m)!==null||r==="style"&&c.querySelector(Eo(y))||r==="script"&&c.querySelector(So(y))||(r=c.createElement("link"),Fi(r,"link",n),pi(r),c.head.appendChild(r)))}}function i1(n,r){Ss.m(n,r);var l=fa;if(l&&n){var c=r&&typeof r.as=="string"?r.as:"script",m='link[rel="modulepreload"][as="'+xt(c)+'"][href="'+xt(n)+'"]',y=m;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":y=ga(n)}if(!Nn.has(y)&&(n=p({rel:"modulepreload",href:n},r),Nn.set(y,n),l.querySelector(m)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(So(y)))return}c=l.createElement("link"),Fi(c,"link",n),pi(c),l.head.appendChild(c)}}}function n1(n,r,l){Ss.S(n,r,l);var c=fa;if(c&&n){var m=_n(c).hoistableStyles,y=pa(n);r=r||"default";var R=m.get(y);if(!R){var I={loading:0,preload:null};if(R=c.querySelector(Eo(y)))I.loading=5;else{n=p({rel:"stylesheet",href:n,"data-precedence":r},l),(l=Nn.get(y))&&Yc(n,l);var X=R=c.createElement("link");pi(X),Fi(X,"link",n),X._p=new Promise(function(ct,vt){X.onload=ct,X.onerror=vt}),X.addEventListener("load",function(){I.loading|=1}),X.addEventListener("error",function(){I.loading|=2}),I.loading|=4,eu(R,r,c)}R={type:"stylesheet",instance:R,count:1,state:I},m.set(y,R)}}}function s1(n,r){Ss.X(n,r);var l=fa;if(l&&n){var c=_n(l).hoistableScripts,m=ga(n),y=c.get(m);y||(y=l.querySelector(So(m)),y||(n=p({src:n,async:!0},r),(r=Nn.get(m))&&Wc(n,r),y=l.createElement("script"),pi(y),Fi(y,"link",n),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(m,y))}}function r1(n,r){Ss.M(n,r);var l=fa;if(l&&n){var c=_n(l).hoistableScripts,m=ga(n),y=c.get(m);y||(y=l.querySelector(So(m)),y||(n=p({src:n,async:!0,type:"module"},r),(r=Nn.get(m))&&Wc(n,r),y=l.createElement("script"),pi(y),Fi(y,"link",n),l.head.appendChild(y)),y={type:"script",instance:y,count:1,state:null},c.set(m,y))}}function cv(n,r,l,c){var m=(m=zt.current)?tu(m):null;if(!m)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(r=pa(l.href),l=_n(m).hoistableStyles,c=l.get(r),c||(c={type:"style",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){n=pa(l.href);var y=_n(m).hoistableStyles,R=y.get(n);if(R||(m=m.ownerDocument||m,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},y.set(n,R),(y=m.querySelector(Eo(n)))&&!y._p&&(R.instance=y,R.state.loading=5),Nn.has(n)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Nn.set(n,l),y||a1(m,n,l,R.state))),r&&c===null)throw Error(i(528,""));return R}if(r&&c!==null)throw Error(i(529,""));return null;case"script":return r=l.async,l=l.src,typeof l=="string"&&r&&typeof r!="function"&&typeof r!="symbol"?(r=ga(l),l=_n(m).hoistableScripts,c=l.get(r),c||(c={type:"script",instance:null,count:0,state:null},l.set(r,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function pa(n){return'href="'+xt(n)+'"'}function Eo(n){return'link[rel="stylesheet"]['+n+"]"}function dv(n){return p({},n,{"data-precedence":n.precedence,precedence:null})}function a1(n,r,l,c){n.querySelector('link[rel="preload"][as="style"]['+r+"]")?c.loading=1:(r=n.createElement("link"),c.preload=r,r.addEventListener("load",function(){return c.loading|=1}),r.addEventListener("error",function(){return c.loading|=2}),Fi(r,"link",l),pi(r),n.head.appendChild(r))}function ga(n){return'[src="'+xt(n)+'"]'}function So(n){return"script[async]"+n}function fv(n,r,l){if(r.count++,r.instance===null)switch(r.type){case"style":var c=n.querySelector('style[data-href~="'+xt(l.href)+'"]');if(c)return r.instance=c,pi(c),c;var m=p({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(n.ownerDocument||n).createElement("style"),pi(c),Fi(c,"style",m),eu(c,l.precedence,n),r.instance=c;case"stylesheet":m=pa(l.href);var y=n.querySelector(Eo(m));if(y)return r.state.loading|=4,r.instance=y,pi(y),y;c=dv(l),(m=Nn.get(m))&&Yc(c,m),y=(n.ownerDocument||n).createElement("link"),pi(y);var R=y;return R._p=new Promise(function(I,X){R.onload=I,R.onerror=X}),Fi(y,"link",c),r.state.loading|=4,eu(y,l.precedence,n),r.instance=y;case"script":return y=ga(l.src),(m=n.querySelector(So(y)))?(r.instance=m,pi(m),m):(c=l,(m=Nn.get(y))&&(c=p({},l),Wc(c,m)),n=n.ownerDocument||n,m=n.createElement("script"),pi(m),Fi(m,"link",c),n.head.appendChild(m),r.instance=m);case"void":return null;default:throw Error(i(443,r.type))}else r.type==="stylesheet"&&(r.state.loading&4)===0&&(c=r.instance,r.state.loading|=4,eu(c,l.precedence,n));return r.instance}function eu(n,r,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),m=c.length?c[c.length-1]:null,y=m,R=0;R<c.length;R++){var I=c[R];if(I.dataset.precedence===r)y=I;else if(y!==m)break}y?y.parentNode.insertBefore(n,y.nextSibling):(r=l.nodeType===9?l.head:l,r.insertBefore(n,r.firstChild))}function Yc(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.title==null&&(n.title=r.title)}function Wc(n,r){n.crossOrigin==null&&(n.crossOrigin=r.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=r.referrerPolicy),n.integrity==null&&(n.integrity=r.integrity)}var iu=null;function pv(n,r,l){if(iu===null){var c=new Map,m=iu=new Map;m.set(l,c)}else m=iu,c=m.get(l),c||(c=new Map,m.set(l,c));if(c.has(n))return c;for(c.set(n,null),l=l.getElementsByTagName(n),m=0;m<l.length;m++){var y=l[m];if(!(y[Li]||y[de]||n==="link"&&y.getAttribute("rel")==="stylesheet")&&y.namespaceURI!=="http://www.w3.org/2000/svg"){var R=y.getAttribute(r)||"";R=n+R;var I=c.get(R);I?I.push(y):c.set(R,[y])}}return c}function gv(n,r,l){n=n.ownerDocument||n,n.head.insertBefore(l,r==="title"?n.querySelector("head > title"):null)}function o1(n,r,l){if(l===1||r.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof r.precedence!="string"||typeof r.href!="string"||r.href==="")break;return!0;case"link":if(typeof r.rel!="string"||typeof r.href!="string"||r.href===""||r.onLoad||r.onError)break;return r.rel==="stylesheet"?(n=r.disabled,typeof r.precedence=="string"&&n==null):!0;case"script":if(r.async&&typeof r.async!="function"&&typeof r.async!="symbol"&&!r.onLoad&&!r.onError&&r.src&&typeof r.src=="string")return!0}return!1}function mv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function l1(n,r,l,c){if(l.type==="stylesheet"&&(typeof c.media!="string"||matchMedia(c.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var m=pa(c.href),y=r.querySelector(Eo(m));if(y){r=y._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(n.count++,n=nu.bind(n),r.then(n,n)),l.state.loading|=4,l.instance=y,pi(y);return}y=r.ownerDocument||r,c=dv(c),(m=Nn.get(m))&&Yc(c,m),y=y.createElement("link"),pi(y);var R=y;R._p=new Promise(function(I,X){R.onload=I,R.onerror=X}),Fi(y,"link",c),l.instance=y}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(l,r),(r=l.state.preload)&&(l.state.loading&3)===0&&(n.count++,l=nu.bind(n),r.addEventListener("load",l),r.addEventListener("error",l))}}var Zc=0;function u1(n,r){return n.stylesheets&&n.count===0&&ru(n,n.stylesheets),0<n.count||0<n.imgCount?function(l){var c=setTimeout(function(){if(n.stylesheets&&ru(n,n.stylesheets),n.unsuspend){var y=n.unsuspend;n.unsuspend=null,y()}},6e4+r);0<n.imgBytes&&Zc===0&&(Zc=62500*q2());var m=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&ru(n,n.stylesheets),n.unsuspend)){var y=n.unsuspend;n.unsuspend=null,y()}},(n.imgBytes>Zc?50:800)+r);return n.unsuspend=l,function(){n.unsuspend=null,clearTimeout(c),clearTimeout(m)}}:null}function nu(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ru(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var su=null;function ru(n,r){n.stylesheets=null,n.unsuspend!==null&&(n.count++,su=new Map,r.forEach(h1,n),su=null,nu.call(n))}function h1(n,r){if(!(r.state.loading&4)){var l=su.get(n);if(l)var c=l.get(null);else{l=new Map,su.set(n,l);for(var m=n.querySelectorAll("link[data-precedence],style[data-precedence]"),y=0;y<m.length;y++){var R=m[y];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(l.set(R.dataset.precedence,R),c=R)}c&&l.set(null,c)}m=r.instance,R=m.getAttribute("data-precedence"),y=l.get(R)||c,y===c&&l.set(null,m),l.set(R,m),this.count++,c=nu.bind(this),m.addEventListener("load",c),m.addEventListener("error",c),y?y.parentNode.insertBefore(m,y.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(m,n.firstChild)),r.state.loading|=4}}var xo={$$typeof:D,Provider:null,Consumer:null,_currentValue:st,_currentValue2:st,_threadCount:0};function c1(n,r,l,c,m,y,R,I,X){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=L(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=L(0),this.hiddenUpdates=L(null),this.identifierPrefix=c,this.onUncaughtError=m,this.onCaughtError=y,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=X,this.incompleteTransitions=new Map}function vv(n,r,l,c,m,y,R,I,X,ct,vt,wt){return n=new c1(n,r,l,R,X,ct,vt,wt,I),r=1,y===!0&&(r|=24),y=dn(3,null,null,r),n.current=y,y.stateNode=n,r=Dh(),r.refCount++,n.pooledCache=r,r.refCount++,y.memoizedState={element:c,isDehydrated:l,cache:r},kh(y),n}function yv(n){return n?(n=Xr,n):Xr}function bv(n,r,l,c,m,y){m=yv(m),c.context===null?c.context=m:c.pendingContext=m,c=Us(r),c.payload={element:l},y=y===void 0?null:y,y!==null&&(c.callback=y),l=Hs(n,c,r),l!==null&&(an(l,n,r),io(l,n,r))}function Av(n,r){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<r?l:r}}function Kc(n,r){Av(n,r),(n=n.alternate)&&Av(n,r)}function _v(n){if(n.tag===13||n.tag===31){var r=fr(n,67108864);r!==null&&an(r,n,67108864),Kc(n,67108864)}}function wv(n){if(n.tag===13||n.tag===31){var r=vn();r=$t(r);var l=fr(n,r);l!==null&&an(l,n,r),Kc(n,r)}}var au=!0;function d1(n,r,l,c){var m=G.T;G.T=null;var y=W.p;try{W.p=2,$c(n,r,l,c)}finally{W.p=y,G.T=m}}function f1(n,r,l,c){var m=G.T;G.T=null;var y=W.p;try{W.p=8,$c(n,r,l,c)}finally{W.p=y,G.T=m}}function $c(n,r,l,c){if(au){var m=Qc(c);if(m===null)zc(n,r,c,ou,l),Sv(n,c);else if(g1(m,n,r,l,c))c.stopPropagation();else if(Sv(n,c),r&4&&-1<p1.indexOf(n)){for(;m!==null;){var y=Os(m);if(y!==null)switch(y.tag){case 3:if(y=y.stateNode,y.current.memoizedState.isDehydrated){var R=F(y.pendingLanes);if(R!==0){var I=y;for(I.pendingLanes|=2,I.entangledLanes|=2;R;){var X=1<<31-U(R);I.entanglements[1]|=X,R&=~X}Qn(y),(Le&6)===0&&(ql=De()+500,bo(0))}}break;case 31:case 13:I=fr(y,2),I!==null&&an(I,y,2),Vl(),Kc(y,2)}if(y=Qc(c),y===null&&zc(n,r,c,ou,l),y===m)break;m=y}m!==null&&c.stopPropagation()}else zc(n,r,c,null,l)}}function Qc(n){return n=th(n),Jc(n)}var ou=null;function Jc(n){if(ou=null,n=zn(n),n!==null){var r=a(n);if(r===null)n=null;else{var l=r.tag;if(l===13){if(n=o(r),n!==null)return n;n=null}else if(l===31){if(n=u(r),n!==null)return n;n=null}else if(l===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;n=null}else r!==n&&(n=null)}}return ou=n,null}function Ev(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wi()){case Di:return 2;case si:return 8;case ki:case ji:return 32;case fi:return 268435456;default:return 32}default:return 32}}var td=!1,Qs=null,Js=null,tr=null,Co=new Map,To=new Map,er=[],p1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Sv(n,r){switch(n){case"focusin":case"focusout":Qs=null;break;case"dragenter":case"dragleave":Js=null;break;case"mouseover":case"mouseout":tr=null;break;case"pointerover":case"pointerout":Co.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":To.delete(r.pointerId)}}function Do(n,r,l,c,m,y){return n===null||n.nativeEvent!==y?(n={blockedOn:r,domEventName:l,eventSystemFlags:c,nativeEvent:y,targetContainers:[m]},r!==null&&(r=Os(r),r!==null&&_v(r)),n):(n.eventSystemFlags|=c,r=n.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),n)}function g1(n,r,l,c,m){switch(r){case"focusin":return Qs=Do(Qs,n,r,l,c,m),!0;case"dragenter":return Js=Do(Js,n,r,l,c,m),!0;case"mouseover":return tr=Do(tr,n,r,l,c,m),!0;case"pointerover":var y=m.pointerId;return Co.set(y,Do(Co.get(y)||null,n,r,l,c,m)),!0;case"gotpointercapture":return y=m.pointerId,To.set(y,Do(To.get(y)||null,n,r,l,c,m)),!0}return!1}function xv(n){var r=zn(n.target);if(r!==null){var l=a(r);if(l!==null){if(r=l.tag,r===13){if(r=o(l),r!==null){n.blockedOn=r,se(n.priority,function(){wv(l)});return}}else if(r===31){if(r=u(l),r!==null){n.blockedOn=r,se(n.priority,function(){wv(l)});return}}else if(r===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function lu(n){if(n.blockedOn!==null)return!1;for(var r=n.targetContainers;0<r.length;){var l=Qc(n.nativeEvent);if(l===null){l=n.nativeEvent;var c=new l.constructor(l.type,l);Pr=c,l.target.dispatchEvent(c),Pr=null}else return r=Os(l),r!==null&&_v(r),n.blockedOn=l,!1;r.shift()}return!0}function Cv(n,r,l){lu(n)&&l.delete(r)}function m1(){td=!1,Qs!==null&&lu(Qs)&&(Qs=null),Js!==null&&lu(Js)&&(Js=null),tr!==null&&lu(tr)&&(tr=null),Co.forEach(Cv),To.forEach(Cv)}function uu(n,r){n.blockedOn===r&&(n.blockedOn=null,td||(td=!0,g.unstable_scheduleCallback(g.unstable_NormalPriority,m1)))}var hu=null;function Tv(n){hu!==n&&(hu=n,g.unstable_scheduleCallback(g.unstable_NormalPriority,function(){hu===n&&(hu=null);for(var r=0;r<n.length;r+=3){var l=n[r],c=n[r+1],m=n[r+2];if(typeof c!="function"){if(Jc(c||l)===null)continue;break}var y=Os(l);y!==null&&(n.splice(r,3),r-=3,Qh(y,{pending:!0,data:m,method:l.method,action:c},c,m))}}))}function ma(n){function r(X){return uu(X,n)}Qs!==null&&uu(Qs,n),Js!==null&&uu(Js,n),tr!==null&&uu(tr,n),Co.forEach(r),To.forEach(r);for(var l=0;l<er.length;l++){var c=er[l];c.blockedOn===n&&(c.blockedOn=null)}for(;0<er.length&&(l=er[0],l.blockedOn===null);)xv(l),l.blockedOn===null&&er.shift();if(l=(n.ownerDocument||n).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var m=l[c],y=l[c+1],R=m[pe]||null;if(typeof y=="function")R||Tv(l);else if(R){var I=null;if(y&&y.hasAttribute("formAction")){if(m=y,R=y[pe]||null)I=R.formAction;else if(Jc(m)!==null)continue}else I=R.action;typeof I=="function"?l[c+1]=I:(l.splice(c,3),c-=3),Tv(l)}}}function Dv(){function n(y){y.canIntercept&&y.info==="react-transition"&&y.intercept({handler:function(){return new Promise(function(R){return m=R})},focusReset:"manual",scroll:"manual"})}function r(){m!==null&&(m(),m=null),c||setTimeout(l,20)}function l(){if(!c&&!navigation.transition){var y=navigation.currentEntry;y&&y.url!=null&&navigation.navigate(y.url,{state:y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var c=!1,m=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",r),navigation.addEventListener("navigateerror",r),setTimeout(l,100),function(){c=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",r),navigation.removeEventListener("navigateerror",r),m!==null&&(m(),m=null)}}}function ed(n){this._internalRoot=n}cu.prototype.render=ed.prototype.render=function(n){var r=this._internalRoot;if(r===null)throw Error(i(409));var l=r.current,c=vn();bv(l,c,n,r,null,null)},cu.prototype.unmount=ed.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var r=n.containerInfo;bv(n.current,2,null,n,null,null),Vl(),r[Gi]=null}};function cu(n){this._internalRoot=n}cu.prototype.unstable_scheduleHydration=function(n){if(n){var r=we();n={blockedOn:null,target:n,priority:r};for(var l=0;l<er.length&&r!==0&&r<er[l].priority;l++);er.splice(l,0,n),l===0&&xv(n)}};var Rv=t.version;if(Rv!=="19.2.4")throw Error(i(527,Rv,"19.2.4"));W.findDOMNode=function(n){var r=n._reactInternals;if(r===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=d(r),n=n!==null?f(n):null,n=n===null?null:n.stateNode,n};var v1={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var du=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!du.isDisabled&&du.supportsFiber)try{Pe=du.inject(v1),Me=du}catch{}}return No.createRoot=function(n,r){if(!s(n))throw Error(i(299));var l=!1,c="",m=Ig,y=zg,R=Fg;return r!=null&&(r.unstable_strictMode===!0&&(l=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onUncaughtError!==void 0&&(m=r.onUncaughtError),r.onCaughtError!==void 0&&(y=r.onCaughtError),r.onRecoverableError!==void 0&&(R=r.onRecoverableError)),r=vv(n,1,!1,null,null,l,c,null,m,y,R,Dv),n[Gi]=r.current,Ic(n),new ed(r)},No.hydrateRoot=function(n,r,l){if(!s(n))throw Error(i(299));var c=!1,m="",y=Ig,R=zg,I=Fg,X=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(y=l.onUncaughtError),l.onCaughtError!==void 0&&(R=l.onCaughtError),l.onRecoverableError!==void 0&&(I=l.onRecoverableError),l.formState!==void 0&&(X=l.formState)),r=vv(n,1,!0,r,l??null,c,m,X,y,R,I,Dv),r.context=yv(null),l=r.current,c=vn(),c=$t(c),m=Us(c),m.callback=null,Hs(l,m,c),l=c,r.current.lanes=l,Y(r,l),Qn(r),n[Gi]=r.current,Ic(n),new cu(r)},No.version="19.2.4",No}var Hv;function D1(){if(Hv)return rd.exports;Hv=1;function g(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(g)}catch(t){console.error(t)}}return g(),rd.exports=T1(),rd.exports}var R1=D1();const N1=ur(R1);function O1(g){return!g||g.length<=2?0:Math.min(Math.floor(g.length/2)-1,3)}function k1(g,t){if(!g)return null;if(!t)return g;const e=O1(g),i=g.slice(0,e),s=g[e],a=g.slice(e+1);return te.jsxs(te.Fragment,{children:[te.jsx("span",{className:"word-normal",children:i}),te.jsx("span",{className:"word-orp",children:s}),te.jsx("span",{className:"word-normal",children:a})]})}function M1({prev:g,current:t,next:e,orpEnabled:i=!0}){return te.jsxs("div",{className:"stream-container",children:[te.jsx("div",{className:"word-blurred",children:g}),te.jsx("div",{className:"word-current",children:k1(t,i)}),te.jsx("div",{className:"word-blurred",children:e})]})}function L1({words:g,currentIndex:t,chapters:e,wpm:i,onJump:s}){if(!g.length)return null;const a=g.length,o=Math.floor(t/a*100);let u=-1;for(let v=0;v<e.length;v++)t>=e[v].wordStart&&(u=v);const h=u>=0?e[u]:null,d=u+1<e.length?e[u+1]:null;let f=0,p=0;return d&&(f=d.wordStart-t,p=Math.max(1,Math.ceil(f/i))),te.jsxs("aside",{className:"sidebar",children:[te.jsxs("div",{className:"sidebar-section",children:[te.jsx("h2",{className:"sidebar-title",children:"Progress"}),te.jsxs("div",{className:"progress-row",children:[te.jsx("div",{className:"progress-bar",children:te.jsx("div",{className:"progress-fill",style:{width:`${o}%`}})}),te.jsxs("span",{className:"progress-text",children:[o,"% read"]})]})]}),h&&te.jsxs("div",{className:"sidebar-section",children:[te.jsx("h3",{className:"sidebar-subtitle",children:"Current Chapter"}),te.jsx("div",{className:"chapter-current",children:h.title}),d&&te.jsxs("div",{className:"chapter-meta",children:[te.jsxs("div",{children:[f," words to next chapter"]}),te.jsxs("div",{children:["~",p," min at current pace"]})]})]}),e.length>0&&te.jsxs("div",{className:"sidebar-section",children:[te.jsx("h3",{className:"sidebar-subtitle",children:"Chapters"}),te.jsx("ul",{className:"chapter-list",children:e.map((v,A)=>{let C="upcoming";return A<u&&(C="done"),A===u&&(C="current"),te.jsxs("li",{className:`chapter-item ${C}`,onClick:()=>s(v.wordStart),children:[te.jsxs("span",{className:"chapter-marker",children:[C==="done"&&"",C==="current"&&"",C==="upcoming"&&""]}),te.jsx("span",{className:"chapter-title",children:v.title})]},A)})})]})]})}const Ki=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),of=[.001,0,0,.001,0,0],ud=1.35,yn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},nr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},qo="pdfjs_internal_editor_",le={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Se={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},B1={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},lf={TRIANGLES:1,LATTICE:2},Ci={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},xu={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Si={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},wa={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ju={ERRORS:0,WARNINGS:1,INFOS:5},Go={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Oo={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},I1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let qu=ju.WARNINGS;function z1(g){Number.isInteger(g)&&(qu=g)}function F1(){return qu}function Gu(g){qu>=ju.INFOS&&console.info(`Info: ${g}`)}function ae(g){qu>=ju.WARNINGS&&console.warn(`Warning: ${g}`)}function We(g){throw new Error(g)}function xe(g,t){g||We(t)}function P1(g){switch(g?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function fy(g,t=null,e=null){if(!g)return null;if(e&&typeof g=="string"&&(e.addDefaultProtocol&&g.startsWith("www.")&&g.match(/\./g)?.length>=2&&(g=`http://${g}`),e.tryConvertEncoding))try{g=G1(g)}catch{}const i=t?URL.parse(g,t):URL.parse(g);return P1(i)?i:null}function py(g,t,e=!1){const i=URL.parse(g);return i?(i.hash=t,i.href):e&&fy(g,"http://example.com")?g.split("#",1)[0]+`${t?`#${t}`:""}`:""}function oe(g,t,e,i=!1){return Object.defineProperty(g,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const kr=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class jv extends kr{constructor(t,e){super(t,"PasswordException"),this.code=e}}class hd extends kr{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class uf extends kr{constructor(t){super(t,"InvalidPDFException")}}class Nu extends kr{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class U1 extends kr{constructor(t){super(t,"FormatError")}}class or extends kr{constructor(t){super(t,"AbortException")}}function gy(g){(typeof g!="object"||g?.length===void 0)&&We("Invalid argument for bytesToString");const t=g.length,e=8192;if(t<e)return String.fromCharCode.apply(null,g);const i=[];for(let s=0;s<t;s+=e){const a=Math.min(s+e,t),o=g.subarray(s,a);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function Ko(g){typeof g!="string"&&We("Invalid argument for stringToBytes");const t=g.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=g.charCodeAt(i)&255;return e}function H1(g){return String.fromCharCode(g>>24&255,g>>16&255,g>>8&255,g&255)}function j1(){const g=new Uint8Array(4);return g[0]=1,new Uint32Array(g.buffer,0,1)[0]===1}function q1(){try{return new Function(""),!0}catch{return!1}}class Ti{static get isLittleEndian(){return oe(this,"isLittleEndian",j1())}static get isEvalSupported(){return oe(this,"isEvalSupported",q1())}static get isOffscreenCanvasSupported(){return oe(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return oe(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return oe(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return oe(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return oe(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return oe(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const cd=Array.from(Array(256).keys(),g=>g.toString(16).padStart(2,"0"));class Pt{static makeHexColor(t,e,i){return`#${cd[t]}${cd[e]}${cd[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const s=t[i],a=t[i+1];t[i]=s*e[0]+a*e[2]+e[4],t[i+1]=s*e[1]+a*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const s=e[0],a=e[1],o=e[2],u=e[3],h=e[4],d=e[5];for(let f=0;f<6;f+=2){const p=t[i+f],v=t[i+f+1];t[i+f]=p*s+v*o+h,t[i+f+1]=p*a+v*u+d}}static applyInverseTransform(t,e){const i=t[0],s=t[1],a=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-s*e[2]+e[2]*e[5]-e[4]*e[3])/a,t[1]=(-i*e[1]+s*e[0]+e[4]*e[1]-e[5]*e[0])/a}static axialAlignedBoundingBox(t,e,i){const s=e[0],a=e[1],o=e[2],u=e[3],h=e[4],d=e[5],f=t[0],p=t[1],v=t[2],A=t[3];let C=s*f+h,w=C,b=s*v+h,_=b,x=u*p+d,D=x,M=u*A+d,T=M;if(a!==0||o!==0){const O=a*f,k=a*v,z=o*p,B=o*A;C+=z,_+=z,b+=B,w+=B,x+=O,T+=O,M+=k,D+=k}i[0]=Math.min(i[0],C,b,w,_),i[1]=Math.min(i[1],x,M,D,T),i[2]=Math.max(i[2],C,b,w,_),i[3]=Math.max(i[3],x,M,D,T)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],s=t[1],a=t[2],o=t[3],u=i**2+s**2,h=i*a+s*o,d=a**2+o**2,f=(u+d)/2,p=Math.sqrt(f**2-(u*d-h**2));e[0]=Math.sqrt(f+p||1),e[1]=Math.sqrt(f-p||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),s=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>s)return null;const a=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),o=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return a>o?null:[i,a,s,o]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,s,a){a[0]=Math.min(a[0],t,i),a[1]=Math.min(a[1],e,s),a[2]=Math.max(a[2],t,i),a[3]=Math.max(a[3],e,s)}static#t(t,e,i,s,a,o,u,h,d,f){if(d<=0||d>=1)return;const p=1-d,v=d*d,A=v*d,C=p*(p*(p*t+3*d*e)+3*v*i)+A*s,w=p*(p*(p*a+3*d*o)+3*v*u)+A*h;f[0]=Math.min(f[0],C),f[1]=Math.min(f[1],w),f[2]=Math.max(f[2],C),f[3]=Math.max(f[3],w)}static#e(t,e,i,s,a,o,u,h,d,f,p,v){if(Math.abs(d)<1e-12){Math.abs(f)>=1e-12&&this.#t(t,e,i,s,a,o,u,h,-p/f,v);return}const A=f**2-4*p*d;if(A<0)return;const C=Math.sqrt(A),w=2*d;this.#t(t,e,i,s,a,o,u,h,(-f+C)/w,v),this.#t(t,e,i,s,a,o,u,h,(-f-C)/w,v)}static bezierBoundingBox(t,e,i,s,a,o,u,h,d){d[0]=Math.min(d[0],t,u),d[1]=Math.min(d[1],e,h),d[2]=Math.max(d[2],t,u),d[3]=Math.max(d[3],e,h),this.#e(t,i,a,u,e,s,o,h,3*(-t+3*(i-a)+u),6*(t-2*i+a),3*(i-t),d),this.#e(t,i,a,u,e,s,o,h,3*(-e+3*(s-o)+h),6*(e-2*s+o),3*(s-e),d)}}function G1(g){return decodeURIComponent(escape(g))}let dd=null,qv=null;function V1(g){return dd||(dd=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,qv=new Map([["","t"]])),g.replaceAll(dd,(t,e,i)=>e?e.normalize("NFKC"):qv.get(i))}function my(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const g=new Uint8Array(32);return crypto.getRandomValues(g),gy(g)}const Da="pdfjs_internal_id_";function X1(g,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,s,...a]=e;if(!g(i)&&!Number.isInteger(i)||!t(s))return!1;const o=a.length;let u=!0;switch(s.name){case"XYZ":if(o<2||o>3)return!1;break;case"Fit":case"FitB":return o===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(o>1)return!1;break;case"FitR":if(o!==4)return!1;u=!1;break;default:return!1}for(const h of a)if(!(typeof h=="number"||u&&h===null))return!1;return!0}function $i(g,t,e){return Math.min(Math.max(g,t),e)}function vy(g){return Uint8Array.prototype.toBase64?g.toBase64():btoa(gy(g))}function Y1(g){return Uint8Array.fromBase64?Uint8Array.fromBase64(g):Ko(atob(g))}typeof Promise.try!="function"&&(Promise.try=function(g,...t){return new Promise(e=>{e(g(...t))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(g){return g.reduce((t,e)=>t+e,0)});class Vo{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function s(a){if(!a)return;let o=null;const u=a.name;if(u==="#text")o=a.value;else if(Vo.shouldBuildText(u))a?.attributes?.textContent?o=a.attributes.textContent:a.value&&(o=a.value);else return;if(o!==null&&e.push({str:o}),!!a.children)for(const h of a.children)s(h)}return s(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class yy{static setupStorage(t,e,i,s,a){const o=s.getValue(e,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(t.textContent=o.value),a==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?t.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&t.removeAttribute("checked"),a==="print")break;t.addEventListener("change",u=>{s.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&t.setAttribute("value",o.value),a==="print")break;t.addEventListener("input",u=>{s.setValue(e,{value:u.target.value})})}break;case"select":if(o.value!==null){t.setAttribute("value",o.value);for(const u of i.children)u.attributes.value===o.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const h=u.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(e,{value:d})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:s,linkService:a}){const{attributes:o}=e,u=t instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[h,d]of Object.entries(o))if(d!=null)switch(h){case"class":d.length&&t.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",d);break;case"style":Object.assign(t.style,d);break;case"textContent":t.textContent=d;break;default:(!u||h!=="href"&&h!=="newWindow")&&t.setAttribute(h,d)}u&&a.addLinkAttributes(t,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(t,o.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,s=t.xfaHtml,a=t.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:a,linkService:i});const u=a!=="richText",h=t.div;if(h.append(o),t.viewport){const p=`matrix(${t.viewport.transform.join(",")})`;h.style.transform=p}u&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(s.children.length===0){if(s.value){const p=document.createTextNode(s.value);o.append(p),u&&Vo.shouldBuildText(s.name)&&d.push(p)}return{textDivs:d}}const f=[[s,-1,o]];for(;f.length>0;){const[p,v,A]=f.at(-1);if(v+1===p.children.length){f.pop();continue}const C=p.children[++f.at(-1)[1]];if(C===null)continue;const{name:w}=C;if(w==="#text"){const _=document.createTextNode(C.value);d.push(_),A.append(_);continue}const b=C?.attributes?.xmlns?document.createElementNS(C.attributes.xmlns,w):document.createElement(w);if(A.append(b),C.attributes&&this.setAttributes({html:b,element:C,storage:e,intent:a,linkService:i}),C.children?.length>0)f.push([C,-1,b]);else if(C.value){const _=document.createTextNode(C.value);u&&Vo.shouldBuildText(w)&&d.push(_),b.append(_)}}for(const p of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))p.setAttribute("readOnly",!0);return{textDivs:d}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const Cs="http://www.w3.org/2000/svg";class za{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function $o(g,t="text"){if(Po(g,document.baseURI)){const e=await fetch(g);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const s=new XMLHttpRequest;s.open("GET",g,!0),s.responseType=t,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(s.response);return}e(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class Qo{constructor({viewBox:t,userUnit:e,scale:i,rotation:s,offsetX:a=0,offsetY:o=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=s,this.offsetX=a,this.offsetY=o,i*=e;const h=(t[2]+t[0])/2,d=(t[3]+t[1])/2;let f,p,v,A;switch(s%=360,s<0&&(s+=360),s){case 180:f=-1,p=0,v=0,A=1;break;case 90:f=0,p=1,v=1,A=0;break;case 270:f=0,p=-1,v=-1,A=0;break;case 0:f=1,p=0,v=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(v=-v,A=-A);let C,w,b,_;f===0?(C=Math.abs(d-t[1])*i+a,w=Math.abs(h-t[0])*i+o,b=(t[3]-t[1])*i,_=(t[2]-t[0])*i):(C=Math.abs(h-t[0])*i+a,w=Math.abs(d-t[1])*i+o,b=(t[2]-t[0])*i,_=(t[3]-t[1])*i),this.transform=[f*i,p*i,v*i,A*i,C-f*i*h-v*i*d,w-p*i*h-A*i*d],this.width=b,this.height=_}get rawDims(){const t=this.viewBox;return oe(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:a=!1}={}){return new Qo({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:a})}convertToViewportPoint(t,e){const i=[t,e];return Pt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];Pt.applyTransform(e,this.transform);const i=[t[2],t[3]];return Pt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return Pt.applyInverseTransform(i,this.transform),i}}class Tf extends kr{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function Vu(g){const t=g.length;let e=0;for(;e<t&&g[e].trim()==="";)e++;return g.substring(e,e+5).toLowerCase()==="data:"}function Df(g){return typeof g=="string"&&/\.pdf$/i.test(g)}function W1(g){return[g]=g.split(/[#?]/,1),g.substring(g.lastIndexOf("/")+1)}function Z1(g,t="document.pdf"){if(typeof g!="string")return t;if(Vu(g))return ae('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(g);if(!i)return t;const s=u=>{try{let h=decodeURIComponent(u);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:u):h}catch{return u}},a=/\.pdf$/i,o=i.pathname.split("/").at(-1);if(a.test(o))return s(o);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const d of u)if(a.test(d))return s(d);const h=Array.from(i.searchParams.keys()).reverse();for(const d of h)if(a.test(d))return s(d)}if(i.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(h)return s(h[0])}return t}class Gv{started=Object.create(null);times=[];time(t){t in this.started&&ae(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ae(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:s,end:a}of this.times)t.push(`${i.padEnd(e)} ${a-s}ms
`);return t.join("")}}function Po(g,t){const e=t?URL.parse(g,t):URL.parse(g);return e?.protocol==="http:"||e?.protocol==="https:"}function In(g){g.preventDefault()}function ci(g){g.preventDefault(),g.stopPropagation()}function K1(g){console.log("Deprecated API usage: "+g)}class hf{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let s=parseInt(e[2],10);s=s>=1&&s<=12?s-1:0;let a=parseInt(e[3],10);a=a>=1&&a<=31?a:1;let o=parseInt(e[4],10);o=o>=0&&o<=23?o:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let h=parseInt(e[6],10);h=h>=0&&h<=59?h:0;const d=e[7]||"Z";let f=parseInt(e[8],10);f=f>=0&&f<=23?f:0;let p=parseInt(e[9],10)||0;return p=p>=0&&p<=59?p:0,d==="-"?(o+=f,u+=p):d==="+"&&(o-=f,u-=p),new Date(Date.UTC(i,s,a,o,u,h))}}function $1(g,{scale:t=1,rotation:e=0}){const{width:i,height:s}=g.attributes.style,a=[0,0,parseInt(i),parseInt(s)];return new Qo({viewBox:a,userUnit:1,scale:t,rotation:e})}function Jo(g){if(g.startsWith("#")){const t=parseInt(g.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return g.startsWith("rgb(")?g.slice(4,-1).split(",").map(t=>parseInt(t)):g.startsWith("rgba(")?g.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ae(`Not a valid color format: "${g}"`),[0,0,0])}function Q1(g){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of g.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;g.set(e,Jo(i))}t.remove()}function ai(g){const{a:t,b:e,c:i,d:s,e:a,f:o}=g.getTransform();return[t,e,i,s,a,o]}function es(g){const{a:t,b:e,c:i,d:s,e:a,f:o}=g.getTransform().invertSelf();return[t,e,i,s,a,o]}function Nr(g,t,e=!1,i=!0){if(t instanceof Qo){const{pageWidth:s,pageHeight:a}=t.rawDims,{style:o}=g,u=Ti.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,d=`var(--total-scale-factor) * ${a}px`,f=u?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,p=u?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!e||t.rotation%180===0?(o.width=f,o.height=p):(o.width=p,o.height=f)}i&&g.setAttribute("data-main-rotation",t.rotation)}class as{constructor(){const{pixelRatio:t}=as;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,s,a=-1){let o=1/0,u=1/0,h=1/0;i=as.capPixels(i,a),i>0&&(o=Math.sqrt(i/(t*e))),s!==-1&&(u=s/t,h=s/e);const d=Math.min(o,u,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const cf=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class J1{static get isDarkMode(){return oe(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class tA{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),oe(this,"commentForegroundColor",Jo(i))}}function eA(g,t,e,i){i=Math.min(Math.max(i??1,0),1);const s=255*(1-i);return g=Math.round(g*i+s),t=Math.round(t*i+s),e=Math.round(e*i+s),[g,t,e]}function Vv(g,t){const e=g[0]/255,i=g[1]/255,s=g[2]/255,a=Math.max(e,i,s),o=Math.min(e,i,s),u=(a+o)/2;if(a===o)t[0]=t[1]=0;else{const h=a-o;switch(t[1]=u<.5?h/(a+o):h/(2-a-o),a){case e:t[0]=((i-s)/h+(i<s?6:0))*60;break;case i:t[0]=((s-e)/h+2)*60;break;case s:t[0]=((e-i)/h+4)*60;break}}t[2]=u}function df(g,t){const e=g[0],i=g[1],s=g[2],a=(1-Math.abs(2*s-1))*i,o=a*(1-Math.abs(e/60%2-1)),u=s-a/2;switch(Math.floor(e/60)){case 0:t[0]=a+u,t[1]=o+u,t[2]=u;break;case 1:t[0]=o+u,t[1]=a+u,t[2]=u;break;case 2:t[0]=u,t[1]=a+u,t[2]=o+u;break;case 3:t[0]=u,t[1]=o+u,t[2]=a+u;break;case 4:t[0]=o+u,t[1]=u,t[2]=a+u;break;case 5:case 6:t[0]=a+u,t[1]=u,t[2]=o+u;break}}function Xv(g){return g<=.03928?g/12.92:((g+.055)/1.055)**2.4}function Yv(g,t,e){df(g,e),e.map(Xv);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];df(t,e),e.map(Xv);const s=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>s?(i+.05)/(s+.05):(s+.05)/(i+.05)}const Wv=new Map;function iA(g,t){const e=g[0]+g[1]*256+g[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=Wv.get(e);if(i)return i;const s=new Float32Array(9),a=s.subarray(0,3),o=s.subarray(3,6);Vv(g,o);const u=s.subarray(6,9);Vv(t,u);const h=u[2]<.5,d=h?12:4.5;if(o[2]=h?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),Yv(o,u,a)<d){let f,p;h?(f=o[2],p=1):(f=0,p=o[2]);const v=.005;for(;p-f>v;){const A=o[2]=(f+p)/2;h===Yv(o,u,a)<d?f=A:p=A}o[2]=h?p:f}return df(o,a),i=Pt.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),Wv.set(e,i),i}function by({html:g,dir:t,className:e},i){const s=document.createDocumentFragment();if(typeof g=="string"){const a=document.createElement("p");a.dir=t||"auto";const o=g.split(/(?:\r\n?|\n)/);for(let u=0,h=o.length;u<h;++u){const d=o[u];a.append(document.createTextNode(d)),u<h-1&&a.append(document.createElement("br"))}s.append(a)}else yy.render({xfaHtml:g,div:s,intent:"richText"});s.firstElementChild.classList.add("richText",e),i.append(s)}function Ay(g){const t=new Path2D;if(!g)return t;for(let e=0,i=g.length;e<i;)switch(g[e++]){case Oo.moveTo:t.moveTo(g[e++],g[e++]);break;case Oo.lineTo:t.lineTo(g[e++],g[e++]);break;case Oo.curveTo:t.bezierCurveTo(g[e++],g[e++],g[e++],g[e++],g[e++],g[e++]);break;case Oo.quadraticCurveTo:t.quadraticCurveTo(g[e++],g[e++],g[e++],g[e++]);break;case Oo.closePath:t.closePath();break;default:ae(`Unrecognized drawing path operator: ${g[e-1]}`);break}return t}class jo{#t=null;#e=null;#n;#i=null;#a=null;#r=null;#s=null;#o=null;static#u=null;constructor(t){this.#n=t,jo.#u||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#n._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",In,{signal:e}),t.addEventListener("pointerdown",jo.#l,{signal:e}));const i=this.#i=document.createElement("div");i.className="buttons",t.append(i);const s=this.#n.toolbarPosition;if(s){const{style:a}=t,o=this.#n._uiManager.direction==="ltr"?1-s[0]:s[0];a.insetInlineEnd=`${100*o}%`,a.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#n._focusEventsAllowed=!1,ci(t)}#c(t){this.#n._focusEventsAllowed=!0,ci(t)}#f(t){const e=this.#n._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#c.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",In,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#a?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#n,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",jo.#u[t]),this.#f(i)&&i.addEventListener("click",s=>{e.delete()},{signal:e._signal}),this.#i.append(i)}get#m(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#i.append(e,this.#m),this.#a=t}addComment(t,e=null){if(this.#r)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const s=this.#s=this.#m;e?(this.#i.insertBefore(i,e),this.#i.insertBefore(s,e)):this.#i.append(i,s),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#i.append(e,this.#m)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#n);this.#f(e),this.#i.append(e,this.#m)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#s?.remove(),this.#s=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const s=this.#i.querySelector(i);s&&t==="comment"&&this.addComment(e,s)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class nA{#t=null;#e=null;#n;constructor(t){this.#n=t}#i(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#n._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",In,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#n.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),t}#a(t,e){let i=0,s=0;for(const a of t){const o=a.y+a.height;if(o<i)continue;const u=a.x+(e?a.width:0);if(o>i){s=u,i=o;continue}e?u>s&&(s=u):u<s&&(s=u)}return[e?1-s:s,i]}show(t,e,i){const[s,a]=this.#a(e,i),{style:o}=this.#e||=this.#i();t.append(this.#e),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*a}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,i,s){const a=document.createElement("button");a.classList.add("basic",t),a.tabIndex=0,a.setAttribute("data-l10n-id",e);const o=document.createElement("span");a.append(o),o.className="visuallyHidden",o.setAttribute("data-l10n-id",i);const u=this.#n._signal;u instanceof AbortSignal&&!u.aborted&&(a.addEventListener("contextmenu",In,{signal:u}),a.addEventListener("click",s,{signal:u})),this.#t.append(a)}}function _y(g,t,e){for(const i of e)t.addEventListener(i,g[i].bind(g))}class Ie{static#t=NaN;static#e=null;static#n=NaN;static#i=null;static initializeAndAddPointerId(t){(Ie.#e||=new Set).add(t)}static setPointer(t,e){Ie.#t||=e,Ie.#i??=t}static setTimeStamp(t){Ie.#n=t}static isSamePointerId(t){return Ie.#t===t}static isSamePointerIdOrRemove(t){return Ie.#t===t?!0:(Ie.#e?.delete(t),!1)}static isSamePointerType(t){return Ie.#i===t}static isInitializedAndDifferentPointerType(t){return Ie.#i!==null&&!Ie.isSamePointerType(t)}static isSameTimeStamp(t){return Ie.#n===t}static isUsingMultiplePointers(){return Ie.#e?.size>=1}static clearPointerType(){Ie.#i=null}static clearPointerIds(){Ie.#t=NaN,Ie.#e=null}static clearTimeStamp(){Ie.#n=NaN}}class sA{#t=0;get id(){return`${qo}${this.#t++}`}}class Rf{#t=my();#e=0;#n=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=t;const a=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return oe(this,"_isSVGFittingCanvas",a)}async#i(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let s;if(typeof e=="string"?(i.url=e,s=await $o(e,"blob")):e instanceof File?s=i.file=e:e instanceof Blob&&(s=e),s.type==="image/svg+xml"){const a=Rf._isSVGFittingCanvas,o=new FileReader,u=new Image,h=new Promise((d,f)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,d()},o.onload=async()=>{const p=i.svgUrl=o.result;u.src=await a?`${p}#svgView(preserveAspectRatio(none))`:p},u.onerror=o.onerror=f});o.readAsDataURL(s),await h}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){ae(s),i=null}return this.#n.set(t,i),i&&this.#n.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:s,type:a}=t;return this.#i(`${e}_${i}_${s}_${a}`,t)}async getFromUrl(t){return this.#i(t,t)}async getFromBlob(t,e){const i=await e;return this.#i(t,i)}async getFromId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#n||=new Map;let i=this.#n.get(t);if(i?.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(e.width,e.height);return s.getContext("2d").drawImage(e,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#n.set(t,i),this.#n.set(i.id,i),i}getSvgUrl(t){const e=this.#n.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#n||=new Map;const e=this.#n.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const s=new OffscreenCanvas(i.width,i.height);s.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=s.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class rA{#t=[];#e=!1;#n;#i=-1;constructor(t=128){this.#n=t}add({cmd:t,undo:e,post:i,mustExec:s,type:a=NaN,overwriteIfSameType:o=!1,keepUndo:u=!1}){if(s&&t(),this.#e)return;const h={cmd:t,undo:e,post:i,type:a};if(this.#i===-1){this.#t.length>0&&(this.#t.length=0),this.#i=0,this.#t.push(h);return}if(o&&this.#t[this.#i].type===a){u&&(h.undo=this.#t[this.#i].undo),this.#t[this.#i]=h;return}const d=this.#i+1;d===this.#n?this.#t.splice(0,1):(this.#i=d,d<this.#t.length&&this.#t.splice(d)),this.#t.push(h)}undo(){if(this.#i===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1,this.#i-=1}redo(){if(this.#i<this.#t.length-1){this.#i+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#i];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#i!==-1}hasSomethingToRedo(){return this.#i<this.#t.length-1}cleanType(t){if(this.#i!==-1){for(let e=this.#i;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#i-e),this.#i=e;return}this.#t.length=0,this.#i=-1}}destroy(){this.#t=null}}class tl{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Ti.platform;for(const[i,s,a={}]of t)for(const o of i){const u=o.startsWith("mac+");e&&u?(this.callbacks.set(o.slice(4),{callback:s,options:a}),this.allKeys.add(o.split("+").at(-1))):!e&&!u&&(this.callbacks.set(o,{callback:s,options:a}),this.allKeys.add(o.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:s,options:{bubbles:a=!1,args:o=[],checker:u=null}}=i;u&&!u(t,e)||(s.bind(t,...o,e)(),a||ci(e))}}class Nf{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return Q1(t),oe(this,"_colors",t)}convert(t){const e=Jo(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,s]of this._colors)if(s.every((a,o)=>a===e[o]))return Nf._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?Pt.makeHexColor(...e):t}}class lr{#t=new AbortController;#e=null;#n=null;#i=new Map;#a=new Map;#r=null;#s=null;#o=null;#u=new rA;#l=null;#d=null;#c=null;#f=0;#m=new Set;#g=null;#h=null;#p=new Set;_editorUndoBar=null;#v=!1;#b=!1;#y=!1;#x=null;#E=null;#_=null;#T=null;#A=!1;#S=null;#N=new sA;#D=!1;#R=!1;#z=!1;#k=null;#L=null;#F=null;#B=null;#G=null;#C=le.NONE;#w=new Set;#M=null;#P=null;#H=null;#Y=null;#X=null;#W={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#j=[0,0];#I=null;#V=null;#Q=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=lr.prototype,e=o=>o.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:u})=>{if(u instanceof HTMLInputElement){const{type:h}=u;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return oe(this,"_keyboardManager",new tl([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#V.contains(u)&&!o.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(o,{target:u})=>!(u instanceof HTMLButtonElement)&&o.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-s,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[s,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-s],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,s],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}]]))}constructor(t,e,i,s,a,o,u,h,d,f,p,v,A,C,w,b){const _=this._signal=this.#t.signal;this.#V=t,this.#Q=e,this.#J=i,this.#r=s,this.#l=a,this.#P=o,this.#X=h,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:_}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:_}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:_}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:_}),u._on("setpreference",this.onSetPreference.bind(this),{signal:_}),u._on("switchannotationeditorparams",x=>this.updateParams(x.type,x.value),{signal:_}),window.addEventListener("pointerdown",()=>{this.#R=!0},{capture:!0,signal:_}),window.addEventListener("pointerup",()=>{this.#R=!1},{capture:!0,signal:_}),this.#at(),this.#dt(),this.#et(),this.#s=h.annotationStorage,this.#x=h.filterFactory,this.#H=d,this.#T=f||null,this.#v=p,this.#b=v,this.#y=A,this.#G=C||null,this.viewParameters={realScale:za.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=w||null,this._supportsPinchToZoom=b!==!1,a?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#a.values())t.destroy();this.#a.clear(),this.#i.clear(),this.#p.clear(),this.#B?.clear(),this.#e=null,this.#w.clear(),this.#u.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#P?.destroy(),this.#S?.hide(),this.#S=null,this.#F?.destroy(),this.#F=null,this.#n=null,this.#E&&(clearTimeout(this.#E),this.#E=null),this.#I&&(clearTimeout(this.#I),this.#I=null),this._editorUndoBar?.destroy(),this.#X=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#b}get useNewAltTextWhenAddingImage(){return this.#y}get hcmFilter(){return oe(this,"hcmFilter",this.#H?this.#x.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return oe(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return oe(this,"_highlightColors",this.#T?new Map(this.#T.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return oe(this,"highlightColors",null);const e=new Map,i=!!this.#H;for(const[s,a]of t){const o=s.endsWith("_HCM");if(i&&o){e.set(s.replace("_HCM",""),a);continue}!i&&!o&&e.set(s,a)}return oe(this,"highlightColors",e)}get highlightColorNames(){return oe(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#c=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,s){this.#l?.showDialog(this,t,e,i,s)}selectComment(t,e){this.#a.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#a.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),s=a=>{a.pageNumber===t&&(this._eventBus._off("editorsrendered",s),e())};this._eventBus.on("editorsrendered",s),await i}getSignature(t){this.#P?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#P}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#y=e)}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const i of this.#a.values()){const{x:s,y:a,width:o,height:u}=i.div.getBoundingClientRect();if(t>=s&&t<=s+o&&e>=a&&e<=a+u)return i}return null}disableUserSelect(t=!1){this.#Q.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*za.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#c?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#$({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#a.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:s,anchorOffset:a,focusNode:o,focusOffset:u}=i,h=i.toString(),f=this.#$(i).closest(".textLayer"),p=this.getSelectionBoxes(f);if(!p)return;i.empty();const v=this.#tt(f),A=this.#C===le.NONE,C=()=>{const w=v?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:p,anchorNode:s,anchorOffset:a,focusNode:o,focusOffset:u,text:h});A&&this.showAllEditors("highlight",!0,!0),e&&w?.editComment()};if(A){this.switchToMode(le.HIGHLIGHT,C);return}C()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#$(t).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(this.#S||=new nA(this),this.#S.show(i,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#s)return null;const e=`${qo}${t}`,i=this.#s.getRawValue(e);return i&&this.#s.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#s&&!this.#s.has(t.id)&&this.#s.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#rt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#M&&(this.#S?.hide(),this.#M=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#M)return;const s=this.#$(t).closest(".textLayer");if(!s){this.#M&&(this.#S?.hide(),this.#M=null,this.#O({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#M=e,this.#O({hasSelectedText:!0}),!(this.#C!==le.HIGHLIGHT&&this.#C!==le.NONE)&&(this.#C===le.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#A=this.isShiftKeyDown,!this.isShiftKeyDown)){const a=this.#C===le.HIGHLIGHT?this.#tt(s):null;if(a?.toggleDrawing(),this.#R){const o=new AbortController,u=this.combinedSignal(o),h=d=>{d.type==="pointerup"&&d.button!==0||(o.abort(),a?.toggleDrawing(!0),d.type==="pointerup"&&this.#Z("main_toolbar"))};window.addEventListener("pointerup",h,{signal:u}),window.addEventListener("blur",h,{signal:u})}else a?.toggleDrawing(!0),this.#Z("main_toolbar")}}#Z(t=""){this.#C===le.HIGHLIGHT?this.highlightSelection(t):this.#v&&this.#st()}#at(){document.addEventListener("selectionchange",this.#rt.bind(this),{signal:this._signal})}#ot(){if(this.#_)return;this.#_=new AbortController;const t=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#Z("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#w)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ut(){this.#k?.abort(),this.#k=null}#ht(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ct(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ut(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#h)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#w){const s=i.serialize(!0);s&&e.push(s)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const a of e.items)for(const o of this.#h)if(o.isHandlingMimeForPasting(a.type)){o.paste(a,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(a){ae(`paste: "${a.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const a=[];for(const h of i){const d=await s.deserialize(h);if(!d)return;a.push(d)}const o=()=>{for(const h of a)this.#it(h);this.#nt(a)},u=()=>{for(const h of a)h.remove()};this.addCommands({cmd:o,undo:u,mustExec:!0})}catch(a){ae(`paste: "${a.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==le.NONE&&!this.isEditorHandlingKeyboard&&lr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#A&&(this.#A=!1,this.#Z("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([i,s])=>this.#W[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#W,t)}),this.#C===le.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#q([[Se.HIGHLIGHT_FREE,!0]]))}#q(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ht(),this.#O({isEditing:this.#C!==le.NONE,isEmpty:this.#K(),hasSomethingToUndo:this.#u.hasSomethingToUndo(),hasSomethingToRedo:this.#u.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ct(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#h){this.#h=t;for(const e of this.#h)this.#q(e.defaultPropertiesToUpdate)}}getId(){return this.#N.id}get currentLayer(){return this.#a.get(this.#f)}getLayer(t){return this.#a.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#a.set(t.pageIndex,t),this.#D?t.enable():t.disable()}removeLayer(t){this.#a.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,s=!1,a=!1,o=!1){if(this.#C!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#c?.commitOrRemove(),this.#C===le.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#C=t,t===le.NONE){this.setEditingState(!1),this.#pt();for(const u of this.#i.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const u of this.#i.values())u.addStandaloneCommentButton();t===le.SIGNATURE&&await this.#P?.loadSignatures(),i&&Ie.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#a.values())u.updateMode(t);if(t===le.POPUP){this.#n||=await this.#X.getAnnotationsByType(new Set(this.#h.map(d=>d._editorType)));const u=new Set,h=[];for(const d of this.#i.values()){const{annotationElementId:f,hasComment:p,deleted:v}=d;f&&u.add(f),p&&!v&&h.push(d.getData())}for(const d of this.#n){const{id:f,popupRef:p,contentsObj:v}=d;p&&v?.str&&!u.has(f)&&!this.#m.has(f)&&h.push(d)}this.#l?.showSidebar(h)}if(!e){s&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const u of this.#i.values())u.uid===e?(this.setSelected(u),o?u.editComment():a?u.enterInEditMode():u.focus()):u.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#h){switch(t){case Se.CREATE:this.currentLayer.addNewEditor(e);return;case Se.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#Y||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#w)i.updateParams(t,e);else for(const i of this.#h)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const a of this.#i.values())a.editorType===t&&a.show(e);(this.#Y?.get(Se.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#q([[Se.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#z!==t){this.#z=t;for(const e of this.#a.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#D){this.#D=!0;const t=[];for(const e of this.#a.values())t.push(e.enable());await Promise.all(t);for(const e of this.#i.values())e.enable()}}#pt(){if(this.unselectAll(),this.#D){this.#D=!1;for(const t of this.#a.values())t.disable();for(const t of this.#i.values())t.disable()}}*getEditors(t){for(const e of this.#i.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#i.get(t)}addEditor(t){this.#i.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#E&&clearTimeout(this.#E),this.#E=setTimeout(()=>{this.focusMainContainer(),this.#E=null},0)),this.#i.delete(t.id),t.annotationElementId&&this.#B?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#m.has(t.annotationElementId))&&this.#s?.remove(t.id)}addDeletedAnnotationElement(t){this.#m.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#m.has(t)}removeDeletedAnnotationElement(t){this.#m.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#it(t){const e=this.#a.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#q(t.propertiesToUpdate))}get#gt(){let t=null;for(t of this.#w);return t}updateUI(t){this.#gt===t&&this.#q(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#q(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#w.has(t)){this.#w.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#w.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#c?.commitOrRemove();for(const e of this.#w)e!==t&&e.unselect();this.#w.clear(),this.#w.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#w.has(t)}get firstSelectedEditor(){return this.#w.values().next().value}unselect(t){t.unselect(),this.#w.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#w.size!==0}get isEnterHandled(){return this.#w.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#u.undo(),this.#O({hasSomethingToUndo:this.#u.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#K()}),this._editorUndoBar?.hide()}redo(){this.#u.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#u.hasSomethingToRedo(),isEmpty:this.#K()})}addCommands(t){this.#u.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#K()})}cleanUndoStack(t){this.#u.cleanType(t)}#K(){if(this.#i.size===0)return!0;if(this.#i.size===1)for(const t of this.#i.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#w],i=()=>{this._editorUndoBar?.show(s,e.length===1?e[0].editorType:e.length);for(const a of e)a.remove()},s=()=>{for(const a of e)this.#it(a)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#nt(t){for(const e of this.#w)e.unselect();this.#w.clear();for(const e of t)e.isEmpty()||(this.#w.add(e),e.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#w)t.commit();this.#nt(this.#i.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#C!==le.NONE))&&!this.#c?.commitOrRemove()&&this.hasSelection){for(const t of this.#w)t.unselect();this.#w.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#j[0]+=t,this.#j[1]+=e;const[s,a]=this.#j,o=[...this.#w],u=1e3;this.#I&&clearTimeout(this.#I),this.#I=setTimeout(()=>{this.#I=null,this.#j[0]=this.#j[1]=0,this.addCommands({cmd:()=>{for(const h of o)this.#i.has(h.id)&&(h.translateInPage(s,a),h.translationDone())},undo:()=>{for(const h of o)this.#i.has(h.id)&&(h.translateInPage(-s,-a),h.translationDone())},mustExec:!1})},u);for(const h of o)h.translateInPage(t,e),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#g=new Map;for(const t of this.#w)this.#g.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#g)return!1;this.disableUserSelect(!1);const t=this.#g;this.#g=null;let e=!1;for(const[{x:s,y:a,pageIndex:o},u]of t)u.newX=s,u.newY=a,u.newPageIndex=o,e||=s!==u.savedX||a!==u.savedY||o!==u.savedPageIndex;if(!e)return!1;const i=(s,a,o,u)=>{if(this.#i.has(s.id)){const h=this.#a.get(u);h?s._setParentAndPosition(h,a,o):(s.pageIndex=u,s.x=a,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:a,newY:o,newPageIndex:u}]of t)i(s,a,o,u)},undo:()=>{for(const[s,{savedX:a,savedY:o,savedPageIndex:u}]of t)i(s,a,o,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#g)for(const i of this.#g.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#w.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#C}isEditingMode(){return this.#C!==le.NONE}get imageManager(){return oe(this,"imageManager",new Rf)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let d=0,f=e.rangeCount;d<f;d++)if(!t.contains(e.getRangeAt(d).commonAncestorContainer))return null;const{x:i,y:s,width:a,height:o}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(d,f,p,v)=>({x:(f-s)/o,y:1-(d+p-i)/a,width:v/o,height:p/a});break;case"180":u=(d,f,p,v)=>({x:1-(d+p-i)/a,y:1-(f+v-s)/o,width:p/a,height:v/o});break;case"270":u=(d,f,p,v)=>({x:1-(f+v-s)/o,y:(d-i)/a,width:v/o,height:p/a});break;default:u=(d,f,p,v)=>({x:(d-i)/a,y:(f-s)/o,width:p/a,height:v/o});break}const h=[];for(let d=0,f=e.rangeCount;d<f;d++){const p=e.getRangeAt(d);if(!p.collapsed)for(const{x:v,y:A,width:C,height:w}of p.getClientRects())C===0||w===0||h.push(u(v,A,C,w))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#s.getRawValue(e);i&&(this.#C===le.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const s=this.#B?.get(t);s&&(s.setCanvas(e,i),this.#B.delete(t))}addMissingCanvas(t,e){(this.#B||=new Map).set(t,e)}}class ss{#t=null;#e=!1;#n=null;#i=null;#a=null;#r=null;#s=!1;#o=null;#u=null;#l=null;#d=null;#c=!1;static#f=null;static _l10n=null;constructor(t){this.#u=t,this.#c=t._uiManager.useNewAltTextFlow,ss.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){ss._l10n??=t}async render(){const t=this.#n=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#i=document.createElement("span");t.append(e),this.#c?(t.classList.add("new"),t.setAttribute("data-l10n-id",ss.#f.missing),e.setAttribute("data-l10n-id",ss.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#u._uiManager._signal;t.addEventListener("contextmenu",In,{signal:i}),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const s=a=>{a.preventDefault(),this.#u._uiManager.editAltText(this.#u),this.#c&&this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#s=!0,s(a))},{signal:i}),await this.#g(),t}get#m(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#s}),this.#s=!1)}isEmpty(){return this.#c?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#c?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await ss._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#g())}toggleAltTextBadge(t=!1){if(!this.#c||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#u.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:s,cancel:a=!1}){i&&(this.#l=i,this.#d=s),!(this.#t===t&&this.#e===e)&&(a||(this.#t=t,this.#e=e),this.#g())}toggle(t=!1){this.#n&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#n.disabled=!t)}shown(){this.#u._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#n?.remove(),this.#n=null,this.#i=null,this.#a=null,this.#o?.remove(),this.#o=null}async#g(){const t=this.#n;if(!t)return;if(this.#c){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",ss.#f[this.#m]),this.#i?.setAttribute("data-l10n-id",ss.#f[`${this.#m}-label`]),!this.#t){this.#a?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#a?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#a;if(!e){this.#a=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#u.id}`;const s=100,a=this.#u._uiManager._signal;a.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#a.classList.add("show"),this.#u._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:a}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#a?.classList.remove("show")},{signal:a})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#u.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class fu{#t=null;#e=null;#n=!1;#i=null;#a=null;#r=null;#s=null;#o=null;#u=!1;#l=null;constructor(t){this.#i=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#i.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#i._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const s=this.#i.commentButtonColor;s&&(i.backgroundColor=s)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#i.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#i._uiManager.updatePopupColor(this.#i)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#i.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:s,y:a,width:o,height:u}=this.#i.parent.boundingClientRect;return[(t-s)/o,(e+i-a)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#i._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#i._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#i._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",In,{signal:i}),e&&(t.addEventListener("focusin",a=>{this.#i._focusEventsAllowed=!1,ci(a)},{capture:!0,signal:i}),t.addEventListener("focusout",a=>{this.#i._focusEventsAllowed=!0,ci(a)},{capture:!0,signal:i})),t.addEventListener("pointerdown",a=>a.stopPropagation(),{signal:i});const s=a=>{a.preventDefault(),t===this.#e?this.edit():this.#i.toggleComment(!0)};return t.addEventListener("click",s,{capture:!0,signal:i}),t.addEventListener("keydown",a=>{a.target===t&&a.key==="Enter"&&(this.#n=!0,s(a))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#i.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#i.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,s;if(e)[i,s]=e;else{[i,s]=this.#i.commentButtonPosition;const{width:f,height:p,x:v,y:A}=this.#i;i=v+i*f,s=A+s*p}const a=this.#i.parent.boundingClientRect,{x:o,y:u,width:h,height:d}=a;this.#i._uiManager.editComment(this.#i,o+i*h,u+s*d,{...t,parentDimensions:a})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#u||this.#s===""}isEmpty(){return this.#s===null}hasBeenEdited(){return this.isDeleted()||this.#s!==this.#a}serialize(){return this.data}get data(){return{text:this.#s,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#s&&(this.#r=null),t===null){this.#s="",this.#u=!0;return}this.#s=t,this.#o=new Date,this.#u=!1}setInitialText(t,e=null){this.#a=t,this.data=t,this.#o=null,this.#r=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#s="",this.#r=null,this.#o=null,this.#i=null,this.#n=!1,this.#u=!1}}class Xu{#t;#e=!1;#n=null;#i;#a;#r;#s;#o=null;#u;#l=null;#d;#c=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:a=null,onPinchEnd:o=null,signal:u}){this.#t=t,this.#n=i,this.#i=e,this.#a=s,this.#r=a,this.#s=o,this.#d=new AbortController,this.#u=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#u})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/as.pixelRatio}#f(t){if(this.#i?.())return;if(t.touches.length===1){if(this.#o)return;const s=this.#o=new AbortController,a=AbortSignal.any([this.#u,s.signal]),o=this.#t,u={capture:!0,signal:a,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};o.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(ci(d),h(d))},u),o.addEventListener("pointerup",h,u),o.addEventListener("pointercancel",h,u);return}if(!this.#c){this.#c=new AbortController;const s=AbortSignal.any([this.#u,this.#c.signal]),a=this.#t,o={signal:s,capture:!1,passive:!1};a.addEventListener("touchmove",this.#m.bind(this),o);const u=this.#g.bind(this);a.addEventListener("touchend",u,o),a.addEventListener("touchcancel",u,o),o.capture=!0,a.addEventListener("pointerdown",ci,o),a.addEventListener("pointermove",ci,o),a.addEventListener("pointercancel",ci,o),a.addEventListener("pointerup",ci,o),this.#a?.()}if(ci(t),t.touches.length!==2||this.#n?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#m(t){if(!this.#l||t.touches.length!==2)return;ci(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:s,screenY:a}=e,{screenX:o,screenY:u}=i,h=this.#l,{touch0X:d,touch0Y:f,touch1X:p,touch1Y:v}=h,A=p-d,C=v-f,w=o-s,b=u-a,_=Math.hypot(w,b)||1,x=Math.hypot(A,C)||1;if(!this.#e&&Math.abs(x-_)<=Xu.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=a,h.touch1X=o,h.touch1Y=u,!this.#e){this.#e=!0;return}const D=[(s+o)/2,(a+u)/2];this.#r?.(D,x,_)}#g(t){t.touches.length>=2||(this.#c&&(this.#c.abort(),this.#c=null,this.#s?.()),this.#l&&(ci(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Xt{#t=null;#e=null;#n=null;#i=null;#a=null;#r=!1;#s=null;#o="";#u=null;#l=null;#d=null;#c=null;#f=null;#m="";#g=!1;#h=null;#p=!1;#v=!1;#b=!1;#y=null;#x=0;#E=0;#_=null;#T=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#A=!1;#S=Xt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Nf;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Xt.prototype._resizeWithKeyboard,e=lr.TRANSLATE_SMALL,i=lr.TRANSLATE_BIG;return oe(this,"_resizerKeyboardManager",new tl([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Xt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:o}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[a,o];const[u,h]=this.parentDimensions;this.x=t.x/u,this.y=t.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return oe(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new aA({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Xt._l10n??=t,Xt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Xt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Xt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){We("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#A}set _isDraggable(t){this.#A=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#I(),this.#c?.remove(),this.#c=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#g?this.#g=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,s){const[a,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(t+i)/a,this.y=(e+s)/o,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,s]=this.parentDimensions;this.setAt(t*i,e*s,this.width*i,this.height*s),this._onTranslated()}#N([t,e],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/t,this.y+=s/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#N(this.parentDimensions,t,e)}translateInPage(t,e){this.#h||=[this.x,this.y,this.width,this.height],this.#N(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#h||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[s,a]}=this;if(this.x+=t/s,this.y+=e/a,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:v}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,v)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:u}=this;const[h,d]=this.getBaseTranslation();o+=h,u+=d;const{style:f}=i;f.left=`${(100*o).toFixed(2)}%`,f.top=`${(100*u).toFixed(2)}%`,this._onTranslating(o,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#h&&(this.#h[0]!==this.x||this.#h[1]!==this.y)}get _hasBeenResized(){return!!this.#h&&(this.#h[2]!==this.width||this.#h[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Xt,s=i/t,a=i/e;switch(this.rotation){case 90:return[-s,a];case 180:return[s,a];case 270:return[s,-a];default:return[-s,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,s]}=this;let{x:a,y:o,width:u,height:h}=this;if(u*=i,h*=s,a*=i,o*=s,this._mustFixPosition)switch(t){case 0:a=$i(a,0,i-u),o=$i(o,0,s-h);break;case 90:a=$i(a,0,i-h),o=$i(o,u,s);break;case 180:a=$i(a,u,i),o=$i(o,h,s);break;case 270:a=$i(a,h,i),o=$i(o,0,s-u);break}this.x=a/=i,this.y=o/=s;const[d,f]=this.getBaseTranslation();a+=d,o+=f,e.left=`${(100*a).toFixed(2)}%`,e.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}static#D(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Xt.#D(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Xt.#D(t,e,360-this.parentRotation)}#R(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#z(){if(this.#u)return;this.#u=document.createElement("div"),this.#u.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const s=document.createElement("div");this.#u.append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",this.#k.bind(this,i),{signal:e}),s.addEventListener("contextmenu",In,{signal:e}),s.tabIndex=-1}this.div.prepend(this.#u)}#k(t,e){e.preventDefault();const{isMac:i}=Ti.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#n?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const a=new AbortController,o=this._uiManager.combinedSignal(a);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#B.bind(this,t),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",ci,{passive:!1,signal:o}),window.addEventListener("contextmenu",In,{signal:o}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const d=()=>{a.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=u,this.div.style.cursor=h,this.#F()};window.addEventListener("pointerup",d,{signal:o}),window.addEventListener("blur",d,{signal:o})}#L(t,e,i,s){this.width=i,this.height=s,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:s}=this.#d;this.#d=null;const a=this.x,o=this.y,u=this.width,h=this.height;a===t&&o===e&&u===i&&h===s||this.addCommands({cmd:this.#L.bind(this,a,o,u,h),undo:this.#L.bind(this,t,e,i,s),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#B(t,e){const[i,s]=this.parentDimensions,a=this.x,o=this.y,u=this.width,h=this.height,d=Xt.MIN_SIZE/i,f=Xt.MIN_SIZE/s,p=this.#R(this.rotation),v=(G,W)=>[p[0]*G+p[2]*W,p[1]*G+p[3]*W],A=this.#R(360-this.rotation),C=(G,W)=>[A[0]*G+A[2]*W,A[1]*G+A[3]*W];let w,b,_=!1,x=!1;switch(t){case"topLeft":_=!0,w=(G,W)=>[0,0],b=(G,W)=>[G,W];break;case"topMiddle":w=(G,W)=>[G/2,0],b=(G,W)=>[G/2,W];break;case"topRight":_=!0,w=(G,W)=>[G,0],b=(G,W)=>[0,W];break;case"middleRight":x=!0,w=(G,W)=>[G,W/2],b=(G,W)=>[0,W/2];break;case"bottomRight":_=!0,w=(G,W)=>[G,W],b=(G,W)=>[0,0];break;case"bottomMiddle":w=(G,W)=>[G/2,W],b=(G,W)=>[G/2,0];break;case"bottomLeft":_=!0,w=(G,W)=>[0,W],b=(G,W)=>[G,0];break;case"middleLeft":x=!0,w=(G,W)=>[0,W/2],b=(G,W)=>[G,W/2];break}const D=w(u,h),M=b(u,h);let T=v(...M);const O=Xt._round(a+T[0]),k=Xt._round(o+T[1]);let z=1,B=1,H,V;if(e.fromKeyboard)({deltaX:H,deltaY:V}=e);else{const{screenX:G,screenY:W}=e,[st,bt]=this.#l;[H,V]=this.screenToPageTranslation(G-st,W-bt),this.#l[0]=G,this.#l[1]=W}if([H,V]=C(H/i,V/s),_){const G=Math.hypot(u,h);z=B=Math.max(Math.min(Math.hypot(M[0]-D[0]-H,M[1]-D[1]-V)/G,1/u,1/h),d/u,f/h)}else x?z=$i(Math.abs(M[0]-D[0]-H),d,1)/u:B=$i(Math.abs(M[1]-D[1]-V),f,1)/h;const Z=Xt._round(u*z),rt=Xt._round(h*B);T=v(...b(Z,rt));const ft=O-T[0],mt=k-T[1];this.#h||=[this.x,this.y,this.width,this.height],this.width=Z,this.height=rt,this.x=ft,this.y=mt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#v)return this._editToolbar;this._editToolbar=new jo(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(ss.initialize(Xt._l10n),this.#n=new ss(this),this.#t&&(this.#n.data=this.#t,this.#t=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(t){this.#n&&(this.#n.data=t)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(t){await this.#n?.setGuessedText(t)}serializeAltText(t){return this.#n?.serialize(t)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#i?.focusButton()}addCommentButton(){return this.canAddComment?this.#i||=new fu(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#a){this._uiManager.isEditingMode()&&this.#a.classList.remove("hidden");return}this.hasComment&&(this.#a=this.#i.renderForStandalone(),this.div.append(this.#a))}}removeStandaloneCommentButton(){this.#i.removeStandaloneCommentButton(),this.#a=null}hideStandaloneCommentButton(){this.#a?.classList.add("hidden")}get comment(){const{data:{richText:t,text:e,date:i,deleted:s}}=this.#i;return{text:e,richText:t,date:i,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#i||=new fu(this),this.#i.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#i||=new fu(this),this.#i.setInitialText(t,i),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#i?.hasBeenEdited()}get hasDeletedComment(){return this.#i?.isDeleted()}get hasComment(){return!!this.#i&&!this.#i.isEmpty()&&!this.#i.isDeleted()}async editComment(t){this.#i||=new fu(this),this.#i.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#i.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,s]=t.rect,[a]=this.pageDimensions,[o]=this.pageTranslation,u=o+a+1,h=s-100,d=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,h,d,s]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#i.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#H();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[s,a]=this.getInitialTranslation();return this.translate(s,a),_y(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#T||=new Xu({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#w.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(t,e,i){let a=.7*(i/e)+1-.7;if(a===1)return;const o=this.#R(this.rotation),u=(O,k)=>[o[0]*O+o[2]*k,o[1]*O+o[3]*k],[h,d]=this.parentDimensions,f=this.x,p=this.y,v=this.width,A=this.height,C=Xt.MIN_SIZE/h,w=Xt.MIN_SIZE/d;a=Math.max(Math.min(a,1/v,1/A),C/v,w/A);const b=Xt._round(v*a),_=Xt._round(A*a);if(b===v&&_===A)return;this.#h||=[f,p,v,A];const x=u(v/2,A/2),D=Xt._round(f+x[0]),M=Xt._round(p+x[1]),T=u(b/2,_/2);this.x=D-T[0],this.y=M-T[1],this.width=b,this.height=_,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#w(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=Ti.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#g=!0,this._isDraggable){this.#P(t);return}this.#M(t)}#M(t){const{isMac:e}=Ti.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#P(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,a=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:a},u=d=>{s.abort(),this.#s=null,this.#g=!1,this._uiManager.endDragSession()||this.#M(d),i&&this._onStopDragging()};e&&(this.#x=t.clientX,this.#E=t.clientY,this.#s=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",d=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:f,clientY:p,pointerId:v}=d;if(v!==this.#s){ci(d);return}const[A,C]=this.screenToPageTranslation(f-this.#x,p-this.#E);this.#x=f,this.#E=p,this._uiManager.dragSelectedEditors(A,C)},o),window.addEventListener("touchmove",ci,o),window.addEventListener("pointerdown",d=>{d.pointerType===this.#o&&(this.#T||d.isPrimary)&&u(d),ci(d)},o));const h=d=>{if(!this.#s||this.#s===d.pointerId){u(d);return}ci(d)};window.addEventListener("pointerup",h,{signal:a}),window.addEventListener("blur",h,{signal:a})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#y&&clearTimeout(this.#y),this.#y=setTimeout(()=>{this.#y=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const s=this.parentScale,[a,o]=this.pageDimensions,[u,h]=this.pageTranslation,d=t/s,f=e/s,p=this.x*a,v=this.y*o,A=this.width*a,C=this.height*o;switch(i){case 0:return[p+d+u,o-v-f-C+h,p+d+A+u,o-v-f+h];case 90:return[p+f+u,o-v+d+h,p+f+C+u,o-v+d+A+h];case 180:return[p-d-A+u,o-v+f+h,p-d+u,o-v+f+C+h];case 270:return[p-f-C+u,o-v-d-A+h,p-f+u,o-v-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,s,a,o]=t,u=a-i,h=o-s;switch(this.rotation){case 0:return[i,e-o,u,h];case 90:return[i,e-s,h,u];case 180:return[a,e-s,u,h];case 270:return[a,e-o,h,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Xt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#i?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:s,deleted:a,richText:o},uid:u,pageIndex:h,creationDate:d,modificationDate:f}=this;return{id:u,pageIndex:h,rect:this.getPDFRect(),richText:o,contentsObj:{str:t},creationDate:d,modificationDate:i||f,popupRef:!a,color:e,opacity:s}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#v=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#v=!1,!0):!1}isInEditMode(){return this.#v}shouldGetKeyboardEvents(){return this.#b}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:a,innerWidth:o}=window;return e<o&&s>0&&t<a&&i>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#H()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const s=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});s.rotation=t.rotation,s.#t=t.accessibilityData,s._isCopy=t.isCopy||!1;const[a,o]=s.pageDimensions,[u,h,d,f]=s.getRectInCurrentCoords(t.rect,o);return s.x=u/a,s.y=h/o,s.width=d/a,s.height=f/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#y&&(clearTimeout(this.#y),this.#y=null),this.#I(),this.removeEditToolbar(),this.#_){for(const t of this.#_.values())clearTimeout(t);this.#_=null}this.parent=null,this.#T?.destroy(),this.#T=null,this.#c?.remove(),this.#c=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#z(),this.#u.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,s,a,o]=this.getPDFRect();return[Xt._round(i+(a-i)*t),Xt._round(s+(o-s)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#i.commentPopupPositionInLayer}set commentPopupPosition(t){this.#i.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#i.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#i.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#i?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#u.children;if(!this.#e){this.#e=Array.from(e);const o=this.#Y.bind(this),u=this.#X.bind(this),h=this._uiManager._signal;for(const d of this.#e){const f=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",o,{signal:h}),d.addEventListener("blur",u,{signal:h}),d.addEventListener("focus",this.#W.bind(this,f),{signal:h}),d.setAttribute("data-l10n-id",Xt._l10nResizer[f])}}const i=this.#e[0];let s=0;for(const o of e){if(o===i)break;s++}const a=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(a!==s){if(a<s)for(let u=0;u<s-a;u++)this.#u.append(this.#u.firstElementChild);else if(a>s)for(let u=0;u<a-s;u++)this.#u.firstElementChild.before(this.#u.lastElementChild);let o=0;for(const u of e){const d=this.#e[o++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Xt._l10nResizer[d])}}this.#j(0),this.#b=!0,this.#u.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#Y(t){Xt._resizerKeyboardManager.exec(this,t)}#X(t){this.#b&&t.relatedTarget?.parentNode!==this.#u&&this.#I()}#W(t){this.#m=this.#b?t:""}#j(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#b&&this.#B(this.#m,{deltaX:t,deltaY:e,fromKeyboard:!0})}#I(){this.#b=!1,this.#j(-1),this.#F()}_stopResizingWithKeyboard(){this.#I(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#u?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#_||=new Map;const{action:i}=t;let s=this.#_.get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(t),this.#_.delete(i),this.#_.size===0&&(this.#_=null)},Xt._telemetryTimeout),this.#_.set(i,s);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#c&&!this.deleted){this.#c=t.addFakeAnnotation(this);return}if(this.deleted){this.#c.remove(),this.#c=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#c.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class aA extends Xt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const Zv=3285377520,On=4294901760,is=65535;class wy{constructor(t){this.h1=t?t&4294967295:Zv,this.h2=t?t&4294967295:Zv}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let w=0,b=t.length;w<b;w++){const _=t.charCodeAt(w);_<=255?e[i++]=_:(e[i++]=_>>>8,e[i++]=_&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,a=i-s*4,o=new Uint32Array(e.buffer,0,s);let u=0,h=0,d=this.h1,f=this.h2;const p=3432918353,v=461845907,A=p&is,C=v&is;for(let w=0;w<s;w++)w&1?(u=o[w],u=u*p&On|u*A&is,u=u<<15|u>>>17,u=u*v&On|u*C&is,d^=u,d=d<<13|d>>>19,d=d*5+3864292196):(h=o[w],h=h*p&On|h*A&is,h=h<<15|h>>>17,h=h*v&On|h*C&is,f^=h,f=f<<13|f>>>19,f=f*5+3864292196);switch(u=0,a){case 3:u^=e[s*4+2]<<16;case 2:u^=e[s*4+1]<<8;case 1:u^=e[s*4],u=u*p&On|u*A&is,u=u<<15|u>>>17,u=u*v&On|u*C&is,s&1?d^=u:f^=u}this.h1=d,this.h2=f}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&On|t*36045&is,e=e*4283543511&On|((e<<16|t>>>16)*2950163797&On)>>>16,t^=e>>>1,t=t*444984403&On|t*60499&is,e=e*3301882366&On|((e<<16|t>>>16)*3120437893&On)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const ff=Object.freeze({map:null,hash:"",transfer:void 0});class Of{#t=!1;#e=null;#n=null;#i=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#i.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#i.get(t)}remove(t){const e=this.#i.get(t);if(e!==void 0&&(e instanceof Xt&&this.#n.delete(e.annotationElementId),this.#i.delete(t),this.#i.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#i.values())if(i instanceof Xt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#i.get(t);let s=!1;if(i!==void 0)for(const[a,o]of Object.entries(e))i[a]!==o&&(s=!0,i[a]=o);else s=!0,this.#i.set(t,e);s&&this.#a(),e instanceof Xt&&((this.#n||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#i.has(t)}get size(){return this.#i.size}#a(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Ey(this)}get serializable(){if(this.#i.size===0)return ff;const t=new Map,e=new wy,i=[],s=Object.create(null);let a=!1;for(const[o,u]of this.#i){const h=u instanceof Xt?u.serialize(!1,s):u;h&&(t.set(o,h),e.update(`${o}:${JSON.stringify(h)}`),a||=!!h.bitmap)}if(a)for(const o of t.values())o.bitmap&&i.push(o.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:ff}get editorStats(){let t=null;const e=new Map;let i=0,s=0;for(const a of this.#i.values()){if(!(a instanceof Xt)){a.popup&&(a.popup.deleted?s+=1:i+=1);continue}a.isCommentDeleted?s+=1:a.hasEditedComment&&(i+=1);const o=a.telemetryFinalData;if(!o)continue;const{type:u}=o;e.has(u)||e.set(u,Object.getPrototypeOf(a).constructor),t||=Object.create(null);const h=t[u]||=new Map;for(const[d,f]of Object.entries(o)){if(d==="type")continue;let p=h.get(d);p||(p=new Map,h.set(d,p));const v=p.get(f)??0;p.set(f,v+1)}}if((s>0||i>0)&&(t||=Object.create(null),t.comments={deleted:s,edited:i}),!t)return null;for(const[a,o]of e)t[a]=o.computeTelemetryFinalData(t[a]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#n?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#n?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#n)for(const e of this.#n.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#i.entries()}}class Ey extends Of{#t;constructor(t){super();const{map:e,hash:i,transfer:s}=t.serializable,a=structuredClone(e,s?{transfer:s}:null);this.#t={map:a,hash:i,transfer:s}}get print(){We("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return oe(this,"modifiedIds",{ids:new Set,hash:""})}}class oA{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(xe(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:a,style:o}=t,u=new FontFace(s,a,o);this.addNativeFontFace(u);try{await u.load(),this.#t.add(s),i?.(t)}catch{ae(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}We("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw ae(`Failed to load font '${i.family}': '${s}'.`),t.disableFontFace=!0,s}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,s)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return oe(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return oe(this,"isSyncFontLoadingSupported",Ki||Ti.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(xe(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const a=i.shift();setTimeout(a.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:e,callback:t};return i.push(s),s}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return oe(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(M,T){return M.charCodeAt(T)<<24|M.charCodeAt(T+1)<<16|M.charCodeAt(T+2)<<8|M.charCodeAt(T+3)&255}function s(M,T,O,k){const z=M.substring(0,T),B=M.substring(T+O);return z+k+B}let a,o;const u=this._document.createElement("canvas");u.width=1,u.height=1;const h=u.getContext("2d");let d=0;function f(M,T){if(++d>30){ae("Load test font never loaded."),T();return}if(h.font="30px "+M,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){T();return}setTimeout(f.bind(null,M,T))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let v=this._loadTestFont;v=s(v,976,p.length,p);const C=16,w=1482184792;let b=i(v,C);for(a=0,o=p.length-3;a<o;a+=4)b=b-w+i(p,a)|0;a<p.length&&(b=b-w+i(p+"XXX",a)|0),v=s(v,C,4,H1(b));const _=`url(data:font/opentype;base64,${btoa(v)});`,x=`@font-face {font-family:"${p}";src:${_}}`;this.insertRule(x);const D=this._document.createElement("div");D.style.visibility="hidden",D.style.width=D.style.height="10px",D.style.position="absolute",D.style.top=D.style.left="0px";for(const M of[t.loadedName,p]){const T=this._document.createElement("span");T.textContent="Hi",T.style.fontFamily=M,D.append(T)}this._document.body.append(D),f(p,()=>{D.remove(),e.complete()})}}class lA{#t;constructor(t,e=null,i,s){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${vy(this.data)});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let s;try{s=t.get(i)}catch(o){ae(`getPathGenerator - ignoring character: "${o}".`)}const a=Ay(s?.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=a}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){oe(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){oe(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class Oa{#t;#e;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let s=0;for(const d of Oa.strings){const f=e.encode(t[d]);i[d]=f,s+=4+f.length}const a=new ArrayBuffer(s),o=new Uint8Array(a),u=new DataView(a);let h=0;for(const d of Oa.strings){const f=i[d],p=f.length;u.setUint32(h,p),o.set(f,h+4),h+=4+p}return xe(h===a.byteLength,"CssFontInfo.write: Buffer overflow"),a}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}#i(t){xe(t<Oa.strings.length,"Invalid string index");let e=0;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#n.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#i(0)}get fontWeight(){return this.#i(1)}get italicAngle(){return this.#i(2)}}class ka{#t;#e;#n;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let s=0;for(const v of ka.strings){const A=e.encode(t[v]);i[v]=A,s+=4+A.length}s+=4;let a,o,u=1+s;t.style&&(a=e.encode(t.style.style),o=e.encode(t.style.weight),u+=4+a.length+4+o.length);const h=new ArrayBuffer(u),d=new Uint8Array(h),f=new DataView(h);let p=0;f.setUint8(p++,t.guessFallback?1:0),f.setUint32(p,0),p+=4,s=0;for(const v of ka.strings){const A=i[v],C=A.length;s+=4+C,f.setUint32(p,C),d.set(A,p+4),p+=4+C}return f.setUint32(p-s-4,s),t.style&&(f.setUint32(p,a.length),d.set(a,p+4),p+=4+a.length,f.setUint32(p,o.length),d.set(o,p+4),p+=4+o.length),xe(p<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(p)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#n=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#i(t){xe(t<ka.strings.length,"Invalid string index");let e=5;for(let s=0;s<t;s++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#n.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#i(0)}get loadedName(){return this.#i(1)}get baseFontName(){return this.#i(2)}get src(){return this.#i(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#n.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const s=this.#e.getUint32(t),a=this.#n.decode(new Uint8Array(this.#t,t+4,s));return{style:i,weight:a}}}class Ge{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#n=this.#e+1+8;static#i=this.#n+1+48;static#a=this.#i+1+6;#r;#s;#o;constructor({data:t,extra:e}){this.#r=t,this.#s=new TextDecoder,this.#o=new DataView(this.#r),e&&Object.assign(this,e)}#u(t){xe(t<Ge.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,s=this.#o.getUint8(e)>>i&3;return s===0?void 0:s===2}get black(){return this.#u(0)}get bold(){return this.#u(1)}get disableFontFace(){return this.#u(2)}get fontExtraProperties(){return this.#u(3)}get isInvalidPDFjsFont(){return this.#u(4)}get isType3Font(){return this.#u(5)}get italic(){return this.#u(6)}get missingFile(){return this.#u(7)}get remeasure(){return this.#u(8)}get vertical(){return this.#u(9)}#l(t){return xe(t<Ge.numbers.length,"Invalid number index"),this.#o.getFloat64(Ge.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Ge.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<4;s++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Ge.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<6;s++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Ge.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let s=0;s<3;s++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){xe(t<Ge.strings.length,"Invalid string index");let e=Ge.#a+4;for(let a=0;a<t;a++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),s=new Uint8Array(i);return s.set(new Uint8Array(this.#r,e+4,i)),this.#s.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ge.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);if(a!==0)return new Uint8Array(this.#r,t+4,a)}clearData(){let t=Ge.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);t+=4+s;const a=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,a).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Ge.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const s=this.#o.getUint32(t);if(s===0)return null;const a=new Uint8Array(s);return a.set(new Uint8Array(this.#r,t+4,s)),new Oa(a.buffer)}get systemFontInfo(){let t=Ge.#a;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const s=new Uint8Array(i);return s.set(new Uint8Array(this.#r,t+4,i)),new ka(s.buffer)}static write(t){const e=t.systemFontInfo?ka.write(t.systemFontInfo):null,i=t.cssFontInfo?Oa.write(t.cssFontInfo):null,s=new TextEncoder,a={};let o=0;for(const w of Ge.strings)a[w]=s.encode(t[w]),o+=4+a[w].length;const u=Ge.#a+4+o+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),h=new ArrayBuffer(u),d=new Uint8Array(h),f=new DataView(h);let p=0;const v=Ge.bools.length;let A=0,C=0;for(let w=0;w<v;w++){const b=t[Ge.bools[w]];A|=(b===void 0?0:b?2:1)<<C,C+=2,(C===8||w===v-1)&&(f.setUint8(p++,A),A=0,C=0)}xe(p===Ge.#t,"FontInfo.write: Boolean properties offset mismatch");for(const w of Ge.numbers)f.setFloat64(p,t[w]),p+=8;if(xe(p===Ge.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){f.setUint8(p++,4);for(const w of t.bbox)f.setInt16(p,w,!0),p+=2}else f.setUint8(p++,0),p+=8;if(xe(p===Ge.#n,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){f.setUint8(p++,6);for(const w of t.fontMatrix)f.setFloat64(p,w,!0),p+=8}else f.setUint8(p++,0),p+=48;if(xe(p===Ge.#i,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){f.setUint8(p++,1);for(const w of t.defaultVMetrics)f.setInt16(p,w,!0),p+=2}else f.setUint8(p++,0),p+=6;xe(p===Ge.#a,"FontInfo.write: DefaultVMetrics properties offset mismatch"),f.setUint32(Ge.#a,0),p+=4;for(const w of Ge.strings){const b=a[w],_=b.length;f.setUint32(p,_),d.set(b,p+4),p+=4+_}if(f.setUint32(Ge.#a,p-Ge.#a-4),!e)f.setUint32(p,0),p+=4;else{const w=e.byteLength;f.setUint32(p,w),xe(p+4+w<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(e),p+4),p+=4+w}if(!i)f.setUint32(p,0),p+=4;else{const w=i.byteLength;f.setUint32(p,w),xe(p+4+w<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(i),p+4),p+=4+w}return t.data===void 0?(f.setUint32(p,0),p+=4):(f.setUint32(p,t.data.length),d.set(t.data,p+4),p+=4+t.data.length),xe(p<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(p)}}class Ni{static#t=0;static#e=1;static#n=2;static#i=3;static#a=4;static#r=8;static#s=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,s=[],a=[],o=[],u=[],h=null,d=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],o=t[3],e===1?s.push(...t[4],...t[5]):s.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,h=t[1],s=t[2],a=t[3],u=t[4]||[],i=t[6],d=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const f=Math.floor(s.length/2),p=Math.floor(a.length/3),v=o.length,A=u.length;let C=0;for(const T of u)C+=1,C=Math.ceil(C/4)*4,C+=4+T.coords.length*4,C+=4+T.colors.length*4,T.verticesPerRow!==void 0&&(C+=4);const w=20+f*8+p*3+v*8+(i?16:0)+(d?3:0)+C,b=new ArrayBuffer(w),_=new DataView(b),x=new Uint8Array(b);_.setUint8(Ni.#t,e),_.setUint8(Ni.#e,i?1:0),_.setUint8(Ni.#n,d?1:0),_.setUint8(Ni.#i,h),_.setUint32(Ni.#a,f,!0),_.setUint32(Ni.#r,p,!0),_.setUint32(Ni.#s,v,!0),_.setUint32(Ni.#o,A,!0);let D=20;new Float32Array(b,D,f*2).set(s),D+=f*8,x.set(a,D),D+=p*3;for(const[T,O]of o)_.setFloat32(D,T,!0),D+=4,_.setUint32(D,parseInt(O.slice(1),16),!0),D+=4;if(i)for(const T of i)_.setFloat32(D,T,!0),D+=4;d&&(x.set(d,D),D+=3);for(let T=0;T<u.length;T++){const O=u[T];_.setUint8(D,O.type),D+=1,D=Math.ceil(D/4)*4,_.setUint32(D,O.coords.length,!0),D+=4,new Int32Array(b,D,O.coords.length).set(O.coords),D+=O.coords.length*4,_.setUint32(D,O.colors.length,!0),D+=4,new Int32Array(b,D,O.colors.length).set(O.colors),D+=O.colors.length*4,O.verticesPerRow!==void 0&&(_.setUint32(D,O.verticesPerRow,!0),D+=4)}return b}getIR(){const t=this.view,e=this.data[Ni.#t],i=!!this.data[Ni.#e],s=!!this.data[Ni.#n],a=t.getUint32(Ni.#a,!0),o=t.getUint32(Ni.#r,!0),u=t.getUint32(Ni.#s,!0),h=t.getUint32(Ni.#o,!0);let d=20;const f=new Float32Array(this.buffer,d,a*2);d+=a*8;const p=new Uint8Array(this.buffer,d,o*3);d+=o*3;const v=[];for(let b=0;b<u;++b){const _=t.getFloat32(d,!0);d+=4;const x=t.getUint32(d,!0);d+=4,v.push([_,`#${x.toString(16).padStart(6,"0")}`])}let A=null;if(i){A=[];for(let b=0;b<4;++b)A.push(t.getFloat32(d,!0)),d+=4}let C=null;s&&(C=new Uint8Array(this.buffer,d,3),d+=3);const w=[];for(let b=0;b<h;++b){const _=t.getUint8(d);d+=1,d=Math.ceil(d/4)*4;const x=t.getUint32(d,!0);d+=4;const D=new Int32Array(this.buffer,d,x);d+=x*4;const M=t.getUint32(d,!0);d+=4;const T=new Int32Array(this.buffer,d,M);d+=M*4;const O={type:_,coords:D,colors:T};_===lf.LATTICE&&(O.verticesPerRow=t.getUint32(d,!0),d+=4),w.push(O)}if(e===1)return["RadialAxial","axial",A,v,Array.from(f.slice(0,2)),Array.from(f.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",A,v,[f[0],f[1]],[f[3],f[4]],f[2],f[5]];if(e===3){const b=this.data[Ni.#i];let _=null;if(f.length>0){let x=f[0],D=f[0],M=f[1],T=f[1];for(let O=0;O<f.length;O+=2){const k=f[O],z=f[O+1];x=x>k?k:x,M=M>z?z:M,D=D<k?k:D,T=T<z?z:T}_=[x,M,D,T]}return["Mesh",b,f,p,w,_,A,C]}throw new Error(`Unsupported pattern kind: ${e}`)}}class uA{static write(t){let e,i;return Ti.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}#t;constructor(t){this.#t=t}get path(){return Ti.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function hA(g){if(g instanceof URL)return g.href;if(typeof g=="string"){if(Ki)return g;const t=URL.parse(g,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function cA(g){if(Ki&&typeof Buffer<"u"&&g instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(g instanceof Uint8Array&&g.byteLength===g.buffer.byteLength)return g;if(typeof g=="string")return Ko(g);if(g instanceof ArrayBuffer||ArrayBuffer.isView(g)||typeof g=="object"&&!isNaN(g?.length))return new Uint8Array(g);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function pu(g){if(typeof g!="string")return null;if(g.endsWith("/"))return g;throw new Error(`Invalid factory url: "${g}" must include trailing slash.`)}const pf=g=>typeof g=="object"&&Number.isInteger(g?.num)&&g.num>=0&&Number.isInteger(g?.gen)&&g.gen>=0,dA=g=>typeof g=="object"&&typeof g?.name=="string",fA=X1.bind(null,pf,dA);class pA{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[s]of this.#t)s.call(this,i)})}addEventListener(t,e,i=null){let s=null;if(i?.signal instanceof AbortSignal){const{signal:a}=i;if(a.aborted){ae("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(t,e);s=()=>a.removeEventListener("abort",o),a.addEventListener("abort",o)}this.#t.set(e,s)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const gu={DATA:1,ERROR:2},Ei={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function Kv(){}function un(g){if(g instanceof or||g instanceof uf||g instanceof jv||g instanceof Nu||g instanceof hd)return g;switch(g instanceof Error||typeof g=="object"&&g!==null||We('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),g.name){case"AbortException":return new or(g.message);case"InvalidPDFException":return new uf(g.message);case"PasswordException":return new jv(g.message,g.code);case"ResponseException":return new Nu(g.message,g.status,g.missing);case"UnknownErrorException":return new hd(g.message,g.details)}return new hd(g.message,g.toString())}class Uo{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#i(t);return}if(t.callback){const i=t.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===gu.DATA)s.resolve(t.data);else if(t.callback===gu.ERROR)s.reject(un(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,s=t.sourceName,a=this.comObj;Promise.try(e,t.data).then(function(o){a.postMessage({sourceName:i,targetName:s,callback:gu.DATA,callbackId:t.callbackId,data:o})},function(o){a.postMessage({sourceName:i,targetName:s,callback:gu.ERROR,callbackId:t.callbackId,reason:un(o)})});return}if(t.streamId){this.#n(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const s=this.callbackId++,a=Promise.withResolvers();this.callbackCapabilities[s]=a;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:s,data:e},i)}catch(o){a.reject(o)}return a.promise}sendWithStream(t,e,i,s){const a=this.streamId++,o=this.sourceName,u=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const f=Promise.withResolvers();return this.streamControllers[a]={controller:d,startCall:f,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:o,targetName:u,action:t,streamId:a,data:e,desiredSize:d.desiredSize},s),f.promise},pull:d=>{const f=Promise.withResolvers();return this.streamControllers[a].pullCall=f,h.postMessage({sourceName:o,targetName:u,stream:Ei.PULL,streamId:a,desiredSize:d.desiredSize}),f.promise},cancel:d=>{xe(d instanceof Error,"cancel must have a valid reason");const f=Promise.withResolvers();return this.streamControllers[a].cancelCall=f,this.streamControllers[a].isClosed=!0,h.postMessage({sourceName:o,targetName:u,stream:Ei.CANCEL,streamId:a,reason:un(d)}),f.promise}},i)}#n(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,a=this.comObj,o=this,u=this.actionHandler[t.action],h={enqueue(d,f=1,p){if(this.isCancelled)return;const v=this.desiredSize;this.desiredSize-=f,v>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),a.postMessage({sourceName:i,targetName:s,stream:Ei.ENQUEUE,streamId:e,chunk:d},p)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:s,stream:Ei.CLOSE,streamId:e}),delete o.streamSinks[e])},error(d){xe(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,a.postMessage({sourceName:i,targetName:s,stream:Ei.ERROR,streamId:e,reason:un(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[e]=h,Promise.try(u,t.data,h).then(function(){a.postMessage({sourceName:i,targetName:s,stream:Ei.START_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:i,targetName:s,stream:Ei.START_COMPLETE,streamId:e,reason:un(d)})})}#i(t){const e=t.streamId,i=this.sourceName,s=t.sourceName,a=this.comObj,o=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case Ei.START_COMPLETE:t.success?o.startCall.resolve():o.startCall.reject(un(t.reason));break;case Ei.PULL_COMPLETE:t.success?o.pullCall.resolve():o.pullCall.reject(un(t.reason));break;case Ei.PULL:if(!u){a.postMessage({sourceName:i,targetName:s,stream:Ei.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||Kv).then(function(){a.postMessage({sourceName:i,targetName:s,stream:Ei.PULL_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:i,targetName:s,stream:Ei.PULL_COMPLETE,streamId:e,reason:un(d)})});break;case Ei.ENQUEUE:if(xe(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(t.chunk);break;case Ei.CLOSE:if(xe(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),this.#a(o,e);break;case Ei.ERROR:xe(o,"error should have stream controller"),o.controller.error(un(t.reason)),this.#a(o,e);break;case Ei.CANCEL_COMPLETE:t.success?o.cancelCall.resolve():o.cancelCall.reject(un(t.reason)),this.#a(o,e);break;case Ei.CANCEL:if(!u)break;const h=un(t.reason);Promise.try(u.onCancel||Kv,h).then(function(){a.postMessage({sourceName:i,targetName:s,stream:Ei.CANCEL_COMPLETE,streamId:e,success:!0})},function(d){a.postMessage({sourceName:i,targetName:s,stream:Ei.CANCEL_COMPLETE,streamId:e,reason:un(d)})}),u.sinkCapability.reject(h),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#a(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Sy{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){We("Abstract method `_createCanvas` called.")}}class gA extends Sy{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class xy{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){We("Abstract method `_fetch` called.")}}class $v extends xy{async _fetch(t){const e=await $o(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):Ko(e)}}class Cy{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,s,a){return"none"}destroy(t=!1){}}class mA extends Cy{#t;#e;#n;#i;#a;#r;#s=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#i=t,this.#a=e}get#o(){return this.#e||=new Map}get#u(){return this.#r||=new Map}get#l(){if(!this.#n){const t=this.#a.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#a.createElementNS(Cs,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#n=this.#a.createElementNS(Cs,"defs"),t.append(i),i.append(this.#n),this.#a.body.append(t)}return this.#n}#d(t){if(t.length===1){const h=t[0],d=new Array(256);for(let p=0;p<256;p++)d[p]=h[p]/255;const f=d.join(",");return[f,f,f]}const[e,i,s]=t,a=new Array(256),o=new Array(256),u=new Array(256);for(let h=0;h<256;h++)a[h]=e[h]/255,o[h]=i[h]/255,u[h]=s[h]/255;return[a.join(","),o.join(","),u.join(",")]}#c(t){if(this.#t===void 0){this.#t="";const e=this.#a.URL;e!==this.#a.baseURI&&(Vu(e)?ae('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=py(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,s,a]=this.#d(t),o=t.length===1?i:`${i}${s}${a}`;if(e=this.#o.get(o),e)return this.#o.set(t,e),e;const u=`g_${this.#i}_transfer_map_${this.#s++}`,h=this.#c(u);this.#o.set(t,h),this.#o.set(o,h);const d=this.#g(u);return this.#p(i,s,a,d),h}addHCMFilter(t,e){const i=`${t}-${e}`,s="base";let a=this.#u.get(s);if(a?.key===i||(a?(a.filter?.remove(),a.key=i,a.url="none",a.filter=null):(a={key:i,url:"none",filter:null},this.#u.set(s,a)),!t||!e))return a.url;const o=this.#b(t);t=Pt.makeHexColor(...o);const u=this.#b(e);if(e=Pt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return a.url;const h=new Array(256);for(let A=0;A<=255;A++){const C=A/255;h[A]=C<=.03928?C/12.92:((C+.055)/1.055)**2.4}const d=h.join(","),f=`g_${this.#i}_hcm_filter`,p=a.filter=this.#g(f);this.#p(d,d,d,p),this.#m(p);const v=(A,C)=>{const w=o[A]/255,b=u[A]/255,_=new Array(C+1);for(let x=0;x<=C;x++)_[x]=w+x/C*(b-w);return _.join(",")};return this.#p(v(0,5),v(1,5),v(2,5),p),a.url=this.#c(f),a.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),s=`alpha_${i}`;if(e=this.#o.get(s),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_alpha_map_${this.#s++}`,o=this.#c(a);this.#o.set(t,o),this.#o.set(s,o);const u=this.#g(a);return this.#v(i,u),o}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,s;if(t?([i]=this.#d([t]),s=`luminosity_${i}`):s="luminosity",e=this.#o.get(s),e)return this.#o.set(t,e),e;const a=`g_${this.#i}_luminosity_map_${this.#s++}`,o=this.#c(a);this.#o.set(t,o),this.#o.set(s,o);const u=this.#g(a);return this.#f(u),t&&this.#v(i,u),o}addHighlightHCMFilter(t,e,i,s,a){const o=`${e}-${i}-${s}-${a}`;let u=this.#u.get(t);if(u?.key===o||(u?(u.filter?.remove(),u.key=o,u.url="none",u.filter=null):(u={key:o,url:"none",filter:null},this.#u.set(t,u)),!e||!i))return u.url;const[h,d]=[e,i].map(this.#b.bind(this));let f=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[v,A]=[s,a].map(this.#b.bind(this));p<f&&([f,p,v,A]=[p,f,A,v]),this.#l.style.color="";const C=(_,x,D)=>{const M=new Array(256),T=(p-f)/D,O=_/255,k=(x-_)/(255*D);let z=0;for(let B=0;B<=D;B++){const H=Math.round(f+B*T),V=O+B*k;for(let Z=z;Z<=H;Z++)M[Z]=V;z=H+1}for(let B=z;B<256;B++)M[B]=M[z-1];return M.join(",")},w=`g_${this.#i}_hcm_${t}_filter`,b=u.filter=this.#g(w);return this.#m(b),this.#p(C(v[0],A[0],5),C(v[1],A[1],5),C(v[2],A[2],5),b),u.url=this.#c(w),u.url}destroy(t=!1){t&&this.#r?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#s=0)}#f(t){const e=this.#a.createElementNS(Cs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#m(t){const e=this.#a.createElementNS(Cs,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#g(t){const e=this.#a.createElementNS(Cs,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#h(t,e,i){const s=this.#a.createElementNS(Cs,e);s.setAttribute("type","discrete"),s.setAttribute("tableValues",i),t.append(s)}#p(t,e,i,s){const a=this.#a.createElementNS(Cs,"feComponentTransfer");s.append(a),this.#h(a,"feFuncR",t),this.#h(a,"feFuncG",e),this.#h(a,"feFuncB",i)}#v(t,e){const i=this.#a.createElementNS(Cs,"feComponentTransfer");e.append(i),this.#h(i,"feFuncA",t)}#b(t){return this.#l.style.color=t,Jo(getComputedStyle(this.#l).getPropertyValue("color"))}}class Ty{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){We("Abstract method `_fetch` called.")}}class Qv extends Ty{async _fetch(t){const e=await $o(t,"arraybuffer");return new Uint8Array(e)}}class Dy{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){We("Abstract method `_fetch` called.")}}class Jv extends Dy{async _fetch(t){const e=await $o(t,"arraybuffer");return new Uint8Array(e)}}Ki&&ae("Please use the `legacy` build in Node.js environments.");async function kf(g){const e=await process.getBuiltinModule("fs").promises.readFile(g);return new Uint8Array(e)}class vA extends Cy{}class yA extends Sy{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class bA extends xy{async _fetch(t){return kf(t)}}class AA extends Ty{async _fetch(t){return kf(t)}}class _A extends Dy{async _fetch(t){return kf(t)}}const va="__forcedDependency",{floor:t0,ceil:e0}=Math;function mu(g,t,e,i,s,a){g[t*4+0]=Math.min(g[t*4+0],e),g[t*4+1]=Math.min(g[t*4+1],i),g[t*4+2]=Math.max(g[t*4+2],s),g[t*4+3]=Math.max(g[t*4+3],a)}const gf=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class wA{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===gf}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const vu=(g,t)=>{if(!g)return;let e=g.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},g.set(t,e)),e};class EA{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[va]:[]};#n=new Map;#i=[];#a=[];#r=[[1,0,0,1,0,0]];#s=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#u=-1;#l=new Set;#d=new Map;#c=new Map;#f;#m;#g;#h;#p;constructor(t,e,i=!1){this.#f=t.width,this.#m=t.height,this.#v(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#h.length&&this.#v(t,this.#h)}#v(t,e){const i=new ArrayBuffer(t*4);this.#g=new Uint8ClampedArray(i),this.#h=new Uint32Array(i),e&&e.length>0?(this.#h.set(e),this.#h.fill(gf,e.length)):this.#h.fill(gf)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[va]:{__proto__:this.#e[va]}},this.#s={__proto__:this.#s},this.#i.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#s=Object.getPrototypeOf(this.#s);const i=this.#i.pop();return i!==void 0&&(vu(this.#p,t)?.dependencies.add(i),this.#h[t]=this.#h[i]),this}recordOpenMarker(t){return this.#i.push(t),this}getOpenMarker(){return this.#i.length===0?null:this.#i.at(-1)}recordCloseMarker(t){const e=this.#i.pop();return e!==void 0&&(vu(this.#p,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}beginMarkedContent(t){return this.#a.push(t),this}endMarkedContent(t){const e=this.#a.pop();return e!==void 0&&(vu(this.#p,t)?.dependencies.add(e),this.#h[t]=this.#h[e]),this}pushBaseTransform(t){return this.#r.push(Pt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#n.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#n.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(va,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(va,t);return this}resetBBox(t){return this.#u!==t&&(this.#u=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,s,a,o){const u=Pt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),h=[1/0,1/0,-1/0,-1/0];Pt.axialAlignedBoundingBox([i,a,s,o],u,h);const d=Pt.intersect(this.#s,h);return d?(this.#s[0]=d[0],this.#s[1]=d[1],this.#s[2]=d[2],this.#s[3]=d[3]):(this.#s[0]=this.#s[1]=1/0,this.#s[2]=this.#s[3]=-1/0),this}recordBBox(t,e,i,s,a,o){const u=this.#s;if(u[0]===1/0)return this;const h=Pt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(u[0]===-1/0)return Pt.axialAlignedBoundingBox([i,a,s,o],h,this.#o),this;const d=[1/0,1/0,-1/0,-1/0];return Pt.axialAlignedBoundingBox([i,a,s,o],h,d),this.#o[0]=Math.min(this.#o[0],Math.max(d[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(d[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(d[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(d[3],u[3])),this}recordCharacterBBox(t,e,i,s=1,a=0,o=0,u){const h=i.bbox;let d,f;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#c.get(i),d!==!1&&(f=[0,0,0,0],Pt.axialAlignedBoundingBox(h,i.fontMatrix,f),(s!==1||a!==0||o!==0)&&Pt.scaleMinMax([s,0,0,-s,a,o],f),d)))return this.recordBBox(t,e,f[0],f[2],f[1],f[3]);if(!u)return this.recordFullPageBBox(t);const p=u();return h&&f&&d===void 0&&(d=f[0]<=a-p.actualBoundingBoxLeft&&f[2]>=a+p.actualBoundingBoxRight&&f[1]<=o-p.actualBoundingBoxAscent&&f[3]>=o+p.actualBoundingBoxDescent,this.#c.set(i,d),d)?this.recordBBox(t,e,f[0],f[2],f[1],f[3]):this.recordBBox(t,e,a-p.actualBoundingBoxLeft,a+p.actualBoundingBoxRight,o-p.actualBoundingBoxAscent,o+p.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#s[0]),this.#o[1]=Math.max(0,this.#s[1]),this.#o[2]=Math.min(this.#f,this.#s[2]),this.#o[3]=Math.min(this.#m,this.#s[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,s=this.#t,a=this.#e;for(const o of e)o in this.#t?i.add(s[o]):o in a&&a[o].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#n.has(e)&&this.#l.add(this.#n.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[va]),this.#p){const i=vu(this.#p,t),{dependencies:s}=i;this.#l.forEach(s.add,s),this.#i.forEach(s.add,s),this.#a.forEach(s.add,s),s.delete(t),i.isRenderingOperation=!0}if(this.#u===t){const i=t0(this.#o[0]*256/this.#f),s=t0(this.#o[1]*256/this.#m),a=e0(this.#o[2]*256/this.#f),o=e0(this.#o[3]*256/this.#m);mu(this.#g,t,i,s,a,o);for(const u of this.#l)u!==t&&mu(this.#g,u,i,s,a,o);for(const u of this.#i)u!==t&&mu(this.#g,u,i,s,a,o);for(const u of this.#a)u!==t&&mu(this.#g,u,i,s,a,o);e||(this.#l.clear(),this.#u=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const s of i)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#u===t&&(this.#u=-1,this.#s[0]=Math.max(this.#s[0],this.#o[0]),this.#s[1]=Math.max(this.#s[1],this.#o[1]),this.#s[2]=Math.min(this.#s[2],this.#o[2]),this.#s[3]=Math.min(this.#s[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#c.clear(),new wA(this.#h,this.#g)}takeDebugMetadata(){return this.#p}}class Ou{#t;#e;#n;#i=0;#a=0;constructor(t,e,i){if(t instanceof Ou&&t.#n===!!i)return t;this.#t=t,this.#e=e,this.#n=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#a++,this.#t.save(this.#e),this}restore(t){return this.#a>0&&(this.#t.restore(this.#e),this.#a--),this}recordOpenMarker(t){return this.#i++,this}getOpenMarker(){return this.#i>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#i--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#n||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,s,a,o){return this.#n||this.#t.recordClipBox(this.#e,e,i,s,a,o),this}recordBBox(t,e,i,s,a,o){return this.#n||this.#t.recordBBox(this.#e,e,i,s,a,o),this}recordCharacterBBox(t,e,i,s,a,o,u){return this.#n||this.#t.recordCharacterBBox(this.#e,e,i,s,a,o,u),this}recordFullPageBBox(t){return this.#n||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#n||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const kn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Ui={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function mf(g,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],s=new Path2D;s.rect(t[0],t[1],e,i),g.clip(s)}class Mf{isModifyingCurrentTransform(){return!1}getPattern(){We("Abstract method `getPattern` called.")}}class SA extends Mf{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,s=this._p0,a=this._p1;if(e&&(s=s.slice(),a=a.slice(),Pt.applyTransform(s,e),Pt.applyTransform(a,e)),this._type==="axial")i=t.createLinearGradient(s[0],s[1],a[0],a[1]);else if(this._type==="radial"){let o=this._r0,u=this._r1;if(e){const h=new Float32Array(2);Pt.singularValueDecompose2dScale(e,h),o*=h[0],u*=h[0]}i=t.createRadialGradient(s[0],s[1],o,a[0],a[1],u)}for(const o of this._colorStops)i.addColorStop(o[0],o[1]);return i}getPattern(t,e,i,s){let a;if(s===Ui.STROKE||s===Ui.FILL){if(this.isOriginBased()){let v=Pt.transform(i,e.baseTransform);this.matrix&&(v=Pt.transform(v,this.matrix));const A=.001,C=Math.hypot(v[0],v[1]),w=Math.hypot(v[2],v[3]),b=(v[0]*v[2]+v[1]*v[3])/(C*w);if(Math.abs(b)<A)if(this.isRadial()){if(Math.abs(C-w)<A)return this._createGradient(t,v)}else return this._createGradient(t,v)}const o=e.current.getClippedPathBoundingBox(s,ai(t))||[0,0,0,0],u=Math.ceil(o[2]-o[0])||1,h=Math.ceil(o[3]-o[1])||1,d=e.cachedCanvases.getCanvas("pattern",u,h),f=d.context;f.clearRect(0,0,f.canvas.width,f.canvas.height),f.beginPath(),f.rect(0,0,f.canvas.width,f.canvas.height),f.translate(-o[0],-o[1]),i=Pt.transform(i,[1,0,0,1,o[0],o[1]]),f.transform(...e.baseTransform),this.matrix&&f.transform(...this.matrix),mf(f,this._bbox),f.fillStyle=this._createGradient(f),f.fill(),a=t.createPattern(d.canvas,"no-repeat");const p=new DOMMatrix(i);a.setTransform(p)}else mf(t,this._bbox),a=this._createGradient(t);return a}}function fd(g,t,e,i,s,a,o,u){const h=t.coords,d=t.colors,f=g.data,p=g.width*4;let v;h[e+1]>h[i+1]&&(v=e,e=i,i=v,v=a,a=o,o=v),h[i+1]>h[s+1]&&(v=i,i=s,s=v,v=o,o=u,u=v),h[e+1]>h[i+1]&&(v=e,e=i,i=v,v=a,a=o,o=v);const A=(h[e]+t.offsetX)*t.scaleX,C=(h[e+1]+t.offsetY)*t.scaleY,w=(h[i]+t.offsetX)*t.scaleX,b=(h[i+1]+t.offsetY)*t.scaleY,_=(h[s]+t.offsetX)*t.scaleX,x=(h[s+1]+t.offsetY)*t.scaleY;if(C>=x)return;const D=d[a],M=d[a+1],T=d[a+2],O=d[o],k=d[o+1],z=d[o+2],B=d[u],H=d[u+1],V=d[u+2],Z=Math.round(C),rt=Math.round(x);let ft,mt,G,W,st,bt,Nt,j;for(let $=Z;$<=rt;$++){if($<b){const kt=$<C?0:(C-$)/(C-b);ft=A-(A-w)*kt,mt=D-(D-O)*kt,G=M-(M-k)*kt,W=T-(T-z)*kt}else{let kt;$>x?kt=1:b===x?kt=0:kt=(b-$)/(b-x),ft=w-(w-_)*kt,mt=O-(O-B)*kt,G=k-(k-H)*kt,W=z-(z-V)*kt}let gt;$<C?gt=0:$>x?gt=1:gt=(C-$)/(C-x),st=A-(A-_)*gt,bt=D-(D-B)*gt,Nt=M-(M-H)*gt,j=T-(T-V)*gt;const yt=Math.round(Math.min(ft,st)),Dt=Math.round(Math.max(ft,st));let zt=p*$+yt*4;for(let kt=yt;kt<=Dt;kt++)gt=(ft-kt)/(ft-st),gt<0?gt=0:gt>1&&(gt=1),f[zt++]=mt-(mt-bt)*gt|0,f[zt++]=G-(G-Nt)*gt|0,f[zt++]=W-(W-j)*gt|0,f[zt++]=255}}function xA(g,t,e){const i=t.coords,s=t.colors;let a,o;switch(t.type){case lf.LATTICE:const u=t.verticesPerRow,h=Math.floor(i.length/u)-1,d=u-1;for(a=0;a<h;a++){let f=a*u;for(let p=0;p<d;p++,f++)fd(g,e,i[f],i[f+1],i[f+u],s[f],s[f+1],s[f+u]),fd(g,e,i[f+u+1],i[f+1],i[f+u],s[f+u+1],s[f+1],s[f+u])}break;case lf.TRIANGLES:for(a=0,o=i.length;a<o;a+=3)fd(g,e,i[a],i[a+1],i[a+2],s[a],s[a+1],s[a+2]);break;default:throw new Error("illegal figure")}}class CA extends Mf{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-u,f=Math.ceil(this._bounds[3])-h,p=Math.min(Math.ceil(Math.abs(d*t[0]*1.1)),3e3),v=Math.min(Math.ceil(Math.abs(f*t[1]*1.1)),3e3),A=d/p,C=f/v,w={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-h,scaleX:1/A,scaleY:1/C},b=p+4,_=v+4,x=i.getCanvas("mesh",b,_),D=x.context,M=D.createImageData(p,v);if(e){const O=M.data;for(let k=0,z=O.length;k<z;k+=4)O[k]=e[0],O[k+1]=e[1],O[k+2]=e[2],O[k+3]=255}for(const O of this._figures)xA(M,O,w);return D.putImageData(M,2,2),{canvas:x.canvas,offsetX:u-2*A,offsetY:h-2*C,scaleX:A,scaleY:C}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,s){mf(t,this._bbox);const a=new Float32Array(2);if(s===Ui.SHADING)Pt.singularValueDecompose2dScale(ai(t),a);else if(this.matrix){Pt.singularValueDecompose2dScale(this.matrix,a);const[u,h]=a;Pt.singularValueDecompose2dScale(e.baseTransform,a),a[0]*=u,a[1]*=h}else Pt.singularValueDecompose2dScale(e.baseTransform,a);const o=this._createMeshCanvas(a,s===Ui.SHADING?null:this._background,e.cachedCanvases);return s!==Ui.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(o.offsetX,o.offsetY),t.scale(o.scaleX,o.scaleY),t.createPattern(o.canvas,"no-repeat")}}class TA extends Mf{getPattern(){return"hotpink"}}function DA(g){switch(g[0]){case"RadialAxial":return new SA(g);case"Mesh":return new CA(g);case"Dummy":return new TA}throw new Error(`Unknown IR type: ${g[0]}`)}const i0={COLORED:1,UNCOLORED:2};class Lf{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,s){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=s}createPatternCanvas(t,e){const{bbox:i,operatorList:s,paintType:a,tilingType:o,color:u,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:f}=this;d=Math.abs(d),f=Math.abs(f),Gu("TilingType: "+o);const p=i[0],v=i[1],A=i[2],C=i[3],w=A-p,b=C-v,_=new Float32Array(2);Pt.singularValueDecompose2dScale(this.matrix,_);const[x,D]=_;Pt.singularValueDecompose2dScale(this.baseTransform,_);const M=x*_[0],T=D*_[1];let O=w,k=b,z=!1,B=!1;const H=Math.ceil(d*M),V=Math.ceil(f*T),Z=Math.ceil(w*M),rt=Math.ceil(b*T);H>=Z?O=d:z=!0,V>=rt?k=f:B=!0;const ft=this.getSizeAndScale(O,this.ctx.canvas.width,M),mt=this.getSizeAndScale(k,this.ctx.canvas.height,T),G=t.cachedCanvases.getCanvas("pattern",ft.size,mt.size),W=G.context,st=h.createCanvasGraphics(W,e);if(st.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(st,a,u),W.translate(-ft.scale*p,-mt.scale*v),st.transform(0,ft.scale,0,0,mt.scale,0,0),W.save(),st.dependencyTracker?.save(),this.clipBbox(st,p,v,A,C),st.baseTransform=ai(st.ctx),st.executeOperatorList(s),st.endDrawing(),st.dependencyTracker?.restore(),W.restore(),z||B){const bt=G.canvas;z&&(O=d),B&&(k=f);const Nt=this.getSizeAndScale(O,this.ctx.canvas.width,M),j=this.getSizeAndScale(k,this.ctx.canvas.height,T),$=Nt.size,gt=j.size,yt=t.cachedCanvases.getCanvas("pattern-workaround",$,gt),Dt=yt.context,zt=z?Math.floor(w/d):0,kt=B?Math.floor(b/f):0;for(let Lt=0;Lt<=zt;Lt++)for(let Gt=0;Gt<=kt;Gt++)Dt.drawImage(bt,$*Lt,gt*Gt,$,gt,0,0,$,gt);return{canvas:yt.canvas,scaleX:Nt.scale,scaleY:j.scale,offsetX:p,offsetY:v}}return{canvas:G.canvas,scaleX:ft.scale,scaleY:mt.scale,offsetX:p,offsetY:v}}getSizeAndScale(t,e,i){const s=Math.max(Lf.MAX_PATTERN_SIZE,e);let a=Math.ceil(t*i);return a>=s?a=s:i=a/t,{scale:i,size:a}}clipBbox(t,e,i,s,a){const o=s-e,u=a-i;t.ctx.rect(e,i,o,u),Pt.axialAlignedBoundingBox([e,i,s,a],ai(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const s=t.ctx,a=t.current;switch(e){case i0.COLORED:const{fillStyle:o,strokeStyle:u}=this.ctx;s.fillStyle=a.fillColor=o,s.strokeStyle=a.strokeColor=u;break;case i0.UNCOLORED:s.fillStyle=s.strokeStyle=i,a.fillColor=a.strokeColor=i;break;default:throw new U1(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,s,a){let o=i;s!==Ui.SHADING&&(o=Pt.transform(o,e.baseTransform),this.matrix&&(o=Pt.transform(o,this.matrix)));const u=this.createPatternCanvas(e,a);let h=new DOMMatrix(o);h=h.translate(u.offsetX,u.offsetY),h=h.scale(1/u.scaleX,1/u.scaleY);const d=t.createPattern(u.canvas,"repeat");return d.setTransform(h),d}}function RA({src:g,srcPos:t=0,dest:e,width:i,height:s,nonBlackColor:a=4294967295,inverseDecode:o=!1}){const u=Ti.isLittleEndian?4278190080:255,[h,d]=o?[a,u]:[u,a],f=i>>3,p=i&7,v=g.length;e=new Uint32Array(e.buffer);let A=0;for(let C=0;C<s;C++){for(const b=t+f;t<b;t++){const _=t<v?g[t]:255;e[A++]=_&128?d:h,e[A++]=_&64?d:h,e[A++]=_&32?d:h,e[A++]=_&16?d:h,e[A++]=_&8?d:h,e[A++]=_&4?d:h,e[A++]=_&2?d:h,e[A++]=_&1?d:h}if(p===0)continue;const w=t<v?g[t++]:255;for(let b=0;b<p;b++)e[A++]=w&1<<7-b?d:h}return{srcPos:t,destPos:A}}const n0=16,s0=100,NA=15,r0=10,hn=16,pd=new DOMMatrix,An=new Float32Array(2),Ra=new Float32Array([1/0,1/0,-1/0,-1/0]);function OA(g,t){if(g._removeMirroring)throw new Error("Context is already forwarding operations.");g.__originalSave=g.save,g.__originalRestore=g.restore,g.__originalRotate=g.rotate,g.__originalScale=g.scale,g.__originalTranslate=g.translate,g.__originalTransform=g.transform,g.__originalSetTransform=g.setTransform,g.__originalResetTransform=g.resetTransform,g.__originalClip=g.clip,g.__originalMoveTo=g.moveTo,g.__originalLineTo=g.lineTo,g.__originalBezierCurveTo=g.bezierCurveTo,g.__originalRect=g.rect,g.__originalClosePath=g.closePath,g.__originalBeginPath=g.beginPath,g._removeMirroring=()=>{g.save=g.__originalSave,g.restore=g.__originalRestore,g.rotate=g.__originalRotate,g.scale=g.__originalScale,g.translate=g.__originalTranslate,g.transform=g.__originalTransform,g.setTransform=g.__originalSetTransform,g.resetTransform=g.__originalResetTransform,g.clip=g.__originalClip,g.moveTo=g.__originalMoveTo,g.lineTo=g.__originalLineTo,g.bezierCurveTo=g.__originalBezierCurveTo,g.rect=g.__originalRect,g.closePath=g.__originalClosePath,g.beginPath=g.__originalBeginPath,delete g._removeMirroring},g.save=function(){t.save(),this.__originalSave()},g.restore=function(){t.restore(),this.__originalRestore()},g.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},g.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},g.transform=function(e,i,s,a,o,u){t.transform(e,i,s,a,o,u),this.__originalTransform(e,i,s,a,o,u)},g.setTransform=function(e,i,s,a,o,u){t.setTransform(e,i,s,a,o,u),this.__originalSetTransform(e,i,s,a,o,u)},g.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},g.rotate=function(e){t.rotate(e),this.__originalRotate(e)},g.clip=function(e){t.clip(e),this.__originalClip(e)},g.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},g.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},g.bezierCurveTo=function(e,i,s,a,o,u){t.bezierCurveTo(e,i,s,a,o,u),this.__originalBezierCurveTo(e,i,s,a,o,u)},g.rect=function(e,i,s,a){t.rect(e,i,s,a),this.__originalRect(e,i,s,a)},g.closePath=function(){t.closePath(),this.__originalClosePath()},g.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class kA{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let s;return this.cache[t]!==void 0?(s=this.cache[t],this.canvasFactory.reset(s,e,i)):(s=this.canvasFactory.create(e,i),this.cache[t]=s),s}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function yu(g,t,e,i,s,a,o,u,h,d){const[f,p,v,A,C,w]=ai(g);if(p===0&&v===0){const x=o*f+C,D=Math.round(x),M=u*A+w,T=Math.round(M),O=(o+h)*f+C,k=Math.abs(Math.round(O)-D)||1,z=(u+d)*A+w,B=Math.abs(Math.round(z)-T)||1;return g.setTransform(Math.sign(f),0,0,Math.sign(A),D,T),g.drawImage(t,e,i,s,a,0,0,k,B),g.setTransform(f,p,v,A,C,w),[k,B]}if(f===0&&A===0){const x=u*v+C,D=Math.round(x),M=o*p+w,T=Math.round(M),O=(u+d)*v+C,k=Math.abs(Math.round(O)-D)||1,z=(o+h)*p+w,B=Math.abs(Math.round(z)-T)||1;return g.setTransform(0,Math.sign(p),Math.sign(v),0,D,T),g.drawImage(t,e,i,s,a,0,0,B,k),g.setTransform(f,p,v,A,C,w),[B,k]}g.drawImage(t,e,i,s,a,o,u,h,d);const b=Math.hypot(f,p),_=Math.hypot(v,A);return[b*h,_*d]}class a0{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=of;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=Ci.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=Ra.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Ui.FILL,e=null){const i=this.minMax.slice();if(t===Ui.STROKE){e||We("Stroke bounding box must include transform."),Pt.singularValueDecompose2dScale(e,An);const s=An[0]*this.lineWidth/2,a=An[1]*this.lineWidth/2;i[0]-=s,i[1]-=a,i[2]+=s,i[3]+=a}return i}updateClipFromPath(){const t=Pt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(Ra,0)}getClippedPathBoundingBox(t=Ui.FILL,e=null){return Pt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function o0(g,t){if(t instanceof ImageData){g.putImageData(t,0,0);return}const e=t.height,i=t.width,s=e%hn,a=(e-s)/hn,o=s===0?a:a+1,u=g.createImageData(i,hn);let h=0,d;const f=t.data,p=u.data;let v,A,C,w;if(t.kind===xu.GRAYSCALE_1BPP){const b=f.byteLength,_=new Uint32Array(p.buffer,0,p.byteLength>>2),x=_.length,D=i+7>>3,M=4294967295,T=Ti.isLittleEndian?4278190080:255;for(v=0;v<o;v++){for(C=v<a?hn:s,d=0,A=0;A<C;A++){const O=b-h;let k=0;const z=O>D?i:O*8-7,B=z&-8;let H=0,V=0;for(;k<B;k+=8)V=f[h++],_[d++]=V&128?M:T,_[d++]=V&64?M:T,_[d++]=V&32?M:T,_[d++]=V&16?M:T,_[d++]=V&8?M:T,_[d++]=V&4?M:T,_[d++]=V&2?M:T,_[d++]=V&1?M:T;for(;k<z;k++)H===0&&(V=f[h++],H=128),_[d++]=V&H?M:T,H>>=1}for(;d<x;)_[d++]=0;g.putImageData(u,0,v*hn)}}else if(t.kind===xu.RGBA_32BPP){for(A=0,w=i*hn*4,v=0;v<a;v++)p.set(f.subarray(h,h+w)),h+=w,g.putImageData(u,0,A),A+=hn;v<o&&(w=i*s*4,p.set(f.subarray(h,h+w)),g.putImageData(u,0,A))}else if(t.kind===xu.RGB_24BPP)for(C=hn,w=i*C,v=0;v<o;v++){for(v>=a&&(C=s,w=i*C),d=0,A=w;A--;)p[d++]=f[h++],p[d++]=f[h++],p[d++]=f[h++],p[d++]=255;g.putImageData(u,0,v*hn)}else throw new Error(`bad image kind: ${t.kind}`)}function l0(g,t){if(t.bitmap){g.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,s=e%hn,a=(e-s)/hn,o=s===0?a:a+1,u=g.createImageData(i,hn);let h=0;const d=t.data,f=u.data;for(let p=0;p<o;p++){const v=p<a?hn:s;({srcPos:h}=RA({src:d,srcPos:h,dest:f,width:i,height:v,nonBlackColor:0})),g.putImageData(u,0,p*hn)}}function ko(g,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)g[i]!==void 0&&(t[i]=g[i]);g.setLineDash!==void 0&&(t.setLineDash(g.getLineDash()),t.lineDashOffset=g.lineDashOffset)}function bu(g){g.strokeStyle=g.fillStyle="#000000",g.fillRule="nonzero",g.globalAlpha=1,g.lineWidth=1,g.lineCap="butt",g.lineJoin="miter",g.miterLimit=10,g.globalCompositeOperation="source-over",g.font="10px sans-serif",g.setLineDash!==void 0&&(g.setLineDash([]),g.lineDashOffset=0);const{filter:t}=g;t!=="none"&&t!==""&&(g.filter="none")}function u0(g,t){if(t)return!0;Pt.singularValueDecompose2dScale(g,An);const e=Math.fround(as.pixelRatio*za.PDF_TO_CSS_UNITS);return An[0]<=e&&An[1]<=e}const MA=["butt","round","square"],LA=["miter","round","bevel"],BA={},h0={};class Ma{constructor(t,e,i,s,a,{optionalContentConfig:o,markedContentStack:u=null},h,d,f){this.ctx=t,this.current=new a0(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=s,this.filterFactory=a,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=o,this.cachedCanvases=new kA(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=f??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:s=null}){const a=this.ctx.canvas.width,o=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,a,o),this.ctx.fillStyle=u,i){const h=this.cachedCanvases.getCanvas("transparent",a,o);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...ai(this.compositeCtx))}this.ctx.save(),bu(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=ai(this.ctx)}executeOperatorList(t,e,i,s,a){const o=t.argsArray,u=t.fnArray;let h=e||0;const d=o.length;if(d===h)return h;const f=d-h>r0&&typeof i=="function",p=f?Date.now()+NA:0;let v=0;const A=this.commonObjs,C=this.objs;let w,b;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,i),h;if(!a||a(h))if(w=u[h],b=o[h]??null,w!==Go.dependency)b===null?this[w](h):this[w](h,...b);else for(const _ of b){this.dependencyTracker?.recordNamedData(_,h);const x=_.startsWith("g_")?A:C;if(!x.has(_))return x.get(_,i),h}if(h++,h===d)return h;if(f&&++v>r0){if(Date.now()>p)return i(),h;v=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,s=t.height??t.displayHeight;let a=Math.max(Math.hypot(e[0],e[1]),1),o=Math.max(Math.hypot(e[2],e[3]),1),u=i,h=s,d="prescale1",f,p;for(;a>2&&u>1||o>2&&h>1;){let v=u,A=h;a>2&&u>1&&(v=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),a/=u/v),o>2&&h>1&&(A=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,o/=h/A),f=this.cachedCanvases.getCanvas(d,v,A),p=f.context,p.clearRect(0,0,v,A),p.drawImage(t,0,0,u,h,0,0,v,A),t=f.canvas,u=v,h=A,d=d==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:h}}_createMaskCanvas(t,e){const i=this.ctx,{width:s,height:a}=e,o=this.current.fillColor,u=this.current.patternFill,h=ai(i);let d,f,p,v;if((e.bitmap||e.data)&&e.count>1){const H=e.bitmap||e.data.buffer;f=JSON.stringify(u?h:[h.slice(0,4),o]),d=this._cachedBitmapsMap.get(H),d||(d=new Map,this._cachedBitmapsMap.set(H,d));const V=d.get(f);if(V&&!u){const Z=Math.round(Math.min(h[0],h[2])+h[4]),rt=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(t,kn.transformAndFill),{canvas:V,offsetX:Z,offsetY:rt}}p=V}p||(v=this.cachedCanvases.getCanvas("maskCanvas",s,a),l0(v.context,e));let A=Pt.transform(h,[1/s,0,0,-1/a,0,0]);A=Pt.transform(A,[1,0,0,1,0,-a]);const C=Ra.slice();Pt.axialAlignedBoundingBox([0,0,s,a],A,C);const[w,b,_,x]=C,D=Math.round(_-w)||1,M=Math.round(x-b)||1,T=this.cachedCanvases.getCanvas("fillCanvas",D,M),O=T.context,k=w,z=b;O.translate(-k,-z),O.transform(...A),p||(p=this._scaleImage(v.canvas,es(O)),p=p.img,d&&u&&d.set(f,p)),O.imageSmoothingEnabled=u0(ai(O),e.interpolate),yu(O,p,0,0,p.width,p.height,0,0,s,a),O.globalCompositeOperation="source-in";const B=Pt.transform(es(O),[1,0,0,1,-k,-z]);return O.fillStyle=u?o.getPattern(i,this,B,Ui.FILL,t):o,O.fillRect(0,0,s,a),d&&!u&&(this.cachedCanvases.delete("fillCanvas"),d.set(f,T.canvas)),this.dependencyTracker?.recordDependencies(t,kn.transformAndFill),{canvas:T.canvas,offsetX:Math.round(k),offsetY:Math.round(z)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=MA[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=LA[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(e),s.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,s]of e)switch(i){case"LW":this.setLineWidth(t,s);break;case"LC":this.setLineCap(t,s);break;case"LJ":this.setLineJoin(t,s);break;case"ML":this.setMiterLimit(t,s);break;case"D":this.setDash(t,s[0],s[1]);break;case"RI":this.setRenderingIntent(t,s);break;case"FL":this.setFlatness(t,s);break;case"Font":this.setFont(t,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,a=this.cachedCanvases.getCanvas(s,e,i);this.suspendedCtx=this.ctx;const o=this.ctx=a.context;o.setTransform(this.suspendedCtx.getTransform()),ko(this.suspendedCtx,o),OA(o,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ko(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,s){const a=s[0],o=s[1],u=s[2]-a,h=s[3]-o;u===0||h===0||(this.genericComposeSMask(e.context,i,u,h,e.subtype,e.backdrop,e.transferMap,a,o,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,s,a,o,u,h,d,f,p){let v=t.canvas,A=h-f,C=d-p;if(o)if(A<0||C<0||A+i>v.width||C+s>v.height){const b=this.cachedCanvases.getCanvas("maskExtension",i,s),_=b.context;_.drawImage(v,-A,-C),_.globalCompositeOperation="destination-atop",_.fillStyle=o,_.fillRect(0,0,i,s),_.globalCompositeOperation="source-over",v=b.canvas,A=C=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const b=new Path2D;b.rect(A,C,i,s),t.clip(b),t.globalCompositeOperation="destination-atop",t.fillStyle=o,t.fillRect(A,C,i,s),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),a==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):a==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const w=new Path2D;w.rect(h,d,i,s),e.clip(w),e.globalCompositeOperation="destination-in",e.drawImage(v,A,C,i,s,h,d,i,s),e.restore()}save(t){this.inSMaskMode&&ko(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&ko(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,s,a,o,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,s,a,o,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,s){let[a]=i;if(!s){a||=i[0]=new Path2D,this[e](t,a);return}if(this.dependencyTracker!==null){const o=e===Go.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,s[0]-o,s[2]+o,s[1]-o,s[3]+o).recordDependencies(t,["transform"])}a instanceof Path2D||(a=i[0]=Ay(a)),Pt.axialAlignedBoundingBox(s,ai(this.ctx),this.current.minMax),this[e](t,a),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const s=this.ctx,a=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof a=="object"&&a?.getPattern){const o=a.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=a.getPattern(s,this,es(s),Ui.STROKE,t),o){const u=new Path2D;u.addPath(e,s.getTransform().invertSelf().multiplySelf(o)),e=u}this.rescaleAndStroke(e,!1),s.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,kn.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Ui.STROKE,ai(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const s=this.ctx,a=this.current.fillColor,o=this.current.patternFill;let u=!1;if(o){const d=a.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(t),s.save(),s.fillStyle=a.getPattern(s,this,es(s),Ui.FILL,t),d){const f=new Path2D;f.addPath(e,s.getTransform().invertSelf().multiplySelf(d)),e=f}u=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(e,"evenodd"),this.pendingEOFill=!1):s.fill(e)),this.dependencyTracker?.recordDependencies(t,kn.fill),u&&(s.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,h)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,kn.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=BA}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=h0}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;e!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",t),s.recordCloseMarker(t)}if(e!==void 0){const s=new Path2D,a=i.getTransform().invertSelf();for(const{transform:o,x:u,y:h,fontSize:d,path:f}of e)f&&s.addPath(f,new DOMMatrix(o).preMultiplySelf(a).translate(u,h).scale(d,-d));i.clip(s)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const s=this.commonObjs.get(e),a=this.current;if(!s)throw new Error(`Can't find font for ${e}`);if(a.fontMatrix=s.fontMatrix||of,(a.fontMatrix[0]===0||a.fontMatrix[3]===0)&&ae("Invalid font matrix for font "+e),i<0?(i=-i,a.fontDirection=-1):a.fontDirection=1,this.current.font=s,this.current.fontSize=i,s.isType3Font)return;const o=s.loadedName||"sans-serif",u=s.systemFontInfo?.css||`"${o}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const d=s.italic?"italic":"normal";let f=i;i<n0?f=n0:i>s0&&(f=s0),this.current.fontSizeScale=i/f,this.ctx.font=`${d} ${h} ${f}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#n(t,e,i){const s=new Path2D;return s.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),s}paintChar(t,e,i,s,a,o){const u=this.ctx,h=this.current,d=h.font,f=h.textRenderingMode,p=h.fontSize/h.fontSizeScale,v=f&Ci.FILL_STROKE_MASK,A=!!(f&Ci.ADD_TO_PATH_FLAG),C=h.patternFill&&!d.missingFile,w=h.patternStroke&&!d.missingFile;let b;if((d.disableFontFace||A||C||w)&&!d.missingFile&&(b=d.getPathGenerator(this.commonObjs,e)),b&&(d.disableFontFace||C||w)){u.save(),u.translate(i,s),u.scale(p,-p),this.dependencyTracker?.recordCharacterBBox(t,u,d);let _;if(v===Ci.FILL||v===Ci.FILL_STROKE)if(a){_=u.getTransform(),u.setTransform(...a);const x=this.#n(b,_,a);u.fill(x)}else u.fill(b);if(v===Ci.STROKE||v===Ci.FILL_STROKE)if(o){_||=u.getTransform(),u.setTransform(...o);const{a:x,b:D,c:M,d:T}=_,O=Pt.inverseTransform(o),k=Pt.transform([x,D,M,T,0,0],O);Pt.singularValueDecompose2dScale(k,An),u.lineWidth*=Math.max(An[0],An[1])/p,u.stroke(this.#n(b,_,o))}else u.lineWidth/=p,u.stroke(b);u.restore()}else(v===Ci.FILL||v===Ci.FILL_STROKE)&&(u.fillText(e,i,s),this.dependencyTracker?.recordCharacterBBox(t,u,d,p,i,s,()=>u.measureText(e))),(v===Ci.STROKE||v===Ci.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,d,p,i,s,()=>u.measureText(e)).recordDependencies(t,kn.stroke),u.strokeText(e,i,s));A&&((this.pendingTextPaths||=[]).push({transform:ai(u),x:i,y:s,fontSize:p,path:b}),this.dependencyTracker?.recordCharacterBBox(t,u,d,p,i,s))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<e.length;s+=4)if(e[s]>0&&e[s]<255){i=!0;break}return oe(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,kn.showText).resetBBox(t),this.current.textRenderingMode&Ci.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,s=i.font;if(s.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const a=i.fontSize;if(a===0){this.dependencyTracker?.recordOperation(t);return}const o=this.ctx,u=i.fontSizeScale,h=i.charSpacing,d=i.wordSpacing,f=i.fontDirection,p=i.textHScale*f,v=e.length,A=s.vertical,C=A?1:-1,w=s.defaultVMetrics,b=a*i.fontMatrix[0],_=i.textRenderingMode===Ci.FILL&&!s.disableFontFace&&!i.patternFill;o.save(),i.textMatrix&&o.transform(...i.textMatrix),o.translate(i.x,i.y+i.textRise),f>0?o.scale(p,-1):o.scale(p,1);let x,D;const M=i.textRenderingMode&Ci.FILL_STROKE_MASK,T=M===Ci.FILL||M===Ci.FILL_STROKE,O=M===Ci.STROKE||M===Ci.FILL_STROKE;if(T&&i.patternFill){o.save();const V=i.fillColor.getPattern(o,this,es(o),Ui.FILL,t);x=ai(o),o.restore(),o.fillStyle=V}if(O&&i.patternStroke){o.save();const V=i.strokeColor.getPattern(o,this,es(o),Ui.STROKE,t);D=ai(o),o.restore(),o.strokeStyle=V}let k=i.lineWidth;const z=i.textMatrixScale;if(z===0||k===0?O&&(k=this.getSinglePixelWidth()):k/=z,u!==1&&(o.scale(u,u),k/=u),o.lineWidth=k,s.isInvalidPDFjsFont){const V=[];let Z=0;for(const ft of e)V.push(ft.unicode),Z+=ft.width;const rt=V.join("");if(o.fillText(rt,0,0),this.dependencyTracker!==null){const ft=o.measureText(rt);this.dependencyTracker.recordBBox(t,this.ctx,-ft.actualBoundingBoxLeft,ft.actualBoundingBoxRight,-ft.actualBoundingBoxAscent,ft.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=Z*b*p,o.restore(),this.compose();return}let B=0,H;for(H=0;H<v;++H){const V=e[H];if(typeof V=="number"){B+=C*V*a/1e3;continue}let Z=!1;const rt=(V.isSpace?d:0)+h,ft=V.fontChar,mt=V.accent;let G,W,st=V.width;if(A){const j=V.vmetric||w,$=-(V.vmetric?j[1]:st*.5)*b,gt=j[2]*b;st=j?-j[0]:st,G=$/u,W=(B+gt)/u}else G=B/u,W=0;let bt;if(s.remeasure&&st>0){bt=o.measureText(ft);const j=bt.width*1e3/a*u;if(st<j&&this.isFontSubpixelAAEnabled){const $=st/j;Z=!0,o.save(),o.scale($,1),G/=$}else st!==j&&(G+=(st-j)/2e3*a/u)}if(this.contentVisible&&(V.isInFont||s.missingFile)){if(_&&!mt)o.fillText(ft,G,W),this.dependencyTracker?.recordCharacterBBox(t,o,bt?{bbox:null}:s,a/u,G,W,()=>bt??o.measureText(ft));else if(this.paintChar(t,ft,G,W,x,D),mt){const j=G+a*mt.offset.x/u,$=W-a*mt.offset.y/u;this.paintChar(t,mt.fontChar,j,$,x,D)}}const Nt=A?st*b-rt*f:st*b+rt*f;B+=Nt,Z&&o.restore()}A?i.y-=B:i.x+=B*p,o.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,s=this.current,a=s.font,o=s.fontSize,u=s.fontDirection,h=a.vertical?1:-1,d=s.charSpacing,f=s.wordSpacing,p=s.textHScale*u,v=s.fontMatrix||of,A=e.length,C=s.textRenderingMode===Ci.INVISIBLE;let w,b,_,x;if(C||o===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),s.textMatrix&&i.transform(...s.textMatrix),i.translate(s.x,s.y+s.textRise),i.scale(p,u);const D=this.dependencyTracker;for(this.dependencyTracker=D?new Ou(D,t):null,w=0;w<A;++w){if(b=e[w],typeof b=="number"){x=h*b*o/1e3,this.ctx.translate(x,0),s.x+=x*p;continue}const M=(b.isSpace?f:0)+d,T=a.charProcOperatorList[b.operatorListId];T?this.contentVisible&&(this.save(),i.scale(o,o),i.transform(...v),this.executeOperatorList(T),this.restore()):ae(`Type3 character "${b.operatorListId}" is not available.`);const O=[b.width,0];Pt.applyTransform(O,v),_=O[0]*o+M,i.translate(_,0),s.x+=_*p}i.restore(),D&&(this.dependencyTracker=D)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,s,a,o,u){const h=new Path2D;h.rect(s,a,o-s,u-a),this.ctx.clip(h),this.dependencyTracker?.recordBBox(t,this.ctx,s,o,a,u).recordClipBox(t,this.ctx,s,o,a,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const s=this.baseTransform||ai(this.ctx),a={createCanvasGraphics:(o,u)=>new Ma(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Ou(this.dependencyTracker,u,!0):null)};i=new Lf(e,this.ctx,a,s)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let s;return this.cachedPatterns.has(e)?s=this.cachedPatterns.get(e):(s=DA(this.getObject(t,e)),this.cachedPatterns.set(e,s)),i&&(s.matrix=i),s}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const s=this._getPattern(t,e);i.fillStyle=s.getPattern(i,this,es(i),Ui.SHADING,t);const a=es(i);if(a){const{width:o,height:u}=i.canvas,h=Ra.slice();Pt.axialAlignedBoundingBox([0,0,o,u],a,h);const[d,f,p,v]=h;this.ctx.fillRect(d,f,p-d,v-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,kn.transform).recordDependencies(t,kn.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){We("Should not call beginInlineImage")}beginImageData(){We("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=ai(this.ctx),i)){Pt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[s,a,o,u]=i,h=new Path2D;h.rect(s,a,o-s,u-a),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(t,this.ctx,s,o,a,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||Gu("TODO: Support non-isolated groups."),e.knockout&&ae("Knockout groups not supported.");const s=ai(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let a=Ra.slice();Pt.axialAlignedBoundingBox(e.bbox,ai(i),a);const o=[0,0,i.canvas.width,i.canvas.height];a=Pt.intersect(a,o)||[0,0,0,0];const u=Math.floor(a[0]),h=Math.floor(a[1]),d=Math.max(Math.ceil(a[2])-u,1),f=Math.max(Math.ceil(a[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,f]);let p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);const v=this.cachedCanvases.getCanvas(p,d,f),A=v.context;A.translate(-u,-h),A.transform(...s);let C=new Path2D;const[w,b,_,x]=e.bbox;if(C.rect(w,b,_-w,x-b),e.matrix){const D=new Path2D;D.addPath(C,new DOMMatrix(e.matrix)),C=D}A.clip(C),e.smask&&this.smaskStack.push({canvas:v.canvas,context:A,offsetX:u,offsetY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,h),i.save()),ko(i,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const a=ai(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...a);const o=Ra.slice();Pt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],a,o),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(o)}}beginAnnotation(t,e,i,s,a,o){if(this.#t(),bu(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],h=i[3]-i[1];if(o&&this.annotationCanvasMap){s=s.slice(),s[4]-=i[0],s[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=h,Pt.singularValueDecompose2dScale(ai(this.ctx),An);const{viewportScale:d}=this,f=Math.ceil(u*this.outputScaleX*d),p=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(f,p);const{canvas:v,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(e,v),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(An[0],0,0,-An[1],0,h*An[1]),bu(this.ctx)}else{bu(this.ctx),this.endPath(t);const d=new Path2D;d.rect(i[0],i[1],u,h),this.ctx.clip(d)}}this.current=new a0(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...s),this.transform(t,...a)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const s=this.ctx,a=this._createMaskCanvas(t,e),o=a.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(o,a.offsetX,a.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,a.offsetX,a.offsetX+o.width,a.offsetY,a.offsetY+o.height).recordOperation(t),s.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,s=0,a=0,o,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const h=this.ctx;h.save();const d=ai(h);h.transform(i,s,a,o,0,0);const f=this._createMaskCanvas(t,e);h.setTransform(1,0,0,1,f.offsetX-d[4],f.offsetY-d[5]),this.dependencyTracker?.resetBBox(t);for(let p=0,v=u.length;p<v;p+=2){const A=Pt.transform(d,[i,s,a,o,u[p],u[p+1]]);h.drawImage(f.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+f.canvas.width,A[5],A[5]+f.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,s=this.current.fillColor,a=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,kn.transformAndFill);for(const o of e){const{data:u,width:h,height:d,transform:f}=o,p=this.cachedCanvases.getCanvas("maskCanvas",h,d),v=p.context;v.save();const A=this.getObject(t,u,o);l0(v,A),v.globalCompositeOperation="source-in",v.fillStyle=a?s.getPattern(v,this,es(i),Ui.FILL,t):s,v.fillRect(0,0,h,d),v.restore(),i.save(),i.transform(...f),i.scale(1,-1),yu(i,p.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,h,0,d),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){ae("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,s,a){if(!this.contentVisible)return;const o=this.getObject(t,e);if(!o){ae("Dependent image isn't ready yet");return}const u=o.width,h=o.height,d=[];for(let f=0,p=a.length;f<p;f+=2)d.push({transform:[i,0,0,s,a[f],a[f+1]],x:0,y:0,w:u,h});this.paintInlineImageXObjectGroup(t,o,d)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:s}=t,a=this.cachedCanvases.getCanvas("inlineImage",i,s),o=a.context;return o.filter=this.current.transferMaps,o.drawImage(e,0,0),o.filter="none",a.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,s=e.height,a=this.ctx;this.save(t);const{filter:o}=a;o!=="none"&&o!==""&&(a.filter="none"),a.scale(1/i,-1/s);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const f=this.cachedCanvases.getCanvas("inlineImage",i,s).context;o0(f,e),u=this.applyTransferMapsToCanvas(f)}const h=this._scaleImage(u,es(a));a.imageSmoothingEnabled=u0(ai(a),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,a,0,i,-s,0).recordDependencies(t,kn.imageXObject).recordOperation(t),yu(a,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,i,s),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const s=this.ctx;let a;if(e.bitmap)a=e.bitmap;else{const o=e.width,u=e.height,d=this.cachedCanvases.getCanvas("inlineImage",o,u).context;o0(d,e),a=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(t);for(const o of i)s.save(),s.transform(...o.transform),s.scale(1,-1),yu(s,a,o.x,o.y,o.w,o.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,kn.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const a=this.ctx;this.pendingClip?(s||(this.pendingClip===h0?a.clip(e,"evenodd"):a.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=ai(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),s=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:s,d:a}=this.ctx.getTransform();let o,u;if(i===0&&s===0){const h=Math.abs(e),d=Math.abs(a);if(h===d)if(t===0)o=u=1/h;else{const f=h*t;o=u=f<1?1/f:1}else if(t===0)o=1/h,u=1/d;else{const f=h*t,p=d*t;o=f<1?1/f:1,u=p<1?1/p:1}}else{const h=Math.abs(e*a-i*s),d=Math.hypot(e,i),f=Math.hypot(s,a);if(t===0)o=f/h,u=d/h;else{const p=t*h;o=f>p?f/p:1,u=d>p?d/p:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:s}}=this,[a,o]=this.getScaleForStroking();if(a===o){i.lineWidth=(s||1)*a,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(a,o),pd.a=1/a,pd.d=1/o;const h=new Path2D;if(h.addPath(t,pd),u.length>0){const d=Math.max(a,o);i.setLineDash(u.map(f=>f/d)),i.lineDashOffset/=d}i.lineWidth=s||1,i.stroke(h),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const g in Go)Ma.prototype[g]!==void 0&&(Ma.prototype[Go[g]]=Ma.prototype[g]);class La{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class IA{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Ea=Symbol("INTERNAL");class zA{#t=!1;#e=!1;#n=!1;#i=!0;constructor(t,{name:e,intent:i,usage:s,rbGroups:a}){this.#t=!!(t&yn.DISPLAY),this.#e=!!(t&yn.PRINT),this.name=e,this.intent=i,this.usage=s,this.rbGroups=a}get visible(){if(this.#n)return this.#i;if(!this.#i)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Ea&&We("Internal method `_setVisible` called."),this.#n=i,this.#i=e}}class FA{#t=null;#e=new Map;#n=null;#i=null;constructor(t,e=yn.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#i=t.order;for(const i of t.groups)this.#e.set(i.id,new zA(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Ea,!1);for(const i of t.on)this.#e.get(i)._setVisible(Ea,!0);for(const i of t.off)this.#e.get(i)._setVisible(Ea,!1);this.#n=this.getHash()}}#a(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let s=1;s<e;s++){const a=t[s];let o;if(Array.isArray(a))o=this.#a(a);else if(this.#e.has(a))o=this.#e.get(a).visible;else return ae(`Optional content group not found: ${a}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return Gu("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ae(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#a(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ae(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ae(`Unknown optional content policy ${t.policy}.`),!0}return ae(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const s=this.#e.get(t);if(!s){ae(`Optional content group not found: ${t}`);return}if(i&&e&&s.rbGroups.length)for(const a of s.rbGroups)for(const o of a)o!==t&&this.#e.get(o)?._setVisible(Ea,!1,!0);s._setVisible(Ea,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const s of t){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const a=this.#e.get(s);if(a)switch(i){case"ON":this.setVisibility(s,!0,e);break;case"OFF":this.setVisibility(s,!1,e);break;case"Toggle":this.setVisibility(s,!a.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#e.size?this.#i?this.#i.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new wy;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class PA{constructor(t,{disableRange:e=!1,disableStream:i=!1}){xe(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:a,progressiveDone:o,contentDispositionFilename:u}=t;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=u,a?.length>0){const h=a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!i,this._isRangeSupported=!e,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],t.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),t.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),t.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),t.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),t.transportReady()}_onReceiveData({begin:t,chunk:e}){const i=e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength?e.buffer:new Uint8Array(e).buffer;if(t===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(a){return a._begin!==t?!1:(a._enqueue(i),!0)});xe(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(t){t.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:t.loaded}):this._fullRequestReader?.onProgress?.({loaded:t.loaded,total:t.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(t){const e=this._rangeReaders.indexOf(t);e>=0&&this._rangeReaders.splice(e,1)}getFullReader(){xe(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const t=this._queuedChunks;return this._queuedChunks=null,new UA(this,t,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new HA(this,t,e);return this._pdfDataRangeTransport.requestDataRange(t,e),this._rangeReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeReaders.slice(0))e.cancel(t);this._pdfDataRangeTransport.abort()}}class UA{constructor(t,e,i=!1,s=null){this._stream=t,this._done=i||!1,this._filename=Df(s)?s:null,this._queuedChunks=e||[],this._loaded=0;for(const a of this._queuedChunks)this._loaded+=a.byteLength;this._requests=[],this._headersReady=Promise.resolve(),t._fullRequestReader=this,this.onProgress=null}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class HA{constructor(t,e,i){this._stream=t,this._begin=e,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function jA(g){let t=!0,e=i("filename\\*","i").exec(g);if(e){e=e[1];let f=u(e);return f=unescape(f),f=h(f),f=d(f),a(f)}if(e=o(g),e){const f=d(e);return a(f)}if(e=i("filename","i").exec(g),e){e=e[1];let f=u(e);return f=d(f),a(f)}function i(f,p){return new RegExp("(?:^|;)\\s*"+f+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function s(f,p){if(f){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const v=new TextDecoder(f,{fatal:!0}),A=Ko(p);p=v.decode(A),t=!1}catch{}}return p}function a(f){return t&&/[\x80-\xff]/.test(f)&&(f=s("utf-8",f),t&&(f=s("iso-8859-1",f))),f}function o(f){const p=[];let v;const A=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(v=A.exec(f))!==null;){let[,w,b,_]=v;if(w=parseInt(w,10),w in p){if(w===0)break;continue}p[w]=[b,_]}const C=[];for(let w=0;w<p.length&&w in p;++w){let[b,_]=p[w];_=u(_),b&&(_=unescape(_),w===0&&(_=h(_))),C.push(_)}return C.join("")}function u(f){if(f.startsWith('"')){const p=f.slice(1).split('\\"');for(let v=0;v<p.length;++v){const A=p[v].indexOf('"');A!==-1&&(p[v]=p[v].slice(0,A),p.length=v+1),p[v]=p[v].replaceAll(/\\(.)/g,"$1")}f=p.join('"')}return f}function h(f){const p=f.indexOf("'");if(p===-1)return f;const v=f.slice(0,p),C=f.slice(p+1).replace(/^[^']*'/,"");return s(v,C)}function d(f){return!f.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(f)?f:f.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,v,A,C){if(A==="q"||A==="Q")return C=C.replaceAll("_"," "),C=C.replaceAll(/=([0-9a-fA-F]{2})/g,function(w,b){return String.fromCharCode(parseInt(b,16))}),s(v,C);try{C=atob(C)}catch{}return s(v,C)})}return""}function Ry(g,t){const e=new Headers;if(!g||!t||typeof t!="object")return e;for(const i in t){const s=t[i];s!==void 0&&e.append(i,s)}return e}function Yu(g){return URL.parse(g)?.origin??null}function Ny({responseHeaders:g,isHttp:t,rangeChunkSize:e,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(g.get("Content-Length"),10);return!Number.isInteger(a)||(s.suggestedLength=a,a<=2*e)||i||!t||g.get("Accept-Ranges")!=="bytes"||(g.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function Oy(g){const t=g.get("Content-Disposition");if(t){let e=jA(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Df(e))return e}return null}function el(g,t){return new Nu(`Unexpected server response (${g}) while retrieving PDF "${t}".`,g,g===404||g===0&&t.startsWith("file:"))}function ky(g){return g===200||g===206}function My(g,t,e){return{method:"GET",headers:g,signal:e.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function Ly(g){return g instanceof Uint8Array?g.buffer:g instanceof ArrayBuffer?g:(ae(`getArrayBuffer - unexpected data format: ${g}`),new Uint8Array(g).buffer)}class qA{_responseOrigin=null;constructor(t){this.source=t,this.isHttp=/^https?:/i.test(t.url),this.headers=Ry(this.isHttp,t.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return xe(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new GA(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new VA(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class GA{constructor(t){this._stream=t,this._reader=null,this._loaded=0,this._filename=null;const e=t.source;this._withCredentials=e.withCredentials||!1,this._contentLength=e.length,this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange;const i=new Headers(t.headers),s=e.url;fetch(s,My(i,this._withCredentials,this._abortController)).then(a=>{if(t._responseOrigin=Yu(a.url),!ky(a.status))throw el(a.status,s);this._reader=a.body.getReader(),this._headersCapability.resolve();const o=a.headers,{allowRangeRequests:u,suggestedLength:h}=Ny({responseHeaders:o,isHttp:t.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=u,this._contentLength=h||this._contentLength,this._filename=Oy(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new or("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Ly(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class VA{constructor(t,e,i){this._stream=t,this._reader=null,this._loaded=0;const s=t.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const a=new Headers(t.headers);a.append("Range",`bytes=${e}-${i-1}`);const o=s.url;fetch(o,My(a,this._withCredentials,this._abortController)).then(u=>{const h=Yu(u.url);if(h!==t._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${t._responseOrigin}".`);if(!ky(u.status))throw el(u.status,o);this._readCapability.resolve(),this._reader=u.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Ly(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const gd=200,md=206;function XA(g){const t=g.response;return typeof t!="string"?t:Ko(t).buffer}class YA{_responseOrigin=null;constructor({url:t,httpHeaders:e,withCredentials:i}){this.url=t,this.isHttp=/^https?:/i.test(t),this.headers=Ry(this.isHttp,e),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(t){const e=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:e};e.open("GET",this.url),e.withCredentials=this.withCredentials;for(const[a,o]of this.headers)e.setRequestHeader(a,o);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),s.expectedStatus=md):s.expectedStatus=gd,e.responseType="arraybuffer",xe(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>{t.onError(e.status)},e.onreadystatechange=this.onStateChange.bind(this,i),e.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=t.onHeadersReceived,s.onDone=t.onDone,s.onError=t.onError,s.onProgress=t.onProgress,e.send(null),i}onProgress(t,e){const i=this.pendingRequests[t];i&&i.onProgress?.(e)}onStateChange(t,e){const i=this.pendingRequests[t];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(t in this.pendingRequests))return;if(delete this.pendingRequests[t],s.status===0&&this.isHttp){i.onError(s.status);return}const a=s.status||gd;if(!(a===gd&&i.expectedStatus===md)&&a!==i.expectedStatus){i.onError(s.status);return}const u=XA(s);if(a===md){const h=s.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?i.onDone({begin:parseInt(d[1],10),chunk:u}):(ae('Missing or invalid "Content-Range" header.'),i.onError(0))}else u?i.onDone({begin:0,chunk:u}):i.onError(s.status)}getRequestXhr(t){return this.pendingRequests[t].xhr}isPendingRequest(t){return t in this.pendingRequests}abortRequest(t){const e=this.pendingRequests[t].xhr;delete this.pendingRequests[t],e.abort()}}class WA{constructor(t){this._source=t,this._manager=new YA(t),this._rangeChunkSize=t.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(t){const e=this._rangeRequestReaders.indexOf(t);e>=0&&this._rangeRequestReaders.splice(e,1)}getFullReader(){return xe(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new ZA(this._manager,this._source),this._fullRequestReader}getRangeReader(t,e){const i=new KA(this._manager,t,e);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class ZA{constructor(t,e){this._manager=t,this._url=e.url,this._fullRequestId=t.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=e.disableRange||!1,this._contentLength=e.length,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const t=this._fullRequestId,e=this._manager.getRequestXhr(t);this._manager._responseOrigin=Yu(e.responseURL);const i=e.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(u=>{const[h,...d]=u.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:a,suggestedLength:o}=Ny({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});a&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=Oy(s),this._isRangeSupported&&this._manager.abortRequest(t),this._headersCapability.resolve()}_onDone(t){if(t&&(this._requests.length>0?this._requests.shift().resolve({value:t.chunk,done:!1}):this._cachedChunks.push(t.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(t){this._storedError=el(t,this._url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class KA{constructor(t,e,i){this._manager=t,this._url=t.url,this._requestId=t.request({begin:e,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const t=Yu(this._manager.getRequestXhr(this._requestId)?.responseURL);t!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${t}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(t){const e=t.chunk;this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunk=e,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(t){this._storedError??=el(t,this._url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(t){this.isStreamingSupported||this.onProgress?.({loaded:t.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const $A=/^[a-z][a-z0-9\-+.]+:/i;function QA(g){if($A.test(g))return new URL(g);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(g))}class JA{constructor(t){this.source=t,this.url=QA(t.url),xe(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return xe(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new t_(this),this._fullRequestReader}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new e_(this,t,e);return this._rangeRequestReaders.push(i),i}cancelAllRequests(t){this._fullRequestReader?.cancel(t);for(const e of this._rangeRequestReaders.slice(0))e.cancel(t)}}class t_{constructor(t){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null;const e=t.source;this._contentLength=e.length,this._loaded=0,this._filename=null,this._disableRange=e.disableRange||!1,this._rangeChunkSize=e.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=el(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new or("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class e_{constructor(t,e,i){this._url=t.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=t.source;this._isStreamingSupported=!s.disableStream;const a=process.getBuiltinModule("fs");this._setReadableStream(a.createReadStream(this._url,{start:e,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const t=this._readableStream.read();return t===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(t).buffer,done:!1})}cancel(t){if(!this._readableStream){this._error(t);return}this._readableStream.destroy(t)}_error(t){this._storedError=t,this._readCapability.resolve()}_setReadableStream(t){this._readableStream=t,t.on("readable",()=>{this._readCapability.resolve()}),t.on("end",()=>{t.destroy(),this._done=!0,this._readCapability.resolve()}),t.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const Mo=Symbol("INITIAL_DATA");class By{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Mo}}get(t,e=null){if(e){const s=this.#e(t);return s.promise.then(()=>e(s.data)),null}const i=this.#t[t];if(!i||i.data===Mo)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Mo}delete(t){const e=this.#t[t];return!e||e.data===Mo?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Mo&&(yield[t,e])}}}const i_=1e5,c0=30;class bn{#t=Promise.withResolvers();#e=null;#n=!1;#i=!!globalThis.FontInspector?.enabled;#a=null;#r=null;#s=0;#o=0;#u=null;#l=null;#d=0;#c=0;#f=Object.create(null);#m=[];#g=null;#h=[];#p=new WeakMap;#v=null;static#b=new Map;static#y=new Map;static#x=new WeakMap;static#E=null;static#_=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#g=t;else if(typeof t=="object")this.#g=new ReadableStream({start(h){h.enqueue(t),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#c=i.scale*as.pixelRatio,this.#d=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:a,pageX:o,pageY:u}=i.rawDims;this.#v=[1,0,0,-1,-o,u+a],this.#o=s,this.#s=a,bn.#R(),e.style.setProperty("--min-font-size",bn.#E),Nr(e,i),this.#t.promise.finally(()=>{bn.#_.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Ti.platform;return oe(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#u.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#a??=e.lang,Object.assign(this.#f,e.styles),this.#T(e.items),t()},this.#t.reject)};return this.#u=this.#g.getReader(),bn.#_.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*as.pixelRatio,s=t.rotation;if(s!==this.#d&&(e?.(),this.#d=s,Nr(this.#l,{rotation:s})),i!==this.#c){e?.(),this.#c=i;const a={div:null,properties:null,ctx:bn.#N(this.#a)};for(const o of this.#h)a.properties=this.#p.get(o),a.div=o,this.#S(a)}}cancel(){const t=new or("TextLayer task cancelled.");this.#u?.cancel(t).catch(()=>{}),this.#u=null,this.#t.reject(t)}get textDivs(){return this.#h}get textContentItemsStr(){return this.#m}#T(t){if(this.#n)return;this.#r.ctx??=bn.#N(this.#a);const e=this.#h,i=this.#m;for(const s of t){if(e.length>i_){ae("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const a=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),s.id&&this.#e.setAttribute("id",`${s.id}`),a.append(this.#e)}else s.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(s.str),this.#A(s)}}#A(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#h.push(e);const s=Pt.transform(this.#v,t.transform);let a=Math.atan2(s[1],s[0]);const o=this.#f[t.fontName];o.vertical&&(a+=Math.PI/2);let u=this.#i&&o.fontSubstitution||o.fontFamily;u=bn.fontFamilyMap.get(u)||u;const h=Math.hypot(s[2],s[3]),d=h*bn.#z(u,o,this.#a);let f,p;a===0?(f=s[4],p=s[5]-d):(f=s[4]+d*Math.sin(a),p=s[5]-d*Math.cos(a));const v=e.style;v.left=`${(100*f/this.#o).toFixed(2)}%`,v.top=`${(100*p/this.#s).toFixed(2)}%`,v.setProperty("--font-height",`${h.toFixed(2)}px`),v.fontFamily=u,i.fontSize=h,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#i&&(e.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),a!==0&&(i.angle=a*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const C=Math.abs(t.transform[0]),w=Math.abs(t.transform[3]);C!==w&&Math.max(C,w)/Math.min(C,w)>1.5&&(A=!0)}if(A&&(i.canvasWidth=o.vertical?t.height:t.width),this.#p.set(e,i),this.#r.div=e,this.#r.properties=i,this.#S(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),this.#e.append(C)}}#S(t){const{div:e,properties:i,ctx:s}=t,{style:a}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:o}=a,{canvasWidth:u,fontSize:h}=i;bn.#D(s,h*this.#c,o);const{width:d}=s.measureText(e.textContent);d>0&&a.setProperty("--scale-x",u*this.#c/d)}i.angle!==0&&a.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#_.size>0)){this.#b.clear();for(const{canvas:t}of this.#y.values())t.remove();this.#y.clear()}}static#N(t=null){let e=this.#y.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#y.set(t,e),this.#x.set(e,{size:0,family:""})}return e}static#D(t,e,i){const s=this.#x.get(t);e===s.size&&i===s.family||(t.font=`${e}px ${i}`,s.size=e,s.family=i)}static#R(){if(this.#E!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#E=t.getBoundingClientRect().height,t.remove()}static#z(t,e,i){const s=this.#b.get(t);if(s)return s;const a=this.#N(i);a.canvas.width=a.canvas.height=c0,this.#D(a,c0,t);const o=a.measureText(""),u=o.fontBoundingBoxAscent,h=Math.abs(o.fontBoundingBoxDescent);a.canvas.width=a.canvas.height=0;let d=.8;return u?d=u/(u+h):(Ti.platform.isFirefox&&ae("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?d=e.ascent:e.descent&&(d=1+e.descent)),this.#b.set(t,d),d}}const n_=100;function Iy(g={}){typeof g=="string"||g instanceof URL?g={url:g}:(g instanceof ArrayBuffer||ArrayBuffer.isView(g))&&(g={data:g});const t=new Bf,{docId:e}=t,i=g.url?hA(g.url):null,s=g.data?cA(g.data):null,a=g.httpHeaders||null,o=g.withCredentials===!0,u=g.password??null,h=g.range instanceof zy?g.range:null,d=Number.isInteger(g.rangeChunkSize)&&g.rangeChunkSize>0?g.rangeChunkSize:2**16;let f=g.worker instanceof Xo?g.worker:null;const p=g.verbosity,v=typeof g.docBaseUrl=="string"&&!Vu(g.docBaseUrl)?g.docBaseUrl:null,A=pu(g.cMapUrl),C=g.cMapPacked!==!1,w=g.CMapReaderFactory||(Ki?bA:$v),b=pu(g.iccUrl),_=pu(g.standardFontDataUrl),x=g.StandardFontDataFactory||(Ki?AA:Qv),D=pu(g.wasmUrl),M=g.WasmFactory||(Ki?_A:Jv),T=g.stopAtErrors!==!0,O=Number.isInteger(g.maxImageSize)&&g.maxImageSize>-1?g.maxImageSize:-1,k=g.isEvalSupported!==!1,z=typeof g.isOffscreenCanvasSupported=="boolean"?g.isOffscreenCanvasSupported:!Ki,B=typeof g.isImageDecoderSupported=="boolean"?g.isImageDecoderSupported:!Ki&&(Ti.platform.isFirefox||!globalThis.chrome),H=Number.isInteger(g.canvasMaxAreaInBytes)?g.canvasMaxAreaInBytes:-1,V=typeof g.disableFontFace=="boolean"?g.disableFontFace:Ki,Z=g.fontExtraProperties===!0,rt=g.enableXfa===!0,ft=g.ownerDocument||globalThis.document,mt=g.disableRange===!0,G=g.disableStream===!0,W=g.disableAutoFetch===!0,st=g.pdfBug===!0,bt=g.CanvasFactory||(Ki?yA:gA),Nt=g.FilterFactory||(Ki?vA:mA),j=g.enableHWA===!0,$=g.useWasm!==!1,gt=h?h.length:g.length??NaN,yt=typeof g.useSystemFonts=="boolean"?g.useSystemFonts:!Ki&&!V,Dt=typeof g.useWorkerFetch=="boolean"?g.useWorkerFetch:!!(w===$v&&x===Qv&&M===Jv&&A&&_&&D&&Po(A,document.baseURI)&&Po(_,document.baseURI)&&Po(D,document.baseURI)),zt=null;z1(p);const kt={canvasFactory:new bt({ownerDocument:ft,enableHWA:j}),filterFactory:new Nt({docId:e,ownerDocument:ft}),cMapReaderFactory:Dt?null:new w({baseUrl:A,isCompressed:C}),standardFontDataFactory:Dt?null:new x({baseUrl:_}),wasmFactory:Dt?null:new M({baseUrl:D})};f||(f=Xo.create({verbosity:p,port:La.workerPort}),t._worker=f);const Lt={docId:e,apiVersion:"5.4.530",data:s,password:u,disableAutoFetch:W,rangeChunkSize:d,length:gt,docBaseUrl:v,enableXfa:rt,evaluatorOptions:{maxImageSize:O,disableFontFace:V,ignoreErrors:T,isEvalSupported:k,isOffscreenCanvasSupported:z,isImageDecoderSupported:B,canvasMaxAreaInBytes:H,fontExtraProperties:Z,useSystemFonts:yt,useWasm:$,useWorkerFetch:Dt,cMapUrl:A,iccUrl:b,standardFontDataUrl:_,wasmUrl:D}},Gt={ownerDocument:ft,pdfBug:st,styleElement:zt,loadingParams:{disableAutoFetch:W,enableXfa:rt}};return f.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const ye=f.messageHandler.sendWithPromise("GetDocRequest",Lt,s?[s.buffer]:null);let Yt;if(h)Yt=new PA(h,{disableRange:mt,disableStream:G});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");const ee=Po(i)?qA:Ki?JA:WA;Yt=new ee({url:i,length:gt,httpHeaders:a,withCredentials:o,rangeChunkSize:d,disableRange:mt,disableStream:G})}return ye.then(ee=>{if(t.destroyed)throw new Error("Loading aborted");if(f.destroyed)throw new Error("Worker was destroyed");const ie=new Uo(e,ee,f.port),ne=new a_(ie,t,Yt,Gt,kt,j);t._transport=ne,ie.send("Ready",null)})}).catch(t._capability.reject),t}class Bf{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Bf.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class zy{#t=Promise.withResolvers();#e=[];#n=[];#i=[];#a=[];constructor(t,e,i=!1,s=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=s}addRangeListener(t){this.#a.push(t)}addProgressListener(t){this.#i.push(t)}addProgressiveReadListener(t){this.#n.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#a)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#i)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#n)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){We("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class s_{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return oe(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class r_{#t=!1;constructor(t,e,i,s=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=s?new Gv:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new By,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:a=!1}={}){return new Qo({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:s,dontFlip:a})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return oe(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:s="display",annotationMode:a=nr.ENABLE,transform:o=null,background:u=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:f=null,printAnnotationStorage:p=null,isEditing:v=!1,recordOperations:A=!1,operationsFilter:C=null}){this._stats?.time("Overall");const w=this._transport.getRenderingIntent(s,a,p,v),{renderingIntent:b,cacheKey:_}=w;this.#t=!1,h||=this._transport.getOptionalContentConfig(b);let x=this._intentStates.get(_);x||(x=Object.create(null),this._intentStates.set(_,x)),x.streamReaderCancelTimeout&&(clearTimeout(x.streamReaderCancelTimeout),x.streamReaderCancelTimeout=null);const D=!!(b&yn.PRINT);x.displayReadyCapability||(x.displayReadyCapability=Promise.withResolvers(),x.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(w));const M=!!(this._pdfBug&&globalThis.StepperManager?.enabled),T=!this.recordedBBoxes&&(A||M),O=B=>{if(x.renderTasks.delete(k),T){const H=k.gfx?.dependencyTracker.take();H&&(k.stepper&&k.stepper.setOperatorBBoxes(H,k.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=H))}D&&(this.#t=!0),this.#e(),B?(k.capability.reject(B),this._abortOperatorList({intentState:x,reason:B instanceof Error?B:new Error(B)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},k=new Na({callback:O,params:{canvas:e,canvasContext:t,dependencyTracker:T?new EA(e,x.operatorList.length,M):null,viewport:i,transform:o,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:x.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!D,pdfBug:this._pdfBug,pageColors:f,enableHWA:this._transport.enableHWA,operationsFilter:C});(x.renderTasks||=new Set).add(k);const z=k.task;return Promise.all([x.displayReadyCapability.promise,h]).then(([B,H])=>{if(this.destroyed){O();return}if(this._stats?.time("Rendering"),!(H.renderingIntent&b))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");k.initializeGraphics({transparency:B,optionalContentConfig:H}),k.operatorListChanged()}).catch(O),z}getOperatorList({intent:t="display",annotationMode:e=nr.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){function a(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(h))}const o=this._transport.getRenderingIntent(t,e,i,s,!0);let u=this._intentStates.get(o.cacheKey);u||(u=Object.create(null),this._intentStates.set(o.cacheKey,u));let h;return u.opListReadCapability||(h=Object.create(null),h.operatorListChanged=a,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(h),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Vo.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,s){function a(){o.read().then(function({value:h,done:d}){if(d){i(u);return}u.lang??=h.lang,Object.assign(u.styles,h.styles),u.items.push(...h.items),a()},s)}const o=e.getReader(),u={items:[],styles:Object.create(null),lang:null};a()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#e();return t&&e&&(this._stats&&=new Gv),e}#e(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,s=t.length;i<s;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#e()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:s}){const{map:a,transfer:o}=i,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:a,modifiedIds:s},o).getReader(),d=this._intentStates.get(e);d.streamReader=h;const f=()=>{h.read().then(({value:p,done:v})=>{if(v){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,d),f())},p=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const v of d.renderTasks)v.operatorListChanged();this.#e()}if(d.displayReadyCapability)d.displayReadyCapability.reject(p);else if(d.opListReadCapability)d.opListReadCapability.reject(p);else throw p}})};f()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Tf){let s=n_;e.extraDelay>0&&e.extraDelay<1e3&&(s+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},s);return}}if(t.streamReader.cancel(new or(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[s,a]of this._intentStates)if(a===t){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var sr,Vn,Ds,Tr,Hu,Dr,Rr,Qi,Cu,Fy,Py,Ho,Ia,Tu;const ni=class ni{constructor({name:t=null,port:e=null,verbosity:i=F1()}={}){Jn(this,Qi);Jn(this,sr,Promise.withResolvers());Jn(this,Vn,null);Jn(this,Ds,null);Jn(this,Tr,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(ii(ni,Rr).has(e))throw new Error("Cannot use more than one PDFWorker per port.");ii(ni,Rr).set(e,this),ts(this,Qi,Fy).call(this,e)}else ts(this,Qi,Py).call(this)}get promise(){return ii(this,sr).promise}get port(){return ii(this,Ds)}get messageHandler(){return ii(this,Vn)}destroy(){this.destroyed=!0,ii(this,Tr)?.terminate(),on(this,Tr,null),ii(ni,Rr).delete(ii(this,Ds)),on(this,Ds,null),ii(this,Vn)?.destroy(),on(this,Vn,null)}static create(t){const e=ii(this,Rr).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new ni(t)}static get workerSrc(){if(La.workerSrc)return La.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return oe(this,"_setupFakeWorkerGlobal",(async()=>ii(this,Ia,Tu)?ii(this,Ia,Tu):(await import(this.workerSrc)).WorkerMessageHandler)())}};sr=new WeakMap,Vn=new WeakMap,Ds=new WeakMap,Tr=new WeakMap,Hu=new WeakMap,Dr=new WeakMap,Rr=new WeakMap,Qi=new WeakSet,Cu=function(){ii(this,sr).resolve(),ii(this,Vn).send("configure",{verbosity:this.verbosity})},Fy=function(t){on(this,Ds,t),on(this,Vn,new Uo("main","worker",t)),ii(this,Vn).on("ready",()=>{}),ts(this,Qi,Cu).call(this)},Py=function(){if(ii(ni,Dr)||ii(ni,Ia,Tu)){ts(this,Qi,Ho).call(this);return}let{workerSrc:t}=ni;try{ni._isSameOrigin(window.location,t)||(t=ni._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Uo("main","worker",e),s=()=>{a.abort(),i.destroy(),e.terminate(),this.destroyed?ii(this,sr).reject(new Error("Worker was destroyed")):ts(this,Qi,Ho).call(this)},a=new AbortController;e.addEventListener("error",()=>{ii(this,Tr)||s()},{signal:a.signal}),i.on("test",u=>{if(a.abort(),this.destroyed||!u){s();return}on(this,Vn,i),on(this,Ds,e),on(this,Tr,e),ts(this,Qi,Cu).call(this)}),i.on("ready",u=>{if(a.abort(),this.destroyed){s();return}try{o()}catch{ts(this,Qi,Ho).call(this)}});const o=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};o();return}catch{Gu("The worker has been disabled.")}ts(this,Qi,Ho).call(this)},Ho=function(){ii(ni,Dr)||(ae("Setting up fake worker."),on(ni,Dr,!0)),ni._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){ii(this,sr).reject(new Error("Worker was destroyed"));return}const e=new pA;on(this,Ds,e);const i=`fake${Ov(ni,Hu)._++}`,s=new Uo(i+"_worker",i,e);t.setup(s,e),on(this,Vn,new Uo(i,i+"_worker",e)),ts(this,Qi,Cu).call(this)}).catch(t=>{ii(this,sr).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},Ia=new WeakSet,Tu=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Jn(ni,Ia),Jn(ni,Hu,0),Jn(ni,Dr,!1),Jn(ni,Rr,new WeakMap),Ki&&(on(ni,Dr,!0),La.workerSrc||="./pdf.worker.mjs"),ni._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const s=new URL(e,i);return i.origin===s.origin},ni._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},ni.fromPort=t=>{if(K1("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return ni.create(t)};let Xo=ni;class a_{#t=new Map;#e=new Map;#n=new Map;#i=new Map;#a=null;constructor(t,e,i,s,a,o){this.messageHandler=t,this.loadingTask=e,this.commonObjs=new By,this.fontLoader=new oA({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=a.canvasFactory,this.filterFactory=a.filterFactory,this.cMapReaderFactory=a.cMapReaderFactory,this.standardFontDataFactory=a.standardFontDataFactory,this.wasmFactory=a.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=o,this.setupMessageHandler()}#r(t,e=null){const i=this.#t.get(t);if(i)return i;const s=this.messageHandler.sendWithPromise(t,e);return this.#t.set(t,s),s}get annotationStorage(){return oe(this,"annotationStorage",new Of)}getRenderingIntent(t,e=nr.ENABLE,i=null,s=!1,a=!1){let o=yn.DISPLAY,u=ff;switch(t){case"any":o=yn.ANY;break;case"display":break;case"print":o=yn.PRINT;break;default:ae(`getRenderingIntent - invalid intent: ${t}`)}const h=o&yn.PRINT&&i instanceof Ey?i:this.annotationStorage;switch(e){case nr.DISABLE:o+=yn.ANNOTATIONS_DISABLE;break;case nr.ENABLE:break;case nr.ENABLE_FORMS:o+=yn.ANNOTATIONS_FORMS;break;case nr.ENABLE_STORAGE:o+=yn.ANNOTATIONS_STORAGE,u=h.serializable;break;default:ae(`getRenderingIntent - invalid annotationMode: ${e}`)}s&&(o+=yn.IS_EDITING),a&&(o+=yn.OPLIST);const{ids:d,hash:f}=h.modifiedIds,p=[o,u.hash,f];return{renderingIntent:o,cacheKey:p.join("_"),annotationStorageSerializable:u,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#e.values())t.push(i._destroy());this.#e.clear(),this.#n.clear(),this.#i.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(),bn.cleanup(),this._networkStream?.cancelAllRequests(new or("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,s)=>{xe(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=a=>{this._lastProgress={loaded:a.loaded,total:a.total}},s.onPull=()=>{this._fullReader.read().then(function({value:a,done:o}){if(o){s.close();return}xe(a instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{s.error(a)})},s.onCancel=a=>{this._fullReader.cancel(a),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),t.on("ReaderHeadersReady",async i=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:a,contentLength:o}=this._fullReader;return(!s||!a)&&(this._lastProgress&&e.onProgress?.(this._lastProgress),this._fullReader.onProgress=u=>{e.onProgress?.({loaded:u.loaded,total:u.total})}),{isStreamingSupported:s,isRangeSupported:a,contentLength:o}}),t.on("GetRangeReader",(i,s)=>{xe(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const a=this._networkStream.getRangeReader(i.begin,i.end);if(!a){s.close();return}s.onPull=()=>{a.read().then(function({value:o,done:u}){if(u){s.close();return}xe(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{a.cancel(o),s.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new s_(i,this))}),t.on("DocException",i=>{e._capability.reject(un(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw un(i);const s=a=>{a instanceof Error?this.#a.reject(a):this.#a.resolve({password:a})};e.onPassword(s,i.code)}catch(s){this.#a.reject(s)}return this.#a.promise}),t.on("DataLoaded",i=>{e.onProgress?.({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#e.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,s,a])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":if("error"in a){const p=a.error;ae(`Error during font loading: ${p}`),this.commonObjs.resolve(i,p);break}const o=new Ge(a),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(p,v)=>globalThis.FontInspector.fontAdded(p,v):null,h=new lA(o,u,a.extra,a.charProcOperatorList);this.fontLoader.bind(h).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(i,h)});break;case"CopyLocalImage":const{imageRef:d}=a;xe(d,"The imageRef must be defined.");for(const p of this.#e.values())for(const[,v]of p.objs)if(v?.ref===d)return v.dataLen?(this.commonObjs.resolve(i,structuredClone(v)),v.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new uA(a));break;case"Image":this.commonObjs.resolve(i,a);break;case"Pattern":const f=new Ni(a);this.commonObjs.resolve(i,f.getIR());break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),t.on("obj",([i,s,a,o])=>{if(this.destroyed)return;const u=this.#e.get(s);if(!u.objs.has(i)){if(u._intentStates.size===0){o?.bitmap?.close();return}switch(a){case"Image":case"Pattern":u.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${a}`)}}}),t.on("DocProgress",i=>{this.destroyed||e.onProgress?.({loaded:i.loaded,total:i.total})}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[i.type];if(!s)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ae("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#n.get(e);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:e}).then(a=>{if(this.destroyed)throw new Error("Transport destroyed");a.refStr&&this.#i.set(a.refStr,t);const o=new r_(e,a,this,this._params.pdfBug);return this.#e.set(e,o),o});return this.#n.set(e,s),s}getPageIndex(t){return pf(t)?this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:e})}getFieldObjects(){return this.#r("GetFieldObjects")}hasJSActions(){return this.#r("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#r("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#r("GetOptionalContentConfig").then(e=>new FA(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#t.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(s=>({info:s[0],metadata:s[1]?new IA(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null,hasStructTree:s[2]}));return this.#t.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#e.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#t.clear(),this.filterFactory.destroy(!0),bn.cleanup()}}cachedPageNumber(t){if(!pf(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`;return this.#i.get(e)??null}}class o_{#t=null;onContinue=null;onError=null;constructor(t){this.#t=t}get promise(){return this.#t.capability.promise}cancel(t=0){this.#t.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#t.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this.#t;return t.form||t.canvas&&e?.size>0}}class Na{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:s,annotationCanvasMap:a,operatorList:o,pageIndex:u,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:f=!1,pdfBug:p=!1,pageColors:v=null,enableHWA:A=!1,operationsFilter:C=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=a,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=u,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=p,this.pageColors=v,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new o_(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=A,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=C}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(Na.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");Na.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:s,background:a,dependencyTracker:o}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Ma(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:s,viewport:i,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),Na.#e.delete(this._canvas),t||=new Tf(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),Na.#e.delete(this._canvas),this.callback())))}}const l_="5.4.530",u_="50cc4adac";class Ln{#t=null;#e=null;#n;#i=null;#a=!1;#r=!1;#s=null;#o;#u=null;#l=null;static#d=null;static get _keyboardManager(){return oe(this,"_keyboardManager",new tl([[["Escape","mac+Escape"],Ln.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ln.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ln.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ln.prototype._moveToPrevious],[["Home","mac+Home"],Ln.prototype._moveToBeginning],[["End","mac+End"],Ln.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#s=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#n=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Ln.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#s&&(t.ariaControls=`${this.#s.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#g.bind(this),{signal:e}),t.addEventListener("keydown",this.#m.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#n,t.append(i),t}renderMainDropdown(){const t=this.#i=this.#c();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#c(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",In,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#s&&(t.id=`${this.#s.id}_colorpicker_dropdown`);for(const[i,s]of this.#l.highlightColors){const a=document.createElement("button");a.tabIndex="0",a.role="option",a.setAttribute("data-color",s),a.title=i,a.setAttribute("data-l10n-id",Ln.#d[i]);const o=document.createElement("span");a.append(o),o.className="swatch",o.style.backgroundColor=s,a.ariaSelected=s===this.#n,a.addEventListener("click",this.#f.bind(this,s),{signal:e}),t.append(a)}return t.addEventListener("keydown",this.#m.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:Se.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#g(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#g(t);return}if(t.target===this.#t){this.#i.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#i?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#g(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#g(t);return}this.#i.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#g(t);return}this.#i.lastElementChild?.focus()}#m(t){Ln._keyboardManager.exec(this,t)}#g(t){if(this.#p){this.hideDropdown();return}if(this.#a=t.detail===0,this.#u||(this.#u=new AbortController,window.addEventListener("pointerdown",this.#h.bind(this),{signal:this.#l.combinedSignal(this.#u)})),this.#t.ariaExpanded="true",this.#i){this.#i.classList.remove("hidden");return}const e=this.#i=this.#c();this.#t.append(e)}#h(t){this.#i?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#i?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#u?.abort(),this.#u=null}get#p(){return this.#i&&!this.#i.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#s?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#a})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#i)return;const e=this.#l.highlightColors.values();for(const i of this.#i.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#i?.remove(),this.#i=null}}class Yo{#t=null;#e=null;#n=null;static#i=null;constructor(t){this.#e=t,this.#n=t._uiManager,Yo.#i||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:i}=this.#e,s=this.#t=document.createElement("input");return s.type="color",s.value=i||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",Yo.#i[t]),s.addEventListener("input",()=>{this.#n.updateParams(e,s.value)},{signal:this.#n._signal}),s}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function d0(g){return Math.floor(Math.max(0,Math.min(1,g))*255).toString(16).padStart(2,"0")}function Lo(g){return Math.max(0,Math.min(255,255*g))}class f0{static CMYK_G([t,e,i,s]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+s)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Lo(t),[t,t,t]}static G_HTML([t]){const e=d0(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Lo)}static RGB_HTML(t){return`#${t.map(d0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,s]){return["RGB",1-Math.min(1,t+s),1-Math.min(1,i+s),1-Math.min(1,e+s)]}static CMYK_rgb([t,e,i,s]){return[Lo(1-Math.min(1,t+s)),Lo(1-Math.min(1,i+s)),Lo(1-Math.min(1,e+s))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const s=1-t,a=1-e,o=1-i,u=Math.min(s,a,o);return["CMYK",s,a,o,u]}}class h_{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${t}px`),s.setAttribute("height",`${e}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${t} ${e}`),s}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){We("Abstract method `_createSVG` called.")}}class ku extends h_{_createSVG(t){return document.createElementNS(Cs,t)}}const c_=9,Or=new WeakSet,d_=new Date().getTimezoneOffset()*60*1e3;class vd{static create(t){switch(t.data.annotationType){case Si.LINK:return new If(t);case Si.TEXT:return new p_(t);case Si.WIDGET:switch(t.data.fieldType){case"Tx":return new g_(t);case"Btn":return t.data.radioButton?new Uy(t):t.data.checkBox?new v_(t):new y_(t);case"Ch":return new b_(t);case"Sig":return new m_(t)}return new Mr(t);case Si.POPUP:return new vf(t);case Si.FREETEXT:return new Hy(t);case Si.LINE:return new __(t);case Si.SQUARE:return new w_(t);case Si.CIRCLE:return new E_(t);case Si.POLYLINE:return new jy(t);case Si.CARET:return new x_(t);case Si.INK:return new zf(t);case Si.POLYGON:return new S_(t);case Si.HIGHLIGHT:return new qy(t);case Si.UNDERLINE:return new C_(t);case Si.SQUIGGLY:return new T_(t);case Si.STRIKEOUT:return new D_(t);case Si.STAMP:return new Gy(t);case Si.FILEATTACHMENT:return new R_(t);default:return new oi(t)}}}class oi{#t=null;#e=!1;#n=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return oi._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:s}=this.data;let a=-1/0,o=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>o?(o=e[u+1],a=e[u+2]):e[u+1]===o&&(a=Math.max(a,e[u+2]));return[a,o]}if(i?.length>=1){for(const u of i)for(let h=0,d=u.length;h<d;h+=2)u[h+1]>o?(o=u[h+1],a=u[h]):u[h+1]===o&&(a=Math.max(a,u[h]));if(a!==1/0)return[a,o]}return s?[s[2],s[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:s,pageX:a,pageY:o}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-a)/i,t[1]=100*(t[1]-o)/s,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${qo}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${qo}${e.id}`,{id:e.id,annotationType:e.annotationType,pageIndex:this.parent.page._pageIndex,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#i(e);let s=this.#n?.popup||this.popup;!s&&i?.text&&(this._createPopup(i),s=this.#n.popup),s&&(s.updateEdited(t),i?.deleted&&(s.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#t&&(this.#i(this.#t.rect),this.#n?.popup.resetEdited(),this.#t=null)}#i(t){const{container:{style:e},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:a,pageHeight:o,pageX:u,pageY:h}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/a}%`,e.top=`${100*(o-t[3]+h)/o}%`,s===0?(e.width=`${100*(t[2]-t[0])/a}%`,e.height=`${100*(t[3]-t[1])/o}%`):this.setRotation(s)}_createContainer(t){const{data:e,parent:{page:i,viewport:s}}=this,a=document.createElement("section");a.setAttribute("data-annotation-id",e.id),!(this instanceof Mr)&&!(this instanceof If)&&(a.tabIndex=0);const{style:o}=a;if(o.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(a.title=e.alternativeText),e.noRotate&&a.classList.add("norotate"),!e.rect||this instanceof vf){const{rotation:w}=e;return!e.hasOwnCanvas&&w!==0&&this.setRotation(w,a),a}const{width:u,height:h}=this;if(!t&&e.borderStyle.width>0){o.borderWidth=`${e.borderStyle.width}px`;const w=e.borderStyle.horizontalCornerRadius,b=e.borderStyle.verticalCornerRadius;if(w>0||b>0){const x=`calc(${w}px * var(--total-scale-factor)) / calc(${b}px * var(--total-scale-factor))`;o.borderRadius=x}else if(this instanceof Uy){const x=`calc(${u}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;o.borderRadius=x}switch(e.borderStyle.style){case wa.SOLID:o.borderStyle="solid";break;case wa.DASHED:o.borderStyle="dashed";break;case wa.BEVELED:ae("Unimplemented border style: beveled");break;case wa.INSET:ae("Unimplemented border style: inset");break;case wa.UNDERLINE:o.borderBottomStyle="solid";break}const _=e.borderColor||null;_?(this.#e=!0,o.borderColor=Pt.makeHexColor(_[0]|0,_[1]|0,_[2]|0)):o.borderWidth=0}const d=Pt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:f,pageHeight:p,pageX:v,pageY:A}=s.rawDims;o.left=`${100*(d[0]-v)/f}%`,o.top=`${100*(d[1]-A)/p}%`;const{rotation:C}=e;return e.hasOwnCanvas||C===0?(o.width=`${100*u/f}%`,o.height=`${100*h/p}%`):this.setRotation(C,a),a}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims;let{width:a,height:o}=this;t%180!==0&&([a,o]=[o,a]),e.style.width=`${100*a/i}%`,e.style.height=`${100*o/s}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,s)=>{const a=s.detail[e],o=a[0],u=a.slice(1);s.target.style[i]=f0[`${o}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:f0[`${o}_rgb`](u)})};return oe(this,"_commonActions",{display:e=>{const{display:i}=e.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const s of Object.keys(e.detail))(t[s]||i[s])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[s,a]of Object.entries(e)){const o=i[s];if(o){const u={detail:{[s]:a},target:t};o(u),delete e[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,s,a]=this.data.rect.map(w=>Math.fround(w));if(t.length===8){const[w,b,_,x]=t.subarray(2,6);if(s===w&&a===b&&e===_&&i===x)return}const{style:o}=this.container;let u;if(this.#e){const{borderColor:w,borderWidth:b}=o;o.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${w}" stroke-width="${b}">`],this.container.classList.add("hasBorder")}const h=s-e,d=a-i,{svgFactory:f}=this,p=f.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0),p.role="none";const v=f.createElement("defs");p.append(v);const A=f.createElement("clipPath"),C=`clippath_${this.data.id}`;A.setAttribute("id",C),A.setAttribute("clipPathUnits","objectBoundingBox"),v.append(A);for(let w=2,b=t.length;w<b;w+=8){const _=t[w],x=t[w+1],D=t[w+2],M=t[w+3],T=f.createElement("rect"),O=(D-e)/h,k=(a-x)/d,z=(_-D)/h,B=(x-M)/d;T.setAttribute("x",O),T.setAttribute("y",k),T.setAttribute("width",z),T.setAttribute("height",B),A.append(T),u?.push(`<rect vector-effect="non-scaling-stroke" x="${O}" y="${k}" width="${z}" height="${B}"/>`)}this.#e&&(u.push("</g></svg>')"),o.backgroundImage=u.join("")),this.container.append(p),this.container.style.clipPath=`url(#${C})`}_createPopup(t=null){const{data:e}=this;let i,s;t?(i={str:t.text},s=t.date):(i=e.contentsObj,s=e.modificationDate),this.#n=new vf({data:{color:e.color,titleObj:e.titleObj,modificationDate:s,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){We("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[t];if(s)for(const{page:a,id:o,exportValues:u}of s){if(a===-1||o===e)continue;const h=typeof u=="string"?u:null,d=document.querySelector(`[data-element-id="${o}"]`);if(d&&!Or.has(d)){ae(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:h,domElement:d})}return i}for(const s of document.getElementsByName(t)){const{exportValue:a}=s,o=s.getAttribute("data-element-id");o!==e&&Or.has(s)&&i.push({id:o,exportValue:a,domElement:s})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class f_ extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class If extends oi{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let s=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),s=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),s=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),s=!0):t.setOCGState?(this.#n(i,t.setOCGState,t.overlaidText),s=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),s=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),s=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(i,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&(this.contentElement=i,this.container.append(i)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",s=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,s),!1),this.#t()}#n(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(e.actions)){const a=i.get(s);a&&(t[a]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:s}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ae('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:s,refs:a,include:o}=e,u=[];if(s.length!==0||a.length!==0){const f=new Set(a);for(const p of s){const v=this._fieldObjects[p]||[];for(const{id:A}of v)f.add(A)}for(const p of Object.values(this._fieldObjects))for(const v of p)f.has(v.id)===o&&u.push(v)}else for(const f of Object.values(this._fieldObjects))u.push(...f);const h=this.annotationStorage,d=[];for(const f of u){const{id:p}=f;switch(d.push(p),f.type){case"text":{const A=f.defaultValue||"";h.setValue(p,{value:A});break}case"checkbox":case"radiobutton":{const A=f.defaultValue===f.exportValues;h.setValue(p,{value:A});break}case"combobox":case"listbox":{const A=f.defaultValue||"";h.setValue(p,{value:A});break}default:continue}const v=document.querySelector(`[data-element-id="${p}"]`);if(v){if(!Or.has(v)){ae(`_bindResetFormAction - element not allowed: ${p}`);continue}}else continue;v.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class p_ extends oi{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class Mr extends oi{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Ti.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,s,a){i.includes("mouse")?t.addEventListener(i,o=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):t.addEventListener(i,o=>{if(i==="blur"){if(!e.focused||!o.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}a&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:a(o)}})})}_setEventListeners(t,e,i,s){for(const[a,o]of i)(o==="Action"||this.data.actions?.[o])&&((o==="Focus"||o==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,a,o,s),o==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):o==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Pt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||c_,a=t.style;let o;const u=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u),f=Math.round(d/(ud*s))||1,p=d/f;o=Math.min(s,h(p/ud))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-u);o=Math.min(s,h(d/ud))}a.fontSize=`calc(${o}px * var(--total-scale-factor))`,a.color=Pt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(a.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class g_ extends Mr{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,s){const a=this.annotationStorage;for(const o of this._getElementsByName(t.name,t.id))o.domElement&&(o.domElement[e]=i),a.setValue(o.id,{[s]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const s=t.getValue(e,{value:this.data.fieldValue});let a=s.value||"";const o=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;o&&a.length>o&&(a=a.slice(0,o));let u=s.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Or.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:d,datetimeType:f,timeStep:p}=this.data,v=!!f&&this.enableScripting;d&&(i.title=d),this._setRequired(i,this.data.required),o&&(i.maxLength=o),i.addEventListener("input",C=>{t.setValue(e,{value:C.target.value}),this.setPropertyOnSiblings(i,"value",C.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",C=>{const w=this.data.defaultFieldValue??"";i.value=h.userValue=w,h.formattedValue=null});let A=C=>{const{formattedValue:w}=h;w!=null&&(C.target.value=w),C.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",w=>{if(h.focused)return;const{target:b}=w;if(v&&(b.type=f,p&&(b.step=p)),h.userValue){const _=h.userValue;if(v)if(f==="time"){const x=new Date(_),D=[x.getHours(),x.getMinutes(),x.getSeconds()];b.value=D.map(M=>M.toString().padStart(2,"0")).join(":")}else b.value=new Date(_-d_).toISOString().split(f==="date"?"T":".",1)[0];else b.value=_}h.lastCommittedValue=b.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",w=>{this.showElementAndHideCanvas(w.target);const b={value(_){h.userValue=_.detail.value??"",v||t.setValue(e,{value:h.userValue.toString()}),_.target.value=h.userValue},formattedValue(_){const{formattedValue:x}=_.detail;h.formattedValue=x,x!=null&&_.target!==document.activeElement&&(_.target.value=x);const D={formattedValue:x};v&&(D.value=x),t.setValue(e,D)},selRange(_){_.target.setSelectionRange(..._.detail.selRange)},charLimit:_=>{const{charLimit:x}=_.detail,{target:D}=_;if(x===0){D.removeAttribute("maxLength");return}D.setAttribute("maxLength",x);let M=h.userValue;!M||M.length<=x||(M=M.slice(0,x),D.value=h.userValue=M,t.setValue(e,{value:M}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,willCommit:!0,commitKey:1,selStart:D.selectionStart,selEnd:D.selectionEnd}}))}};this._dispatchEventFromSandbox(b,w)}),i.addEventListener("keydown",w=>{h.commitKey=1;let b=-1;if(w.key==="Escape"?b=0:w.key==="Enter"&&!this.data.multiLine?b=2:w.key==="Tab"&&(h.commitKey=3),b===-1)return;const{value:_}=w.target;h.lastCommittedValue!==_&&(h.lastCommittedValue=_,h.userValue=_,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:b,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}))});const C=A;A=null,i.addEventListener("blur",w=>{if(!h.focused||!w.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:b}=w;let{value:_}=b;if(v){if(_&&f==="time"){const x=_.split(":").map(D=>parseInt(D,10));_=new Date(2e3,0,1,x[0],x[1],x[2]||0).valueOf(),b.step=""}else _.includes("T")||(_=`${_}T00:00`),_=new Date(_).valueOf();b.type="text"}h.userValue=_,h.lastCommittedValue!==_&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:_,willCommit:!0,commitKey:h.commitKey,selStart:w.target.selectionStart,selEnd:w.target.selectionEnd}}),C(w)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",w=>{h.lastCommittedValue=null;const{data:b,target:_}=w,{value:x,selectionStart:D,selectionEnd:M}=_;let T=D,O=M;switch(w.inputType){case"deleteWordBackward":{const k=x.substring(0,D).match(/\w*[^\w]*$/);k&&(T-=k[0].length);break}case"deleteWordForward":{const k=x.substring(D).match(/^[^\w]*\w*/);k&&(O+=k[0].length);break}case"deleteContentBackward":D===M&&(T-=1);break;case"deleteContentForward":D===M&&(O+=1);break}w.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:x,change:b||"",willCommit:!1,selStart:T,selEnd:O}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],w=>w.target.value)}if(A&&i.addEventListener("blur",A),this.data.comb){const w=(this.data.rect[2]-this.data.rect[0])/o;i.classList.add("comb"),i.style.letterSpacing=`calc(${w}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class m_ extends Mr{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class v_ extends Mr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",t.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const a=document.createElement("input");return Or.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="checkbox",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.setAttribute("exportValue",e.exportValue),a.tabIndex=0,a.addEventListener("change",o=>{const{name:u,checked:h}=o.target;for(const d of this._getElementsByName(u,i)){const f=h&&d.exportValue===e.exportValue;d.domElement&&(d.domElement.checked=f),t.setValue(d.id,{value:f})}t.setValue(i,{value:h})}),a.addEventListener("resetform",o=>{const u=e.defaultFieldValue||"Off";o.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(a.addEventListener("updatefromsandbox",o=>{const u={value(h){h.target.checked=h.detail.value!=="Off",t.setValue(i,{value:h.target.checked})}};this._dispatchEventFromSandbox(u,o)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class Uy extends Mr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let s=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof s=="string"&&(s=s!==e.buttonValue,t.setValue(i,{value:s})),s)for(const o of this._getElementsByName(e.fieldName,i))t.setValue(o.id,{value:!1});const a=document.createElement("input");if(Or.add(a),a.setAttribute("data-element-id",i),a.disabled=e.readOnly,this._setRequired(a,this.data.required),a.type="radio",a.name=e.fieldName,s&&a.setAttribute("checked",!0),a.tabIndex=0,a.addEventListener("change",o=>{const{name:u,checked:h}=o.target;for(const d of this._getElementsByName(u,i))t.setValue(d.id,{value:!1});t.setValue(i,{value:h})}),a.addEventListener("resetform",o=>{const u=e.defaultFieldValue;o.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const o=e.buttonValue;a.addEventListener("updatefromsandbox",u=>{const h={value:d=>{const f=o===d.detail.value;for(const p of this._getElementsByName(d.target.name)){const v=f&&p.id===i;p.domElement&&(p.domElement.checked=v),t.setValue(p.id,{value:v})}}};this._dispatchEventFromSandbox(h,u)}),this._setEventListeners(a,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class y_ extends If{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class b_ extends Mr{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),s=document.createElement("select");Or.add(s),s.setAttribute("data-element-id",e),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let a=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",f=>{const p=this.data.defaultFieldValue;for(const v of s.options)v.selected=v.value===p});for(const f of this.data.options){const p=document.createElement("option");p.textContent=f.displayValue,p.value=f.exportValue,i.value.includes(f.exportValue)&&(p.setAttribute("selected",!0),a=!1),s.append(p)}let o=null;if(a){const f=document.createElement("option");f.value=" ",f.setAttribute("hidden",!0),f.setAttribute("selected",!0),s.prepend(f),o=()=>{f.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const u=f=>{const p=f?"value":"textContent",{options:v,multiple:A}=s;return A?Array.prototype.filter.call(v,C=>C.selected).map(C=>C[p]):v.selectedIndex===-1?null:v[v.selectedIndex][p]};let h=u(!1);const d=f=>{const p=f.target.options;return Array.prototype.map.call(p,v=>({displayValue:v.textContent,exportValue:v.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",f=>{const p={value(v){o?.();const A=v.detail.value,C=new Set(Array.isArray(A)?A:[A]);for(const w of s.options)w.selected=C.has(w.value);t.setValue(e,{value:u(!0)}),h=u(!1)},multipleSelection(v){s.multiple=!0},remove(v){const A=s.options,C=v.detail.remove;A[C].selected=!1,s.remove(C),A.length>0&&Array.prototype.findIndex.call(A,b=>b.selected)===-1&&(A[0].selected=!0),t.setValue(e,{value:u(!0),items:d(v)}),h=u(!1)},clear(v){for(;s.length!==0;)s.remove(0);t.setValue(e,{value:null,items:[]}),h=u(!1)},insert(v){const{index:A,displayValue:C,exportValue:w}=v.detail.insert,b=s.children[A],_=document.createElement("option");_.textContent=C,_.value=w,b?b.before(_):s.append(_),t.setValue(e,{value:u(!0),items:d(v)}),h=u(!1)},items(v){const{items:A}=v.detail;for(;s.length!==0;)s.remove(0);for(const C of A){const{displayValue:w,exportValue:b}=C,_=document.createElement("option");_.textContent=w,_.value=b,s.append(_)}s.options.length>0&&(s.options[0].selected=!0),t.setValue(e,{value:u(!0),items:d(v)}),h=u(!1)},indices(v){const A=new Set(v.detail.indices);for(const C of v.target.options)C.selected=A.has(C.index);t.setValue(e,{value:u(!0)}),h=u(!1)},editable(v){v.target.disabled=!v.detail.editable}};this._dispatchEventFromSandbox(p,f)}),s.addEventListener("input",f=>{const p=u(!0),v=u(!1);t.setValue(e,{value:p}),f.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:h,change:v,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],f=>f.target.value)):s.addEventListener("input",function(f){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class vf extends oi{constructor(t){const{data:e,elements:i,parent:s}=t,a=!!s._commentManager;if(super(t,{isRenderable:!a&&oi._hasPopupData(e)}),this.elements=i,a&&oi._hasPopupData(e)){const o=this.popup=this.#t();for(const u of i)u.popup=o}else this.popup=null}#t(){return new A_({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const s of this.elements)s.popup=e,s.container.ariaHasPopup="dialog",i.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(s=>`${Da}${s}`).join(",")),this.container}}class A_{#t=null;#e=this.#G.bind(this);#n=this.#P.bind(this);#i=this.#M.bind(this);#a=this.#w.bind(this);#r=null;#s=null;#o=null;#u=null;#l=null;#d=null;#c=null;#f=!1;#m=null;#g=null;#h=null;#p=null;#v=null;#b=null;#y=null;#x=null;#E=null;#_=null;#T=!1;#A=null;#S=null;constructor({container:t,color:e,elements:i,titleObj:s,modificationDate:a,contentsObj:o,richText:u,parent:h,rect:d,parentRect:f,open:p,commentManager:v=null}){this.#s=t,this.#E=s,this.#o=o,this.#x=u,this.#d=h,this.#r=e,this.#y=d,this.#c=f,this.#l=i,this.#t=v,this.#A=i[0],this.#u=hf.toDateObject(a),this.trigger=i.flatMap(A=>A.getElementsToTriggerPopup()),v||(this.#N(),this.#s.hidden=!0,p&&this.#w())}#N(){if(this.#g)return;this.#g=new AbortController;const{signal:t}=this.#g;for(const e of this.trigger)e.addEventListener("click",this.#a,{signal:t}),e.addEventListener("pointerenter",this.#i,{signal:t}),e.addEventListener("pointerleave",this.#n,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#D(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#v=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#A.container.after(this.#p);return}if(this.#v||this.#D(),!this.#v)return;const{signal:t}=this.#g=new AbortController,e=this.#A.hasOwnCommentButton,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},s=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#A.container;for(const o of this.trigger)o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",s,{signal:t}),o.addEventListener("pointerleave",a,{signal:t}),o.classList.add("popupTriggerArea")}else{const o=this.#p=document.createElement("button");o.className="annotationCommentButton";const u=this.#A.container;o.style.zIndex=u.style.zIndex+1,o.tabIndex=0,o.ariaHasPopup="dialog",o.ariaControls="commentPopup",o.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#z(),this.#R(),o.addEventListener("keydown",this.#e,{signal:t}),o.addEventListener("click",i,{signal:t}),o.addEventListener("pointerenter",s,{signal:t}),o.addEventListener("pointerleave",a,{signal:t}),u.after(o)}}#R(){if(this.#A.extraPopupElement&&!this.#A.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#v,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#z(){this.#A.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#A.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:s,modificationDate:a}=this.#A.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:s,modificationDate:a}}get elementBeforePopup(){return this.#p}get comment(){return this.#S||=this.#A.commentText,this.#S}set comment(t){t!==this.comment&&(this.#A.commentText=this.#S=t)}focus(){this.#A.container?.focus()}get parentBoundingClientRect(){return this.#A.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#b)return this.#b;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:s,y:a,width:o,height:u}=this.#A.layer.getBoundingClientRect();return[(t-s)/o,(e+i-a)/u]}set commentPopupPosition(t){this.#b=t}hasDefaultPopupPosition(){return this.#b===null}get commentButtonPosition(){return this.#v}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#b||this.commentButtonPosition.map(d=>d/100),s=this.parentBoundingClientRect,{x:a,y:o,width:u,height:h}=s;this.#t.showDialog(null,this,a+e*u,o+i*h,{...t,parentDimensions:s})}render(){if(this.#m)return;const t=this.#m=document.createElement("div");if(t.className="popup",this.#r){const i=t.style.outlineColor=Pt.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#E?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#E}if(t.append(e),this.#u){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#u.valueOf()})),i.dateTime=this.#u.toISOString(),e.append(i)}by({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#s.append(t)}get#k(){const t=this.#x,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#x.html||null}get#L(){return this.#k?.attributes?.style?.fontSize||0}get#F(){return this.#k?.attributes?.style?.color||null}#B(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},s={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const a of t.split(`
`))e.push({name:"span",value:a,attributes:s});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#w()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#S=null):e&&(e.deleted?this.remove():(this.#z(),this.#S=e.text)),t&&(this.#v=null,this.#D(),this.#R());return}if(i||e?.deleted){this.remove();return}this.#N(),this.#_||={contentsObj:this.#o,richText:this.#x},t&&(this.#h=null),e&&e.text&&(this.#x=this.#B(e.text),this.#u=hf.toDateObject(e.date),this.#o=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#_&&({contentsObj:this.#o,richText:this.#x}=this.#_,this.#_=null,this.#m?.remove(),this.#m=null,this.#h=null)}remove(){if(this.#g?.abort(),this.#g=null,this.#m?.remove(),this.#m=null,this.#T=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#C(){if(this.#h!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:s,pageY:a}}}=this.#d;let o=!!this.#c,u=o?this.#c:this.#y;for(const C of this.#l)if(!u||Pt.intersect(C.data.rect,u)!==null){u=C.data.rect,o=!0;break}const h=Pt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),f=o?u[2]-u[0]+5:0,p=h[0]+f,v=h[1];this.#h=[100*(p-s)/e,100*(v-a)/i];const{style:A}=this.#s;A.left=`${this.#h[0]}%`,A.top=`${this.#h[1]}%`}#w(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#M(),this.#s.addEventListener("click",this.#a),this.#s.addEventListener("keydown",this.#e)):(this.#P(),this.#s.removeEventListener("click",this.#a),this.#s.removeEventListener("keydown",this.#e))}#M(){this.#m||this.render(),this.isVisible?this.#f&&this.#s.classList.add("focused"):(this.#C(),this.#s.hidden=!1,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)+1e3)}#P(){this.#s.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#s.hidden=!0,this.#s.style.zIndex=parseInt(this.#s.style.zIndex)-1e3)}forceHide(){this.#T=this.isVisible,this.#T&&(this.#s.hidden=!0)}maybeShow(){this.#t||(this.#N(),this.#T&&(this.#m||this.#M(),this.#T=!1,this.#s.hidden=!1))}get isVisible(){return this.#t?!1:this.#s.hidden===!1}}class Hy extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=le.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class __ extends oi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),a=this.#t=this.svgFactory.createElement("svg:line");return a.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),a.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),a.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),a.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),a.setAttribute("stroke-width",t.borderStyle.width||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),s.append(a),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class w_ extends oi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:rect");return o.setAttribute("x",a/2),o.setAttribute("y",a/2),o.setAttribute("width",e-a),o.setAttribute("height",i-a),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class E_ extends oi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,s=this.svgFactory.create(e,i,!0),a=t.borderStyle.width,o=this.#t=this.svgFactory.createElement("svg:ellipse");return o.setAttribute("cx",e/2),o.setAttribute("cy",i/2),o.setAttribute("rx",e/2-a/2),o.setAttribute("ry",i/2-a/2),o.setAttribute("stroke-width",a||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class jy extends oi{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:s},width:a,height:o}=this;if(!e)return this.container;const u=this.svgFactory.create(a,o,!0);let h=[];for(let f=0,p=e.length;f<p;f+=2){const v=e[f]-t[0],A=t[3]-e[f+1];h.push(`${v},${A}`)}h=h.join(" ");const d=this.#t=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",i.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),u.append(d),this.container.append(u),!s&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class S_ extends jy{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class x_ extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class zf extends oi{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?le.HIGHLIGHT:le.INK}#n(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:s,popupRef:a}}=this,{transform:o,width:u,height:h}=this.#n(e,t),d=this.svgFactory.create(u,h,!0),f=this.#t=this.svgFactory.createElement("svg:g");d.append(f),f.setAttribute("stroke-width",s.width||1),f.setAttribute("stroke-linecap","round"),f.setAttribute("stroke-linejoin","round"),f.setAttribute("stroke-miterlimit",10),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),f.setAttribute("transform",o);for(let p=0,v=i.length;p<v;p++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",i[p].join(",")),f.append(A)}return!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:s}=t,a=this.#t;if(e>=0&&a.setAttribute("stroke-width",e||1),i)for(let o=0,u=this.#e.length;o<u;o++)this.#e[o].setAttribute("points",i[o].join(","));if(s){const{transform:o,width:u,height:h}=this.#n(this.data.rotation,s);a.parentElement.setAttribute("viewBox",`0 0 ${u} ${h}`),a.setAttribute("transform",o)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class qy extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=le.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class C_ extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class T_ extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class D_ extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class Gy extends oi{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=le.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class R_ extends oi{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:s}=Ti.platform;return t.addEventListener("keydown",a=>{a.key==="Enter"&&(s?a.metaKey:a.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Ff{#t=null;#e=null;#n=null;#i=new Map;#a=null;#r=null;#s=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:s,page:a,viewport:o,structTreeLayer:u,commentManager:h,linkService:d,annotationStorage:f}){this.div=t,this.#t=e,this.#e=i,this.#a=u||null,this.#r=d||null,this.#n=f||new Of,this.page=a,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return this.#i.size>0}async render(t){const{annotations:e}=t,i=this.div;Nr(i,this.viewport);const s=new Map,a=[],o={data:null,layer:i,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new ku,annotationStorage:this.#n,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const h=u.annotationType===Si.POPUP;if(h){const p=s.get(u.id);if(!p)continue;if(!this._commentManager){a.push(u);continue}o.elements=p}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;o.data=u;const d=vd.create(o);if(!d.isRenderable)continue;if(!h&&(this.#s.push(d),u.popupRef)){const p=s.get(u.popupRef);p?p.push(d):s.set(u.popupRef,[d])}const f=d.render();u.hidden&&(f.style.visibility="hidden"),d._isEditable&&(this.#i.set(d.data.id,d),this._annotationEditorUIManager?.renderAnnotationElement(d))}await this.#u();for(const u of a){const h=o.elements=s.get(u.id);o.data=u;const d=vd.create(o);if(!d.isRenderable)continue;const f=d.render();d.contentElement.id=`${Da}${u.id}`,u.hidden&&(f.style.visibility="hidden"),h.at(-1).container.after(f)}this.#l()}async#u(){if(this.#s.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:i,data:{id:s}}of this.#s){const a=i.id=`${Da}${s}`;t.push(this.#a?.getAriaAttributes(a).then(o=>{if(o)for(const[u,h]of o)i.setAttribute(u,h)}))}}this.#s.sort(({data:{rect:[i,s,a,o]}},{data:{rect:[u,h,d,f]}})=>{if(i===a&&s===o)return 1;if(u===d&&h===f)return-1;const p=o,v=s,A=(s+o)/2,C=f,w=h,b=(h+f)/2;if(A>=C&&b<=v)return-1;if(b>=p&&A<=w)return 1;const _=(i+a)/2,x=(u+d)/2;return _-x});const e=document.createDocumentFragment();for(const i of this.#s)e.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&e.append(i.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const i of this.#s)this.#t.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#r,svgFactory:new ku,parent:this};for(const i of t){i.borderStyle||=Ff._defaultBorderStyle,e.data=i;const s=vd.create(e);s.isRenderable&&(s.render(),s.contentElement.id=`${Da}${i.id}`,this.#s.push(s))}await this.#u()}update({viewport:t}){const e=this.div;this.viewport=t,Nr(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const s=t.querySelector(`[data-annotation-id="${e}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:a}=s;a?a.nodeName==="CANVAS"?a.replaceWith(i):a.classList.contains("annotationContent")?a.after(i):a.before(i):s.append(i);const o=this.#i.get(e);o&&(o._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,s.id,i),o._hasNoCanvas=!1):o.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#i.values())}getEditableAnnotation(t){return this.#i.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:s}=t,a=new f_({data:{id:i,rect:t.getPDFRect(),rotation:s},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#n});return a.render(),a.contentElement.id=`${Da}${i}`,a.createOrUpdatePopup(),this.#s.push(a),a}removeAnnotation(t){const e=this.#s.findIndex(s=>s.data.id===t);if(e<0)return;const[i]=this.#s.splice(e,1);this.#t?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#u()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return oe(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:wa.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Au=/\r\n?|\n/g;class Oi extends Xt{#t="";#e=`${this.id}-editor`;#n=null;#i;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Oi.prototype,e=a=>a.isEmpty(),i=lr.TRANSLATE_SMALL,s=lr.TRANSLATE_BIG;return oe(this,"_keyboardManager",new tl([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[s,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,s],checker:e}]]))}static _type="freetext";static _editorType=le.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Oi._defaultColor||Xt._defaultLineColor,this.#i=t.fontSize||Oi._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){Xt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case Se.FREETEXT_SIZE:Oi._defaultFontSize=e;break;case Se.FREETEXT_COLOR:Oi._defaultColor=e;break}}updateParams(t,e){switch(t){case Se.FREETEXT_SIZE:this.#a(e);break;case Se.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[Se.FREETEXT_SIZE,Oi._defaultFontSize],[Se.FREETEXT_COLOR,Oi._defaultColor||Xt._defaultLineColor]]}get propertiesToUpdate(){return[[Se.FREETEXT_SIZE,this.#i],[Se.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Yo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Se.FREETEXT_COLOR}#a(t){const e=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#i)*this.parentScale),this.#i=s,this.#o()},i=this.#i;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Se.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const e=s=>{this.color=s,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Se.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Oi._internalPadding*t,-(Oi._internalPadding+this.#i)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const t=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#s(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Oi.#u(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:s,div:a}=this,o=a.style.display,u=a.classList.contains("hidden");a.classList.remove("hidden"),a.style.display="hidden",s.div.append(this.div),i=a.getBoundingClientRect(),a.remove(),a.style.display=o,a.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#s().trimEnd();if(t===e)return;const i=s=>{if(this.#t=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Oi._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,a]=this.parentDimensions;if(this.annotationElementId){const{position:o}=this._initialData;let[u,h]=this.getInitialTranslation();[u,h]=this.pageTranslationToScreen(u,h);const[d,f]=this.pageDimensions,[p,v]=this.pageTranslation;let A,C;switch(this.rotation){case 0:A=t+(o[0]-p)/d,C=e+this.height-(o[1]-v)/f;break;case 90:A=t+(o[0]-p)/d,C=e-(o[1]-v)/f,[u,h]=[h,-u];break;case 180:A=t-this.width+(o[0]-p)/d,C=e-(o[1]-v)/f,[u,h]=[-u,-h];break;case 270:A=t+(o[0]-p-this.height*f)/d,C=e+(o[1]-v-this.width*d)/f,[u,h]=[-h,u];break}this.setAt(A*s,C*a,u,h)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#u(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Au,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const s=Oi.#c(e.getData("text")||"").replaceAll(Au,`
`);if(!s)return;const a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();const o=a.getRangeAt(0);if(!s.includes(`
`)){o.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),a.collapseToStart();return}const{startContainer:u,startOffset:h}=o,d=[],f=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(f.push(u.nodeValue.slice(h).replaceAll(Au,"")),A!==this.editorDiv){let C=d;for(const w of this.editorDiv.childNodes){if(w===A){C=f;continue}C.push(Oi.#u(w))}}d.push(u.nodeValue.slice(0,h).replaceAll(Au,""))}else if(u===this.editorDiv){let A=d,C=0;for(const w of this.editorDiv.childNodes)C++===h&&(A=f),A.push(Oi.#u(w))}this.#t=`${d.join(`
`)}${s}${f.join(`
`)}`,this.#l();const p=new Range;let v=Math.sumPrecise(d.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const C=A.nodeValue.length;if(v<=C){p.setStart(A,v),p.setEnd(A,v);break}v-=C}a.removeAllRanges(),a.addRange(p)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#c(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Oi._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let s=null;if(t instanceof Hy){const{data:{defaultAppearanceData:{fontSize:o,fontColor:u},rect:h,rotation:d,id:f,popupRef:p,richText:v,contentsObj:A,creationDate:C,modificationDate:w},textContent:b,textPosition:_,parent:{page:{pageNumber:x}}}=t;if(!b||b.length===0)return null;s=t={annotationType:le.FREETEXT,color:Array.from(u),fontSize:o,value:b.join(`
`),position:_,pageIndex:x-1,rect:h.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:p,comment:A?.str||null,richText:v,creationDate:C,modificationDate:w}}const a=await super.deserialize(t,e,i);return a.#i=t.fontSize,a.color=Pt.makeHexColor(...t.color),a.#t=Oi.#c(t.value),a._initialData=s,t.comment&&a.setCommentData(t),a}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Xt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#i,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((o,u)=>o!==s[u])||t.pageIndex!==a}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#i}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const s of this.#t.split(`
`)){const a=document.createElement("div");a.append(s?document.createTextNode(s):document.createElement("br")),e.append(a)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Ut{static PRECISION=1e-4;toSVGPath(){We("Abstract method `toSVGPath` must be implemented.")}get box(){We("Abstract getter `box` must be implemented.")}serialize(t,e){We("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,s,a,o){o||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)o[u]=e+t[u]*s,o[u+1]=i+t[u+1]*a;return o}static _rescaleAndSwap(t,e,i,s,a,o){o||=new Float32Array(t.length);for(let u=0,h=t.length;u<h;u+=2)o[u]=e+t[u+1]*s,o[u+1]=i+t[u]*a;return o}static _translate(t,e,i,s){s||=new Float32Array(t.length);for(let a=0,o=t.length;a<o;a+=2)s[a]=e+t[a],s[a+1]=i+t[a+1];return s}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,s,a){switch(a){case 90:return[1-e/i,t/s];case 180:return[1-t/i,1-e/s];case 270:return[e/i,1-t/s];default:return[t/i,e/s]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,s,a,o){return[(t+5*i)/6,(e+5*s)/6,(5*i+a)/6,(5*s+o)/6,(i+a)/2,(s+o)/2]}}class Cr{#t;#e=[];#n;#i;#a=[];#r=new Float32Array(18);#s;#o;#u;#l;#d;#c;#f=[];static#m=8;static#g=2;static#h=Cr.#m+Cr.#g;constructor({x:t,y:e},i,s,a,o,u=0){this.#t=i,this.#c=a*s,this.#i=o,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#n=u,this.#l=Cr.#m*s,this.#u=Cr.#h*s,this.#d=s,this.#f.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#p(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,s,a,o]=this.#t;return[(this.#s+(t[0]-e[0])/2-i)/a,(this.#o+(t[1]-e[1])/2-s)/o,(this.#s+(e[0]-t[0])/2-i)/a,(this.#o+(e[1]-t[1])/2-s)/o]}add({x:t,y:e}){this.#s=t,this.#o=e;const[i,s,a,o]=this.#t;let[u,h,d,f]=this.#r.subarray(8,12);const p=t-d,v=e-f,A=Math.hypot(p,v);if(A<this.#u)return!1;const C=A-this.#l,w=C/A,b=w*p,_=w*v;let x=u,D=h;u=d,h=f,d+=b,f+=_,this.#f?.push(t,e);const M=-_/C,T=b/C,O=M*this.#c,k=T*this.#c;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([d+O,f+k],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([d-O,f-k],16),isNaN(this.#r[6])?(this.#a.length===0&&(this.#r.set([u+O,h+k],2),this.#a.push(NaN,NaN,NaN,NaN,(u+O-i)/a,(h+k-s)/o),this.#r.set([u-O,h-k],14),this.#e.push(NaN,NaN,NaN,NaN,(u-O-i)/a,(h-k-s)/o)),this.#r.set([x,D,u,h,d,f],6),!this.isEmpty()):(this.#r.set([x,D,u,h,d,f],6),Math.abs(Math.atan2(D-h,x-u)-Math.atan2(_,b))<Math.PI/2?([u,h,d,f]=this.#r.subarray(2,6),this.#a.push(NaN,NaN,NaN,NaN,((u+d)/2-i)/a,((h+f)/2-s)/o),[u,h,x,D]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((x+u)/2-i)/a,((D+h)/2-s)/o),!0):([x,D,u,h,d,f]=this.#r.subarray(0,6),this.#a.push(((x+5*u)/6-i)/a,((D+5*h)/6-s)/o,((5*u+d)/6-i)/a,((5*h+f)/6-s)/o,((u+d)/2-i)/a,((h+f)/2-s)/o),[d,f,u,h,x,D]=this.#r.subarray(12,18),this.#e.push(((x+5*u)/6-i)/a,((D+5*h)/6-s)/o,((5*u+d)/6-i)/a,((5*h+f)/6-s)/o,((u+d)/2-i)/a,((h+f)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#a,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#v();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let s=6;s<t.length;s+=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);this.#y(i);for(let s=e.length-6;s>=6;s-=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);return this.#b(i),i.join(" ")}#v(){const[t,e,i,s]=this.#t,[a,o,u,h]=this.#p();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/s} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/s} L${a} ${o} L${u} ${h} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/s} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/s} Z`}#b(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#y(t){const[e,i,s,a]=this.#t,o=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[h,d,f,p]=this.#p();t.push(`L${(o[0]-e)/s} ${(o[1]-i)/a} L${h} ${d} L${f} ${p} L${(u[0]-e)/s} ${(u[1]-i)/a}`)}newFreeDrawOutline(t,e,i,s,a,o){return new Vy(t,e,i,s,a,o)}getOutlines(){const t=this.#a,e=this.#e,i=this.#r,[s,a,o,u]=this.#t,h=new Float32Array((this.#f?.length??0)+2);for(let p=0,v=h.length-2;p<v;p+=2)h[p]=(this.#f[p]-s)/o,h[p+1]=(this.#f[p+1]-a)/u;if(h[h.length-2]=(this.#s-s)/o,h[h.length-1]=(this.#o-a)/u,isNaN(i[6])&&!this.isEmpty())return this.#x(h);const d=new Float32Array(this.#a.length+24+this.#e.length);let f=t.length;for(let p=0;p<f;p+=2){if(isNaN(t[p])){d[p]=d[p+1]=NaN;continue}d[p]=t[p],d[p+1]=t[p+1]}f=this.#_(d,f);for(let p=e.length-6;p>=6;p-=6)for(let v=0;v<6;v+=2){if(isNaN(e[p+v])){d[f]=d[f+1]=NaN,f+=2;continue}d[f]=e[p+v],d[f+1]=e[p+v+1],f+=2}return this.#E(d,f),this.newFreeDrawOutline(d,h,this.#t,this.#d,this.#n,this.#i)}#x(t){const e=this.#r,[i,s,a,o]=this.#t,[u,h,d,f]=this.#p(),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(e[2]-i)/a,(e[3]-s)/o,NaN,NaN,NaN,NaN,(e[4]-i)/a,(e[5]-s)/o,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,(e[16]-i)/a,(e[17]-s)/o,NaN,NaN,NaN,NaN,(e[14]-i)/a,(e[15]-s)/o],0),this.newFreeDrawOutline(p,t,this.#t,this.#d,this.#n,this.#i)}#E(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#_(t,e){const i=this.#r.subarray(4,6),s=this.#r.subarray(16,18),[a,o,u,h]=this.#t,[d,f,p,v]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-a)/u,(i[1]-o)/h,NaN,NaN,NaN,NaN,d,f,NaN,NaN,NaN,NaN,p,v,NaN,NaN,NaN,NaN,(s[0]-a)/u,(s[1]-o)/h],e),e+=24}}class Vy extends Ut{#t;#e=new Float32Array(4);#n;#i;#a;#r;#s;constructor(t,e,i,s,a,o){super(),this.#s=t,this.#a=e,this.#t=i,this.#r=s,this.#n=a,this.#i=o,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(o);const[u,h,d,f]=this.#e;for(let p=0,v=t.length;p<v;p+=2)t[p]=(t[p]-u)/d,t[p+1]=(t[p+1]-h)/f;for(let p=0,v=e.length;p<v;p+=2)e[p]=(e[p]-u)/d,e[p+1]=(e[p+1]-h)/f}toSVGPath(){const t=[`M${this.#s[4]} ${this.#s[5]}`];for(let e=6,i=this.#s.length;e<i;e+=6){if(isNaN(this.#s[e])){t.push(`L${this.#s[e+4]} ${this.#s[e+5]}`);continue}t.push(`C${this.#s[e]} ${this.#s[e+1]} ${this.#s[e+2]} ${this.#s[e+3]} ${this.#s[e+4]} ${this.#s[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,s],a){const o=i-t,u=s-e;let h,d;switch(a){case 0:h=Ut._rescale(this.#s,t,s,o,-u),d=Ut._rescale(this.#a,t,s,o,-u);break;case 90:h=Ut._rescaleAndSwap(this.#s,t,e,o,u),d=Ut._rescaleAndSwap(this.#a,t,e,o,u);break;case 180:h=Ut._rescale(this.#s,i,e,-o,u),d=Ut._rescale(this.#a,i,e,-o,u);break;case 270:h=Ut._rescaleAndSwap(this.#s,i,s,-o,-u),d=Ut._rescaleAndSwap(this.#a,i,s,-o,-u);break}return{outline:Array.from(h),points:[Array.from(d)]}}#o(t){const e=this.#s;let i=e[4],s=e[5];const a=[i,s,i,s];let o=i,u=s,h=i,d=s;const f=t?Math.max:Math.min,p=new Float32Array(4);for(let A=6,C=e.length;A<C;A+=6){const w=e[A+4],b=e[A+5];isNaN(e[A])?(Pt.pointBoundingBox(w,b,a),u>b?(o=w,u=b):u===b&&(o=f(o,w)),d<b?(h=w,d=b):d===b&&(h=f(h,w))):(p[0]=p[1]=1/0,p[2]=p[3]=-1/0,Pt.bezierBoundingBox(i,s,...e.slice(A,A+6),p),Pt.rectBoundingBox(p[0],p[1],p[2],p[3],a),u>p[1]?(o=p[0],u=p[1]):u===p[1]&&(o=f(o,p[0])),d<p[3]?(h=p[2],d=p[3]):d===p[3]&&(h=f(h,p[2]))),i=w,s=b}const v=this.#e;v[0]=a[0]-this.#n,v[1]=a[1]-this.#n,v[2]=a[2]-a[0]+2*this.#n,v[3]=a[3]-a[1]+2*this.#n,this.firstPoint=[o,u],this.lastPoint=[h,d]}get box(){return this.#e}newOutliner(t,e,i,s,a,o=0){return new Cr(t,e,i,s,a,o)}getNewOutline(t,e){const[i,s,a,o]=this.#e,[u,h,d,f]=this.#t,p=a*d,v=o*f,A=i*d+u,C=s*f+h,w=this.newOutliner({x:this.#a[0]*p+A,y:this.#a[1]*v+C},this.#t,this.#r,t,this.#i,e??this.#n);for(let b=2;b<this.#a.length;b+=2)w.add({x:this.#a[b]*p+A,y:this.#a[b+1]*v+C});return w.getOutlines()}}class yf{#t;#e;#n;#i=[];#a=[];constructor(t,e=0,i=0,s=!0){const a=[1/0,1/0,-1/0,-1/0],o=10**-4;for(const{x:w,y:b,width:_,height:x}of t){const D=Math.floor((w-e)/o)*o,M=Math.ceil((w+_+e)/o)*o,T=Math.floor((b-e)/o)*o,O=Math.ceil((b+x+e)/o)*o,k=[D,T,O,!0],z=[M,T,O,!1];this.#i.push(k,z),Pt.rectBoundingBox(D,T,M,O,a)}const u=a[2]-a[0]+2*i,h=a[3]-a[1]+2*i,d=a[0]-i,f=a[1]-i;let p=s?-1/0:1/0,v=1/0;const A=this.#i.at(s?-1:-2),C=[A[0],A[2]];for(const w of this.#i){const[b,_,x,D]=w;!D&&s?_<v?(v=_,p=b):_===v&&(p=Math.max(p,b)):D&&!s&&(_<v?(v=_,p=b):_===v&&(p=Math.min(p,b))),w[0]=(b-d)/u,w[1]=(_-f)/h,w[2]=(x-f)/h}this.#t=new Float32Array([d,f,u,h]),this.#e=[p,v],this.#n=C}getOutlines(){this.#i.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#i)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#u(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],i=new Set;for(const o of t){const[u,h,d]=o;e.push([u,h,o],[u,d,o])}e.sort((o,u)=>o[1]-u[1]||o[0]-u[0]);for(let o=0,u=e.length;o<u;o+=2){const h=e[o][2],d=e[o+1][2];h.push(d),d.push(h),i.add(h),i.add(d)}const s=[];let a;for(;i.size>0;){const o=i.values().next().value;let[u,h,d,f,p]=o;i.delete(o);let v=u,A=h;for(a=[u,d],s.push(a);;){let C;if(i.has(f))C=f;else if(i.has(p))C=p;else break;i.delete(C),[u,h,d,f,p]=C,v!==u&&(a.push(v,A,u,A===h?h:d),v=u),A=A===h?d:h}a.push(v,A)}return new N_(s,this.#t,this.#e,this.#n)}#s(t){const e=this.#a;let i=0,s=e.length-1;for(;i<=s;){const a=i+s>>1,o=e[a][0];if(o===t)return a;o<t?i=a+1:s=a-1}return s+1}#o([,t,e]){const i=this.#s(t);this.#a.splice(i,0,[t,e])}#u([,t,e]){const i=this.#s(t);for(let s=i;s<this.#a.length;s++){const[a,o]=this.#a[s];if(a!==t)break;if(a===t&&o===e){this.#a.splice(s,1);return}}for(let s=i-1;s>=0;s--){const[a,o]=this.#a[s];if(a!==t)break;if(a===t&&o===e){this.#a.splice(s,1);return}}}#l(t){const[e,i,s]=t,a=[[e,i,s]],o=this.#s(s);for(let u=0;u<o;u++){const[h,d]=this.#a[u];for(let f=0,p=a.length;f<p;f++){const[,v,A]=a[f];if(!(d<=v||A<=h)){if(v>=h){if(A>d)a[f][1]=d;else{if(p===1)return[];a.splice(f,1),f--,p--}continue}a[f][2]=h,A>d&&a.push([e,d,A])}}}return a}}class N_ extends Ut{#t;#e;constructor(t,e,i,s){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=s}toSVGPath(){const t=[];for(const e of this.#e){let[i,s]=e;t.push(`M${i} ${s}`);for(let a=2;a<e.length;a+=2){const o=e[a],u=e[a+1];o===i?(t.push(`V${u}`),s=u):u===s&&(t.push(`H${o}`),i=o)}t.push("Z")}return t.join(" ")}serialize([t,e,i,s],a){const o=[],u=i-t,h=s-e;for(const d of this.#e){const f=new Array(d.length);for(let p=0;p<d.length;p+=2)f[p]=t+d[p]*u,f[p+1]=s-d[p+1]*h;o.push(f)}return o}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class bf extends Cr{newFreeDrawOutline(t,e,i,s,a,o){return new O_(t,e,i,s,a,o)}}class O_ extends Vy{newOutliner(t,e,i,s,a,o=0){return new bf(t,e,i,s,a,o)}}class vi extends Xt{#t=null;#e=0;#n;#i=null;#a=null;#r=null;#s=null;#o=0;#u=null;#l=null;#d=null;#c=!1;#f=null;#m=null;#g=null;#h="";#p;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=le.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=vi.prototype;return oe(this,"_keyboardManager",new tl([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||vi._defaultColor,this.#p=t.thickness||vi._defaultThickness,this.opacity=t.opacity||vi._defaultOpacity,this.#n=t.boxes||null,this.#v=t.methodOfCreation||"",this.#h=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#c=!0,this.#y(t),this.#A()):this.#n&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#s=t.focusNode,this.#o=t.focusOffset,this.#b(),this.#A(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#c?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#b(){const t=new yf(this.#n,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new yf(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:s}=this.#r;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#y({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const s=1.5;if(this.#r=t.getNewOutline(this.#p/2+s,.0025),e>=0)this.#d=e,this.#i=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#g=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const p=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:vi.#S(this.#l.box,(p-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#g,{bbox:vi.#S(this.#r.box,p),path:{d:this.#r.toSVGPath()}})}const[a,o,u,h]=t.box;switch(this.rotation){case 0:this.x=a,this.y=o,this.width=u,this.height=h;break;case 90:{const[p,v]=this.parentDimensions;this.x=o,this.y=1-a,this.width=u*v/p,this.height=h*p/v;break}case 180:this.x=1-a,this.y=1-o,this.width=u,this.height=h;break;case 270:{const[p,v]=this.parentDimensions;this.x=1-o,this.y=a,this.width=u*v/p,this.height=h*p/v;break}}const{firstPoint:d}=t;this.#f=[(d[0]-a)/u,(d[1]-o)/h];const{lastPoint:f}=this.#r;this.#m=[(f[0]-a)/u,(f[1]-o)/h]}static initialize(t,e){Xt.initialize(t,e),vi._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case Se.HIGHLIGHT_COLOR:vi._defaultColor=e;break;case Se.HIGHLIGHT_THICKNESS:vi._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case Se.HIGHLIGHT_COLOR:this.#x(e);break;case Se.HIGHLIGHT_THICKNESS:this.#E(e);break}}static get defaultPropertiesToUpdate(){return[[Se.HIGHLIGHT_COLOR,vi._defaultColor],[Se.HIGHLIGHT_THICKNESS,vi._defaultThickness]]}get propertiesToUpdate(){return[[Se.HIGHLIGHT_COLOR,this.color||vi._defaultColor],[Se.HIGHLIGHT_THICKNESS,this.#p||vi._defaultThickness],[Se.HIGHLIGHT_FREE,this.#c]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#a?.updateColor(this.color),super.onUpdatedColor()}#x(t){const e=(a,o)=>{this.color=a,this.opacity=o,this.onUpdatedColor()},i=this.color,s=this.opacity;this.addCommands({cmd:e.bind(this,t,vi._defaultOpacity),undo:e.bind(this,i,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Se.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#E(t){const e=this.#p,i=s=>{this.#p=s,this.#_(s)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Se.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#a=new Ln({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#R())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#R())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#T(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#A(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#T():t&&(this.#A(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#_(t){this.#c&&(this.#y({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#T(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#g),this.#g=null)}#A(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#i}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#c},path:{d:this.#l.toSVGPath()}},!1,!0),this.#g=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#c},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#c),this.#u&&(this.#u.style.clipPath=this.#i))}static#S([t,e,i,s],a){switch(a){case 90:return[1-e-s,t,s,i];case 180:return[1-t-i,1-e-s,i,s];case 270:return[e,1-t-i,s,i]}return[t,e,i,s]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#c?(t=(t-this.rotation+360)%360,i=vi.#S(this.#l.box,t)):i=vi.#S([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#g,{bbox:vi.#S(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#h&&(t.setAttribute("aria-label",this.#h),t.setAttribute("role","mark")),this.#c?t.classList.add("free"):this.div.addEventListener("keydown",this.#N.bind(this),{signal:this._uiManager._signal});const e=this.#u=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#i,this.setDims(),_y(this,this.#u,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1}})}#N(t){vi._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#D(!0);break;case 1:case 3:this.#D(!1);break}}#D(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#s,this.#o)}select(){super.select(),this.#g&&this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#g&&(this.parent?.drawLayer.updateProperties(this.#g,{rootClass:{selected:!1}}),this.#c||this.#D(!1))}get _mustFixPosition(){return!this.#c}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#g,{rootClass:{hidden:!t}}))}#R(){return this.#c?this.rotation:0}#z(){if(this.#c)return null;const[t,e]=this.pageDimensions,[i,s]=this.pageTranslation,a=this.#n,o=new Float32Array(a.length*8);let u=0;for(const{x:h,y:d,width:f,height:p}of a){const v=h*t+i,A=(1-d)*e+s;o[u]=o[u+4]=v,o[u+1]=o[u+3]=A,o[u+2]=o[u+6]=v+f*t,o[u+5]=o[u+7]=A-p*e,u+=8}return o}#k(t){return this.#l.serialize(t,this.#R())}static startHighlighting(t,e,{target:i,x:s,y:a}){const{x:o,y:u,width:h,height:d}=i.getBoundingClientRect(),f=new AbortController,p=t.combinedSignal(f),v=A=>{f.abort(),this.#F(t,A)};window.addEventListener("blur",v,{signal:p}),window.addEventListener("pointerup",v,{signal:p}),window.addEventListener("pointerdown",ci,{capture:!0,passive:!1,signal:p}),window.addEventListener("contextmenu",In,{signal:p}),i.addEventListener("pointermove",this.#L.bind(this,t),{signal:p}),this._freeHighlight=new bf({x:s,y:a},[o,u,h,d],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let s=null;if(t instanceof qy){const{data:{quadPoints:C,rect:w,rotation:b,id:_,color:x,opacity:D,popupRef:M,richText:T,contentsObj:O,creationDate:k,modificationDate:z},parent:{page:{pageNumber:B}}}=t;s=t={annotationType:le.HIGHLIGHT,color:Array.from(x),opacity:D,quadPoints:C,boxes:null,pageIndex:B-1,rect:w.slice(0),rotation:b,annotationElementId:_,id:_,deleted:!1,popupRef:M,richText:T,comment:O?.str||null,creationDate:k,modificationDate:z}}else if(t instanceof zf){const{data:{inkLists:C,rect:w,rotation:b,id:_,color:x,borderStyle:{rawWidth:D},popupRef:M,richText:T,contentsObj:O,creationDate:k,modificationDate:z},parent:{page:{pageNumber:B}}}=t;s=t={annotationType:le.HIGHLIGHT,color:Array.from(x),thickness:D,inkLists:C,boxes:null,pageIndex:B-1,rect:w.slice(0),rotation:b,annotationElementId:_,id:_,deleted:!1,popupRef:M,richText:T,comment:O?.str||null,creationDate:k,modificationDate:z}}const{color:a,quadPoints:o,inkLists:u,opacity:h}=t,d=await super.deserialize(t,e,i);d.color=Pt.makeHexColor(...a),d.opacity=h||1,u&&(d.#p=t.thickness),d._initialData=s,t.comment&&d.setCommentData(t);const[f,p]=d.pageDimensions,[v,A]=d.pageTranslation;if(o){const C=d.#n=[];for(let w=0;w<o.length;w+=8)C.push({x:(o[w]-v)/f,y:1-(o[w+1]-A)/p,width:(o[w+2]-o[w])/f,height:(o[w+1]-o[w+5])/p});d.#b(),d.#A(),d.rotate(d.rotation)}else if(u){d.#c=!0;const C=u[0],w={x:C[0]-v,y:p-(C[1]-A)},b=new bf(w,[0,0,f,p],1,d.#p/2,!0,.001);for(let D=0,M=C.length;D<M;D+=2)w.x=C[D]-v,w.y=p-(C[D+1]-A),b.add(w);const{id:_,clipPathId:x}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:b.toSVGPath()}},!0,!0);d.#y({highlightOutlines:b.getOutlines(),highlightId:_,clipPathId:x}),d.#A(),d.rotate(d.parentRotation)}return d}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Xt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#z(),outlines:this.#k(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#B(i)?null:(i.id=this.annotationElementId,i)}#B(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,s)=>i!==e[s])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Xy{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){We("Not implemented")}}class Be extends Xt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#i=null;static#a=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#u())}#r({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#s(t,this.parent),this.#c(t.box)}#s(t,e){const{id:i}=e.drawLayer.draw(Be._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[s,a]of Object.entries(e))i.has(s)?Object.assign(t[s],a):t[s]=a;return t}static getDefaultDrawingOptions(t){We("Not implemented")}static get typesMap(){We("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(Be.#n.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,s]of this.typesMap)t.push([i,e[s]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,s]of this.constructor.typesMap)t.push([i,e[s]]);return t}_updateProperty(t,e,i){const s=this._drawingOptions,a=s[e],o=u=>{s.updateProperty(e,u);const h=this.#t.updateProperty(e,u);h&&this.#c(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:o.bind(this,i),undo:o.bind(this,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#u(),this.#c(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#u(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#u(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#s(this.#t,t)}}#l([t,e,i,s]){const{parentDimensions:[a,o],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(o/a),s*(a/o)];case 180:return[1-t,1-e,i,s];case 270:return[1-e,t,i*(o/a),s*(a/o)];default:return[t,e,i,s]}}#d(){const{x:t,y:e,width:i,height:s,parentDimensions:[a,o],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(a/o),s*(o/a)];case 180:return[1-t,1-e,i,s];case 270:return[e,1-t,i*(a/o),s*(o/a)];default:return[t,e,i,s]}}#c(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:i,height:s,rotation:a,parentRotation:o,parentDimensions:[u,h]}=this;switch((a*4+o)/90){case 1:return[1-e-s,t,s,i];case 2:return[1-t-i,1-e-s,i,s];case 3:return[e,1-t-i,s,i];case 4:return[t,e-i*(u/h),s*(h/u),i*(u/h)];case 5:return[1-e,t,i*(u/h),s*(h/u)];case 6:return[1-t-s*(h/u),1-e,s*(h/u),i*(u/h)];case 7:return[e-i*(u/h),1-t-s*(h/u),i*(u/h),s*(h/u)];case 8:return[t-i,e-s,i,s];case 9:return[1-e,t-i,s,i];case 10:return[1-t,1-e,i,s];case 11:return[e-s,1-t,s,i];case 12:return[t-s*(h/u),e,s*(h/u),i*(u/h)];case 13:return[1-e-i*(u/h),t-s*(h/u),i*(u/h),s*(h/u)];case 14:return[1-t,1-e-i*(u/h),s*(h/u),i*(u/h)];case 15:return[e,1-t,i*(u/h),s*(h/u)];default:return[t,e,i,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,Be._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#c(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const s=document.createElement("div");return i.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,s,a){We("Not implemented")}static startDrawing(t,e,i,s){const{target:a,offsetX:o,offsetY:u,pointerId:h,pointerType:d}=s;if(Ie.isInitializedAndDifferentPointerType(d))return;const{viewport:{rotation:f}}=t,{width:p,height:v}=a.getBoundingClientRect(),A=Be.#i=new AbortController,C=t.combinedSignal(A);if(Ie.setPointer(d,h),window.addEventListener("pointerup",w=>{Ie.isSamePointerIdOrRemove(w.pointerId)&&this._endDraw(w)},{signal:C}),window.addEventListener("pointercancel",w=>{Ie.isSamePointerIdOrRemove(w.pointerId)&&this._currentParent.endDrawingSession()},{signal:C}),window.addEventListener("pointerdown",w=>{Ie.isSamePointerType(w.pointerType)&&(Ie.initializeAndAddPointerId(w.pointerId),Be.#n.isCancellable()&&(Be.#n.removeLastElement(),Be.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:C}),window.addEventListener("contextmenu",In,{signal:C}),a.addEventListener("pointermove",this._drawMove.bind(this),{signal:C}),a.addEventListener("touchmove",w=>{Ie.isSameTimeStamp(w.timeStamp)&&ci(w)},{signal:C}),t.toggleDrawing(),e._editorUndoBar?.hide(),Be.#n){t.drawLayer.updateProperties(this._currentDrawId,Be.#n.startNew(o,u,p,v,f));return}e.updateUIForDefaultProperties(this),Be.#n=this.createDrawerInstance(o,u,p,v,f),Be.#a=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(Be.#a.toSVGProperties(),Be.#n.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Ie.isSameTimeStamp(t.timeStamp),!Be.#n)return;const{offsetX:e,offsetY:i,pointerId:s}=t;if(Ie.isSamePointerId(s)){if(Ie.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,Be.#n.add(e,i)),Ie.setTimeStamp(t.timeStamp),ci(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,Be.#n=null,Be.#a=null,Ie.clearTimeStamp()),Be.#i&&(Be.#i.abort(),Be.#i=null,Ie.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,Be.#n.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=Be.#n,s=this._currentDrawId,a=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(s,i.setLastElement(a))},undo:()=>{e.drawLayer.updateProperties(s,i.removeLastElement())},mustExec:!1,type:Se.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(Se.DRAW_STEP),!Be.#n.isEmpty()){const{pageDimensions:[i,s],scale:a}=e,o=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:Be.#n.getOutlines(i*a,s*a,a,this._INNER_MARGIN),drawingOptions:Be.#a,mustBeCommitted:!t});return this._cleanup(!0),o}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,s,a,o){We("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:s,pageHeight:a,pageX:o,pageY:u}}=e.viewport,h=this.deserializeDraw(o,u,s,a,this._INNER_MARGIN,t),d=await super.deserialize(t,e,i);return d.createDrawingOptions(t),d.#r({drawOutlines:h}),d.#u(),d.onScaleChanging(),d.rotate(),d}serializeDraw(t){const[e,i]=this.pageTranslation,[s,a]=this.pageDimensions;return this.#t.serialize([e,i,s,a],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class k_{#t=new Float64Array(6);#e;#n;#i;#a;#r;#s="";#o=0;#u=new il;#l;#d;constructor(t,e,i,s,a,o){this.#l=i,this.#d=s,this.#i=a,this.#a=o,[t,e]=this.#c(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#n=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#a=e)}#c(t,e){return Ut._normalizePoint(t,e,this.#l,this.#d,this.#i)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#c(t,e);const[i,s,a,o]=this.#t.subarray(2,6),u=t-a,h=e-o;return Math.hypot(this.#l*u,this.#d*h)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([a,o,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,s,a,o,t,e],0),this.#e.push(...Ut.createBezierPoints(i,s,a,o,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,s,a){this.#l=i,this.#d=s,this.#i=a,[t,e]=this.#c(t,e);const o=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const u=this.#n.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#n.push({line:o,points:this.#r}),this.#t.set(o,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(t){return this.#n?(this.#n.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#u.setLastElement(t)}removeLastElement(){if(!this.#n)return this.#u.removeLastElement();this.#n.pop(),this.#s="";for(let t=0,e=this.#n.length;t<e;t++){const{line:i,points:s}=this.#n[t];this.#e=i,this.#r=s,this.#o=0,this.toSVGPath()}return{path:{d:this.#s}}}toSVGPath(){const t=Ut.svgRound(this.#e[4]),e=Ut.svgRound(this.#e[5]);if(this.#r.length===2)return this.#s=`${this.#s} M ${t} ${e} Z`,this.#s;if(this.#r.length<=6){const s=this.#s.lastIndexOf("M");this.#s=`${this.#s.slice(0,s)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const s=Ut.svgRound(this.#e[10]),a=Ut.svgRound(this.#e[11]);return this.#s=`${this.#s} L ${s} ${a}`,this.#o=12,this.#s}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let s=this.#o,a=this.#e.length;s<a;s+=6){const[o,u,h,d,f,p]=this.#e.slice(s,s+6).map(Ut.svgRound);i.push(`C${o} ${u} ${h} ${d} ${f} ${p}`)}return this.#s+=i.join(" "),this.#o=this.#e.length,this.#s}getOutlines(t,e,i,s){const a=this.#n.at(-1);return a.line=new Float32Array(a.line),a.points=new Float32Array(a.points),this.#u.build(this.#n,t,e,i,this.#i,this.#a,s),this.#t=null,this.#e=null,this.#n=null,this.#s=null,this.#u}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class il extends Ut{#t;#e=0;#n;#i;#a;#r;#s;#o;#u;build(t,e,i,s,a,o,u){this.#a=e,this.#r=i,this.#s=s,this.#o=a,this.#u=o,this.#n=u??0,this.#i=t,this.#c()}get thickness(){return this.#u}setLastElement(t){return this.#i.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#i.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#i){if(t.push(`M${Ut.svgRound(e[4])} ${Ut.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Ut.svgRound(e[10])} ${Ut.svgRound(e[11])}`);continue}for(let i=6,s=e.length;i<s;i+=6){const[a,o,u,h,d,f]=e.subarray(i,i+6).map(Ut.svgRound);t.push(`C${a} ${o} ${u} ${h} ${d} ${f}`)}}return t.join("")}serialize([t,e,i,s],a){const o=[],u=[],[h,d,f,p]=this.#d();let v,A,C,w,b,_,x,D,M;switch(this.#o){case 0:M=Ut._rescale,v=t,A=e+s,C=i,w=-s,b=t+h*i,_=e+(1-d-p)*s,x=t+(h+f)*i,D=e+(1-d)*s;break;case 90:M=Ut._rescaleAndSwap,v=t,A=e,C=i,w=s,b=t+d*i,_=e+h*s,x=t+(d+p)*i,D=e+(h+f)*s;break;case 180:M=Ut._rescale,v=t+i,A=e,C=-i,w=s,b=t+(1-h-f)*i,_=e+d*s,x=t+(1-h)*i,D=e+(d+p)*s;break;case 270:M=Ut._rescaleAndSwap,v=t+i,A=e+s,C=-i,w=-s,b=t+(1-d-p)*i,_=e+(1-h-f)*s,x=t+(1-d)*i,D=e+(1-h)*s;break}for(const{line:T,points:O}of this.#i)o.push(M(T,v,A,C,w,a?new Array(T.length):null)),u.push(M(O,v,A,C,w,a?new Array(O.length):null));return{lines:o,points:u,rect:[b,_,x,D]}}static deserialize(t,e,i,s,a,{paths:{lines:o,points:u},rotation:h,thickness:d}){const f=[];let p,v,A,C,w;switch(h){case 0:w=Ut._rescale,p=-t/i,v=e/s+1,A=1/i,C=-1/s;break;case 90:w=Ut._rescaleAndSwap,p=-e/s,v=-t/i,A=1/s,C=1/i;break;case 180:w=Ut._rescale,p=t/i+1,v=-e/s,A=-1/i,C=1/s;break;case 270:w=Ut._rescaleAndSwap,p=e/s+1,v=t/i+1,A=-1/s,C=-1/i;break}if(!o){o=[];for(const _ of u){const x=_.length;if(x===2){o.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1]]));continue}if(x===4){o.push(new Float32Array([NaN,NaN,NaN,NaN,_[0],_[1],NaN,NaN,NaN,NaN,_[2],_[3]]));continue}const D=new Float32Array(3*(x-2));o.push(D);let[M,T,O,k]=_.subarray(0,4);D.set([NaN,NaN,NaN,NaN,M,T],0);for(let z=4;z<x;z+=2){const B=_[z],H=_[z+1];D.set(Ut.createBezierPoints(M,T,O,k,B,H),(z-2)*3),[M,T,O,k]=[O,k,B,H]}}}for(let _=0,x=o.length;_<x;_++)f.push({line:w(o[_].map(D=>D??NaN),p,v,A,C),points:w(u[_].map(D=>D??NaN),p,v,A,C)});const b=new this.prototype.constructor;return b.build(f,i,s,1,h,d,a),b}#l(t=this.#u){const e=this.#n+t/2*this.#s;return this.#o%180===0?[e/this.#a,e/this.#r]:[e/this.#r,e/this.#a]}#d(){const[t,e,i,s]=this.#t,[a,o]=this.#l(0);return[t+a,e+o,i-2*a,s-2*o]}#c(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#i){if(s.length<=12){for(let u=4,h=s.length;u<h;u+=6)Pt.pointBoundingBox(s[u],s[u+1],t);continue}let a=s[4],o=s[5];for(let u=6,h=s.length;u<h;u+=6){const[d,f,p,v,A,C]=s.subarray(u,u+6);Pt.bezierBoundingBox(a,o,d,f,p,v,A,C,t),a=A,o=C}}const[e,i]=this.#l();t[0]=$i(t[0]-e,0,1),t[1]=$i(t[1]-i,0,1),t[2]=$i(t[2]+e,0,1),t[3]=$i(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#u=t;const[s,a]=this.#l(),[o,u]=[s-e,a-i],h=this.#t;return h[0]-=o,h[1]-=u,h[2]+=2*o,h[3]+=2*u,h}updateParentDimensions([t,e],i){const[s,a]=this.#l();this.#a=t,this.#r=e,this.#s=i;const[o,u]=this.#l(),h=o-s,d=u-a,f=this.#t;return f[0]-=h,f[1]-=d,f[2]+=2*h,f[3]+=2*d,f}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Ut.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ut.svgRound(t)} ${Ut.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,s=0,a=0,o=0,u=0,h=0;switch(this.#e){case 90:s=e/t,a=-t/e,u=t;break;case 180:i=-1,o=-1,u=t,h=e;break;case 270:s=-e/t,a=t/e,h=e;break;default:return""}return`matrix(${i} ${s} ${a} ${o} ${Ut.svgRound(u)} ${Ut.svgRound(h)})`}getPathResizingSVGProperties([t,e,i,s]){const[a,o]=this.#l(),[u,h,d,f]=this.#t;if(Math.abs(d-a)<=Ut.PRECISION||Math.abs(f-o)<=Ut.PRECISION){const w=t+i/2-(u+d/2),b=e+s/2-(h+f/2);return{path:{"transform-origin":`${Ut.svgRound(t)} ${Ut.svgRound(e)}`,transform:`${this.rotationTransform} translate(${w} ${b})`}}}const p=(i-2*a)/(d-2*a),v=(s-2*o)/(f-2*o),A=d/i,C=f/s;return{path:{"transform-origin":`${Ut.svgRound(u)} ${Ut.svgRound(h)}`,transform:`${this.rotationTransform} scale(${A} ${C}) translate(${Ut.svgRound(a)} ${Ut.svgRound(o)}) scale(${p} ${v}) translate(${Ut.svgRound(-a)} ${Ut.svgRound(-o)})`}}}getPathResizedSVGProperties([t,e,i,s]){const[a,o]=this.#l(),u=this.#t,[h,d,f,p]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=s,Math.abs(f-a)<=Ut.PRECISION||Math.abs(p-o)<=Ut.PRECISION){const b=t+i/2-(h+f/2),_=e+s/2-(d+p/2);for(const{line:x,points:D}of this.#i)Ut._translate(x,b,_,x),Ut._translate(D,b,_,D);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ut.svgRound(t)} ${Ut.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const v=(i-2*a)/(f-2*a),A=(s-2*o)/(p-2*o),C=-v*(h+a)+t+a,w=-A*(d+o)+e+o;if(v!==1||A!==1||C!==0||w!==0)for(const{line:b,points:_}of this.#i)Ut._rescale(b,C,w,v,A,b),Ut._rescale(_,C,w,v,A,_);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Ut.svgRound(t)} ${Ut.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[s,a]=i,o=this.#t,u=t-o[0],h=e-o[1];if(this.#a===s&&this.#r===a)for(const{line:d,points:f}of this.#i)Ut._translate(d,u,h,d),Ut._translate(f,u,h,f);else{const d=this.#a/s,f=this.#r/a;this.#a=s,this.#r=a;for(const{line:p,points:v}of this.#i)Ut._rescale(p,u,h,d,f,p),Ut._rescale(v,u,h,d,f,v);o[2]*=d,o[3]*=f}return o[0]=t,o[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Ut.svgRound(t)} ${Ut.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Ut.svgRound(t[0])} ${Ut.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class Wu extends Xy{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Xt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new Wu(this._viewParameters);return t.updateAll(this),t}}class Pf extends Be{static _type="ink";static _editorType=le.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Xt.initialize(t,e),this._defaultDrawingOptions=new Wu(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return oe(this,"typesMap",new Map([[Se.INK_THICKNESS,"stroke-width"],[Se.INK_COLOR,"stroke"],[Se.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,s,a){return new k_(t,e,i,s,a,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,s,a,o){return il.deserialize(t,e,i,s,a,o)}static async deserialize(t,e,i){let s=null;if(t instanceof zf){const{data:{inkLists:o,rect:u,rotation:h,id:d,color:f,opacity:p,borderStyle:{rawWidth:v},popupRef:A,richText:C,contentsObj:w,creationDate:b,modificationDate:_},parent:{page:{pageNumber:x}}}=t;s=t={annotationType:le.INK,color:Array.from(f),thickness:v,opacity:p,paths:{points:o},boxes:null,pageIndex:x-1,rect:u.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:A,richText:C,comment:w?.str||null,creationDate:b,modificationDate:_}}const a=await super.deserialize(t,e,i);return a._initialData=s,t.comment&&a.setCommentData(t),a}get toolbarButtons(){return this._colorPicker||=new Yo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Se.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=Pf.getDefaultDrawingOptions({stroke:Pt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:s,"stroke-opacity":a,"stroke-width":o}}=this,u=Object.assign(super.serialize(t),{color:Xt._colorManager.convert(s),opacity:a,thickness:o,paths:{lines:e,points:i}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:s,pageIndex:a}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((o,u)=>o!==e[u])||t.thickness!==i||t.opacity!==s||t.pageIndex!==a}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class Af extends il{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const _u=8,Bo=3;class Sa{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,s){return i-=t,s-=e,i===0?s>0?0:4:i===1?s+6:2-s}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#i(t,e,i,s,a,o,u){const h=this.#e(i,s,a,o);for(let d=0;d<8;d++){const f=(-d+h-u+16)%8,p=this.#n[2*f],v=this.#n[2*f+1];if(t[(i+p)*e+(s+v)]!==0)return f}return-1}static#a(t,e,i,s,a,o,u){const h=this.#e(i,s,a,o);for(let d=0;d<8;d++){const f=(d+h+u+16)%8,p=this.#n[2*f],v=this.#n[2*f+1];if(t[(i+p)*e+(s+v)]!==0)return f}return-1}static#r(t,e,i,s){const a=t.length,o=new Int32Array(a);for(let f=0;f<a;f++)o[f]=t[f]<=s?1:0;for(let f=1;f<i-1;f++)o[f*e]=o[f*e+e-1]=0;for(let f=0;f<e;f++)o[f]=o[e*i-1-f]=0;let u=1,h;const d=[];for(let f=1;f<i-1;f++){h=1;for(let p=1;p<e-1;p++){const v=f*e+p,A=o[v];if(A===0)continue;let C=f,w=p;if(A===1&&o[v-1]===0)u+=1,w-=1;else if(A>=1&&o[v+1]===0)u+=1,w+=1,A>1&&(h=A);else{A!==1&&(h=Math.abs(A));continue}const b=[p,f],_=w===p+1,x={isHole:_,points:b,id:u,parent:0};d.push(x);let D;for(const V of d)if(V.id===h){D=V;break}D?D.isHole?x.parent=_?D.parent:h:x.parent=_?h:D.parent:x.parent=_?h:0;const M=this.#i(o,e,f,p,C,w,0);if(M===-1){o[v]=-u,o[v]!==1&&(h=Math.abs(o[v]));continue}let T=this.#n[2*M],O=this.#n[2*M+1];const k=f+T,z=p+O;C=k,w=z;let B=f,H=p;for(;;){const V=this.#a(o,e,B,H,C,w,1);T=this.#n[2*V],O=this.#n[2*V+1];const Z=B+T,rt=H+O;b.push(rt,Z);const ft=B*e+H;if(o[ft+1]===0?o[ft]=-u:o[ft]===1&&(o[ft]=u),Z===f&&rt===p&&B===k&&H===z){o[v]!==1&&(h=Math.abs(o[v]));break}else C=B,w=H,B=Z,H=rt}}}return d}static#s(t,e,i,s){if(i-e<=4){for(let k=e;k<i-2;k+=2)s.push(t[k],t[k+1]);return}const a=t[e],o=t[e+1],u=t[i-4]-a,h=t[i-3]-o,d=Math.hypot(u,h),f=u/d,p=h/d,v=f*o-p*a,A=h/u,C=1/d,w=Math.atan(A),b=Math.cos(w),_=Math.sin(w),x=C*(Math.abs(b)+Math.abs(_)),D=C*(1-x+x**2),M=Math.max(Math.atan(Math.abs(_+b)*D),Math.atan(Math.abs(_-b)*D));let T=0,O=e;for(let k=e+2;k<i-2;k+=2){const z=Math.abs(v-f*t[k+1]+p*t[k]);z>T&&(O=k,T=z)}T>(d*M)**2?(this.#s(t,e,O+2,s),this.#s(t,O,i,s)):s.push(a,o)}static#o(t){const e=[],i=t.length;return this.#s(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#u(t,e,i,s,a,o){const u=new Float32Array(o**2),h=-2*s**2,d=o>>1;for(let w=0;w<o;w++){const b=(w-d)**2;for(let _=0;_<o;_++)u[w*o+_]=Math.exp((b+(_-d)**2)/h)}const f=new Float32Array(256),p=-2*a**2;for(let w=0;w<256;w++)f[w]=Math.exp(w**2/p);const v=t.length,A=new Uint8Array(v),C=new Uint32Array(256);for(let w=0;w<i;w++)for(let b=0;b<e;b++){const _=w*e+b,x=t[_];let D=0,M=0;for(let O=0;O<o;O++){const k=w+O-d;if(!(k<0||k>=i))for(let z=0;z<o;z++){const B=b+z-d;if(B<0||B>=e)continue;const H=t[k*e+B],V=u[O*o+z]*f[Math.abs(H-x)];D+=H*V,M+=V}}const T=A[_]=Math.round(D/M);C[T]++}return[A,C]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let s=-1/0,a=1/0;for(let u=0,h=i.length;u<h;u++){const d=i[u]=t[u<<2];s=Math.max(s,d),a=Math.min(a,d)}const o=255/(s-a);for(let u=0,h=i.length;u<h;u++)i[u]=(i[u]-a)*o;return i}static#c(t){let e,i=-1/0,s=-1/0;const a=t.findIndex(h=>h!==0);let o=a,u=a;for(e=a;e<256;e++){const h=t[e];h>i&&(e-o>s&&(s=e-o,u=e-1),i=h,o=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:s}=t,{maxDim:a}=this.#t;let o=i,u=s;if(i>a||s>a){let v=i,A=s,C=Math.log2(Math.max(i,s)/a);const w=Math.floor(C);C=C===w?w-1:w;for(let _=0;_<C;_++){o=Math.ceil(v/2),u=Math.ceil(A/2);const x=new OffscreenCanvas(o,u);x.getContext("2d").drawImage(t,0,0,v,A,0,0,o,u),v=o,A=u,t!==e&&t.close(),t=x.transferToImageBitmap()}const b=Math.min(a/o,a/u);o=Math.round(o*b),u=Math.round(u*b)}const d=new OffscreenCanvas(o,u).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,o,u),d.filter="grayscale(1)",d.drawImage(t,0,0,t.width,t.height,0,0,o,u);const f=d.getImageData(0,0,o,u).data;return[this.#d(f),o,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:s},a,o,u,h){let d=new OffscreenCanvas(1,1),f=d.getContext("2d",{alpha:!1});const p=200,v=f.font=`${i} ${s} ${p}px ${e}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:C,actualBoundingBoxAscent:w,actualBoundingBoxDescent:b,fontBoundingBoxAscent:_,fontBoundingBoxDescent:x,width:D}=f.measureText(t),M=1.5,T=Math.ceil(Math.max(Math.abs(A)+Math.abs(C)||0,D)*M),O=Math.ceil(Math.max(Math.abs(w)+Math.abs(b)||p,Math.abs(_)+Math.abs(x)||p)*M);d=new OffscreenCanvas(T,O),f=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),f.font=v,f.filter="grayscale(1)",f.fillStyle="white",f.fillRect(0,0,T,O),f.fillStyle="black",f.fillText(t,T*(M-1)/2,O*(3-M)/2);const k=this.#d(f.getImageData(0,0,T,O).data),z=this.#l(k),B=this.#c(z),H=this.#r(k,T,O,B);return this.processDrawnLines({lines:{curves:H,width:T,height:O},pageWidth:a,pageHeight:o,rotation:u,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(t,e,i,s,a){const[o,u,h]=this.#f(t),[d,f]=this.#u(o,u,h,Math.hypot(u,h)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),p=this.#c(f),v=this.#r(d,u,h,p);return this.processDrawnLines({lines:{curves:v,width:u,height:h},pageWidth:e,pageHeight:i,rotation:s,innerMargin:a,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:a,mustSmooth:o,areContours:u}){s%180!==0&&([e,i]=[i,e]);const{curves:h,width:d,height:f}=t,p=t.thickness??0,v=[],A=Math.min(e/d,i/f),C=A/e,w=A/i,b=[];for(const{points:x}of h){const D=o?this.#o(x):x;if(!D)continue;b.push(D);const M=D.length,T=new Float32Array(M),O=new Float32Array(3*(M===2?2:M-2));if(v.push({line:O,points:T}),M===2){T[0]=D[0]*C,T[1]=D[1]*w,O.set([NaN,NaN,NaN,NaN,T[0],T[1]],0);continue}let[k,z,B,H]=D;k*=C,z*=w,B*=C,H*=w,T.set([k,z,B,H],0),O.set([NaN,NaN,NaN,NaN,k,z],0);for(let V=4;V<M;V+=2){const Z=T[V]=D[V]*C,rt=T[V+1]=D[V+1]*w;O.set(Ut.createBezierPoints(k,z,B,H,Z,rt),(V-2)*3),[k,z,B,H]=[B,H,Z,rt]}}if(v.length===0)return null;const _=u?new Af:new il;return _.build(v,e,i,1,s,u?0:p,a),{outline:_,newCurves:b,areContours:u,thickness:p,width:d,height:f}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:s,height:a}){let o=1/0,u=-1/0,h=0;for(const D of t){h+=D.length;for(let M=2,T=D.length;M<T;M++){const O=D[M]-D[M-2];o=Math.min(o,O),u=Math.max(u,O)}}let d;o>=-128&&u<=127?d=Int8Array:o>=-32768&&u<=32767?d=Int16Array:d=Int32Array;const f=t.length,p=_u+Bo*f,v=new Uint32Array(p);let A=0;v[A++]=p*Uint32Array.BYTES_PER_ELEMENT+(h-2*f)*d.BYTES_PER_ELEMENT,v[A++]=0,v[A++]=s,v[A++]=a,v[A++]=e?0:1,v[A++]=Math.max(0,Math.floor(i??0)),v[A++]=f,v[A++]=d.BYTES_PER_ELEMENT;for(const D of t)v[A++]=D.length-2,v[A++]=D[0],v[A++]=D[1];const C=new CompressionStream("deflate-raw"),w=C.writable.getWriter();await w.ready,w.write(v);const b=d.prototype.constructor;for(const D of t){const M=new b(D.length-2);for(let T=2,O=D.length;T<O;T++)M[T-2]=D[T]-D[T-2];w.write(M)}w.close();const _=await new Response(C.readable).arrayBuffer(),x=new Uint8Array(_);return vy(x)}static async decompressSignature(t){try{const e=Y1(t),{readable:i,writable:s}=new DecompressionStream("deflate-raw"),a=s.getWriter();await a.ready,a.write(e).then(async()=>{await a.ready,await a.close()}).catch(()=>{});let o=null,u=0;for await(const D of i)o||=new Uint8Array(new Uint32Array(D.buffer,0,4)[0]),o.set(D,u),u+=D.length;const h=new Uint32Array(o.buffer,0,o.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const f=h[2],p=h[3],v=h[4]===0,A=h[5],C=h[6],w=h[7],b=[],_=(_u+Bo*C)*Uint32Array.BYTES_PER_ELEMENT;let x;switch(w){case Int8Array.BYTES_PER_ELEMENT:x=new Int8Array(o.buffer,_);break;case Int16Array.BYTES_PER_ELEMENT:x=new Int16Array(o.buffer,_);break;case Int32Array.BYTES_PER_ELEMENT:x=new Int32Array(o.buffer,_);break}u=0;for(let D=0;D<C;D++){const M=h[Bo*D+_u],T=new Float32Array(M+2);b.push(T);for(let O=0;O<Bo-1;O++)T[O]=h[Bo*D+_u+O+1];for(let O=0;O<M;O++)T[O+2]=T[O]+x[u++]}return{areContours:v,thickness:A,outlines:b,width:f,height:p}}catch(e){return ae(`decompressSignature: ${e}`),null}}}class Uf extends Xy{constructor(){super(),super.updateProperties({fill:Xt._defaultLineColor,"stroke-width":0})}clone(){const t=new Uf;return t.updateAll(this),t}}class Hf extends Wu{constructor(t){super(t),super.updateProperties({stroke:Xt._defaultLineColor,"stroke-width":1})}clone(){const t=new Hf(this._viewParameters);return t.updateAll(this),t}}class ns extends Be{#t=!1;#e=null;#n=null;#i=null;static _type="signature";static _editorType=le.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Xt.initialize(t,e),this._defaultDrawingOptions=new Uf,this._defaultDrawnSignatureOptions=new Hf(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return oe(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:s,mustSmooth:a,areContours:o,description:u,uuid:h,heightInPage:d}=this.#n,{rawDims:{pageWidth:f,pageHeight:p},rotation:v}=this.parent.viewport,A=Sa.processDrawnLines({lines:s,pageWidth:f,pageHeight:p,rotation:v,innerMargin:ns._INNER_MARGIN,mustSmooth:a,areContours:o});this.addSignature(A,d,u,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#i=t,this.addEditToolbar()}getUuid(){return this.#i}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:s,height:a}=this.#n,o=Math.max(s,a),u=Sa.processDrawnLines({lines:{curves:t.map(h=>({points:h})),thickness:i,width:s,height:a},pageWidth:o,pageHeight:o,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,s){const{x:a,y:o}=this,{outline:u}=this.#n=t;this.#t=u instanceof Af,this.description=i;let h;this.#t?h=ns.getDefaultDrawingOptions():(h=ns._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:h});const[,d]=this.pageDimensions;let f=e/d;f=f>=1?.5:f,this.width*=f/this.height,this.width>=1&&(f*=.9/this.width,this.width=.9),this.height=f,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return Sa.process(t,e,i,s,ns._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:s},rotation:a}=this.parent.viewport;return Sa.extractContoursFromText(t,e,i,s,a,ns._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:s}=this.parent.viewport;return Sa.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:s,innerMargin:ns._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=ns.getDefaultDrawingOptions():(this._drawingOptions=ns._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":s}}=this,a=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:s});return this.addComment(a),t?(a.paths={lines:e,points:i},a.uuid=this.#i,a.isCopy=!0):a.lines=e,this.#e&&(a.accessibilityData={type:"Figure",alt:this.#e}),a}static deserializeDraw(t,e,i,s,a,o){return o.areContours?Af.deserialize(t,e,i,s,a,o):il.deserialize(t,e,i,s,a,o)}static async deserialize(t,e,i){const s=await super.deserialize(t,e,i);return s.#t=t.areContours,s.description=t.accessibilityData?.alt||"",s.#i=t.uuid,s}}class M_ extends Xt{#t=null;#e=null;#n=null;#i=null;#a=null;#r="";#s=null;#o=!1;#u=null;#l=!1;#d=!1;static _type="stamp";static _editorType=le.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#i=t.bitmapUrl,this.#a=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Xt.initialize(t,e)}static isHandlingMimeForPasting(t){return cf.includes(t)}static paste(t,e){e.pasteEditor({mode:le.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#c(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#g()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#s){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:a,height:o}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:s,width:a,height:o,channels:s.length/(a*o)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const h=u.output;return await this.setGuessedAltText(h),e&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#c(i,!0)).finally(()=>this.#f());return}if(this.#i){const i=this.#i;this.#i=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(i).then(s=>this.#c(s)).finally(()=>this.#f());return}if(this.#a){const i=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(i).then(s=>this.#c(s)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=cf.join(",");const e=this._uiManager._signal;this.#n=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#c(s)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#s?.remove(),this.#s=null,this.#u&&(clearTimeout(this.#u),this.#u=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#m();return}super.rebuild(),this.div!==null&&(this.#e&&this.#s===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#n||this.#t||this.#i||this.#a||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#g():this.#m()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:s}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,s&&(this.#t=s),this.#o=!1,this.#g())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#u!==null&&clearTimeout(this.#u);const t=200;this.#u=setTimeout(()=>{this.#u=null,this.#p()},t)}#g(){const{div:t}=this;let{width:e,height:i}=this.#t;const[s,a]=this.pageDimensions,o=.75;if(this.width)e=this.width*s,i=this.height*a;else if(e>o*s||i>o*a){const h=Math.min(o*s/e,o*a/i);e*=h,i*=h}this._uiManager.enableWaiting(!1);const u=this.#s=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/s,this.height=i/a,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:s,height:a}=this.#t,o=new as;let u=this.#t,h=s,d=a,f=null;if(e){if(s>e||a>e){const O=Math.min(e/s,e/a);h=Math.floor(s*O),d=Math.floor(a*O)}f=document.createElement("canvas");const v=f.width=Math.ceil(h*o.sx),A=f.height=Math.ceil(d*o.sy);this.#l||(u=this.#h(v,A));const C=f.getContext("2d");C.filter=this._uiManager.hcmFilter;let w="white",b="#cfcfd8";this._uiManager.hcmFilter!=="none"?b="black":J1.isDarkMode&&(w="#8f8f9d",b="#42414d");const _=15,x=_*o.sx,D=_*o.sy,M=new OffscreenCanvas(x*2,D*2),T=M.getContext("2d");T.fillStyle=w,T.fillRect(0,0,x*2,D*2),T.fillStyle=b,T.fillRect(0,0,x,D),T.fillRect(x,D,x,D),C.fillStyle=C.createPattern(M,"repeat"),C.fillRect(0,0,v,A),C.drawImage(u,0,0,u.width,u.height,0,0,v,A)}let p=null;if(i){let v,A;if(o.symmetric&&u.width<t&&u.height<t)v=u.width,A=u.height;else if(u=this.#t,s>t||a>t){const b=Math.min(t/s,t/a);v=Math.floor(s*b),A=Math.floor(a*b),this.#l||(u=this.#h(v,A))}const w=new OffscreenCanvas(v,A).getContext("2d",{willReadFrequently:!0});w.drawImage(u,0,0,u.width,u.height,0,0,v,A),p={width:v,height:A,data:w.getImageData(0,0,v,A).data}}return{canvas:f,width:h,height:d,imageData:p}}#h(t,e){const{width:i,height:s}=this.#t;let a=i,o=s,u=this.#t;for(;a>2*t||o>2*e;){const h=a,d=o;a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2)),o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2));const f=new OffscreenCanvas(a,o);f.getContext("2d").drawImage(u,0,0,h,d,0,0,a,o),u=f.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:i,height:s}=this,a=new as,o=Math.ceil(i*t*a.sx),u=Math.ceil(s*e*a.sy),h=this.#s;if(!h||h.width===o&&h.height===u)return;h.width=o,h.height=u;const d=this.#l?this.#t:this.#h(o,u),f=h.getContext("2d");f.filter=this._uiManager.hcmFilter,f.drawImage(d,0,0,d.width,d.height,0,0,o,u)}#v(t){if(t){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#e);if(s)return s}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,s=Math.round(this.width*e*za.PDF_TO_CSS_UNITS),a=Math.round(this.height*i*za.PDF_TO_CSS_UNITS),o=new OffscreenCanvas(s,a);return o.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,s,a),o.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let s=null,a=!1;if(t instanceof Gy){const{data:{rect:w,rotation:b,id:_,structParent:x,popupRef:D,richText:M,contentsObj:T,creationDate:O,modificationDate:k},container:z,parent:{page:{pageNumber:B}},canvas:H}=t;let V,Z;H?(delete t.canvas,{id:V,bitmap:Z}=i.imageManager.getFromCanvas(z.id,H),H.remove()):(a=!0,t._hasNoCanvas=!0);const rt=(await e._structTree.getAriaAttributes(`${Da}${_}`))?.get("aria-label")||"";s=t={annotationType:le.STAMP,bitmapId:V,bitmap:Z,pageIndex:B-1,rect:w.slice(0),rotation:b,annotationElementId:_,id:_,deleted:!1,accessibilityData:{decorative:!1,altText:rt},isSvg:!1,structParent:x,popupRef:D,richText:M,comment:T?.str||null,creationDate:O,modificationDate:k}}const o=await super.deserialize(t,e,i),{rect:u,bitmap:h,bitmapUrl:d,bitmapId:f,isSvg:p,accessibilityData:v}=t;a?(i.addMissingCanvas(t.id,o),o.#o=!0):f&&i.imageManager.isValidId(f)?(o.#e=f,h&&(o.#t=h)):o.#i=d,o.#l=p;const[A,C]=o.pageDimensions;return o.width=(u[2]-u[0])/A,o.height=(u[3]-u[1])/C,v&&(o.altTextData=v),o._initialData=s,t.comment&&o.setCommentData(t),o.#d=!!s,o}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#v(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:s,altText:a}=this.serializeAltText(!1);if(!s&&a&&(i.accessibilityData={type:"Figure",alt:a}),this.annotationElementId){const u=this.#b(i);return u.isSame?null:(u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const o=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:o,serialized:i}),i.bitmap=this.#v(!1);else if(this.#l){const u=e.stamps.get(this.#e);o>u.area&&(u.area=o,u.serialized.bitmap.close(),u.serialized.bitmap=this.#v(!1))}return i}#b(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,s=t.pageIndex===e,a=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&a,isSameAltText:a}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class Ts{#t;#e=!1;#n=null;#i=null;#a=null;#r=new Map;#s=!1;#o=!1;#u=!1;#l=null;#d=null;#c=null;#f=null;#m=null;#g=-1;#h;static _initialized=!1;static#p=new Map([Oi,Pf,M_,vi,ns].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:s,accessibilityManager:a,annotationLayer:o,drawLayer:u,textLayer:h,viewport:d,l10n:f}){const p=[...Ts.#p.values()];if(!Ts._initialized){Ts._initialized=!0;for(const v of p)v.initialize(f,t)}t.registerEditorTypes(p),this.#h=t,this.pageIndex=e,this.div=i,this.#t=a,this.#n=o,this.viewport=d,this.#c=h,this.drawLayer=u,this._structTree=s,this.#h.addLayer(this)}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#h.getMode()===le.NONE}updateToolbar(t){this.#h.updateToolbar(t)}updateMode(t=this.#h.getMode()){switch(this.#_(),t){case le.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case le.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case le.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===le.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of Ts.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#c?.div}setEditingState(t){this.#h.setEditingState(t)}addCommands(t){this.#h.addCommands(t)}cleanUndoStack(t){this.#h.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#n?.togglePointerEvents(t)}get#v(){return this.#r.size!==0?this.#r.values():this.#h.getEditors(this.pageIndex)}async enable(){this.#u=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const t=new Set;for(const i of this.#v)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#h.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#n;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#h.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}this.#u=!1,this.#h._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#c&&!this.#m){this.#m=new AbortController;const s=this.#h.combinedSignal(this.#m);this.#c.div.addEventListener("pointerdown",a=>{const{clientX:u,clientY:h,timeStamp:d}=a,f=this.#g;if(d-f>500){this.#g=d;return}this.#g=-1;const{classList:p}=this.div;p.toggle("getElements",!0);const v=document.elementsFromPoint(u,h);if(p.toggle("getElements",!1),!this.div.contains(v[0]))return;let A;const C=new RegExp(`^${qo}[0-9]+$`);for(const b of v)if(C.test(b.id)){A=b.id;break}if(!A)return;const w=this.#r.get(A);w?.annotationElementId===null&&(a.stopPropagation(),a.preventDefault(),w.dblclick(a))},{signal:s,capture:!0})}const t=this.#n,e=[];if(t){const s=new Map,a=new Map;for(const u of this.#v){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){s.set(u.annotationElementId,u);continue}else a.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const o=t.getEditableAnnotations();for(const u of o){const{id:h}=u.data;if(this.#h.isDeletedAnnotationElement(h)){u.updateEdited({deleted:!0});continue}let d=a.get(h);if(d){d.resetAnnotationElement(u),d.show(!1),u.show();continue}d=s.get(h),d&&(this.#h.addChangedExistingAnnotation(d),d.renderAnnotationElement(u)&&d.show(!1)),u.show()}}this.#_(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const s of Ts.#p.values())i.remove(`${s._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#n?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#h.getActive()!==t&&this.#h.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#c?.div&&!this.#f){this.#f=new AbortController;const t=this.#h.combinedSignal(this.#f);this.#c.div.addEventListener("pointerdown",this.#b.bind(this),{signal:t}),this.#c.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#c?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#c.div.classList.remove("highlighting"))}#b(t){this.#h.unselectAll();const{target:e}=t;if(e===this.#c.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#c.div.contains(e)){const{isMac:i}=Ti.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#h.showAllEditors("highlight",!0,!0),this.#c.div.classList.add("free"),this.toggleDrawing(),vi.startHighlighting(this,this.#h.direction==="ltr",{target:this.#c.div,x:t.x,y:t.y}),this.#c.div.addEventListener("pointerup",()=>{this.#c.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#h._signal}),t.preventDefault()}}enableClick(){if(this.#i)return;this.#i=new AbortController;const t=this.#h.combinedSignal(this.#i);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#i?.abort(),this.#i=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#h.isDeletedAnnotationElement(e)&&this.#h.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#h.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#h.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#h.addDeletedAnnotationElement(t),Xt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#h.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#u),this.#h.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#a&&(t._focusEventsAllowed=!1,this.#a=setTimeout(()=>{this.#a=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#h._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#r.values())if(e.uid===t)return e;return null}getNextId(){return this.#h.getId()}get#y(){return Ts.#p.get(this.#h.getMode())}combinedSignal(t){return this.#h.combinedSignal(t)}#x(t){const e=this.#y;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#y?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#h.updateMode(t.mode);const{offsetX:i,offsetY:s}=this.#E(),a=this.getNextId(),o=this.#x({parent:this,id:a,x:i,y:s,uiManager:this.#h,isCentered:!0,...e});o&&this.add(o)}async deserialize(t){return await Ts.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#h)||null}createAndAddNewEditor(t,e,i={}){const s=this.getNextId(),a=this.#x({parent:this,id:s,x:t.offsetX,y:t.offsetY,uiManager:this.#h,isCentered:e,...i});return a&&this.add(a),a}get boundingClientRect(){return this.div.getBoundingClientRect()}#E(){const{x:t,y:e,width:i,height:s}=this.boundingClientRect,a=Math.max(0,t),o=Math.max(0,e),u=Math.min(window.innerWidth,t+i),h=Math.min(window.innerHeight,e+s),d=(a+u)/2-t,f=(o+h)/2-e,[p,v]=this.viewport.rotation%180===0?[d,f]:[f,d];return{offsetX:p,offsetY:v}}addNewEditor(t={}){this.createAndAddNewEditor(this.#E(),!0,t)}setSelected(t){this.#h.setSelected(t)}toggleSelected(t){this.#h.toggleSelected(t)}unselect(t){this.#h.unselect(t)}pointerup(t){const{isMac:e}=Ti.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#s||(this.#s=!1,this.#y?.isDrawer&&this.#y.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#h.getMode();if(i===le.STAMP||i===le.SIGNATURE){this.#h.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#h.getMode()===le.HIGHLIGHT&&this.enableTextSelection(),this.#s){this.#s=!1;return}const{isMac:e}=Ti.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#s=!0,this.#y?.isDrawer){this.startDrawingSession(t);return}const i=this.#h.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#y.startDrawing(this,this.#h,!1,t);return}this.#h.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#h.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#y.startDrawing(this,this.#h,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#h.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#y.endDrawing(t)):null}findNewParent(t,e,i){const s=this.#h.findParent(e,i);return s===null||s===this?!1:(s.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#y.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#h.getActive()?.parent===this&&(this.#h.commitOrRemove(),this.#h.setActiveEditor(null)),this.#a&&(clearTimeout(this.#a),this.#a=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#h.removeLayer(this)}#_(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Nr(this.div,t);for(const e of this.#h.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#h.commitOrRemove(),this.#_();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Nr(this.div,{rotation:i}),e!==i)for(const s of this.#r.values())s.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#h.viewParameters.realScale}}class Pi{#t=null;#e=new Map;#n=new Map;static#i=0;constructor({pageIndex:t}){this.pageIndex=t}setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return oe(this,"_svgFactory",new ku)}static#a(t,[e,i,s,a]){const{style:o}=t;o.top=`${100*i}%`,o.left=`${100*e}%`,o.width=`${100*s}%`,o.height=`${100*a}%`}#r(){const t=Pi._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#s(t,e){const i=Pi._svgFactory.createElement("clipPath");t.append(i);const s=`clip_${e}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const a=Pi._svgFactory.createElement("use");return i.append(a),a.setAttribute("href",`#${e}`),a.classList.add("clip"),s}#o(t,e){for(const[i,s]of Object.entries(e))s===null?t.removeAttribute(i):t.setAttribute(i,s)}draw(t,e=!1,i=!1){const s=Pi.#i++,a=this.#r(),o=Pi._svgFactory.createElement("defs");a.append(o);const u=Pi._svgFactory.createElement("path");o.append(u);const h=`path_p${this.pageIndex}_${s}`;u.setAttribute("id",h),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#n.set(s,u);const d=i?this.#s(o,h):null,f=Pi._svgFactory.createElement("use");return a.append(f),f.setAttribute("href",`#${h}`),this.updateProperties(a,t),this.#e.set(s,a),{id:s,clipPathId:`url(#${d})`}}drawOutline(t,e){const i=Pi.#i++,s=this.#r(),a=Pi._svgFactory.createElement("defs");s.append(a);const o=Pi._svgFactory.createElement("path");a.append(o);const u=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",u),o.setAttribute("vector-effect","non-scaling-stroke");let h;if(e){const p=Pi._svgFactory.createElement("mask");a.append(p),h=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",h),p.setAttribute("maskUnits","objectBoundingBox");const v=Pi._svgFactory.createElement("rect");p.append(v),v.setAttribute("width","1"),v.setAttribute("height","1"),v.setAttribute("fill","white");const A=Pi._svgFactory.createElement("use");p.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const d=Pi._svgFactory.createElement("use");s.append(d),d.setAttribute("href",`#${u}`),h&&d.setAttribute("mask",`url(#${h})`);const f=d.cloneNode();return s.append(f),d.classList.add("mainOutline"),f.classList.add("secondaryOutline"),this.updateProperties(s,t),this.#e.set(i,s),i}finalizeDraw(t,e){this.#n.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:s,rootClass:a,path:o}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#o(u,i),s&&Pi.#a(u,s),a){const{classList:h}=u;for(const[d,f]of Object.entries(a))h.toggle(d,f)}if(o){const d=u.firstElementChild.firstElementChild;this.#o(d,o)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#n.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:yf};globalThis.pdfjsLib={AbortException:or,AnnotationEditorLayer:Ts,AnnotationEditorParamsType:Se,AnnotationEditorType:le,AnnotationEditorUIManager:lr,AnnotationLayer:Ff,AnnotationMode:nr,AnnotationType:Si,applyOpacity:eA,build:u_,ColorPicker:Ln,createValidAbsoluteUrl:fy,CSSConstants:tA,DOMSVGFactory:ku,DrawLayer:Pi,FeatureTest:Ti,fetchData:$o,findContrastColor:iA,getDocument:Iy,getFilenameFromUrl:W1,getPdfFilenameFromUrl:Z1,getRGB:Jo,getUuid:my,getXfaPageViewport:$1,GlobalWorkerOptions:La,ImageKind:xu,InvalidPDFException:uf,isDataScheme:Vu,isPdfFile:Df,isValidExplicitDest:fA,MathClamp:$i,noContextMenu:In,normalizeUnicode:V1,OPS:Go,OutputScale:as,PasswordResponses:I1,PDFDataRangeTransport:zy,PDFDateString:hf,PDFWorker:Xo,PermissionFlag:B1,PixelsPerInch:za,RenderingCancelledException:Tf,renderRichText:by,ResponseException:Nu,setLayerDimensions:Nr,shadow:oe,SignatureExtractor:Sa,stopEvent:ci,SupportedImageMimeTypes:cf,TextLayer:bn,TouchManager:Xu,updateUrlHash:py,Util:Pt,VerbosityLevel:ju,version:l_,XfaLayer:yy};const L_="/projects/focus-reader/assets/pdf.worker-DjmdXq8j.mjs";var wu={exports:{}},yd={exports:{}},bd,p0;function Yy(){if(p0)return bd;p0=1;var g=void 0;return bd=function(t){return t!==g&&t!==null},bd}var Ad,g0;function B_(){if(g0)return Ad;g0=1;var g=Yy(),t={object:!0,function:!0,undefined:!0};return Ad=function(e){return g(e)?hasOwnProperty.call(t,typeof e):!1},Ad}var _d,m0;function I_(){if(m0)return _d;m0=1;var g=B_();return _d=function(t){if(!g(t))return!1;try{return t.constructor?t.constructor.prototype===t:!1}catch{return!1}},_d}var wd,v0;function z_(){if(v0)return wd;v0=1;var g=I_();return wd=function(t){if(typeof t!="function"||!hasOwnProperty.call(t,"length"))return!1;try{if(typeof t.length!="number"||typeof t.call!="function"||typeof t.apply!="function")return!1}catch{return!1}return!g(t)},wd}var Ed,y0;function F_(){if(y0)return Ed;y0=1;var g=z_(),t=/^\s*class[\s{/}]/,e=Function.prototype.toString;return Ed=function(i){return!(!g(i)||t.test(e.call(i)))},Ed}var Sd,b0;function P_(){return b0||(b0=1,Sd=function(){var g=Object.assign,t;return typeof g!="function"?!1:(t={foo:"raz"},g(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}),Sd}var xd,A0;function U_(){return A0||(A0=1,xd=function(){try{return Object.keys("primitive"),!0}catch{return!1}}),xd}var Cd,_0;function H_(){return _0||(_0=1,Cd=function(){}),Cd}var Td,w0;function jf(){if(w0)return Td;w0=1;var g=H_()();return Td=function(t){return t!==g&&t!==null},Td}var Dd,E0;function j_(){if(E0)return Dd;E0=1;var g=jf(),t=Object.keys;return Dd=function(e){return t(g(e)?Object(e):e)},Dd}var Rd,S0;function q_(){return S0||(S0=1,Rd=U_()()?Object.keys:j_()),Rd}var Nd,x0;function G_(){if(x0)return Nd;x0=1;var g=jf();return Nd=function(t){if(!g(t))throw new TypeError("Cannot use null or undefined");return t},Nd}var Od,C0;function V_(){if(C0)return Od;C0=1;var g=q_(),t=G_(),e=Math.max;return Od=function(i,s){var a,o,u=e(arguments.length,2),h;for(i=Object(t(i)),h=function(d){try{i[d]=s[d]}catch(f){a||(a=f)}},o=1;o<u;++o)s=arguments[o],g(s).forEach(h);if(a!==void 0)throw a;return i},Od}var kd,T0;function X_(){return T0||(T0=1,kd=P_()()?Object.assign:V_()),kd}var Md,D0;function Y_(){if(D0)return Md;D0=1;var g=jf(),t=Array.prototype.forEach,e=Object.create,i=function(s,a){var o;for(o in s)a[o]=s[o]};return Md=function(s){var a=e(null);return t.call(arguments,function(o){g(o)&&i(Object(o),a)}),a},Md}var Ld,R0;function W_(){if(R0)return Ld;R0=1;var g="razdwatrzy";return Ld=function(){return typeof g.contains!="function"?!1:g.contains("dwa")===!0&&g.contains("foo")===!1},Ld}var Bd,N0;function Z_(){if(N0)return Bd;N0=1;var g=String.prototype.indexOf;return Bd=function(t){return g.call(this,t,arguments[1])>-1},Bd}var Id,O0;function K_(){return O0||(O0=1,Id=W_()()?String.prototype.contains:Z_()),Id}var k0;function $_(){if(k0)return yd.exports;k0=1;var g=Yy(),t=F_(),e=X_(),i=Y_(),s=K_(),a=yd.exports=function(o,u){var h,d,f,p,v;return arguments.length<2||typeof o!="string"?(p=u,u=o,o=null):p=arguments[2],g(o)?(h=s.call(o,"c"),d=s.call(o,"e"),f=s.call(o,"w")):(h=f=!0,d=!1),v={value:u,configurable:h,enumerable:d,writable:f},p?e(i(p),v):v};return a.gs=function(o,u,h){var d,f,p,v;return typeof o!="string"?(p=h,h=u,u=o,o=null):p=arguments[3],g(u)?t(u)?g(h)?t(h)||(p=h,h=void 0):h=void 0:(p=u,u=h=void 0):u=void 0,g(o)?(d=s.call(o,"c"),f=s.call(o,"e")):(d=!0,f=!1),v={get:u,set:h,configurable:d,enumerable:f},p?e(i(p),v):v},yd.exports}var zd,M0;function Q_(){return M0||(M0=1,zd=function(g){if(typeof g!="function")throw new TypeError(g+" is not a function");return g}),zd}var L0;function J_(){return L0||(L0=1,(function(g,t){var e=$_(),i=Q_(),s=Function.prototype.apply,a=Function.prototype.call,o=Object.create,u=Object.defineProperty,h=Object.defineProperties,d=Object.prototype.hasOwnProperty,f={configurable:!0,enumerable:!1,writable:!0},p,v,A,C,w,b,_;p=function(x,D){var M;return i(D),d.call(this,"__ee__")?M=this.__ee__:(M=f.value=o(null),u(this,"__ee__",f),f.value=null),M[x]?typeof M[x]=="object"?M[x].push(D):M[x]=[M[x],D]:M[x]=D,this},v=function(x,D){var M,T;return i(D),T=this,p.call(this,x,M=function(){A.call(T,x,M),s.call(D,this,arguments)}),M.__eeOnceListener__=D,this},A=function(x,D){var M,T,O,k;if(i(D),!d.call(this,"__ee__"))return this;if(M=this.__ee__,!M[x])return this;if(T=M[x],typeof T=="object")for(k=0;O=T[k];++k)(O===D||O.__eeOnceListener__===D)&&(T.length===2?M[x]=T[k?0:1]:T.splice(k,1));else(T===D||T.__eeOnceListener__===D)&&delete M[x];return this},C=function(x){var D,M,T,O,k;if(d.call(this,"__ee__")&&(O=this.__ee__[x],!!O))if(typeof O=="object"){for(M=arguments.length,k=new Array(M-1),D=1;D<M;++D)k[D-1]=arguments[D];for(O=O.slice(),D=0;T=O[D];++D)s.call(T,this,k)}else switch(arguments.length){case 1:a.call(O,this);break;case 2:a.call(O,this,arguments[1]);break;case 3:a.call(O,this,arguments[1],arguments[2]);break;default:for(M=arguments.length,k=new Array(M-1),D=1;D<M;++D)k[D-1]=arguments[D];s.call(O,this,k)}},w={on:p,once:v,off:A,emit:C},b={on:e(p),once:e(v),off:e(A),emit:e(C)},_=h({},b),g.exports=t=function(x){return x==null?o(_):h(Object(x),b)},t.methods=w})(wu,wu.exports)),wu.exports}var tw=J_();const os=ur(tw);var Io={},xs={},ya={},B0;function Zu(){if(B0)return ya;B0=1;function g(s,a,o){if(o===void 0&&(o=Array.prototype),s&&typeof o.find=="function")return o.find.call(s,a);for(var u=0;u<s.length;u++)if(Object.prototype.hasOwnProperty.call(s,u)){var h=s[u];if(a.call(void 0,h,u,s))return h}}function t(s,a){return a===void 0&&(a=Object),a&&typeof a.freeze=="function"?a.freeze(s):s}var e=t({HTML:"text/html",isHTML:function(s){return s===e.HTML},XML_APPLICATION:"application/xml",XML_TEXT:"text/xml",XML_XHTML_APPLICATION:"application/xhtml+xml",XML_SVG_IMAGE:"image/svg+xml"}),i=t({HTML:"http://www.w3.org/1999/xhtml",isHTML:function(s){return s===i.HTML},SVG:"http://www.w3.org/2000/svg",XML:"http://www.w3.org/XML/1998/namespace",XMLNS:"http://www.w3.org/2000/xmlns/"});return ya.find=g,ya.freeze=t,ya.MIME_TYPE=e,ya.NAMESPACE=i,ya}var I0;function Wy(){if(I0)return xs;I0=1;var g=Zu(),t=g.find,e=g.NAMESPACE;function i(N){return N!==""}function s(N){return N?N.split(/[\t\n\f\r ]+/).filter(i):[]}function a(N,E){return N.hasOwnProperty(E)||(N[E]=!0),N}function o(N){if(!N)return[];var E=s(N);return Object.keys(E.reduce(a,{}))}function u(N){return function(E){return N&&N.indexOf(E)!==-1}}function h(N,E){for(var F in N)Object.prototype.hasOwnProperty.call(N,F)&&(E[F]=N[F])}function d(N,E){var F=N.prototype;if(!(F instanceof E)){let tt=function(){};tt.prototype=E.prototype,tt=new tt,h(F,tt),N.prototype=F=tt}F.constructor!=N&&(typeof N!="function"&&console.error("unknown Class:"+N),F.constructor=N)}var f={},p=f.ELEMENT_NODE=1,v=f.ATTRIBUTE_NODE=2,A=f.TEXT_NODE=3,C=f.CDATA_SECTION_NODE=4,w=f.ENTITY_REFERENCE_NODE=5,b=f.ENTITY_NODE=6,_=f.PROCESSING_INSTRUCTION_NODE=7,x=f.COMMENT_NODE=8,D=f.DOCUMENT_NODE=9,M=f.DOCUMENT_TYPE_NODE=10,T=f.DOCUMENT_FRAGMENT_NODE=11,O=f.NOTATION_NODE=12,k={},z={};k.INDEX_SIZE_ERR=(z[1]="Index size error",1),k.DOMSTRING_SIZE_ERR=(z[2]="DOMString size error",2);var B=k.HIERARCHY_REQUEST_ERR=(z[3]="Hierarchy request error",3);k.WRONG_DOCUMENT_ERR=(z[4]="Wrong document",4),k.INVALID_CHARACTER_ERR=(z[5]="Invalid character",5),k.NO_DATA_ALLOWED_ERR=(z[6]="No data allowed",6),k.NO_MODIFICATION_ALLOWED_ERR=(z[7]="No modification allowed",7);var H=k.NOT_FOUND_ERR=(z[8]="Not found",8);k.NOT_SUPPORTED_ERR=(z[9]="Not supported",9);var V=k.INUSE_ATTRIBUTE_ERR=(z[10]="Attribute in use",10);k.INVALID_STATE_ERR=(z[11]="Invalid state",11),k.SYNTAX_ERR=(z[12]="Syntax error",12),k.INVALID_MODIFICATION_ERR=(z[13]="Invalid modification",13),k.NAMESPACE_ERR=(z[14]="Invalid namespace",14),k.INVALID_ACCESS_ERR=(z[15]="Invalid access",15);function Z(N,E){if(E instanceof Error)var F=E;else F=this,Error.call(this,z[N]),this.message=z[N],Error.captureStackTrace&&Error.captureStackTrace(this,Z);return F.code=N,E&&(this.message=this.message+": "+E),F}Z.prototype=Error.prototype,h(k,Z);function rt(){}rt.prototype={length:0,item:function(N){return N>=0&&N<this.length?this[N]:null},toString:function(N,E){for(var F=[],tt=0;tt<this.length;tt++)Et(this[tt],F,N,E);return F.join("")},filter:function(N){return Array.prototype.filter.call(this,N)},indexOf:function(N){return Array.prototype.indexOf.call(this,N)}};function ft(N,E){this._node=N,this._refresh=E,mt(this)}function mt(N){var E=N._node._inc||N._node.ownerDocument._inc;if(N._inc!==E){var F=N._refresh(N._node);if(Q(N,"length",F.length),!N.$$length||F.length<N.$$length)for(var tt=F.length;tt in N;tt++)Object.prototype.hasOwnProperty.call(N,tt)&&delete N[tt];h(F,N),N._inc=E}}ft.prototype.item=function(N){return mt(this),this[N]||null},d(ft,rt);function G(){}function W(N,E){for(var F=N.length;F--;)if(N[F]===E)return F}function st(N,E,F,tt){if(tt?E[W(E,tt)]=F:E[E.length++]=F,N){F.ownerElement=N;var S=N.ownerDocument;S&&(tt&&zt(S,N,tt),Dt(S,N,F))}}function bt(N,E,F){var tt=W(E,F);if(tt>=0){for(var S=E.length-1;tt<S;)E[tt]=E[++tt];if(E.length=S,N){var it=N.ownerDocument;it&&(zt(it,N,F),F.ownerElement=null)}}else throw new Z(H,new Error(N.tagName+"@"+F))}G.prototype={length:0,item:rt.prototype.item,getNamedItem:function(N){for(var E=this.length;E--;){var F=this[E];if(F.nodeName==N)return F}},setNamedItem:function(N){var E=N.ownerElement;if(E&&E!=this._ownerElement)throw new Z(V);var F=this.getNamedItem(N.nodeName);return st(this._ownerElement,this,N,F),F},setNamedItemNS:function(N){var E=N.ownerElement,F;if(E&&E!=this._ownerElement)throw new Z(V);return F=this.getNamedItemNS(N.namespaceURI,N.localName),st(this._ownerElement,this,N,F),F},removeNamedItem:function(N){var E=this.getNamedItem(N);return bt(this._ownerElement,this,E),E},removeNamedItemNS:function(N,E){var F=this.getNamedItemNS(N,E);return bt(this._ownerElement,this,F),F},getNamedItemNS:function(N,E){for(var F=this.length;F--;){var tt=this[F];if(tt.localName==E&&tt.namespaceURI==N)return tt}return null}};function Nt(){}Nt.prototype={hasFeature:function(N,E){return!0},createDocument:function(N,E,F){var tt=new yt;if(tt.implementation=this,tt.childNodes=new rt,tt.doctype=F||null,F&&tt.appendChild(F),E){var S=tt.createElementNS(N,E);tt.appendChild(S)}return tt},createDocumentType:function(N,E,F){var tt=new si;return tt.name=N,tt.nodeName=N,tt.publicId=E||"",tt.systemId=F||"",tt}};function j(){}j.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(N,E){return Je(this,N,E)},replaceChild:function(N,E){Je(this,N,E,Ve),E&&this.removeChild(E)},removeChild:function(N){return Lt(this,N)},appendChild:function(N){return this.insertBefore(N,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(N){return It(this.ownerDocument||this,this,N)},normalize:function(){for(var N=this.firstChild;N;){var E=N.nextSibling;E&&E.nodeType==A&&N.nodeType==A?(this.removeChild(E),N.appendData(E.data)):(N.normalize(),N=E)}},isSupported:function(N,E){return this.ownerDocument.implementation.hasFeature(N,E)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(N){for(var E=this;E;){var F=E._nsMap;if(F){for(var tt in F)if(Object.prototype.hasOwnProperty.call(F,tt)&&F[tt]===N)return tt}E=E.nodeType==v?E.ownerDocument:E.parentNode}return null},lookupNamespaceURI:function(N){for(var E=this;E;){var F=E._nsMap;if(F&&N in F&&Object.prototype.hasOwnProperty.call(F,N))return F[N];E=E.nodeType==v?E.ownerDocument:E.parentNode}return null},isDefaultNamespace:function(N){var E=this.lookupPrefix(N);return E==null}};function $(N){return N=="<"&&"&lt;"||N==">"&&"&gt;"||N=="&"&&"&amp;"||N=='"'&&"&quot;"||"&#"+N.charCodeAt()+";"}h(f,j),h(f,j.prototype);function gt(N,E){if(E(N))return!0;if(N=N.firstChild)do if(gt(N,E))return!0;while(N=N.nextSibling)}function yt(){this.ownerDocument=this}function Dt(N,E,F){N&&N._inc++;var tt=F.namespaceURI;tt===e.XMLNS&&(E._nsMap[F.prefix?F.localName:""]=F.value)}function zt(N,E,F,tt){N&&N._inc++;var S=F.namespaceURI;S===e.XMLNS&&delete E._nsMap[F.prefix?F.localName:""]}function kt(N,E,F){if(N&&N._inc){N._inc++;var tt=E.childNodes;if(F)tt[tt.length++]=F;else{for(var S=E.firstChild,it=0;S;)tt[it++]=S,S=S.nextSibling;tt.length=it,delete tt[tt.length]}}}function Lt(N,E){var F=E.previousSibling,tt=E.nextSibling;return F?F.nextSibling=tt:N.firstChild=tt,tt?tt.previousSibling=F:N.lastChild=F,E.parentNode=null,E.previousSibling=null,E.nextSibling=null,kt(N.ownerDocument,N),E}function Gt(N){return N&&(N.nodeType===j.DOCUMENT_NODE||N.nodeType===j.DOCUMENT_FRAGMENT_NODE||N.nodeType===j.ELEMENT_NODE)}function ye(N){return N&&(ee(N)||ie(N)||Yt(N)||N.nodeType===j.DOCUMENT_FRAGMENT_NODE||N.nodeType===j.COMMENT_NODE||N.nodeType===j.PROCESSING_INSTRUCTION_NODE)}function Yt(N){return N&&N.nodeType===j.DOCUMENT_TYPE_NODE}function ee(N){return N&&N.nodeType===j.ELEMENT_NODE}function ie(N){return N&&N.nodeType===j.TEXT_NODE}function ne(N,E){var F=N.childNodes||[];if(t(F,ee)||Yt(E))return!1;var tt=t(F,Yt);return!(E&&tt&&F.indexOf(tt)>F.indexOf(E))}function Re(N,E){var F=N.childNodes||[];function tt(it){return ee(it)&&it!==E}if(t(F,tt))return!1;var S=t(F,Yt);return!(E&&S&&F.indexOf(S)>F.indexOf(E))}function be(N,E,F){if(!Gt(N))throw new Z(B,"Unexpected parent node type "+N.nodeType);if(F&&F.parentNode!==N)throw new Z(H,"child not in parent");if(!ye(E)||Yt(E)&&N.nodeType!==j.DOCUMENT_NODE)throw new Z(B,"Unexpected node type "+E.nodeType+" for parent node type "+N.nodeType)}function fe(N,E,F){var tt=N.childNodes||[],S=E.childNodes||[];if(E.nodeType===j.DOCUMENT_FRAGMENT_NODE){var it=S.filter(ee);if(it.length>1||t(S,ie))throw new Z(B,"More than one element or text in fragment");if(it.length===1&&!ne(N,F))throw new Z(B,"Element in fragment can not be inserted before doctype")}if(ee(E)&&!ne(N,F))throw new Z(B,"Only one element can be added and only after doctype");if(Yt(E)){if(t(tt,Yt))throw new Z(B,"Only one doctype is allowed");var lt=t(tt,ee);if(F&&tt.indexOf(lt)<tt.indexOf(F))throw new Z(B,"Doctype can only be inserted before an element");if(!F&&lt)throw new Z(B,"Doctype can not be appended since element is present")}}function Ve(N,E,F){var tt=N.childNodes||[],S=E.childNodes||[];if(E.nodeType===j.DOCUMENT_FRAGMENT_NODE){var it=S.filter(ee);if(it.length>1||t(S,ie))throw new Z(B,"More than one element or text in fragment");if(it.length===1&&!Re(N,F))throw new Z(B,"Element in fragment can not be inserted before doctype")}if(ee(E)&&!Re(N,F))throw new Z(B,"Only one element can be added and only after doctype");if(Yt(E)){if(t(tt,function(Y){return Yt(Y)&&Y!==F}))throw new Z(B,"Only one doctype is allowed");var lt=t(tt,ee);if(F&&tt.indexOf(lt)<tt.indexOf(F))throw new Z(B,"Doctype can only be inserted before an element")}}function Je(N,E,F,tt){be(N,E,F),N.nodeType===j.DOCUMENT_NODE&&(tt||fe)(N,E,F);var S=E.parentNode;if(S&&S.removeChild(E),E.nodeType===T){var it=E.firstChild;if(it==null)return E;var lt=E.lastChild}else it=lt=E;var L=F?F.previousSibling:N.lastChild;it.previousSibling=L,lt.nextSibling=F,L?L.nextSibling=it:N.firstChild=it,F==null?N.lastChild=lt:F.previousSibling=lt;do it.parentNode=N;while(it!==lt&&(it=it.nextSibling));return kt(N.ownerDocument||N,N),E.nodeType==T&&(E.firstChild=E.lastChild=null),E}function Ke(N,E){return E.parentNode&&E.parentNode.removeChild(E),E.parentNode=N,E.previousSibling=N.lastChild,E.nextSibling=null,E.previousSibling?E.previousSibling.nextSibling=E:N.firstChild=E,N.lastChild=E,kt(N.ownerDocument,N,E),E}yt.prototype={nodeName:"#document",nodeType:D,doctype:null,documentElement:null,_inc:1,insertBefore:function(N,E){if(N.nodeType==T){for(var F=N.firstChild;F;){var tt=F.nextSibling;this.insertBefore(F,E),F=tt}return N}return Je(this,N,E),N.ownerDocument=this,this.documentElement===null&&N.nodeType===p&&(this.documentElement=N),N},removeChild:function(N){return this.documentElement==N&&(this.documentElement=null),Lt(this,N)},replaceChild:function(N,E){Je(this,N,E,Ve),N.ownerDocument=this,E&&this.removeChild(E),ee(N)&&(this.documentElement=N)},importNode:function(N,E){return Ct(this,N,E)},getElementById:function(N){var E=null;return gt(this.documentElement,function(F){if(F.nodeType==p&&F.getAttribute("id")==N)return E=F,!0}),E},getElementsByClassName:function(N){var E=o(N);return new ft(this,function(F){var tt=[];return E.length>0&&gt(F.documentElement,function(S){if(S!==F&&S.nodeType===p){var it=S.getAttribute("class");if(it){var lt=N===it;if(!lt){var L=o(it);lt=E.every(u(L))}lt&&tt.push(S)}}}),tt})},createElement:function(N){var E=new Wt;E.ownerDocument=this,E.nodeName=N,E.tagName=N,E.localName=N,E.childNodes=new rt;var F=E.attributes=new G;return F._ownerElement=E,E},createDocumentFragment:function(){var N=new qi;return N.ownerDocument=this,N.childNodes=new rt,N},createTextNode:function(N){var E=new De;return E.ownerDocument=this,E.appendData(N),E},createComment:function(N){var E=new Wi;return E.ownerDocument=this,E.appendData(N),E},createCDATASection:function(N){var E=new Di;return E.ownerDocument=this,E.appendData(N),E},createProcessingInstruction:function(N,E){var F=new Mi;return F.ownerDocument=this,F.tagName=F.nodeName=F.target=N,F.nodeValue=F.data=E,F},createAttribute:function(N){var E=new Jt;return E.ownerDocument=this,E.name=N,E.nodeName=N,E.localName=N,E.specified=!0,E},createEntityReference:function(N){var E=new fi;return E.ownerDocument=this,E.nodeName=N,E},createElementNS:function(N,E){var F=new Wt,tt=E.split(":"),S=F.attributes=new G;return F.childNodes=new rt,F.ownerDocument=this,F.nodeName=E,F.tagName=E,F.namespaceURI=N,tt.length==2?(F.prefix=tt[0],F.localName=tt[1]):F.localName=E,S._ownerElement=F,F},createAttributeNS:function(N,E){var F=new Jt,tt=E.split(":");return F.ownerDocument=this,F.nodeName=E,F.name=E,F.namespaceURI=N,F.specified=!0,tt.length==2?(F.prefix=tt[0],F.localName=tt[1]):F.localName=E,F}},d(yt,j);function Wt(){this._nsMap={}}Wt.prototype={nodeType:p,hasAttribute:function(N){return this.getAttributeNode(N)!=null},getAttribute:function(N){var E=this.getAttributeNode(N);return E&&E.value||""},getAttributeNode:function(N){return this.attributes.getNamedItem(N)},setAttribute:function(N,E){var F=this.ownerDocument.createAttribute(N);F.value=F.nodeValue=""+E,this.setAttributeNode(F)},removeAttribute:function(N){var E=this.getAttributeNode(N);E&&this.removeAttributeNode(E)},appendChild:function(N){return N.nodeType===T?this.insertBefore(N,null):Ke(this,N)},setAttributeNode:function(N){return this.attributes.setNamedItem(N)},setAttributeNodeNS:function(N){return this.attributes.setNamedItemNS(N)},removeAttributeNode:function(N){return this.attributes.removeNamedItem(N.nodeName)},removeAttributeNS:function(N,E){var F=this.getAttributeNodeNS(N,E);F&&this.removeAttributeNode(F)},hasAttributeNS:function(N,E){return this.getAttributeNodeNS(N,E)!=null},getAttributeNS:function(N,E){var F=this.getAttributeNodeNS(N,E);return F&&F.value||""},setAttributeNS:function(N,E,F){var tt=this.ownerDocument.createAttributeNS(N,E);tt.value=tt.nodeValue=""+F,this.setAttributeNode(tt)},getAttributeNodeNS:function(N,E){return this.attributes.getNamedItemNS(N,E)},getElementsByTagName:function(N){return new ft(this,function(E){var F=[];return gt(E,function(tt){tt!==E&&tt.nodeType==p&&(N==="*"||tt.tagName==N)&&F.push(tt)}),F})},getElementsByTagNameNS:function(N,E){return new ft(this,function(F){var tt=[];return gt(F,function(S){S!==F&&S.nodeType===p&&(N==="*"||S.namespaceURI===N)&&(E==="*"||S.localName==E)&&tt.push(S)}),tt})}},yt.prototype.getElementsByTagName=Wt.prototype.getElementsByTagName,yt.prototype.getElementsByTagNameNS=Wt.prototype.getElementsByTagNameNS,d(Wt,j);function Jt(){}Jt.prototype.nodeType=v,d(Jt,j);function Kt(){}Kt.prototype={data:"",substringData:function(N,E){return this.data.substring(N,N+E)},appendData:function(N){N=this.data+N,this.nodeValue=this.data=N,this.length=N.length},insertData:function(N,E){this.replaceData(N,0,E)},appendChild:function(N){throw new Error(z[B])},deleteData:function(N,E){this.replaceData(N,E,"")},replaceData:function(N,E,F){var tt=this.data.substring(0,N),S=this.data.substring(N+E);F=tt+F+S,this.nodeValue=this.data=F,this.length=F.length}},d(Kt,j);function De(){}De.prototype={nodeName:"#text",nodeType:A,splitText:function(N){var E=this.data,F=E.substring(N);E=E.substring(0,N),this.data=this.nodeValue=E,this.length=E.length;var tt=this.ownerDocument.createTextNode(F);return this.parentNode&&this.parentNode.insertBefore(tt,this.nextSibling),tt}},d(De,Kt);function Wi(){}Wi.prototype={nodeName:"#comment",nodeType:x},d(Wi,Kt);function Di(){}Di.prototype={nodeName:"#cdata-section",nodeType:C},d(Di,Kt);function si(){}si.prototype.nodeType=M,d(si,j);function ki(){}ki.prototype.nodeType=O,d(ki,j);function ji(){}ji.prototype.nodeType=b,d(ji,j);function fi(){}fi.prototype.nodeType=w,d(fi,j);function qi(){}qi.prototype.nodeName="#document-fragment",qi.prototype.nodeType=T,d(qi,j);function Mi(){}Mi.prototype.nodeType=_,d(Mi,j);function Pe(){}Pe.prototype.serializeToString=function(N,E,F){return Me.call(N,E,F)},j.prototype.toString=Me;function Me(N,E){var F=[],tt=this.nodeType==9&&this.documentElement||this,S=tt.prefix,it=tt.namespaceURI;if(it&&S==null){var S=tt.lookupPrefix(it);if(S==null)var lt=[{namespace:it,prefix:null}]}return Et(this,F,N,E,lt),F.join("")}function yi(N,E,F){var tt=N.prefix||"",S=N.namespaceURI;if(!S||tt==="xml"&&S===e.XML||S===e.XMLNS)return!1;for(var it=F.length;it--;){var lt=F[it];if(lt.prefix===tt)return lt.namespace!==S}return!0}function U(N,E,F){N.push(" ",E,'="',F.replace(/[<&"]/g,$),'"')}function Et(N,E,F,tt,S){if(S||(S=[]),tt)if(N=tt(N),N){if(typeof N=="string"){E.push(N);return}}else return;switch(N.nodeType){case p:var it=N.attributes,lt=it.length,Qt=N.firstChild,L=N.tagName;F=e.isHTML(N.namespaceURI)||F;var Y=L;if(!F&&!N.prefix&&N.namespaceURI){for(var ut,Ft=0;Ft<it.length;Ft++)if(it.item(Ft).name==="xmlns"){ut=it.item(Ft).value;break}if(!ut)for(var Ot=S.length-1;Ot>=0;Ot--){var Mt=S[Ot];if(Mt.prefix===""&&Mt.namespace===N.namespaceURI){ut=Mt.namespace;break}}if(ut!==N.namespaceURI)for(var Ot=S.length-1;Ot>=0;Ot--){var Mt=S[Ot];if(Mt.namespace===N.namespaceURI){Mt.prefix&&(Y=Mt.prefix+":"+L);break}}}E.push("<",Y);for(var $t=0;$t<lt;$t++){var Ze=it.item($t);Ze.prefix=="xmlns"?S.push({prefix:Ze.localName,namespace:Ze.value}):Ze.nodeName=="xmlns"&&S.push({prefix:"",namespace:Ze.value})}for(var $t=0;$t<lt;$t++){var Ze=it.item($t);if(yi(Ze,F,S)){var we=Ze.prefix||"",se=Ze.namespaceURI;U(E,we?"xmlns:"+we:"xmlns",se),S.push({prefix:we,namespace:se})}Et(Ze,E,F,tt,S)}if(L===Y&&yi(N,F,S)){var we=N.prefix||"",se=N.namespaceURI;U(E,we?"xmlns:"+we:"xmlns",se),S.push({prefix:we,namespace:se})}if(Qt||F&&!/^(?:meta|link|img|br|hr|input)$/i.test(L)){if(E.push(">"),F&&/^script$/i.test(L))for(;Qt;)Qt.data?E.push(Qt.data):Et(Qt,E,F,tt,S.slice()),Qt=Qt.nextSibling;else for(;Qt;)Et(Qt,E,F,tt,S.slice()),Qt=Qt.nextSibling;E.push("</",Y,">")}else E.push("/>");return;case D:case T:for(var Qt=N.firstChild;Qt;)Et(Qt,E,F,tt,S.slice()),Qt=Qt.nextSibling;return;case v:return U(E,N.name,N.value);case A:return E.push(N.data.replace(/[<&]/g,$).replace(/]]>/g,"]]&gt;"));case C:return E.push("<![CDATA[",N.data,"]]>");case x:return E.push("<!--",N.data,"-->");case M:var de=N.publicId,pe=N.systemId;if(E.push("<!DOCTYPE ",N.name),de)E.push(" PUBLIC ",de),pe&&pe!="."&&E.push(" ",pe),E.push(">");else if(pe&&pe!=".")E.push(" SYSTEM ",pe,">");else{var Gi=N.internalSubset;Gi&&E.push(" [",Gi,"]"),E.push(">")}return;case _:return E.push("<?",N.target," ",N.data,"?>");case w:return E.push("&",N.nodeName,";");default:E.push("??",N.nodeName)}}function Ct(N,E,F){var tt;switch(E.nodeType){case p:tt=E.cloneNode(!1),tt.ownerDocument=N;case T:break;case v:F=!0;break}if(tt||(tt=E.cloneNode(!1)),tt.ownerDocument=N,tt.parentNode=null,F)for(var S=E.firstChild;S;)tt.appendChild(Ct(N,S,F)),S=S.nextSibling;return tt}function It(N,E,F){var tt=new E.constructor;for(var S in E)if(Object.prototype.hasOwnProperty.call(E,S)){var it=E[S];typeof it!="object"&&it!=tt[S]&&(tt[S]=it)}switch(E.childNodes&&(tt.childNodes=new rt),tt.ownerDocument=N,tt.nodeType){case p:var lt=E.attributes,L=tt.attributes=new G,Y=lt.length;L._ownerElement=tt;for(var ut=0;ut<Y;ut++)tt.setAttributeNode(It(N,lt.item(ut),!0));break;case v:F=!0}if(F)for(var Ft=E.firstChild;Ft;)tt.appendChild(It(N,Ft,F)),Ft=Ft.nextSibling;return tt}function Q(N,E,F){N[E]=F}try{if(Object.defineProperty){let N=function(E){switch(E.nodeType){case p:case T:var F=[];for(E=E.firstChild;E;)E.nodeType!==7&&E.nodeType!==8&&F.push(N(E)),E=E.nextSibling;return F.join("");default:return E.nodeValue}};Object.defineProperty(ft.prototype,"length",{get:function(){return mt(this),this.$$length}}),Object.defineProperty(j.prototype,"textContent",{get:function(){return N(this)},set:function(E){switch(this.nodeType){case p:case T:for(;this.firstChild;)this.removeChild(this.firstChild);(E||String(E))&&this.appendChild(this.ownerDocument.createTextNode(E));break;default:this.data=E,this.value=E,this.nodeValue=E}}}),Q=function(E,F,tt){E["$$"+F]=tt}}}catch{}return xs.DocumentType=si,xs.DOMException=Z,xs.DOMImplementation=Nt,xs.Element=Wt,xs.Node=j,xs.NodeList=rt,xs.XMLSerializer=Pe,xs}var ba={},Fd={},z0;function ew(){return z0||(z0=1,(function(g){var t=Zu().freeze;g.XML_ENTITIES=t({amp:"&",apos:"'",gt:">",lt:"<",quot:'"'}),g.HTML_ENTITIES=t({Aacute:"",aacute:"",Abreve:"",abreve:"",ac:"",acd:"",acE:"",Acirc:"",acirc:"",acute:"",Acy:"",acy:"",AElig:"",aelig:"",af:"",Afr:"",afr:"",Agrave:"",agrave:"",alefsym:"",aleph:"",Alpha:"",alpha:"",Amacr:"",amacr:"",amalg:"",AMP:"&",amp:"&",And:"",and:"",andand:"",andd:"",andslope:"",andv:"",ang:"",ange:"",angle:"",angmsd:"",angmsdaa:"",angmsdab:"",angmsdac:"",angmsdad:"",angmsdae:"",angmsdaf:"",angmsdag:"",angmsdah:"",angrt:"",angrtvb:"",angrtvbd:"",angsph:"",angst:"",angzarr:"",Aogon:"",aogon:"",Aopf:"",aopf:"",ap:"",apacir:"",apE:"",ape:"",apid:"",apos:"'",ApplyFunction:"",approx:"",approxeq:"",Aring:"",aring:"",Ascr:"",ascr:"",Assign:"",ast:"*",asymp:"",asympeq:"",Atilde:"",atilde:"",Auml:"",auml:"",awconint:"",awint:"",backcong:"",backepsilon:"",backprime:"",backsim:"",backsimeq:"",Backslash:"",Barv:"",barvee:"",Barwed:"",barwed:"",barwedge:"",bbrk:"",bbrktbrk:"",bcong:"",Bcy:"",bcy:"",bdquo:"",becaus:"",Because:"",because:"",bemptyv:"",bepsi:"",bernou:"",Bernoullis:"",Beta:"",beta:"",beth:"",between:"",Bfr:"",bfr:"",bigcap:"",bigcirc:"",bigcup:"",bigodot:"",bigoplus:"",bigotimes:"",bigsqcup:"",bigstar:"",bigtriangledown:"",bigtriangleup:"",biguplus:"",bigvee:"",bigwedge:"",bkarow:"",blacklozenge:"",blacksquare:"",blacktriangle:"",blacktriangledown:"",blacktriangleleft:"",blacktriangleright:"",blank:"",blk12:"",blk14:"",blk34:"",block:"",bne:"=",bnequiv:"",bNot:"",bnot:"",Bopf:"",bopf:"",bot:"",bottom:"",bowtie:"",boxbox:"",boxDL:"",boxDl:"",boxdL:"",boxdl:"",boxDR:"",boxDr:"",boxdR:"",boxdr:"",boxH:"",boxh:"",boxHD:"",boxHd:"",boxhD:"",boxhd:"",boxHU:"",boxHu:"",boxhU:"",boxhu:"",boxminus:"",boxplus:"",boxtimes:"",boxUL:"",boxUl:"",boxuL:"",boxul:"",boxUR:"",boxUr:"",boxuR:"",boxur:"",boxV:"",boxv:"",boxVH:"",boxVh:"",boxvH:"",boxvh:"",boxVL:"",boxVl:"",boxvL:"",boxvl:"",boxVR:"",boxVr:"",boxvR:"",boxvr:"",bprime:"",Breve:"",breve:"",brvbar:"",Bscr:"",bscr:"",bsemi:"",bsim:"",bsime:"",bsol:"\\",bsolb:"",bsolhsub:"",bull:"",bullet:"",bump:"",bumpE:"",bumpe:"",Bumpeq:"",bumpeq:"",Cacute:"",cacute:"",Cap:"",cap:"",capand:"",capbrcup:"",capcap:"",capcup:"",capdot:"",CapitalDifferentialD:"",caps:"",caret:"",caron:"",Cayleys:"",ccaps:"",Ccaron:"",ccaron:"",Ccedil:"",ccedil:"",Ccirc:"",ccirc:"",Cconint:"",ccups:"",ccupssm:"",Cdot:"",cdot:"",cedil:"",Cedilla:"",cemptyv:"",cent:"",CenterDot:"",centerdot:"",Cfr:"",cfr:"",CHcy:"",chcy:"",check:"",checkmark:"",Chi:"",chi:"",cir:"",circ:"",circeq:"",circlearrowleft:"",circlearrowright:"",circledast:"",circledcirc:"",circleddash:"",CircleDot:"",circledR:"",circledS:"",CircleMinus:"",CirclePlus:"",CircleTimes:"",cirE:"",cire:"",cirfnint:"",cirmid:"",cirscir:"",ClockwiseContourIntegral:"",CloseCurlyDoubleQuote:"",CloseCurlyQuote:"",clubs:"",clubsuit:"",Colon:"",colon:":",Colone:"",colone:"",coloneq:"",comma:",",commat:"@",comp:"",compfn:"",complement:"",complexes:"",cong:"",congdot:"",Congruent:"",Conint:"",conint:"",ContourIntegral:"",Copf:"",copf:"",coprod:"",Coproduct:"",COPY:"",copy:"",copysr:"",CounterClockwiseContourIntegral:"",crarr:"",Cross:"",cross:"",Cscr:"",cscr:"",csub:"",csube:"",csup:"",csupe:"",ctdot:"",cudarrl:"",cudarrr:"",cuepr:"",cuesc:"",cularr:"",cularrp:"",Cup:"",cup:"",cupbrcap:"",CupCap:"",cupcap:"",cupcup:"",cupdot:"",cupor:"",cups:"",curarr:"",curarrm:"",curlyeqprec:"",curlyeqsucc:"",curlyvee:"",curlywedge:"",curren:"",curvearrowleft:"",curvearrowright:"",cuvee:"",cuwed:"",cwconint:"",cwint:"",cylcty:"",Dagger:"",dagger:"",daleth:"",Darr:"",dArr:"",darr:"",dash:"",Dashv:"",dashv:"",dbkarow:"",dblac:"",Dcaron:"",dcaron:"",Dcy:"",dcy:"",DD:"",dd:"",ddagger:"",ddarr:"",DDotrahd:"",ddotseq:"",deg:"",Del:"",Delta:"",delta:"",demptyv:"",dfisht:"",Dfr:"",dfr:"",dHar:"",dharl:"",dharr:"",DiacriticalAcute:"",DiacriticalDot:"",DiacriticalDoubleAcute:"",DiacriticalGrave:"`",DiacriticalTilde:"",diam:"",Diamond:"",diamond:"",diamondsuit:"",diams:"",die:"",DifferentialD:"",digamma:"",disin:"",div:"",divide:"",divideontimes:"",divonx:"",DJcy:"",djcy:"",dlcorn:"",dlcrop:"",dollar:"$",Dopf:"",dopf:"",Dot:"",dot:"",DotDot:"",doteq:"",doteqdot:"",DotEqual:"",dotminus:"",dotplus:"",dotsquare:"",doublebarwedge:"",DoubleContourIntegral:"",DoubleDot:"",DoubleDownArrow:"",DoubleLeftArrow:"",DoubleLeftRightArrow:"",DoubleLeftTee:"",DoubleLongLeftArrow:"",DoubleLongLeftRightArrow:"",DoubleLongRightArrow:"",DoubleRightArrow:"",DoubleRightTee:"",DoubleUpArrow:"",DoubleUpDownArrow:"",DoubleVerticalBar:"",DownArrow:"",Downarrow:"",downarrow:"",DownArrowBar:"",DownArrowUpArrow:"",DownBreve:"",downdownarrows:"",downharpoonleft:"",downharpoonright:"",DownLeftRightVector:"",DownLeftTeeVector:"",DownLeftVector:"",DownLeftVectorBar:"",DownRightTeeVector:"",DownRightVector:"",DownRightVectorBar:"",DownTee:"",DownTeeArrow:"",drbkarow:"",drcorn:"",drcrop:"",Dscr:"",dscr:"",DScy:"",dscy:"",dsol:"",Dstrok:"",dstrok:"",dtdot:"",dtri:"",dtrif:"",duarr:"",duhar:"",dwangle:"",DZcy:"",dzcy:"",dzigrarr:"",Eacute:"",eacute:"",easter:"",Ecaron:"",ecaron:"",ecir:"",Ecirc:"",ecirc:"",ecolon:"",Ecy:"",ecy:"",eDDot:"",Edot:"",eDot:"",edot:"",ee:"",efDot:"",Efr:"",efr:"",eg:"",Egrave:"",egrave:"",egs:"",egsdot:"",el:"",Element:"",elinters:"",ell:"",els:"",elsdot:"",Emacr:"",emacr:"",empty:"",emptyset:"",EmptySmallSquare:"",emptyv:"",EmptyVerySmallSquare:"",emsp:"",emsp13:"",emsp14:"",ENG:"",eng:"",ensp:"",Eogon:"",eogon:"",Eopf:"",eopf:"",epar:"",eparsl:"",eplus:"",epsi:"",Epsilon:"",epsilon:"",epsiv:"",eqcirc:"",eqcolon:"",eqsim:"",eqslantgtr:"",eqslantless:"",Equal:"",equals:"=",EqualTilde:"",equest:"",Equilibrium:"",equiv:"",equivDD:"",eqvparsl:"",erarr:"",erDot:"",Escr:"",escr:"",esdot:"",Esim:"",esim:"",Eta:"",eta:"",ETH:"",eth:"",Euml:"",euml:"",euro:"",excl:"!",exist:"",Exists:"",expectation:"",ExponentialE:"",exponentiale:"",fallingdotseq:"",Fcy:"",fcy:"",female:"",ffilig:"",fflig:"",ffllig:"",Ffr:"",ffr:"",filig:"",FilledSmallSquare:"",FilledVerySmallSquare:"",fjlig:"fj",flat:"",fllig:"",fltns:"",fnof:"",Fopf:"",fopf:"",ForAll:"",forall:"",fork:"",forkv:"",Fouriertrf:"",fpartint:"",frac12:"",frac13:"",frac14:"",frac15:"",frac16:"",frac18:"",frac23:"",frac25:"",frac34:"",frac35:"",frac38:"",frac45:"",frac56:"",frac58:"",frac78:"",frasl:"",frown:"",Fscr:"",fscr:"",gacute:"",Gamma:"",gamma:"",Gammad:"",gammad:"",gap:"",Gbreve:"",gbreve:"",Gcedil:"",Gcirc:"",gcirc:"",Gcy:"",gcy:"",Gdot:"",gdot:"",gE:"",ge:"",gEl:"",gel:"",geq:"",geqq:"",geqslant:"",ges:"",gescc:"",gesdot:"",gesdoto:"",gesdotol:"",gesl:"",gesles:"",Gfr:"",gfr:"",Gg:"",gg:"",ggg:"",gimel:"",GJcy:"",gjcy:"",gl:"",gla:"",glE:"",glj:"",gnap:"",gnapprox:"",gnE:"",gne:"",gneq:"",gneqq:"",gnsim:"",Gopf:"",gopf:"",grave:"`",GreaterEqual:"",GreaterEqualLess:"",GreaterFullEqual:"",GreaterGreater:"",GreaterLess:"",GreaterSlantEqual:"",GreaterTilde:"",Gscr:"",gscr:"",gsim:"",gsime:"",gsiml:"",Gt:"",GT:">",gt:">",gtcc:"",gtcir:"",gtdot:"",gtlPar:"",gtquest:"",gtrapprox:"",gtrarr:"",gtrdot:"",gtreqless:"",gtreqqless:"",gtrless:"",gtrsim:"",gvertneqq:"",gvnE:"",Hacek:"",hairsp:"",half:"",hamilt:"",HARDcy:"",hardcy:"",hArr:"",harr:"",harrcir:"",harrw:"",Hat:"^",hbar:"",Hcirc:"",hcirc:"",hearts:"",heartsuit:"",hellip:"",hercon:"",Hfr:"",hfr:"",HilbertSpace:"",hksearow:"",hkswarow:"",hoarr:"",homtht:"",hookleftarrow:"",hookrightarrow:"",Hopf:"",hopf:"",horbar:"",HorizontalLine:"",Hscr:"",hscr:"",hslash:"",Hstrok:"",hstrok:"",HumpDownHump:"",HumpEqual:"",hybull:"",hyphen:"",Iacute:"",iacute:"",ic:"",Icirc:"",icirc:"",Icy:"",icy:"",Idot:"",IEcy:"",iecy:"",iexcl:"",iff:"",Ifr:"",ifr:"",Igrave:"",igrave:"",ii:"",iiiint:"",iiint:"",iinfin:"",iiota:"",IJlig:"",ijlig:"",Im:"",Imacr:"",imacr:"",image:"",ImaginaryI:"",imagline:"",imagpart:"",imath:"",imof:"",imped:"",Implies:"",in:"",incare:"",infin:"",infintie:"",inodot:"",Int:"",int:"",intcal:"",integers:"",Integral:"",intercal:"",Intersection:"",intlarhk:"",intprod:"",InvisibleComma:"",InvisibleTimes:"",IOcy:"",iocy:"",Iogon:"",iogon:"",Iopf:"",iopf:"",Iota:"",iota:"",iprod:"",iquest:"",Iscr:"",iscr:"",isin:"",isindot:"",isinE:"",isins:"",isinsv:"",isinv:"",it:"",Itilde:"",itilde:"",Iukcy:"",iukcy:"",Iuml:"",iuml:"",Jcirc:"",jcirc:"",Jcy:"",jcy:"",Jfr:"",jfr:"",jmath:"",Jopf:"",jopf:"",Jscr:"",jscr:"",Jsercy:"",jsercy:"",Jukcy:"",jukcy:"",Kappa:"",kappa:"",kappav:"",Kcedil:"",kcedil:"",Kcy:"",kcy:"",Kfr:"",kfr:"",kgreen:"",KHcy:"",khcy:"",KJcy:"",kjcy:"",Kopf:"",kopf:"",Kscr:"",kscr:"",lAarr:"",Lacute:"",lacute:"",laemptyv:"",lagran:"",Lambda:"",lambda:"",Lang:"",lang:"",langd:"",langle:"",lap:"",Laplacetrf:"",laquo:"",Larr:"",lArr:"",larr:"",larrb:"",larrbfs:"",larrfs:"",larrhk:"",larrlp:"",larrpl:"",larrsim:"",larrtl:"",lat:"",lAtail:"",latail:"",late:"",lates:"",lBarr:"",lbarr:"",lbbrk:"",lbrace:"{",lbrack:"[",lbrke:"",lbrksld:"",lbrkslu:"",Lcaron:"",lcaron:"",Lcedil:"",lcedil:"",lceil:"",lcub:"{",Lcy:"",lcy:"",ldca:"",ldquo:"",ldquor:"",ldrdhar:"",ldrushar:"",ldsh:"",lE:"",le:"",LeftAngleBracket:"",LeftArrow:"",Leftarrow:"",leftarrow:"",LeftArrowBar:"",LeftArrowRightArrow:"",leftarrowtail:"",LeftCeiling:"",LeftDoubleBracket:"",LeftDownTeeVector:"",LeftDownVector:"",LeftDownVectorBar:"",LeftFloor:"",leftharpoondown:"",leftharpoonup:"",leftleftarrows:"",LeftRightArrow:"",Leftrightarrow:"",leftrightarrow:"",leftrightarrows:"",leftrightharpoons:"",leftrightsquigarrow:"",LeftRightVector:"",LeftTee:"",LeftTeeArrow:"",LeftTeeVector:"",leftthreetimes:"",LeftTriangle:"",LeftTriangleBar:"",LeftTriangleEqual:"",LeftUpDownVector:"",LeftUpTeeVector:"",LeftUpVector:"",LeftUpVectorBar:"",LeftVector:"",LeftVectorBar:"",lEg:"",leg:"",leq:"",leqq:"",leqslant:"",les:"",lescc:"",lesdot:"",lesdoto:"",lesdotor:"",lesg:"",lesges:"",lessapprox:"",lessdot:"",lesseqgtr:"",lesseqqgtr:"",LessEqualGreater:"",LessFullEqual:"",LessGreater:"",lessgtr:"",LessLess:"",lesssim:"",LessSlantEqual:"",LessTilde:"",lfisht:"",lfloor:"",Lfr:"",lfr:"",lg:"",lgE:"",lHar:"",lhard:"",lharu:"",lharul:"",lhblk:"",LJcy:"",ljcy:"",Ll:"",ll:"",llarr:"",llcorner:"",Lleftarrow:"",llhard:"",lltri:"",Lmidot:"",lmidot:"",lmoust:"",lmoustache:"",lnap:"",lnapprox:"",lnE:"",lne:"",lneq:"",lneqq:"",lnsim:"",loang:"",loarr:"",lobrk:"",LongLeftArrow:"",Longleftarrow:"",longleftarrow:"",LongLeftRightArrow:"",Longleftrightarrow:"",longleftrightarrow:"",longmapsto:"",LongRightArrow:"",Longrightarrow:"",longrightarrow:"",looparrowleft:"",looparrowright:"",lopar:"",Lopf:"",lopf:"",loplus:"",lotimes:"",lowast:"",lowbar:"_",LowerLeftArrow:"",LowerRightArrow:"",loz:"",lozenge:"",lozf:"",lpar:"(",lparlt:"",lrarr:"",lrcorner:"",lrhar:"",lrhard:"",lrm:"",lrtri:"",lsaquo:"",Lscr:"",lscr:"",Lsh:"",lsh:"",lsim:"",lsime:"",lsimg:"",lsqb:"[",lsquo:"",lsquor:"",Lstrok:"",lstrok:"",Lt:"",LT:"<",lt:"<",ltcc:"",ltcir:"",ltdot:"",lthree:"",ltimes:"",ltlarr:"",ltquest:"",ltri:"",ltrie:"",ltrif:"",ltrPar:"",lurdshar:"",luruhar:"",lvertneqq:"",lvnE:"",macr:"",male:"",malt:"",maltese:"",Map:"",map:"",mapsto:"",mapstodown:"",mapstoleft:"",mapstoup:"",marker:"",mcomma:"",Mcy:"",mcy:"",mdash:"",mDDot:"",measuredangle:"",MediumSpace:"",Mellintrf:"",Mfr:"",mfr:"",mho:"",micro:"",mid:"",midast:"*",midcir:"",middot:"",minus:"",minusb:"",minusd:"",minusdu:"",MinusPlus:"",mlcp:"",mldr:"",mnplus:"",models:"",Mopf:"",mopf:"",mp:"",Mscr:"",mscr:"",mstpos:"",Mu:"",mu:"",multimap:"",mumap:"",nabla:"",Nacute:"",nacute:"",nang:"",nap:"",napE:"",napid:"",napos:"",napprox:"",natur:"",natural:"",naturals:"",nbsp:"",nbump:"",nbumpe:"",ncap:"",Ncaron:"",ncaron:"",Ncedil:"",ncedil:"",ncong:"",ncongdot:"",ncup:"",Ncy:"",ncy:"",ndash:"",ne:"",nearhk:"",neArr:"",nearr:"",nearrow:"",nedot:"",NegativeMediumSpace:"",NegativeThickSpace:"",NegativeThinSpace:"",NegativeVeryThinSpace:"",nequiv:"",nesear:"",nesim:"",NestedGreaterGreater:"",NestedLessLess:"",NewLine:`
`,nexist:"",nexists:"",Nfr:"",nfr:"",ngE:"",nge:"",ngeq:"",ngeqq:"",ngeqslant:"",nges:"",nGg:"",ngsim:"",nGt:"",ngt:"",ngtr:"",nGtv:"",nhArr:"",nharr:"",nhpar:"",ni:"",nis:"",nisd:"",niv:"",NJcy:"",njcy:"",nlArr:"",nlarr:"",nldr:"",nlE:"",nle:"",nLeftarrow:"",nleftarrow:"",nLeftrightarrow:"",nleftrightarrow:"",nleq:"",nleqq:"",nleqslant:"",nles:"",nless:"",nLl:"",nlsim:"",nLt:"",nlt:"",nltri:"",nltrie:"",nLtv:"",nmid:"",NoBreak:"",NonBreakingSpace:"",Nopf:"",nopf:"",Not:"",not:"",NotCongruent:"",NotCupCap:"",NotDoubleVerticalBar:"",NotElement:"",NotEqual:"",NotEqualTilde:"",NotExists:"",NotGreater:"",NotGreaterEqual:"",NotGreaterFullEqual:"",NotGreaterGreater:"",NotGreaterLess:"",NotGreaterSlantEqual:"",NotGreaterTilde:"",NotHumpDownHump:"",NotHumpEqual:"",notin:"",notindot:"",notinE:"",notinva:"",notinvb:"",notinvc:"",NotLeftTriangle:"",NotLeftTriangleBar:"",NotLeftTriangleEqual:"",NotLess:"",NotLessEqual:"",NotLessGreater:"",NotLessLess:"",NotLessSlantEqual:"",NotLessTilde:"",NotNestedGreaterGreater:"",NotNestedLessLess:"",notni:"",notniva:"",notnivb:"",notnivc:"",NotPrecedes:"",NotPrecedesEqual:"",NotPrecedesSlantEqual:"",NotReverseElement:"",NotRightTriangle:"",NotRightTriangleBar:"",NotRightTriangleEqual:"",NotSquareSubset:"",NotSquareSubsetEqual:"",NotSquareSuperset:"",NotSquareSupersetEqual:"",NotSubset:"",NotSubsetEqual:"",NotSucceeds:"",NotSucceedsEqual:"",NotSucceedsSlantEqual:"",NotSucceedsTilde:"",NotSuperset:"",NotSupersetEqual:"",NotTilde:"",NotTildeEqual:"",NotTildeFullEqual:"",NotTildeTilde:"",NotVerticalBar:"",npar:"",nparallel:"",nparsl:"",npart:"",npolint:"",npr:"",nprcue:"",npre:"",nprec:"",npreceq:"",nrArr:"",nrarr:"",nrarrc:"",nrarrw:"",nRightarrow:"",nrightarrow:"",nrtri:"",nrtrie:"",nsc:"",nsccue:"",nsce:"",Nscr:"",nscr:"",nshortmid:"",nshortparallel:"",nsim:"",nsime:"",nsimeq:"",nsmid:"",nspar:"",nsqsube:"",nsqsupe:"",nsub:"",nsubE:"",nsube:"",nsubset:"",nsubseteq:"",nsubseteqq:"",nsucc:"",nsucceq:"",nsup:"",nsupE:"",nsupe:"",nsupset:"",nsupseteq:"",nsupseteqq:"",ntgl:"",Ntilde:"",ntilde:"",ntlg:"",ntriangleleft:"",ntrianglelefteq:"",ntriangleright:"",ntrianglerighteq:"",Nu:"",nu:"",num:"#",numero:"",numsp:"",nvap:"",nVDash:"",nVdash:"",nvDash:"",nvdash:"",nvge:"",nvgt:">",nvHarr:"",nvinfin:"",nvlArr:"",nvle:"",nvlt:"<",nvltrie:"",nvrArr:"",nvrtrie:"",nvsim:"",nwarhk:"",nwArr:"",nwarr:"",nwarrow:"",nwnear:"",Oacute:"",oacute:"",oast:"",ocir:"",Ocirc:"",ocirc:"",Ocy:"",ocy:"",odash:"",Odblac:"",odblac:"",odiv:"",odot:"",odsold:"",OElig:"",oelig:"",ofcir:"",Ofr:"",ofr:"",ogon:"",Ograve:"",ograve:"",ogt:"",ohbar:"",ohm:"",oint:"",olarr:"",olcir:"",olcross:"",oline:"",olt:"",Omacr:"",omacr:"",Omega:"",omega:"",Omicron:"",omicron:"",omid:"",ominus:"",Oopf:"",oopf:"",opar:"",OpenCurlyDoubleQuote:"",OpenCurlyQuote:"",operp:"",oplus:"",Or:"",or:"",orarr:"",ord:"",order:"",orderof:"",ordf:"",ordm:"",origof:"",oror:"",orslope:"",orv:"",oS:"",Oscr:"",oscr:"",Oslash:"",oslash:"",osol:"",Otilde:"",otilde:"",Otimes:"",otimes:"",otimesas:"",Ouml:"",ouml:"",ovbar:"",OverBar:"",OverBrace:"",OverBracket:"",OverParenthesis:"",par:"",para:"",parallel:"",parsim:"",parsl:"",part:"",PartialD:"",Pcy:"",pcy:"",percnt:"%",period:".",permil:"",perp:"",pertenk:"",Pfr:"",pfr:"",Phi:"",phi:"",phiv:"",phmmat:"",phone:"",Pi:"",pi:"",pitchfork:"",piv:"",planck:"",planckh:"",plankv:"",plus:"+",plusacir:"",plusb:"",pluscir:"",plusdo:"",plusdu:"",pluse:"",PlusMinus:"",plusmn:"",plussim:"",plustwo:"",pm:"",Poincareplane:"",pointint:"",Popf:"",popf:"",pound:"",Pr:"",pr:"",prap:"",prcue:"",prE:"",pre:"",prec:"",precapprox:"",preccurlyeq:"",Precedes:"",PrecedesEqual:"",PrecedesSlantEqual:"",PrecedesTilde:"",preceq:"",precnapprox:"",precneqq:"",precnsim:"",precsim:"",Prime:"",prime:"",primes:"",prnap:"",prnE:"",prnsim:"",prod:"",Product:"",profalar:"",profline:"",profsurf:"",prop:"",Proportion:"",Proportional:"",propto:"",prsim:"",prurel:"",Pscr:"",pscr:"",Psi:"",psi:"",puncsp:"",Qfr:"",qfr:"",qint:"",Qopf:"",qopf:"",qprime:"",Qscr:"",qscr:"",quaternions:"",quatint:"",quest:"?",questeq:"",QUOT:'"',quot:'"',rAarr:"",race:"",Racute:"",racute:"",radic:"",raemptyv:"",Rang:"",rang:"",rangd:"",range:"",rangle:"",raquo:"",Rarr:"",rArr:"",rarr:"",rarrap:"",rarrb:"",rarrbfs:"",rarrc:"",rarrfs:"",rarrhk:"",rarrlp:"",rarrpl:"",rarrsim:"",Rarrtl:"",rarrtl:"",rarrw:"",rAtail:"",ratail:"",ratio:"",rationals:"",RBarr:"",rBarr:"",rbarr:"",rbbrk:"",rbrace:"}",rbrack:"]",rbrke:"",rbrksld:"",rbrkslu:"",Rcaron:"",rcaron:"",Rcedil:"",rcedil:"",rceil:"",rcub:"}",Rcy:"",rcy:"",rdca:"",rdldhar:"",rdquo:"",rdquor:"",rdsh:"",Re:"",real:"",realine:"",realpart:"",reals:"",rect:"",REG:"",reg:"",ReverseElement:"",ReverseEquilibrium:"",ReverseUpEquilibrium:"",rfisht:"",rfloor:"",Rfr:"",rfr:"",rHar:"",rhard:"",rharu:"",rharul:"",Rho:"",rho:"",rhov:"",RightAngleBracket:"",RightArrow:"",Rightarrow:"",rightarrow:"",RightArrowBar:"",RightArrowLeftArrow:"",rightarrowtail:"",RightCeiling:"",RightDoubleBracket:"",RightDownTeeVector:"",RightDownVector:"",RightDownVectorBar:"",RightFloor:"",rightharpoondown:"",rightharpoonup:"",rightleftarrows:"",rightleftharpoons:"",rightrightarrows:"",rightsquigarrow:"",RightTee:"",RightTeeArrow:"",RightTeeVector:"",rightthreetimes:"",RightTriangle:"",RightTriangleBar:"",RightTriangleEqual:"",RightUpDownVector:"",RightUpTeeVector:"",RightUpVector:"",RightUpVectorBar:"",RightVector:"",RightVectorBar:"",ring:"",risingdotseq:"",rlarr:"",rlhar:"",rlm:"",rmoust:"",rmoustache:"",rnmid:"",roang:"",roarr:"",robrk:"",ropar:"",Ropf:"",ropf:"",roplus:"",rotimes:"",RoundImplies:"",rpar:")",rpargt:"",rppolint:"",rrarr:"",Rrightarrow:"",rsaquo:"",Rscr:"",rscr:"",Rsh:"",rsh:"",rsqb:"]",rsquo:"",rsquor:"",rthree:"",rtimes:"",rtri:"",rtrie:"",rtrif:"",rtriltri:"",RuleDelayed:"",ruluhar:"",rx:"",Sacute:"",sacute:"",sbquo:"",Sc:"",sc:"",scap:"",Scaron:"",scaron:"",sccue:"",scE:"",sce:"",Scedil:"",scedil:"",Scirc:"",scirc:"",scnap:"",scnE:"",scnsim:"",scpolint:"",scsim:"",Scy:"",scy:"",sdot:"",sdotb:"",sdote:"",searhk:"",seArr:"",searr:"",searrow:"",sect:"",semi:";",seswar:"",setminus:"",setmn:"",sext:"",Sfr:"",sfr:"",sfrown:"",sharp:"",SHCHcy:"",shchcy:"",SHcy:"",shcy:"",ShortDownArrow:"",ShortLeftArrow:"",shortmid:"",shortparallel:"",ShortRightArrow:"",ShortUpArrow:"",shy:"",Sigma:"",sigma:"",sigmaf:"",sigmav:"",sim:"",simdot:"",sime:"",simeq:"",simg:"",simgE:"",siml:"",simlE:"",simne:"",simplus:"",simrarr:"",slarr:"",SmallCircle:"",smallsetminus:"",smashp:"",smeparsl:"",smid:"",smile:"",smt:"",smte:"",smtes:"",SOFTcy:"",softcy:"",sol:"/",solb:"",solbar:"",Sopf:"",sopf:"",spades:"",spadesuit:"",spar:"",sqcap:"",sqcaps:"",sqcup:"",sqcups:"",Sqrt:"",sqsub:"",sqsube:"",sqsubset:"",sqsubseteq:"",sqsup:"",sqsupe:"",sqsupset:"",sqsupseteq:"",squ:"",Square:"",square:"",SquareIntersection:"",SquareSubset:"",SquareSubsetEqual:"",SquareSuperset:"",SquareSupersetEqual:"",SquareUnion:"",squarf:"",squf:"",srarr:"",Sscr:"",sscr:"",ssetmn:"",ssmile:"",sstarf:"",Star:"",star:"",starf:"",straightepsilon:"",straightphi:"",strns:"",Sub:"",sub:"",subdot:"",subE:"",sube:"",subedot:"",submult:"",subnE:"",subne:"",subplus:"",subrarr:"",Subset:"",subset:"",subseteq:"",subseteqq:"",SubsetEqual:"",subsetneq:"",subsetneqq:"",subsim:"",subsub:"",subsup:"",succ:"",succapprox:"",succcurlyeq:"",Succeeds:"",SucceedsEqual:"",SucceedsSlantEqual:"",SucceedsTilde:"",succeq:"",succnapprox:"",succneqq:"",succnsim:"",succsim:"",SuchThat:"",Sum:"",sum:"",sung:"",Sup:"",sup:"",sup1:"",sup2:"",sup3:"",supdot:"",supdsub:"",supE:"",supe:"",supedot:"",Superset:"",SupersetEqual:"",suphsol:"",suphsub:"",suplarr:"",supmult:"",supnE:"",supne:"",supplus:"",Supset:"",supset:"",supseteq:"",supseteqq:"",supsetneq:"",supsetneqq:"",supsim:"",supsub:"",supsup:"",swarhk:"",swArr:"",swarr:"",swarrow:"",swnwar:"",szlig:"",Tab:"	",target:"",Tau:"",tau:"",tbrk:"",Tcaron:"",tcaron:"",Tcedil:"",tcedil:"",Tcy:"",tcy:"",tdot:"",telrec:"",Tfr:"",tfr:"",there4:"",Therefore:"",therefore:"",Theta:"",theta:"",thetasym:"",thetav:"",thickapprox:"",thicksim:"",ThickSpace:"",thinsp:"",ThinSpace:"",thkap:"",thksim:"",THORN:"",thorn:"",Tilde:"",tilde:"",TildeEqual:"",TildeFullEqual:"",TildeTilde:"",times:"",timesb:"",timesbar:"",timesd:"",tint:"",toea:"",top:"",topbot:"",topcir:"",Topf:"",topf:"",topfork:"",tosa:"",tprime:"",TRADE:"",trade:"",triangle:"",triangledown:"",triangleleft:"",trianglelefteq:"",triangleq:"",triangleright:"",trianglerighteq:"",tridot:"",trie:"",triminus:"",TripleDot:"",triplus:"",trisb:"",tritime:"",trpezium:"",Tscr:"",tscr:"",TScy:"",tscy:"",TSHcy:"",tshcy:"",Tstrok:"",tstrok:"",twixt:"",twoheadleftarrow:"",twoheadrightarrow:"",Uacute:"",uacute:"",Uarr:"",uArr:"",uarr:"",Uarrocir:"",Ubrcy:"",ubrcy:"",Ubreve:"",ubreve:"",Ucirc:"",ucirc:"",Ucy:"",ucy:"",udarr:"",Udblac:"",udblac:"",udhar:"",ufisht:"",Ufr:"",ufr:"",Ugrave:"",ugrave:"",uHar:"",uharl:"",uharr:"",uhblk:"",ulcorn:"",ulcorner:"",ulcrop:"",ultri:"",Umacr:"",umacr:"",uml:"",UnderBar:"_",UnderBrace:"",UnderBracket:"",UnderParenthesis:"",Union:"",UnionPlus:"",Uogon:"",uogon:"",Uopf:"",uopf:"",UpArrow:"",Uparrow:"",uparrow:"",UpArrowBar:"",UpArrowDownArrow:"",UpDownArrow:"",Updownarrow:"",updownarrow:"",UpEquilibrium:"",upharpoonleft:"",upharpoonright:"",uplus:"",UpperLeftArrow:"",UpperRightArrow:"",Upsi:"",upsi:"",upsih:"",Upsilon:"",upsilon:"",UpTee:"",UpTeeArrow:"",upuparrows:"",urcorn:"",urcorner:"",urcrop:"",Uring:"",uring:"",urtri:"",Uscr:"",uscr:"",utdot:"",Utilde:"",utilde:"",utri:"",utrif:"",uuarr:"",Uuml:"",uuml:"",uwangle:"",vangrt:"",varepsilon:"",varkappa:"",varnothing:"",varphi:"",varpi:"",varpropto:"",vArr:"",varr:"",varrho:"",varsigma:"",varsubsetneq:"",varsubsetneqq:"",varsupsetneq:"",varsupsetneqq:"",vartheta:"",vartriangleleft:"",vartriangleright:"",Vbar:"",vBar:"",vBarv:"",Vcy:"",vcy:"",VDash:"",Vdash:"",vDash:"",vdash:"",Vdashl:"",Vee:"",vee:"",veebar:"",veeeq:"",vellip:"",Verbar:"",verbar:"|",Vert:"",vert:"|",VerticalBar:"",VerticalLine:"|",VerticalSeparator:"",VerticalTilde:"",VeryThinSpace:"",Vfr:"",vfr:"",vltri:"",vnsub:"",vnsup:"",Vopf:"",vopf:"",vprop:"",vrtri:"",Vscr:"",vscr:"",vsubnE:"",vsubne:"",vsupnE:"",vsupne:"",Vvdash:"",vzigzag:"",Wcirc:"",wcirc:"",wedbar:"",Wedge:"",wedge:"",wedgeq:"",weierp:"",Wfr:"",wfr:"",Wopf:"",wopf:"",wp:"",wr:"",wreath:"",Wscr:"",wscr:"",xcap:"",xcirc:"",xcup:"",xdtri:"",Xfr:"",xfr:"",xhArr:"",xharr:"",Xi:"",xi:"",xlArr:"",xlarr:"",xmap:"",xnis:"",xodot:"",Xopf:"",xopf:"",xoplus:"",xotime:"",xrArr:"",xrarr:"",Xscr:"",xscr:"",xsqcup:"",xuplus:"",xutri:"",xvee:"",xwedge:"",Yacute:"",yacute:"",YAcy:"",yacy:"",Ycirc:"",ycirc:"",Ycy:"",ycy:"",yen:"",Yfr:"",yfr:"",YIcy:"",yicy:"",Yopf:"",yopf:"",Yscr:"",yscr:"",YUcy:"",yucy:"",Yuml:"",yuml:"",Zacute:"",zacute:"",Zcaron:"",zcaron:"",Zcy:"",zcy:"",Zdot:"",zdot:"",zeetrf:"",ZeroWidthSpace:"",Zeta:"",zeta:"",Zfr:"",zfr:"",ZHcy:"",zhcy:"",zigrarr:"",Zopf:"",zopf:"",Zscr:"",zscr:"",zwj:"",zwnj:""}),g.entityMap=g.HTML_ENTITIES})(Fd)),Fd}var Eu={},F0;function iw(){if(F0)return Eu;F0=1;var g=Zu().NAMESPACE,t=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,e=new RegExp("[\\-\\.0-9"+t.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+t.source+e.source+"*(?::"+t.source+e.source+"*)?$"),s=0,a=1,o=2,u=3,h=4,d=5,f=6,p=7;function v(B,H){this.message=B,this.locator=H,Error.captureStackTrace&&Error.captureStackTrace(this,v)}v.prototype=new Error,v.prototype.name=v.name;function A(){}A.prototype={parse:function(B,H,V){var Z=this.domBuilder;Z.startDocument(),M(H,H={}),C(B,H,V,Z,this.errorHandler),Z.endDocument()}};function C(B,H,V,Z,rt){function ft(Wt){if(Wt>65535){Wt-=65536;var Jt=55296+(Wt>>10),Kt=56320+(Wt&1023);return String.fromCharCode(Jt,Kt)}else return String.fromCharCode(Wt)}function mt(Wt){var Jt=Wt.slice(1,-1);return Jt in V?V[Jt]:Jt.charAt(0)==="#"?ft(parseInt(Jt.substr(1).replace("x","0x"))):(rt.error("entity not found:"+Wt),Wt)}function G(Wt){if(Wt>yt){var Jt=B.substring(yt,Wt).replace(/&#?\w+;/g,mt);j&&W(yt),Z.characters(Jt,0,Wt-yt),yt=Wt}}function W(Wt,Jt){for(;Wt>=bt&&(Jt=Nt.exec(B));)st=Jt.index,bt=st+Jt[0].length,j.lineNumber++;j.columnNumber=Wt-st+1}for(var st=0,bt=0,Nt=/.*(?:\r\n?|\n)|.*$/g,j=Z.locator,$=[{currentNSMap:H}],gt={},yt=0;;){try{var Dt=B.indexOf("<",yt);if(Dt<0){if(!B.substr(yt).match(/^\s*$/)){var zt=Z.doc,kt=zt.createTextNode(B.substr(yt));zt.appendChild(kt),Z.currentElement=kt}return}switch(Dt>yt&&G(Dt),B.charAt(Dt+1)){case"/":var be=B.indexOf(">",Dt+3),Lt=B.substring(Dt+2,be).replace(/[ \t\n\r]+$/g,""),Gt=$.pop();be<0?(Lt=B.substring(Dt+2).replace(/[\s<].*/,""),rt.error("end tag name: "+Lt+" is not complete:"+Gt.tagName),be=Dt+1+Lt.length):Lt.match(/\s</)&&(Lt=Lt.replace(/[\s<].*/,""),rt.error("end tag name: "+Lt+" maybe not complete"),be=Dt+1+Lt.length);var ye=Gt.localNSMap,Yt=Gt.tagName==Lt,ee=Yt||Gt.tagName&&Gt.tagName.toLowerCase()==Lt.toLowerCase();if(ee){if(Z.endElement(Gt.uri,Gt.localName,Lt),ye)for(var ie in ye)Object.prototype.hasOwnProperty.call(ye,ie)&&Z.endPrefixMapping(ie);Yt||rt.fatalError("end tag name: "+Lt+" is not match the current start tagName:"+Gt.tagName)}else $.push(Gt);be++;break;case"?":j&&W(Dt),be=O(B,Dt,Z);break;case"!":j&&W(Dt),be=T(B,Dt,Z,rt);break;default:j&&W(Dt);var ne=new k,Re=$[$.length-1].currentNSMap,be=b(B,Dt,ne,Re,mt,rt),fe=ne.length;if(!ne.closed&&D(B,be,ne.tagName,gt)&&(ne.closed=!0,V.nbsp||rt.warning("unclosed xml attribute")),j&&fe){for(var Ve=w(j,{}),Je=0;Je<fe;Je++){var Ke=ne[Je];W(Ke.offset),Ke.locator=w(j,{})}Z.locator=Ve,_(ne,Z,Re)&&$.push(ne),Z.locator=j}else _(ne,Z,Re)&&$.push(ne);g.isHTML(ne.uri)&&!ne.closed?be=x(B,be,ne.tagName,mt,Z):be++}}catch(Wt){if(Wt instanceof v)throw Wt;rt.error("element parse error: "+Wt),be=-1}be>yt?yt=be:G(Math.max(Dt,yt)+1)}}function w(B,H){return H.lineNumber=B.lineNumber,H.columnNumber=B.columnNumber,H}function b(B,H,V,Z,rt,ft){function mt(j,$,gt){V.attributeNames.hasOwnProperty(j)&&ft.fatalError("Attribute "+j+" redefined"),V.addValue(j,$,gt)}for(var G,W,st=++H,bt=s;;){var Nt=B.charAt(st);switch(Nt){case"=":if(bt===a)G=B.slice(H,st),bt=u;else if(bt===o)bt=u;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(bt===u||bt===a)if(bt===a&&(ft.warning('attribute value must after "="'),G=B.slice(H,st)),H=st+1,st=B.indexOf(Nt,H),st>0)W=B.slice(H,st).replace(/&#?\w+;/g,rt),mt(G,W,H-1),bt=d;else throw new Error("attribute value no end '"+Nt+"' match");else if(bt==h)W=B.slice(H,st).replace(/&#?\w+;/g,rt),mt(G,W,H),ft.warning('attribute "'+G+'" missed start quot('+Nt+")!!"),H=st+1,bt=d;else throw new Error('attribute value must after "="');break;case"/":switch(bt){case s:V.setTagName(B.slice(H,st));case d:case f:case p:bt=p,V.closed=!0;case h:case a:break;case o:V.closed=!0;break;default:throw new Error("attribute invalid close char('/')")}break;case"":return ft.error("unexpected end of input"),bt==s&&V.setTagName(B.slice(H,st)),st;case">":switch(bt){case s:V.setTagName(B.slice(H,st));case d:case f:case p:break;case h:case a:W=B.slice(H,st),W.slice(-1)==="/"&&(V.closed=!0,W=W.slice(0,-1));case o:bt===o&&(W=G),bt==h?(ft.warning('attribute "'+W+'" missed quot(")!'),mt(G,W.replace(/&#?\w+;/g,rt),H)):((!g.isHTML(Z[""])||!W.match(/^(?:disabled|checked|selected)$/i))&&ft.warning('attribute "'+W+'" missed value!! "'+W+'" instead!!'),mt(W,W,H));break;case u:throw new Error("attribute value missed!!")}return st;case"":Nt=" ";default:if(Nt<=" ")switch(bt){case s:V.setTagName(B.slice(H,st)),bt=f;break;case a:G=B.slice(H,st),bt=o;break;case h:var W=B.slice(H,st).replace(/&#?\w+;/g,rt);ft.warning('attribute "'+W+'" missed quot(")!!'),mt(G,W,H);case d:bt=f;break}else switch(bt){case o:V.tagName,(!g.isHTML(Z[""])||!G.match(/^(?:disabled|checked|selected)$/i))&&ft.warning('attribute "'+G+'" missed value!! "'+G+'" instead2!!'),mt(G,G,H),H=st,bt=a;break;case d:ft.warning('attribute space is required"'+G+'"!!');case f:bt=a,H=st;break;case u:bt=h,H=st;break;case p:throw new Error("elements closed character '/' and '>' must be connected to")}}st++}}function _(B,H,V){for(var Z=B.tagName,rt=null,Nt=B.length;Nt--;){var ft=B[Nt],mt=ft.qName,G=ft.value,j=mt.indexOf(":");if(j>0)var W=ft.prefix=mt.slice(0,j),st=mt.slice(j+1),bt=W==="xmlns"&&st;else st=mt,W=null,bt=mt==="xmlns"&&"";ft.localName=st,bt!==!1&&(rt==null&&(rt={},M(V,V={})),V[bt]=rt[bt]=G,ft.uri=g.XMLNS,H.startPrefixMapping(bt,G))}for(var Nt=B.length;Nt--;){ft=B[Nt];var W=ft.prefix;W&&(W==="xml"&&(ft.uri=g.XML),W!=="xmlns"&&(ft.uri=V[W||""]))}var j=Z.indexOf(":");j>0?(W=B.prefix=Z.slice(0,j),st=B.localName=Z.slice(j+1)):(W=null,st=B.localName=Z);var $=B.uri=V[W||""];if(H.startElement($,st,Z,B),B.closed){if(H.endElement($,st,Z),rt)for(W in rt)Object.prototype.hasOwnProperty.call(rt,W)&&H.endPrefixMapping(W)}else return B.currentNSMap=V,B.localNSMap=rt,!0}function x(B,H,V,Z,rt){if(/^(?:script|textarea)$/i.test(V)){var ft=B.indexOf("</"+V+">",H),mt=B.substring(H+1,ft);if(/[&<]/.test(mt))return/^script$/i.test(V)?(rt.characters(mt,0,mt.length),ft):(mt=mt.replace(/&#?\w+;/g,Z),rt.characters(mt,0,mt.length),ft)}return H+1}function D(B,H,V,Z){var rt=Z[V];return rt==null&&(rt=B.lastIndexOf("</"+V+">"),rt<H&&(rt=B.lastIndexOf("</"+V)),Z[V]=rt),rt<H}function M(B,H){for(var V in B)Object.prototype.hasOwnProperty.call(B,V)&&(H[V]=B[V])}function T(B,H,V,Z){var rt=B.charAt(H+2);switch(rt){case"-":if(B.charAt(H+3)==="-"){var ft=B.indexOf("-->",H+4);return ft>H?(V.comment(B,H+4,ft-H-4),ft+3):(Z.error("Unclosed comment"),-1)}else return-1;default:if(B.substr(H+3,6)=="CDATA["){var ft=B.indexOf("]]>",H+9);return V.startCDATA(),V.characters(B,H+9,ft-H-9),V.endCDATA(),ft+3}var mt=z(B,H),G=mt.length;if(G>1&&/!doctype/i.test(mt[0][0])){var W=mt[1][0],st=!1,bt=!1;G>3&&(/^public$/i.test(mt[2][0])?(st=mt[3][0],bt=G>4&&mt[4][0]):/^system$/i.test(mt[2][0])&&(bt=mt[3][0]));var Nt=mt[G-1];return V.startDTD(W,st,bt),V.endDTD(),Nt.index+Nt[0].length}}return-1}function O(B,H,V){var Z=B.indexOf("?>",H);if(Z){var rt=B.substring(H,Z).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return rt?(rt[0].length,V.processingInstruction(rt[1],rt[2]),Z+2):-1}return-1}function k(){this.attributeNames={}}k.prototype={setTagName:function(B){if(!i.test(B))throw new Error("invalid tagName:"+B);this.tagName=B},addValue:function(B,H,V){if(!i.test(B))throw new Error("invalid attribute:"+B);this.attributeNames[B]=this.length,this[this.length++]={qName:B,value:H,offset:V}},length:0,getLocalName:function(B){return this[B].localName},getLocator:function(B){return this[B].locator},getQName:function(B){return this[B].qName},getURI:function(B){return this[B].uri},getValue:function(B){return this[B].value}};function z(B,H){var V,Z=[],rt=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(rt.lastIndex=H,rt.exec(B);V=rt.exec(B);)if(Z.push(V),V[1])return Z}return Eu.XMLReader=A,Eu.ParseError=v,Eu}var P0;function nw(){if(P0)return ba;P0=1;var g=Zu(),t=Wy(),e=ew(),i=iw(),s=t.DOMImplementation,a=g.NAMESPACE,o=i.ParseError,u=i.XMLReader;function h(w){this.options=w||{locator:{}}}h.prototype.parseFromString=function(w,b){var _=this.options,x=new u,D=_.domBuilder||new f,M=_.errorHandler,T=_.locator,O=_.xmlns||{},k=/\/x?html?$/.test(b),z=k?e.HTML_ENTITIES:e.XML_ENTITIES;return T&&D.setDocumentLocator(T),x.errorHandler=d(M,D,T),x.domBuilder=_.domBuilder||D,k&&(O[""]=a.HTML),O.xml=O.xml||a.XML,w&&typeof w=="string"?x.parse(w,O,z):x.errorHandler.error("invalid doc source"),D.doc};function d(w,b,_){if(!w){if(b instanceof f)return b;w=b}var x={},D=w instanceof Function;_=_||{};function M(T){var O=w[T];!O&&D&&(O=w.length==2?function(k){w(T,k)}:w),x[T]=O&&function(k){O("[xmldom "+T+"]	"+k+v(_))}||function(){}}return M("warning"),M("error"),M("fatalError"),x}function f(){this.cdata=!1}function p(w,b){b.lineNumber=w.lineNumber,b.columnNumber=w.columnNumber}f.prototype={startDocument:function(){this.doc=new s().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(w,b,_,x){var D=this.doc,M=D.createElementNS(w,_||b),T=x.length;C(this,M),this.currentElement=M,this.locator&&p(this.locator,M);for(var O=0;O<T;O++){var w=x.getURI(O),k=x.getValue(O),_=x.getQName(O),z=D.createAttributeNS(w,_);this.locator&&p(x.getLocator(O),z),z.value=z.nodeValue=k,M.setAttributeNode(z)}},endElement:function(w,b,_){var x=this.currentElement;x.tagName,this.currentElement=x.parentNode},startPrefixMapping:function(w,b){},endPrefixMapping:function(w){},processingInstruction:function(w,b){var _=this.doc.createProcessingInstruction(w,b);this.locator&&p(this.locator,_),C(this,_)},ignorableWhitespace:function(w,b,_){},characters:function(w,b,_){if(w=A.apply(this,arguments),w){if(this.cdata)var x=this.doc.createCDATASection(w);else var x=this.doc.createTextNode(w);this.currentElement?this.currentElement.appendChild(x):/^\s*$/.test(w)&&this.doc.appendChild(x),this.locator&&p(this.locator,x)}},skippedEntity:function(w){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(w){(this.locator=w)&&(w.lineNumber=0)},comment:function(w,b,_){w=A.apply(this,arguments);var x=this.doc.createComment(w);this.locator&&p(this.locator,x),C(this,x)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(w,b,_){var x=this.doc.implementation;if(x&&x.createDocumentType){var D=x.createDocumentType(w,b,_);this.locator&&p(this.locator,D),C(this,D),this.doc.doctype=D}},warning:function(w){console.warn("[xmldom warning]	"+w,v(this.locator))},error:function(w){console.error("[xmldom error]	"+w,v(this.locator))},fatalError:function(w){throw new o(w,this.locator)}};function v(w){if(w)return`
@`+(w.systemId||"")+"#[line:"+w.lineNumber+",col:"+w.columnNumber+"]"}function A(w,b,_){return typeof w=="string"?w.substr(b,_):w.length>=b+_||b?new java.lang.String(w,b,_)+"":w}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(w){f.prototype[w]=function(){return null}});function C(w,b){w.currentElement?w.currentElement.appendChild(b):w.doc.appendChild(b)}return ba.__DOMHandler=f,ba.DOMParser=h,ba.DOMImplementation=t.DOMImplementation,ba.XMLSerializer=t.XMLSerializer,ba}var U0;function sw(){if(U0)return Io;U0=1;var g=Wy();return Io.DOMImplementation=g.DOMImplementation,Io.XMLSerializer=g.XMLSerializer,Io.DOMParser=nw().DOMParser,Io}var Zy=sw();const qf=typeof window<"u"?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1,rw=1,aw=3,Ky=typeof URL<"u"?URL:typeof window<"u"?window.URL||window.webkitURL||window.mozURL:void 0;function Ku(){var g=new Date().getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var i=(g+Math.random()*16)%16|0;return g=Math.floor(g/16),(e=="x"?i:i&7|8).toString(16)});return t}function ow(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function $y(g){return!!(g&&g.nodeType==1)}function di(g){return!isNaN(parseFloat(g))&&isFinite(g)}function Qy(g){let t=parseFloat(g);return di(g)===!1?!1:typeof g=="string"&&g.indexOf(".")>-1?!0:Math.floor(t)!==t}function xa(g){var t=["Webkit","webkit","Moz","O","ms"],e=["-webkit-","-webkit-","-moz-","-o-","-ms-"],i=g.toLowerCase(),s=t.length;if(typeof document>"u"||typeof document.body.style[i]<"u")return g;for(var a=0;a<s;a++)if(typeof document.body.style[e[a]+i]<"u")return e[a]+i;return g}function Jy(g){for(var t=1,e=arguments.length;t<e;t++){var i=arguments[t];for(var s in i)g[s]===void 0&&(g[s]=i[s])}return g}function Hi(g){var t=[].slice.call(arguments,1);return t.forEach(function(e){e&&Object.getOwnPropertyNames(e).forEach(function(i){Object.defineProperty(g,i,Object.getOwnPropertyDescriptor(e,i))})}),g}function lw(g,t,e){var i=Fa(g,t,e);return t.splice(i,0,g),i}function Fa(g,t,e,i,s){var a=i||0,o=s||t.length,u=parseInt(a+(o-a)/2),h;return e||(e=function(d,f){if(d>f)return 1;if(d<f)return-1;if(d==f)return 0}),o-a<=0?u:(h=e(t[u],g),o-a===1?h>=0?u:u+1:h===0?u:h===-1?Fa(g,t,e,u,o):Fa(g,t,e,a,u))}function Mu(g,t,e,i,s){var a=i||0,o=s||t.length,u=parseInt(a+(o-a)/2),h;return e||(e=function(d,f){if(d>f)return 1;if(d<f)return-1;if(d==f)return 0}),o-a<=0?-1:(h=e(t[u],g),o-a===1?h===0?u:-1:h===0?u:h===-1?Mu(g,t,e,u,o):Mu(g,t,e,a,u))}function Du(g){var t=window.getComputedStyle(g),e=["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,a=0;return e.forEach(function(o){s+=parseFloat(t[o])||0}),i.forEach(function(o){a+=parseFloat(t[o])||0}),{height:a,width:s}}function Lu(g){var t=window.getComputedStyle(g),e=["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"],i=["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"],s=0,a=0;return e.forEach(function(o){s+=parseFloat(t[o])||0}),i.forEach(function(o){a+=parseFloat(t[o])||0}),{height:a,width:s}}function _f(g){let t,e=g.ownerDocument;if(g.nodeType==Node.TEXT_NODE){let i=e.createRange();i.selectNodeContents(g),t=i.getBoundingClientRect()}else t=g.getBoundingClientRect();return t}function Bu(){var g=window.innerWidth,t=window.innerHeight;return{top:0,left:0,right:g,bottom:t,width:g,height:t}}function Gf(g,t){for(var e=g.parentNode,i=e.childNodes,s,a=-1,o=0;o<i.length&&(s=i[o],s.nodeType===t&&a++,s!=g);o++);return a}function uw(g){return Gf(g,aw)}function tb(g){return Gf(g,rw)}function Wo(g){return["xml","opf","ncx"].indexOf(g)>-1}function eb(g,t){return new Blob([g],{type:t})}function Iu(g,t){var e,i=eb(g,t);return e=Ky.createObjectURL(i),e}function ib(g){return Ky.revokeObjectURL(g)}function wf(g,t){var e,i;if(typeof g=="string")return e=btoa(g),i="data:"+t+";base64,"+e,i}function nb(g){return Object.prototype.toString.call(g).slice(8,-1)}function rs(g,t,e){var i,s;return typeof DOMParser>"u"||e?s=Zy.DOMParser:s=DOMParser,g.charCodeAt(0)===65279&&(g=g.slice(1)),i=new s().parseFromString(g,t),i}function Ye(g,t){var e;if(!g)throw new Error("No Element Provided");if(typeof g.querySelector<"u")return g.querySelector(t);if(e=g.getElementsByTagName(t),e.length)return e[0]}function Rs(g,t){return typeof g.querySelector<"u"?g.querySelectorAll(t):g.getElementsByTagName(t)}function Ca(g,t,e){var i,s;if(typeof g.querySelector<"u"){t+="[";for(var a in e)t+=a+"~='"+e[a]+"'";return t+="]",g.querySelector(t)}else if(i=g.getElementsByTagName(t),s=Array.prototype.slice.call(i,0).filter(function(o){for(var u in e)if(o.getAttribute(u)===e[u])return!0;return!1}),s)return s[0]}function zu(g,t){var e=g.ownerDocument||g;typeof e.createTreeWalker<"u"?sb(g,t,NodeFilter.SHOW_TEXT):Vf(g,function(i){i&&i.nodeType===3&&t(i)})}function sb(g,t,e){var i=document.createTreeWalker(g,e,null,!1);let s;for(;s=i.nextNode();)t(s)}function Vf(g,t){if(t(g))return!0;if(g=g.firstChild,g)do{if(Vf(g,t))return!0;g=g.nextSibling}while(g)}function rb(g){return new Promise(function(t,e){var i=new FileReader;i.readAsDataURL(g),i.onloadend=function(){t(i.result)}})}function Ce(){this.resolve=null,this.reject=null,this.id=Ku(),this.promise=new Promise((g,t)=>{this.resolve=g,this.reject=t}),Object.freeze(this)}function Fu(g,t,e){var i;if(typeof g.querySelector<"u"&&(i=g.querySelector(`${t}[*|type="${e}"]`)),!i||i.length===0){i=Rs(g,t);for(var s=0;s<i.length;s++)if(i[s].getAttributeNS("http://www.idpf.org/2007/ops","type")===e||i[s].getAttribute("epub:type")===e)return i[s]}else return i}function Ef(g){for(var t=[],e=g.childNodes,i=0;i<e.length;i++){let s=e[i];s.nodeType===1&&t.push(s)}return t}function Sf(g){for(var t=[g];g;g=g.parentNode)t.unshift(g);return t}function Ta(g,t,e){for(var i=[],s=g.childNodes,a=0;a<s.length;a++){let o=s[a];if(o.nodeType===1&&o.nodeName.toLowerCase()===t){if(e)return o;i.push(o)}}if(!e)return i}function hw(g,t){let e;if(!(g===null||t===""))for(e=g.parentNode;e.nodeType===1;){if(e.tagName.toLowerCase()===t)return e;e=e.parentNode}}class ab{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(t,e){this.startContainer=t,this.startOffset=e,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(t,e){this.endContainer=t,this.endOffset=e,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(t){this.collapsed=!0,t?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(t){let e=t.parentNode,i=Array.prototype.indexOf.call(e.childNodes,t);this.setStart(e,i),this.setEnd(e,i+1)}selectNodeContents(t){t.childNodes[t.childNodes-1];let e=t.nodeType===3?t.textContent.length:parent.childNodes.length;this.setStart(t,0),this.setEnd(t,e)}_commonAncestorContainer(t,e){var i=Sf(t||this.startContainer),s=Sf(e||this.endContainer);if(i[0]==s[0]){for(var a=0;a<i.length;a++)if(i[a]!=s[a])return i[a-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}}const cw=Object.freeze(Object.defineProperty({__proto__:null,RangeObject:ab,blob2base64:rb,borders:Lu,bounds:Du,createBase64Url:wf,createBlob:eb,createBlobUrl:Iu,defaults:Jy,defer:Ce,documentHeight:ow,extend:Hi,filterChildren:Ta,findChildren:Ef,getParentByTagName:hw,indexOfElementNode:tb,indexOfNode:Gf,indexOfSorted:Mu,indexOfTextNode:uw,insert:lw,isElement:$y,isFloat:Qy,isNumber:di,isXml:Wo,locationOf:Fa,nodeBounds:_f,parents:Sf,parse:rs,prefixed:xa,qs:Ye,qsa:Rs,qsp:Ca,querySelectorByType:Fu,requestAnimationFrame:qf,revokeBlobUrl:ib,sprint:zu,treeWalker:sb,type:nb,uuid:Ku,walk:Vf,windowBounds:Bu},Symbol.toStringTag,{value:"Module"}));var Pd,H0;function dw(){if(H0)return Pd;if(H0=1,!g)var g={cwd:function(){return"/"}};function t(a){if(typeof a!="string")throw new TypeError("Path must be a string. Received "+a)}function e(a,o){for(var u="",h=-1,d=0,f,p=0;p<=a.length;++p){if(p<a.length)f=a.charCodeAt(p);else{if(f===47)break;f=47}if(f===47){if(!(h===p-1||d===1))if(h!==p-1&&d===2){if(u.length<2||u.charCodeAt(u.length-1)!==46||u.charCodeAt(u.length-2)!==46){if(u.length>2){for(var v=u.length-1,A=v;A>=0&&u.charCodeAt(A)!==47;--A);if(A!==v){A===-1?u="":u=u.slice(0,A),h=p,d=0;continue}}else if(u.length===2||u.length===1){u="",h=p,d=0;continue}}o&&(u.length>0?u+="/..":u="..")}else u.length>0?u+="/"+a.slice(h+1,p):u=a.slice(h+1,p);h=p,d=0}else f===46&&d!==-1?++d:d=-1}return u}function i(a,o){var u=o.dir||o.root,h=o.base||(o.name||"")+(o.ext||"");return u?u===o.root?u+h:u+a+h:h}var s={resolve:function(){for(var o="",u=!1,h,d=arguments.length-1;d>=-1&&!u;d--){var f;d>=0?f=arguments[d]:(h===void 0&&(h=g.cwd()),f=h),t(f),f.length!==0&&(o=f+"/"+o,u=f.charCodeAt(0)===47)}return o=e(o,!u),u?o.length>0?"/"+o:"/":o.length>0?o:"."},normalize:function(o){if(t(o),o.length===0)return".";var u=o.charCodeAt(0)===47,h=o.charCodeAt(o.length-1)===47;return o=e(o,!u),o.length===0&&!u&&(o="."),o.length>0&&h&&(o+="/"),u?"/"+o:o},isAbsolute:function(o){return t(o),o.length>0&&o.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var o,u=0;u<arguments.length;++u){var h=arguments[u];t(h),h.length>0&&(o===void 0?o=h:o+="/"+h)}return o===void 0?".":s.normalize(o)},relative:function(o,u){if(t(o),t(u),o===u||(o=s.resolve(o),u=s.resolve(u),o===u))return"";for(var h=1;h<o.length&&o.charCodeAt(h)===47;++h);for(var d=o.length,f=d-h,p=1;p<u.length&&u.charCodeAt(p)===47;++p);for(var v=u.length,A=v-p,C=f<A?f:A,w=-1,b=0;b<=C;++b){if(b===C){if(A>C){if(u.charCodeAt(p+b)===47)return u.slice(p+b+1);if(b===0)return u.slice(p+b)}else f>C&&(o.charCodeAt(h+b)===47?w=b:b===0&&(w=0));break}var _=o.charCodeAt(h+b),x=u.charCodeAt(p+b);if(_!==x)break;_===47&&(w=b)}var D="";for(b=h+w+1;b<=d;++b)(b===d||o.charCodeAt(b)===47)&&(D.length===0?D+="..":D+="/..");return D.length>0?D+u.slice(p+w):(p+=w,u.charCodeAt(p)===47&&++p,u.slice(p))},_makeLong:function(o){return o},dirname:function(o){if(t(o),o.length===0)return".";for(var u=o.charCodeAt(0),h=u===47,d=-1,f=!0,p=o.length-1;p>=1;--p)if(u=o.charCodeAt(p),u===47){if(!f){d=p;break}}else f=!1;return d===-1?h?"/":".":h&&d===1?"//":o.slice(0,d)},basename:function(o,u){if(u!==void 0&&typeof u!="string")throw new TypeError('"ext" argument must be a string');t(o);var h=0,d=-1,f=!0,p;if(u!==void 0&&u.length>0&&u.length<=o.length){if(u.length===o.length&&u===o)return"";var v=u.length-1,A=-1;for(p=o.length-1;p>=0;--p){var C=o.charCodeAt(p);if(C===47){if(!f){h=p+1;break}}else A===-1&&(f=!1,A=p+1),v>=0&&(C===u.charCodeAt(v)?--v===-1&&(d=p):(v=-1,d=A))}return h===d?d=A:d===-1&&(d=o.length),o.slice(h,d)}else{for(p=o.length-1;p>=0;--p)if(o.charCodeAt(p)===47){if(!f){h=p+1;break}}else d===-1&&(f=!1,d=p+1);return d===-1?"":o.slice(h,d)}},extname:function(o){t(o);for(var u=-1,h=0,d=-1,f=!0,p=0,v=o.length-1;v>=0;--v){var A=o.charCodeAt(v);if(A===47){if(!f){h=v+1;break}continue}d===-1&&(f=!1,d=v+1),A===46?u===-1?u=v:p!==1&&(p=1):u!==-1&&(p=-1)}return u===-1||d===-1||p===0||p===1&&u===d-1&&u===h+1?"":o.slice(u,d)},format:function(o){if(o===null||typeof o!="object")throw new TypeError('Parameter "pathObject" must be an object, not '+typeof o);return i("/",o)},parse:function(o){t(o);var u={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return u;var h=o.charCodeAt(0),d=h===47,f;d?(u.root="/",f=1):f=0;for(var p=-1,v=0,A=-1,C=!0,w=o.length-1,b=0;w>=f;--w){if(h=o.charCodeAt(w),h===47){if(!C){v=w+1;break}continue}A===-1&&(C=!1,A=w+1),h===46?p===-1?p=w:b!==1&&(b=1):p!==-1&&(b=-1)}return p===-1||A===-1||b===0||b===1&&p===A-1&&p===v+1?A!==-1&&(v===0&&d?u.base=u.name=o.slice(1,A):u.base=u.name=o.slice(v,A)):(v===0&&d?(u.name=o.slice(1,p),u.base=o.slice(1,A)):(u.name=o.slice(v,p),u.base=o.slice(v,A)),u.ext=o.slice(p,A)),v>0?u.dir=o.slice(0,v-1):d&&(u.dir="/"),u},sep:"/",delimiter:":",posix:null};return Pd=s,Pd}var fw=dw();const rr=ur(fw);class Ns{constructor(t){var e,i;e=t.indexOf("://"),e>-1&&(t=new URL(t).pathname),i=this.parse(t),this.path=t,this.isDirectory(t)?this.directory=t:this.directory=i.dir+"/",this.filename=i.base,this.extension=i.ext.slice(1)}parse(t){return rr.parse(t)}isAbsolute(t){return rr.isAbsolute(t||this.path)}isDirectory(t){return t.charAt(t.length-1)==="/"}resolve(t){return rr.resolve(this.directory,t)}relative(t){var e=t&&t.indexOf("://")>-1;return e?t:rr.relative(this.directory,t)}splitPath(t){return this.splitPathRe.exec(t).slice(1)}toString(){return this.path}}class Gn{constructor(t,e){var i=t.indexOf("://")>-1,s=t,a;if(this.Url=void 0,this.href=t,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=e,!i&&e!==!1&&typeof e!="string"&&window&&window.location&&(this.base=window.location.href),i||this.base)try{this.base?this.Url=new URL(t,this.base):this.Url=new URL(t),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,s=this.Url.pathname+(this.Url.search?this.Url.search:"")}catch{this.Url=void 0,this.base&&(a=new Ns(this.base),s=a.resolve(s))}this.Path=new Ns(s),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(t){var e=t.indexOf("://")>-1,i;return e?t:(i=rr.resolve(this.directory,t),this.origin+i)}relative(t){return rr.relative(t,this.directory)}toString(){return this.href}}const Aa=1,Mn=3,pw=9;class Te{constructor(t,e,i){var s;if(this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof Te))return new Te(t,e,i);if(typeof e=="string"?this.base=this.parseComponent(e):typeof e=="object"&&e.steps&&(this.base=e),s=this.checkType(t),s==="string")return this.str=t,Hi(this,this.parse(t));if(s==="range")return Hi(this,this.fromRange(t,this.base,i));if(s==="node")return Hi(this,this.fromNode(t,this.base,i));if(s==="EpubCFI"&&t.path)return t;if(t)throw new TypeError("not a valid argument for EpubCFI");return this}checkType(t){return this.isCfiString(t)?"string":t&&typeof t=="object"&&(nb(t)==="Range"||typeof t.startContainer<"u")?"range":t&&typeof t=="object"&&typeof t.nodeType<"u"?"node":t&&typeof t=="object"&&t instanceof Te?"EpubCFI":!1}parse(t){var e={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},i,s,a;return typeof t!="string"?{spinePos:-1}:(t.indexOf("epubcfi(")===0&&t[t.length-1]===")"&&(t=t.slice(8,t.length-1)),i=this.getChapterComponent(t),i?(e.base=this.parseComponent(i),s=this.getPathComponent(t),e.path=this.parseComponent(s),a=this.getRange(t),a&&(e.range=!0,e.start=this.parseComponent(a[0]),e.end=this.parseComponent(a[1])),e.spinePos=e.base.steps[1].index,e):{spinePos:-1})}parseComponent(t){var e={steps:[],terminal:{offset:null,assertion:null}},i=t.split(":"),s=i[0].split("/"),a;return i.length>1&&(a=i[1],e.terminal=this.parseTerminal(a)),s[0]===""&&s.shift(),e.steps=s.map((function(o){return this.parseStep(o)}).bind(this)),e}parseStep(t){var e,i,s,a,o;if(a=t.match(/\[(.*)\]/),a&&a[1]&&(o=a[1]),i=parseInt(t),!isNaN(i))return i%2===0?(e="element",s=i/2-1):(e="text",s=(i-1)/2),{type:e,index:s,id:o||null}}parseTerminal(t){var e,i,s=t.match(/\[(.*)\]/);return s&&s[1]?(e=parseInt(t.split("[")[0]),i=s[1]):e=parseInt(t),di(e)||(e=null),{offset:e,assertion:i}}getChapterComponent(t){var e=t.split("!");return e[0]}getPathComponent(t){var e=t.split("!");if(e[1])return e[1].split(",")[0]}getRange(t){var e=t.split(",");return e.length===3?[e[1],e[2]]:!1}getCharecterOffsetComponent(t){var e=t.split(":");return e[1]||""}joinSteps(t){return t?t.map(function(e){var i="";return e.type==="element"&&(i+=(e.index+1)*2),e.type==="text"&&(i+=1+2*e.index),e.id&&(i+="["+e.id+"]"),i}).join("/"):""}segmentString(t){var e="/";return e+=this.joinSteps(t.steps),t.terminal&&t.terminal.offset!=null&&(e+=":"+t.terminal.offset),t.terminal&&t.terminal.assertion!=null&&(e+="["+t.terminal.assertion+"]"),e}toString(){var t="epubcfi(";return t+=this.segmentString(this.base),t+="!",t+=this.segmentString(this.path),this.range&&this.start&&(t+=",",t+=this.segmentString(this.start)),this.range&&this.end&&(t+=",",t+=this.segmentString(this.end)),t+=")",t}compare(t,e){var i,s,a,o;if(typeof t=="string"&&(t=new Te(t)),typeof e=="string"&&(e=new Te(e)),t.spinePos>e.spinePos)return 1;if(t.spinePos<e.spinePos)return-1;t.range?(i=t.path.steps.concat(t.start.steps),a=t.start.terminal):(i=t.path.steps,a=t.path.terminal),e.range?(s=e.path.steps.concat(e.start.steps),o=e.start.terminal):(s=e.path.steps,o=e.path.terminal);for(var u=0;u<i.length;u++){if(!i[u])return-1;if(!s[u]||i[u].index>s[u].index)return 1;if(i[u].index<s[u].index)return-1}return i.length<s.length?-1:a.offset>o.offset?1:a.offset<o.offset?-1:0}step(t){var e=t.nodeType===Mn?"text":"element";return{id:t.id,tagName:t.tagName,type:e,index:this.position(t)}}filteredStep(t,e){var i=this.filter(t,e),s;if(i)return s=i.nodeType===Mn?"text":"element",{id:i.id,tagName:i.tagName,type:s,index:this.filteredPosition(i,e)}}pathTo(t,e,i){for(var s={steps:[],terminal:{offset:null,assertion:null}},a=t,o;a&&a.parentNode&&a.parentNode.nodeType!=pw;)i?o=this.filteredStep(a,i):o=this.step(a),o&&s.steps.unshift(o),a=a.parentNode;return e!=null&&e>=0&&(s.terminal.offset=e,s.steps[s.steps.length-1].type!="text"&&s.steps.push({type:"text",index:0})),s}equalStep(t,e){return!t||!e?!1:t.index===e.index&&t.id===e.id&&t.type===e.type}fromRange(t,e,i){var s={range:!1,base:{},path:{},start:null,end:null},a=t.startContainer,o=t.endContainer,u=t.startOffset,h=t.endOffset,d=!1;if(i&&(d=a.ownerDocument.querySelector("."+i)!=null),typeof e=="string"?(s.base=this.parseComponent(e),s.spinePos=s.base.steps[1].index):typeof e=="object"&&(s.base=e),t.collapsed)d&&(u=this.patchOffset(a,u,i)),s.path=this.pathTo(a,u,i);else{s.range=!0,d&&(u=this.patchOffset(a,u,i)),s.start=this.pathTo(a,u,i),d&&(h=this.patchOffset(o,h,i)),s.end=this.pathTo(o,h,i),s.path={steps:[],terminal:null};var f=s.start.steps.length,p;for(p=0;p<f&&this.equalStep(s.start.steps[p],s.end.steps[p]);p++)p===f-1?s.start.terminal===s.end.terminal&&(s.path.steps.push(s.start.steps[p]),s.range=!1):s.path.steps.push(s.start.steps[p]);s.start.steps=s.start.steps.slice(s.path.steps.length),s.end.steps=s.end.steps.slice(s.path.steps.length)}return s}fromNode(t,e,i){var s={range:!1,base:{},path:{},start:null,end:null};return typeof e=="string"?(s.base=this.parseComponent(e),s.spinePos=s.base.steps[1].index):typeof e=="object"&&(s.base=e),s.path=this.pathTo(t,null,i),s}filter(t,e){var i,s,a,o,u,h=!1;return t.nodeType===Mn?(h=!0,a=t.parentNode,i=t.parentNode.classList.contains(e)):(h=!1,i=t.classList.contains(e)),i&&h?(o=a.previousSibling,u=a.nextSibling,o&&o.nodeType===Mn?s=o:u&&u.nodeType===Mn&&(s=u),s||t):i&&!h?!1:t}patchOffset(t,e,i){if(t.nodeType!=Mn)throw new Error("Anchor must be a text node");var s=t,a=e;for(t.parentNode.classList.contains(i)&&(s=t.parentNode);s.previousSibling;){if(s.previousSibling.nodeType===Aa)if(s.previousSibling.classList.contains(i))a+=s.previousSibling.textContent.length;else break;else a+=s.previousSibling.textContent.length;s=s.previousSibling}return a}normalizedMap(t,e,i){var s={},a=-1,o,u=t.length,h,d;for(o=0;o<u;o++)h=t[o].nodeType,h===Aa&&t[o].classList.contains(i)&&(h=Mn),o>0&&h===Mn&&d===Mn?s[o]=a:e===h&&(a=a+1,s[o]=a),d=h;return s}position(t){var e,i;return t.nodeType===Aa?(e=t.parentNode.children,e||(e=Ef(t.parentNode)),i=Array.prototype.indexOf.call(e,t)):(e=this.textNodes(t.parentNode),i=e.indexOf(t)),i}filteredPosition(t,e){var i,s,a;return t.nodeType===Aa?(i=t.parentNode.children,a=this.normalizedMap(i,Aa,e)):(i=t.parentNode.childNodes,t.parentNode.classList.contains(e)&&(t=t.parentNode,i=t.parentNode.childNodes),a=this.normalizedMap(i,Mn,e)),s=Array.prototype.indexOf.call(i,t),a[s]}stepsToXpath(t){var e=[".","*"];return t.forEach(function(i){var s=i.index+1;i.id?e.push("*[position()="+s+" and @id='"+i.id+"']"):i.type==="text"?e.push("text()["+s+"]"):e.push("*["+s+"]")}),e.join("/")}stepsToQuerySelector(t){var e=["html"];return t.forEach(function(i){var s=i.index+1;i.id?e.push("#"+i.id):i.type==="text"||e.push("*:nth-child("+s+")")}),e.join(">")}textNodes(t,e){return Array.prototype.slice.call(t.childNodes).filter(function(i){return i.nodeType===Mn?!0:!!(e&&i.classList.contains(e))})}walkToNode(t,e,i){var s=e||document,a=s.documentElement,o,u,h=t.length,d;for(d=0;d<h&&(u=t[d],u.type==="element"?u.id?a=s.getElementById(u.id):(o=a.children||Ef(a),a=o[u.index]):u.type==="text"&&(a=this.textNodes(a,i)[u.index]),!!a);d++);return a}findNode(t,e,i){var s=e||document,a,o;return!i&&typeof s.evaluate<"u"?(o=this.stepsToXpath(t),a=s.evaluate(o,s,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i?a=this.walkToNode(t,s,i):a=this.walkToNode(t,s),a}fixMiss(t,e,i,s){var a=this.findNode(t.slice(0,-1),i,s),o=a.childNodes,u=this.normalizedMap(o,Mn,s),h,d,f=t[t.length-1].index;for(let p in u){if(!u.hasOwnProperty(p))return;if(u[p]===f)if(h=o[p],d=h.textContent.length,e>d)e=e-d;else{h.nodeType===Aa?a=h.childNodes[0]:a=h;break}}return{container:a,offset:e}}toRange(t,e){var i=t||document,s,a,o,u,h,d=this,f,p,v=e?i.querySelector("."+e)!=null:!1,A;if(typeof i.createRange<"u"?s=i.createRange():s=new ab,d.range?(a=d.start,f=d.path.steps.concat(a.steps),u=this.findNode(f,i,v?e:null),o=d.end,p=d.path.steps.concat(o.steps),h=this.findNode(p,i,v?e:null)):(a=d.path,f=d.path.steps,u=this.findNode(d.path.steps,i,v?e:null)),u)try{a.terminal.offset!=null?s.setStart(u,a.terminal.offset):s.setStart(u,0)}catch{A=this.fixMiss(f,a.terminal.offset,i,v?e:null),s.setStart(A.container,A.offset)}else return console.log("No startContainer found for",this.toString()),null;if(h)try{o.terminal.offset!=null?s.setEnd(h,o.terminal.offset):s.setEnd(h,0)}catch{A=this.fixMiss(p,d.end.terminal.offset,i,v?e:null),s.setEnd(A.container,A.offset)}return s}isCfiString(t){return typeof t=="string"&&t.indexOf("epubcfi(")===0&&t[t.length-1]===")"}generateChapterComponent(t,e,i){var s=parseInt(e),a=(t+1)*2,o="/"+a+"/";return o+=(s+1)*2,i&&(o+="["+i+"]"),o}collapse(t){this.range&&(this.range=!1,t?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}class Xn{constructor(t){this.context=t||this,this.hooks=[]}register(){for(var t=0;t<arguments.length;++t)if(typeof arguments[t]=="function")this.hooks.push(arguments[t]);else for(var e=0;e<arguments[t].length;++e)this.hooks.push(arguments[t][e])}deregister(t){let e;for(let i=0;i<this.hooks.length;i++)if(e=this.hooks[i],e===t){this.hooks.splice(i,1);break}}trigger(){var t=arguments,e=this.context,i=[];return this.hooks.forEach(function(s){try{var a=s.apply(e,t)}catch(o){console.log(o)}a&&typeof a.then=="function"&&i.push(a)}),Promise.all(i)}list(){return this.hooks}clear(){return this.hooks=[]}}function ob(g,t){var e,i,s=t.url,a=s.indexOf("://")>-1;g&&(i=Ye(g,"head"),e=Ye(i,"base"),e||(e=g.createElement("base"),i.insertBefore(e,i.firstChild)),!a&&window&&window.location&&(s=window.location.origin+s),e.setAttribute("href",s))}function gw(g,t){var e,i,s=t.canonical;g&&(e=Ye(g,"head"),i=Ye(e,"link[rel='canonical']"),i?i.setAttribute("href",s):(i=g.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",s),e.appendChild(i)))}function mw(g,t){var e,i,s=t.idref;g&&(e=Ye(g,"head"),i=Ye(e,"link[property='dc.identifier']"),i?i.setAttribute("content",s):(i=g.createElement("meta"),i.setAttribute("name","dc.identifier"),i.setAttribute("content",s),e.appendChild(i)))}function vw(g,t){var e=g.querySelectorAll("a[href]");if(e.length)for(var i=Ye(g.ownerDocument,"base"),s=i?i.getAttribute("href"):void 0,a=(function(u){var h=u.getAttribute("href");if(h.indexOf("mailto:")!==0){var d=h.indexOf("://")>-1;if(d)u.setAttribute("target","_blank");else{var f;try{f=new Gn(h,s)}catch{}u.onclick=function(){return f&&f.hash?t(f.Path.path+f.hash):t(f?f.Path.path:h),!1}}}}).bind(this),o=0;o<e.length;o++)a(e[o])}function j0(g,t,e){return t.forEach(function(i,s){i&&e[s]&&(i=i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),g=g.replace(new RegExp(i,"g"),e[s]))}),g}function Zo(g,t,e,i){var s=typeof window<"u"?window.URL:!1,a=s?"blob":"arraybuffer",o=new Ce,u=new XMLHttpRequest,h=XMLHttpRequest.prototype,d;"overrideMimeType"in h||Object.defineProperty(h,"overrideMimeType",{value:function(){}}),e&&(u.withCredentials=!0),u.onreadystatechange=p,u.onerror=f,u.open("GET",g,!0);for(d in i)u.setRequestHeader(d,i[d]);t=="json"&&u.setRequestHeader("Accept","application/json"),t||(t=new Ns(g).extension),t=="blob"&&(u.responseType=a),Wo(t)&&u.overrideMimeType("text/xml"),t=="binary"&&(u.responseType="arraybuffer"),u.send();function f(v){o.reject(v)}function p(){if(this.readyState===XMLHttpRequest.DONE){var v=!1;if((this.responseType===""||this.responseType==="document")&&(v=this.responseXML),this.status===200||this.status===0||v){var A;if(!this.response&&!v)return o.reject({status:this.status,message:"Empty Response",stack:new Error().stack}),o.promise;if(this.status===403)return o.reject({status:this.status,response:this.response,message:"Forbidden",stack:new Error().stack}),o.promise;v?A=this.responseXML:Wo(t)?A=rs(this.response,"text/xml"):t=="xhtml"?A=rs(this.response,"application/xhtml+xml"):t=="html"||t=="htm"?A=rs(this.response,"text/html"):t=="json"?A=JSON.parse(this.response):t=="blob"?s?A=this.response:A=new Blob([this.response]):A=this.response,o.resolve(A)}else o.reject({status:this.status,message:this.response,stack:new Error().stack})}}return o.promise}class yw{constructor(t,e){this.idref=t.idref,this.linear=t.linear==="yes",this.properties=t.properties,this.index=t.index,this.href=t.href,this.url=t.url,this.canonical=t.canonical,this.next=t.next,this.prev=t.prev,this.cfiBase=t.cfiBase,e?this.hooks=e:(this.hooks={},this.hooks.serialize=new Xn(this),this.hooks.content=new Xn(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(t){var e=t||this.request||Zo,i=new Ce,s=i.promise;return this.contents?i.resolve(this.contents):e(this.url).then((function(a){return this.document=a,this.contents=a.documentElement,this.hooks.content.trigger(this.document,this)}).bind(this)).then((function(){i.resolve(this.contents)}).bind(this)).catch(function(a){i.reject(a)}),s}base(){return ob(this.document,this)}render(t){var e=new Ce,i=e.promise;return this.output,this.load(t).then((function(s){var a=typeof navigator<"u"&&navigator.userAgent||"",o=a.indexOf("Trident")>=0,u;typeof XMLSerializer>"u"||o?u=Zy.DOMParser:u=XMLSerializer;var h=new u;return this.output=h.serializeToString(s),this.output}).bind(this)).then((function(){return this.hooks.serialize.trigger(this.output,this)}).bind(this)).then((function(){e.resolve(this.output)}).bind(this)).catch(function(s){e.reject(s)}),i}find(t){var e=this,i=[],s=t.toLowerCase(),a=function(o){for(var u=o.textContent.toLowerCase(),h=e.document.createRange(),d,f,p=-1,v,A=150;f!=-1;)f=u.indexOf(s,p+1),f!=-1&&(h=e.document.createRange(),h.setStart(o,f),h.setEnd(o,f+s.length),d=e.cfiFromRange(h),o.textContent.length<A?v=o.textContent:(v=o.textContent.substring(f-A/2,f+A/2),v="..."+v+"..."),i.push({cfi:d,excerpt:v})),p=f};return zu(e.document,function(o){a(o)}),i}search(t,e=5){if(typeof document.createTreeWalker>"u")return this.find(t);let i=[];const s=150,a=this,o=t.toLowerCase(),u=function(p){const C=p.reduce((w,b)=>w+b.textContent,"").toLowerCase().indexOf(o);if(C!=-1){const b=C+o.length;let _=0,x=0;if(C<p[0].length){let D;for(;_<p.length-1&&(x+=p[_].length,!(b<=x));)_+=1;let M=p[0],T=p[_],O=a.document.createRange();O.setStart(M,C);let k=p.slice(0,_).reduce((B,H)=>B+H.textContent.length,0);O.setEnd(T,k>b?b:b-k),D=a.cfiFromRange(O);let z=p.slice(0,_+1).reduce((B,H)=>B+H.textContent,"");z.length>s&&(z=z.substring(C-s/2,C+s/2),z="..."+z+"..."),i.push({cfi:D,excerpt:z})}}},h=document.createTreeWalker(a.document,NodeFilter.SHOW_TEXT,null,!1);let d,f=[];for(;d=h.nextNode();)f.push(d),f.length==e&&(u(f.slice(0,e)),f=f.slice(1,e));return f.length>0&&u(f),i}reconcileLayoutSettings(t){var e={layout:t.layout,spread:t.spread,orientation:t.orientation};return this.properties.forEach(function(i){var s=i.replace("rendition:",""),a=s.indexOf("-"),o,u;a!=-1&&(o=s.slice(0,a),u=s.slice(a+1),e[o]=u)}),e}cfiFromRange(t){return new Te(t,this.cfiBase).toString()}cfiFromElement(t){return new Te(t,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}class bw{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new Xn,this.hooks.content=new Xn,this.hooks.content.register(ob),this.hooks.content.register(gw),this.hooks.content.register(mw),this.epubcfi=new Te,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(t,e,i){this.items=t.spine,this.manifest=t.manifest,this.spineNodeIndex=t.spineNodeIndex,this.baseUrl=t.baseUrl||t.basePath||"",this.length=this.items.length,this.items.forEach((s,a)=>{var o=this.manifest[s.idref],u;s.index=a,s.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,s.index,s.id),s.href&&(s.url=e(s.href,!0),s.canonical=i(s.href)),o&&(s.href=o.href,s.url=e(s.href,!0),s.canonical=i(s.href),o.properties.length&&s.properties.push.apply(s.properties,o.properties)),s.linear==="yes"?(s.prev=(function(){let h=s.index;for(;h>0;){let d=this.get(h-1);if(d&&d.linear)return d;h-=1}}).bind(this),s.next=(function(){let h=s.index;for(;h<this.spineItems.length-1;){let d=this.get(h+1);if(d&&d.linear)return d;h+=1}}).bind(this)):(s.prev=function(){},s.next=function(){}),u=new yw(s,this.hooks),this.append(u)}),this.loaded=!0}get(t){var e=0;if(typeof t>"u")for(;e<this.spineItems.length;){let i=this.spineItems[e];if(i&&i.linear)break;e+=1}else this.epubcfi.isCfiString(t)?e=new Te(t).spinePos:typeof t=="number"||isNaN(t)===!1?e=t:typeof t=="string"&&t.indexOf("#")===0?e=this.spineById[t.substring(1)]:typeof t=="string"&&(t=t.split("#")[0],e=this.spineByHref[t]||this.spineByHref[encodeURI(t)]);return this.spineItems[e]||null}append(t){var e=this.spineItems.length;return t.index=e,this.spineItems.push(t),this.spineByHref[decodeURI(t.href)]=e,this.spineByHref[encodeURI(t.href)]=e,this.spineByHref[t.href]=e,this.spineById[t.idref]=e,e}prepend(t){return this.spineByHref[t.href]=0,this.spineById[t.idref]=0,this.spineItems.forEach(function(e,i){e.index=i}),0}remove(t){var e=this.spineItems.indexOf(t);if(e>-1)return delete this.spineByHref[t.href],delete this.spineById[t.idref],this.spineItems.splice(e,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let t=0;do{let e=this.get(t);if(e&&e.linear)return e;t+=1}while(t<this.spineItems.length)}last(){let t=this.spineItems.length-1;do{let e=this.get(t);if(e&&e.linear)return e;t-=1}while(t>=0)}destroy(){this.each(t=>t.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}class Xf{constructor(t){this._q=[],this.context=t,this.tick=qf,this.running=!1,this.paused=!1}enqueue(){var t,e,i,s=[].shift.call(arguments),a=arguments;if(!s)throw new Error("No Task Provided");return typeof s=="function"?(t=new Ce,e=t.promise,i={task:s,args:a,deferred:t,promise:e}):i={promise:s},this._q.push(i),this.paused==!1&&!this.running&&this.run(),i.promise}dequeue(){var t,e,i;if(this._q.length&&!this.paused){if(t=this._q.shift(),e=t.task,e)return i=e.apply(this.context,t.args),i&&typeof i.then=="function"?i.then((function(){t.deferred.resolve.apply(this.context,arguments)}).bind(this),(function(){t.deferred.reject.apply(this.context,arguments)}).bind(this)):(t.deferred.resolve.apply(this.context,i),t.promise);if(t.promise)return t.promise}else return t=new Ce,t.deferred.resolve(),t.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new Ce),this.tick.call(window,()=>{this._q.length?this.dequeue().then((function(){this.run()}).bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==!0&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then((function(){return this.running=void 0,this.flush()}).bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}}const $u="0.3",Ru=["keydown","keyup","keypressed","mouseup","mousedown","mousemove","click","touchend","touchstart","touchmove"],Bt={BOOK:{OPEN_FAILED:"openFailed"},CONTENTS:{EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},LOCATIONS:{CHANGED:"changed"},MANAGERS:{RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},VIEWS:{AXIS:"axis",WRITING_MODE:"writingMode",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},RENDITION:{STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},LAYOUT:{UPDATED:"updated"},ANNOTATION:{ATTACH:"attach",DETACH:"detach"}};class lb{constructor(t,e,i){this.spine=t,this.request=e,this.pause=i||100,this.q=new Xf(this),this.epubcfi=new Te,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}generate(t){return t&&(this.break=t),this.q.pause(),this.spine.each((function(e){e.linear&&this.q.enqueue(this.process.bind(this),e)}).bind(this)),this.q.run().then((function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}).bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(t){return t.load(this.request).then((function(e){var i=new Ce,s=this.parse(e,t.cfiBase);return this._locations=this._locations.concat(s),t.unload(),this.processingTimeout=setTimeout(()=>i.resolve(s),this.pause),i.promise}).bind(this))}parse(t,e,i){var s=[],a,o=t.ownerDocument,u=Ye(o,"body"),h=0,d,f=i||this.break,p=function(v){var A=v.length,C,w=0;if(v.textContent.trim().length===0)return!1;for(h==0&&(a=this.createRange(),a.startContainer=v,a.startOffset=0),C=f-h,C>A&&(h+=A,w=A);w<A;)if(C=f-h,h===0&&(w+=1,a=this.createRange(),a.startContainer=v,a.startOffset=w),w+C>=A)h+=A-w,w=A;else{w+=C,a.endContainer=v,a.endOffset=w;let b=new Te(a,e).toString();s.push(b),h=0}d=v};if(zu(u,p.bind(this)),a&&a.startContainer&&d){a.endContainer=d,a.endOffset=d.length;let v=new Te(a,e).toString();s.push(v),h=0}return s}generateFromWords(t,e,i){var s=t?new Te(t):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each((function(a){a.linear&&(s?a.index>=s.spinePos&&this.q.enqueue(this.processWords.bind(this),a,e,s,i):this.q.enqueue(this.processWords.bind(this),a,e,s,i))}).bind(this)),this.q.run().then((function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}).bind(this))}processWords(t,e,i,s){return s&&this._locationsWords.length>=s?Promise.resolve():t.load(this.request).then((function(a){var o=new Ce,u=this.parseWords(a,t,e,i),h=s-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(u.length>=s?u.slice(0,h):u),t.unload(),this.processingTimeout=setTimeout(()=>o.resolve(u),this.pause),o.promise}).bind(this))}countWords(t){return t=t.replace(/(^\s*)|(\s*$)/gi,""),t=t.replace(/[ ]{2,}/gi," "),t=t.replace(/\n /,`
`),t.split(" ").length}parseWords(t,e,i,s){var a=e.cfiBase,o=[],u=t.ownerDocument,h=Ye(u,"body"),d=i,f=s?s.spinePos!==e.index:!0,p;s&&e.index===s.spinePos&&(p=s.findNode(s.range?s.path.steps.concat(s.start.steps):s.path.steps,t.ownerDocument));var v=function(A){if(!f)if(A===p)f=!0;else return!1;if(A.textContent.length<10&&A.textContent.trim().length===0)return!1;var C=this.countWords(A.textContent),w,b=0;if(C===0)return!1;for(w=d-this._wordCounter,w>C&&(this._wordCounter+=C,b=C);b<C;)if(w=d-this._wordCounter,b+w>=C)this._wordCounter+=C-b,b=C;else{b+=w;let _=new Te(A,a);o.push({cfi:_.toString(),wordCount:this._wordCounter}),this._wordCounter=0}};return zu(h,v.bind(this)),o}locationFromCfi(t){let e;return Te.prototype.isCfiString(t)&&(t=new Te(t)),this._locations.length===0?-1:(e=Fa(t,this._locations,this.epubcfi.compare),e>this.total?this.total:e)}percentageFromCfi(t){if(this._locations.length===0)return null;var e=this.locationFromCfi(t);return this.percentageFromLocation(e)}percentageFromLocation(t){return!t||!this.total?0:t/this.total}cfiFromLocation(t){var e=-1;return typeof t!="number"&&(t=parseInt(t)),t>=0&&t<this._locations.length&&(e=this._locations[t]),e}cfiFromPercentage(t){let e;if(t>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),t>=1){let i=new Te(this._locations[this.total]);return i.collapse(),i.toString()}return e=Math.ceil(this.total*t),this.cfiFromLocation(e)}load(t){return typeof t=="string"?this._locations=JSON.parse(t):this._locations=t,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(t){var e;if(typeof t=="string")this._currentCfi=t;else if(typeof t=="number")this._current=t;else return;this._locations.length!==0&&(typeof t=="string"?(e=this.locationFromCfi(t),this._current=e):e=t,this.emit(Bt.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(e)}))}get currentLocation(){return this._current}set currentLocation(t){this.setCurrent(t)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}os(lb.prototype);class Aw{constructor(t){this.packagePath="",this.directory="",this.encoding="",t&&this.parse(t)}parse(t){var e;if(!t)throw new Error("Container File Not Found");if(e=Ye(t,"rootfile"),!e)throw new Error("No RootFile Found");this.packagePath=e.getAttribute("full-path"),this.directory=rr.dirname(this.packagePath),this.encoding=t.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}class q0{constructor(t){this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},t&&this.parse(t)}parse(t){var e,i,s;if(!t)throw new Error("Package File Not Found");if(e=Ye(t,"metadata"),!e)throw new Error("No Metadata Found");if(i=Ye(t,"manifest"),!i)throw new Error("No Manifest Found");if(s=Ye(t,"spine"),!s)throw new Error("No Spine Found");return this.manifest=this.parseManifest(i),this.navPath=this.findNavPath(i),this.ncxPath=this.findNcxPath(i,s),this.coverPath=this.findCoverPath(t),this.spineNodeIndex=tb(s),this.spine=this.parseSpine(s,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(t),this.metadata=this.parseMetadata(e),this.metadata.direction=s.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(t){var e={};return e.title=this.getElementText(t,"title"),e.creator=this.getElementText(t,"creator"),e.description=this.getElementText(t,"description"),e.pubdate=this.getElementText(t,"date"),e.publisher=this.getElementText(t,"publisher"),e.identifier=this.getElementText(t,"identifier"),e.language=this.getElementText(t,"language"),e.rights=this.getElementText(t,"rights"),e.modified_date=this.getPropertyText(t,"dcterms:modified"),e.layout=this.getPropertyText(t,"rendition:layout"),e.orientation=this.getPropertyText(t,"rendition:orientation"),e.flow=this.getPropertyText(t,"rendition:flow"),e.viewport=this.getPropertyText(t,"rendition:viewport"),e.media_active_class=this.getPropertyText(t,"media:active-class"),e.spread=this.getPropertyText(t,"rendition:spread"),e}parseManifest(t){var e={},i=Rs(t,"item"),s=Array.prototype.slice.call(i);return s.forEach(function(a){var o=a.getAttribute("id"),u=a.getAttribute("href")||"",h=a.getAttribute("media-type")||"",d=a.getAttribute("media-overlay")||"",f=a.getAttribute("properties")||"";e[o]={href:u,type:h,overlay:d,properties:f.length?f.split(" "):[]}}),e}parseSpine(t,e){var i=[],s=Rs(t,"itemref"),a=Array.prototype.slice.call(s);return a.forEach(function(o,u){var h=o.getAttribute("idref"),d=o.getAttribute("properties")||"",f=d.length?d.split(" "):[],p={id:o.getAttribute("id"),idref:h,linear:o.getAttribute("linear")||"yes",properties:f,index:u};i.push(p)}),i}findUniqueIdentifier(t){var e=t.documentElement.getAttribute("unique-identifier");if(!e)return"";var i=t.getElementById(e);return i&&i.localName==="identifier"&&i.namespaceURI==="http://purl.org/dc/elements/1.1/"&&i.childNodes.length>0?i.childNodes[0].nodeValue.trim():""}findNavPath(t){var e=Ca(t,"item",{properties:"nav"});return e?e.getAttribute("href"):!1}findNcxPath(t,e){var i=Ca(t,"item",{"media-type":"application/x-dtbncx+xml"}),s;return i||(s=e.getAttribute("toc"),s&&(i=t.querySelector(`#${s}`))),i?i.getAttribute("href"):!1}findCoverPath(t){var e=Ye(t,"package");e.getAttribute("version");var i=Ca(t,"item",{properties:"cover-image"});if(i)return i.getAttribute("href");var s=Ca(t,"meta",{name:"cover"});if(s){var a=s.getAttribute("content"),o=t.getElementById(a);return o?o.getAttribute("href"):""}else return!1}getElementText(t,e){var i=t.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",e),s;return!i||i.length===0?"":(s=i[0],s.childNodes.length?s.childNodes[0].nodeValue:"")}getPropertyText(t,e){var i=Ca(t,"meta",{property:e});return i&&i.childNodes.length?i.childNodes[0].nodeValue:""}load(t){this.metadata=t.metadata;let e=t.readingOrder||t.spine;return this.spine=e.map((i,s)=>(i.index=s,i.linear=i.linear||"yes",i)),t.resources.forEach((i,s)=>{this.manifest[s]=i,i.rel&&i.rel[0]==="cover"&&(this.coverPath=i.href)}),this.spineNodeIndex=0,this.toc=t.toc.map((i,s)=>(i.label=i.title,i)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}class Ud{constructor(t){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,t&&this.parse(t)}parse(t){let e=t.nodeType,i,s;e&&(i=Ye(t,"html"),s=Ye(t,"ncx")),e?i?(this.toc=this.parseNav(t),this.landmarks=this.parseLandmarks(t)):s&&(this.toc=this.parseNcx(t)):this.toc=this.load(t),this.length=0,this.unpack(this.toc)}unpack(t){for(var e,i=0;i<t.length;i++)e=t[i],e.href&&(this.tocByHref[e.href]=i),e.id&&(this.tocById[e.id]=i),this.length++,e.subitems.length&&this.unpack(e.subitems)}get(t){var e;return t?(t.indexOf("#")===0?e=this.tocById[t.substring(1)]:t in this.tocByHref&&(e=this.tocByHref[t]),this.getByIndex(t,e,this.toc)):this.toc}getByIndex(t,e,i){if(i.length===0)return;const s=i[e];if(s&&(t===s.id||t===s.href))return s;{let a;for(let o=0;o<i.length&&(a=this.getByIndex(t,e,i[o].subitems),!a);++o);return a}}landmark(t){var e;return t?(e=this.landmarksByType[t],this.landmarks[e]):this.landmarks}parseNav(t){var e=Fu(t,"nav","toc"),i=[];if(!e)return i;let s=Ta(e,"ol",!0);return s&&(i=this.parseNavList(s)),i}parseNavList(t,e){const i=[];if(!t||!t.children)return i;for(let s=0;s<t.children.length;s++){const a=this.navItem(t.children[s],e);a&&i.push(a)}return i}navItem(t,e){let i=t.getAttribute("id")||void 0,s=Ta(t,"a",!0)||Ta(t,"span",!0);if(!s)return;let a=s.getAttribute("href")||"";i||(i=a);let o=s.textContent||"",u=[],h=Ta(t,"ol",!0);return h&&(u=this.parseNavList(h,i)),{id:i,href:a,label:o,subitems:u,parent:e}}parseLandmarks(t){var e=Fu(t,"nav","landmarks"),i=e?Rs(e,"li"):[],s=i.length,a,o=[],u;if(!i||s===0)return o;for(a=0;a<s;++a)u=this.landmarkItem(i[a]),u&&(o.push(u),this.landmarksByType[u.type]=a);return o}landmarkItem(t){let e=Ta(t,"a",!0);if(!e)return;let i=e.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0,s=e.getAttribute("href")||"",a=e.textContent||"";return{href:s,label:a,type:i}}parseNcx(t){var e=Rs(t,"navPoint"),i=e.length,s,a={},o=[],u,h;if(!e||i===0)return o;for(s=0;s<i;++s)u=this.ncxItem(e[s]),a[u.id]=u,u.parent?(h=a[u.parent],h.subitems.push(u)):o.push(u);return o}ncxItem(t){var e=t.getAttribute("id")||!1,i=Ye(t,"content"),s=i.getAttribute("src"),a=Ye(t,"navLabel"),o=a.textContent?a.textContent:"",u=[],h=t.parentNode,d;return h&&(h.nodeName==="navPoint"||h.nodeName.split(":").slice(-1)[0]==="navPoint")&&(d=h.getAttribute("id")),{id:e,href:s,label:o,subitems:u,parent:d}}load(t){return t.map(e=>(e.label=e.title,e.subitems=e.children?this.load(e.children):[],e))}forEach(t){return this.toc.forEach(t)}}var zo={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},_w=(function(){var g,t,e,i,s={};for(g in zo)if(zo.hasOwnProperty(g)){for(t in zo[g])if(zo[g].hasOwnProperty(t))if(e=zo[g][t],typeof e=="string")s[e]=g+"/"+t;else for(i=0;i<e.length;i++)s[e[i]]=g+"/"+t}return s})(),ww="text/plain";function Ew(g){return g&&_w[g.split(".").pop().toLowerCase()]||ww}const Ba={lookup:Ew};class Sw{constructor(t,e){this.settings={replacements:e&&e.replacements||"base64",archive:e&&e.archive,resolver:e&&e.resolver,request:e&&e.request},this.process(t)}process(t){this.manifest=t,this.resources=Object.keys(t).map(function(e){return t[e]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(t){if(t.type==="application/xhtml+xml"||t.type==="text/html")return!0}),this.assets=this.resources.filter(function(t){if(t.type!=="application/xhtml+xml"&&t.type!=="text/html")return!0}),this.css=this.resources.filter(function(t){if(t.type==="text/css")return!0})}splitUrls(){this.urls=this.assets.map((function(t){return t.href}).bind(this)),this.cssUrls=this.css.map(function(t){return t.href})}createUrl(t){var e=new Gn(t),i=Ba.lookup(e.filename);return this.settings.archive?this.settings.archive.createUrl(t,{base64:this.settings.replacements==="base64"}):this.settings.replacements==="base64"?this.settings.request(t,"blob").then(s=>rb(s)).then(s=>wf(s,i)):this.settings.request(t,"blob").then(s=>Iu(s,i))}replacements(){if(this.settings.replacements==="none")return new Promise((function(e){e(this.urls)}).bind(this));var t=this.urls.map(e=>{var i=this.settings.resolver(e);return this.createUrl(i).catch(s=>(console.error(s),null))});return Promise.all(t).then(e=>(this.replacementUrls=e.filter(i=>typeof i=="string"),e))}replaceCss(t,e){var i=[];return t=t||this.settings.archive,e=e||this.settings.resolver,this.cssUrls.forEach((function(s){var a=this.createCssFile(s,t,e).then((function(o){var u=this.urls.indexOf(s);u>-1&&(this.replacementUrls[u]=o)}).bind(this));i.push(a)}).bind(this)),Promise.all(i)}createCssFile(t){var e;if(rr.isAbsolute(t))return new Promise(function(o){o()});var i=this.settings.resolver(t),s;this.settings.archive?s=this.settings.archive.getText(i):s=this.settings.request(i,"text");var a=this.urls.map(o=>{var u=this.settings.resolver(o),h=new Ns(i).relative(u);return h});return s?s.then(o=>(o=j0(o,a,this.replacementUrls),this.settings.replacements==="base64"?e=wf(o,"text/css"):e=Iu(o,"text/css"),e),o=>new Promise(function(u){u()})):new Promise(function(o){o()})}relativeTo(t,e){return e=e||this.settings.resolver,this.urls.map((function(i){var s=e(i),a=new Ns(t).relative(s);return a}).bind(this))}get(t){var e=this.urls.indexOf(t);if(e!==-1)return this.replacementUrls.length?new Promise((function(i,s){i(this.replacementUrls[e])}).bind(this)):this.createUrl(t)}substitute(t,e){var i;return e?i=this.relativeTo(e):i=this.urls,j0(t,i,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}class Hd{constructor(t){this.pages=[],this.locations=[],this.epubcfi=new Te,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,t&&(this.pageList=this.parse(t)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(t){var e=Ye(t,"html"),i=Ye(t,"ncx");if(e)return this.parseNav(t);if(i)return this.parseNcx(t)}parseNav(t){var e=Fu(t,"nav","page-list"),i=e?Rs(e,"li"):[],s=i.length,a,o=[],u;if(!i||s===0)return o;for(a=0;a<s;++a)u=this.item(i[a]),o.push(u);return o}parseNcx(t){var e=[],i=0,s,a,o,u=0;if(a=Ye(t,"pageList"),!a||(o=Rs(a,"pageTarget"),u=o.length,!o||o.length===0))return e;for(i=0;i<u;++i)s=this.ncxItem(o[i]),e.push(s);return e}ncxItem(t){var e=Ye(t,"navLabel"),i=Ye(e,"text"),s=i.textContent,a=Ye(t,"content"),o=a.getAttribute("src"),u=parseInt(s,10);return{href:o,page:u}}item(t){var e=Ye(t,"a"),i=e.getAttribute("href")||"",s=e.textContent||"",a=parseInt(s),o=i.indexOf("epubcfi"),u,h,d;return o!=-1?(u=i.split("#"),h=u[0],d=u.length>1?u[1]:!1,{cfi:d,href:i,packageUrl:h,page:a}):{href:i,page:a}}process(t){t.forEach(function(e){this.pages.push(e.page),e.cfi&&this.locations.push(e.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(t){var e=-1;if(this.locations.length===0)return-1;var i=Mu(t,this.locations,this.epubcfi.compare);return i!=-1?e=this.pages[i]:(i=Fa(t,this.locations,this.epubcfi.compare),e=i-1>=0?this.pages[i-1]:this.pages[0],e!==void 0||(e=-1)),e}cfiFromPage(t){var e=-1;typeof t!="number"&&(t=parseInt(t));var i=this.pages.indexOf(t);return i!=-1&&(e=this.locations[i]),e}pageFromPercentage(t){var e=Math.round(this.totalPages*t);return e}percentageFromPage(t){var e=(t-this.firstPage)/this.totalPages;return Math.round(e*1e3)/1e3}percentageFromCfi(t){var e=this.pageFromCfi(t),i=this.percentageFromPage(e);return i}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}class ub{constructor(t){this.settings=t,this.name=t.layout||"reflowable",this._spread=t.spread!=="none",this._minSpreadWidth=t.minSpreadWidth||800,this._evenSpreads=t.evenSpreads||!1,t.flow==="scrolled"||t.flow==="scrolled-continuous"||t.flow==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(t){return typeof t<"u"&&(t==="scrolled"||t==="scrolled-continuous"||t==="scrolled-doc"?this._flow="scrolled":this._flow="paginated",this.update({flow:this._flow})),this._flow}spread(t,e){return t&&(this._spread=t!=="none",this.update({spread:this._spread})),e>=0&&(this._minSpreadWidth=e),this._spread}calculate(t,e,i){var s=1,a=i||0,o=t,u=e,h=Math.floor(o/12),d,f,p,v;this._spread&&o>=this._minSpreadWidth?s=2:s=1,this.name==="reflowable"&&this._flow==="paginated"&&!(i>=0)&&(a=h%2===0?h:h-1),this.name==="pre-paginated"&&(a=0),s>1?(d=o/s-a,p=d+a):(d=o,p=o),this.name==="pre-paginated"&&s>1&&(o=d),f=d*s+a,v=o,this.width=o,this.height=u,this.spreadWidth=f,this.pageWidth=p,this.delta=v,this.columnWidth=d,this.gap=a,this.divisor=s,this.update({width:o,height:u,spreadWidth:f,pageWidth:p,delta:v,columnWidth:d,gap:a,divisor:s})}format(t,e,i){var s;return this.name==="pre-paginated"?s=t.fit(this.columnWidth,this.height,e):this._flow==="paginated"?s=t.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):i&&i==="horizontal"?s=t.size(null,this.height):s=t.size(this.width,null),s}count(t,e){let i,s;return this.name==="pre-paginated"?(i=1,s=1):this._flow==="paginated"?(e=e||this.delta,i=Math.ceil(t/e),s=i*this.divisor):(e=e||this.height,i=Math.ceil(t/e),s=i),{spreads:i,pages:s}}update(t){if(Object.keys(t).forEach(e=>{this.props[e]===t[e]&&delete t[e]}),Object.keys(t).length>0){let e=Hi(this.props,t);this.emit(Bt.LAYOUT.UPDATED,e,t)}}}os(ub.prototype);class xw{constructor(t){this.rendition=t,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]=="object")return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]=="string")return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]=="string")return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]=="object")return this.registerRules(arguments[0],arguments[1])}}default(t){if(t){if(typeof t=="string")return this.registerUrl("default",t);if(typeof t=="object")return this.registerRules("default",t)}}registerThemes(t){for(var e in t)t.hasOwnProperty(e)&&(typeof t[e]=="string"?this.registerUrl(e,t[e]):this.registerRules(e,t[e]))}registerCss(t,e){this._themes[t]={serialized:e},(this._injected[t]||t=="default")&&this.update(t)}registerUrl(t,e){var i=new Gn(e);this._themes[t]={url:i.toString()},(this._injected[t]||t=="default")&&this.update(t)}registerRules(t,e){this._themes[t]={rules:e},(this._injected[t]||t=="default")&&this.update(t)}select(t){var e=this._current,i;this._current=t,this.update(t),i=this.rendition.getContents(),i.forEach(s=>{s.removeClass(e),s.addClass(t)})}update(t){var e=this.rendition.getContents();e.forEach(i=>{this.add(t,i)})}inject(t){var e=[],i=this._themes,s;for(var a in i)i.hasOwnProperty(a)&&(a===this._current||a==="default")&&(s=i[a],(s.rules&&Object.keys(s.rules).length>0||s.url&&e.indexOf(s.url)===-1)&&this.add(a,t),this._injected.push(a));this._current!="default"&&t.addClass(this._current)}add(t,e){var i=this._themes[t];!i||!e||(i.url?e.addStylesheet(i.url):i.serialized?(e.addStylesheetCss(i.serialized,t),i.injected=!0):i.rules&&(e.addStylesheetRules(i.rules,t),i.injected=!0))}override(t,e,i){var s=this.rendition.getContents();this._overrides[t]={value:e,priority:i===!0},s.forEach(a=>{a.css(t,this._overrides[t].value,this._overrides[t].priority)})}removeOverride(t){var e=this.rendition.getContents();delete this._overrides[t],e.forEach(i=>{i.css(t)})}overrides(t){var e=this._overrides;for(var i in e)e.hasOwnProperty(i)&&t.css(i,e[i].value,e[i].priority)}fontSize(t){this.override("font-size",t)}font(t){this.override("font-family",t,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}class Pu{constructor(t,e,i,s=!1){this.layout=t,this.horizontal=i==="horizontal",this.direction=e||"ltr",this._dev=s}section(t){var e=this.findRanges(t),i=this.rangeListToCfiList(t.section.cfiBase,e);return i}page(t,e,i,s){var a=t&&t.document?t.document.body:!1,o;if(a){if(o=this.rangePairToCfiPair(e,{start:this.findStart(a,i,s),end:this.findEnd(a,i,s)}),this._dev===!0){let u=t.document,h=new Te(o.start).toRange(u),d=new Te(o.end).toRange(u),f=u.defaultView.getSelection(),p=u.createRange();f.removeAllRanges(),p.setStart(h.startContainer,h.startOffset),p.setEnd(d.endContainer,d.endOffset),f.addRange(p)}return o}}walk(t,e){if(!(t&&t.nodeType===Node.TEXT_NODE)){var i={acceptNode:function(h){return h.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},s=i.acceptNode;s.acceptNode=i.acceptNode;for(var a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,s,!1),o,u;(o=a.nextNode())&&(u=e(o),!u););return u}}findRanges(t){for(var e=[],i=t.contents.scrollWidth(),s=Math.ceil(i/this.layout.spreadWidth),a=s*this.layout.divisor,o=this.layout.columnWidth,u=this.layout.gap,h,d,f=0;f<a.pages;f++)h=(o+u)*f,d=o*(f+1)+u*f,e.push({start:this.findStart(t.document.body,h,d),end:this.findEnd(t.document.body,h,d)});return e}findStart(t,e,i){for(var s=[t],a,o,u=t;s.length;)if(a=s.shift(),o=this.walk(a,h=>{var d,f,p,v,A;if(A=_f(h),this.horizontal&&this.direction==="ltr"){if(d=this.horizontal?A.left:A.top,f=this.horizontal?A.right:A.bottom,d>=e&&d<=i)return h;if(f>e)return h;u=h,s.push(h)}else if(this.horizontal&&this.direction==="rtl"){if(d=A.left,f=A.right,f<=i&&f>=e)return h;if(d<i)return h;u=h,s.push(h)}else{if(p=A.top,v=A.bottom,p>=e&&p<=i)return h;if(v>e)return h;u=h,s.push(h)}}),o)return this.findTextStartRange(o,e,i);return this.findTextStartRange(u,e,i)}findEnd(t,e,i){for(var s=[t],a,o=t,u;s.length;)if(a=s.shift(),u=this.walk(a,h=>{var d,f,p,v,A;if(A=_f(h),this.horizontal&&this.direction==="ltr"){if(d=Math.round(A.left),f=Math.round(A.right),d>i&&o)return o;if(f>i)return h;o=h,s.push(h)}else if(this.horizontal&&this.direction==="rtl"){if(d=Math.round(this.horizontal?A.left:A.top),f=Math.round(this.horizontal?A.right:A.bottom),f<e&&o)return o;if(d<e)return h;o=h,s.push(h)}else{if(p=Math.round(A.top),v=Math.round(A.bottom),p>i&&o)return o;if(v>i)return h;o=h,s.push(h)}}),u)return this.findTextEndRange(u,e,i);return this.findTextEndRange(o,e,i)}findTextStartRange(t,e,i){for(var s=this.splitTextNodeIntoRanges(t),a,o,u,h,d,f=0;f<s.length;f++)if(a=s[f],o=a.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(u=o.left,u>=e)return a}else if(this.horizontal&&this.direction==="rtl"){if(d=o.right,d<=i)return a}else if(h=o.top,h>=e)return a;return s[0]}findTextEndRange(t,e,i){for(var s=this.splitTextNodeIntoRanges(t),a,o,u,h,d,f,p,v=0;v<s.length;v++){if(o=s[v],u=o.getBoundingClientRect(),this.horizontal&&this.direction==="ltr"){if(h=u.left,d=u.right,h>i&&a)return a;if(d>i)return o}else if(this.horizontal&&this.direction==="rtl"){if(h=u.left,d=u.right,d<e&&a)return a;if(h<e)return o}else{if(f=u.top,p=u.bottom,f>i&&a)return a;if(p>i)return o}a=o}return s[s.length-1]}splitTextNodeIntoRanges(t,e){var i=[],s=t.textContent||"",a=s.trim(),o,u=t.ownerDocument,h=e||" ",d=a.indexOf(h);if(d===-1||t.nodeType!=Node.TEXT_NODE)return o=u.createRange(),o.selectNodeContents(t),[o];for(o=u.createRange(),o.setStart(t,0),o.setEnd(t,d),i.push(o),o=!1;d!=-1;)d=a.indexOf(h,d+1),d>0&&(o&&(o.setEnd(t,d),i.push(o)),o=u.createRange(),o.setStart(t,d+1));return o&&(o.setEnd(t,a.length),i.push(o)),i}rangePairToCfiPair(t,e){var i=e.start,s=e.end;i.collapse(!0),s.collapse(!1);let a=new Te(i,t).toString(),o=new Te(s,t).toString();return{start:a,end:o}}rangeListToCfiList(t,e){for(var i=[],s,a=0;a<e.length;a++)s=this.rangePairToCfiPair(t,e[a]),i.push(s);return i}axis(t){return t&&(this.horizontal=t==="horizontal"),this.horizontal}}const hb=typeof navigator<"u",Cw=hb&&/Chrome/.test(navigator.userAgent),G0=hb&&!Cw&&/AppleWebKit/.test(navigator.userAgent),Tw=1;class Yf{constructor(t,e,i,s){this.epubcfi=new Te,this.document=t,this.documentElement=this.document.documentElement,this.content=e||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=s||0,this.cfiBase=i||"",this.epubReadingSystem("epub.js",$u),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return Ru}width(t){var e=this.content;return t&&di(t)&&(t=t+"px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}height(t){var e=this.content;return t&&di(t)&&(t=t+"px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}contentWidth(t){var e=this.content||this.document.body;return t&&di(t)&&(t=t+"px"),t&&(e.style.width=t),parseInt(this.window.getComputedStyle(e).width)}contentHeight(t){var e=this.content||this.document.body;return t&&di(t)&&(t=t+"px"),t&&(e.style.height=t),parseInt(this.window.getComputedStyle(e).height)}textWidth(){let t,e,i=this.document.createRange(),s=this.content||this.document.body,a=Lu(s);return i.selectNodeContents(s),t=i.getBoundingClientRect(),e=t.width,a&&a.width&&(e+=a.width),Math.round(e)}textHeight(){let t,e,i=this.document.createRange(),s=this.content||this.document.body;return i.selectNodeContents(s),t=i.getBoundingClientRect(),e=t.bottom,Math.round(e)}scrollWidth(){var t=this.documentElement.scrollWidth;return t}scrollHeight(){var t=this.documentElement.scrollHeight;return t}overflow(t){return t&&(this.documentElement.style.overflow=t),this.window.getComputedStyle(this.documentElement).overflow}overflowX(t){return t&&(this.documentElement.style.overflowX=t),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(t){return t&&(this.documentElement.style.overflowY=t),this.window.getComputedStyle(this.documentElement).overflowY}css(t,e,i){var s=this.content||this.document.body;return e?s.style.setProperty(t,e,i?"important":""):s.style.removeProperty(t),this.window.getComputedStyle(s)[t]}viewport(t){var e=this.document.querySelector("meta[name='viewport']"),i={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},s=[],a={};if(e&&e.hasAttribute("content")){let o=e.getAttribute("content"),u=o.match(/width\s*=\s*([^,]*)/),h=o.match(/height\s*=\s*([^,]*)/),d=o.match(/initial-scale\s*=\s*([^,]*)/),f=o.match(/minimum-scale\s*=\s*([^,]*)/),p=o.match(/maximum-scale\s*=\s*([^,]*)/),v=o.match(/user-scalable\s*=\s*([^,]*)/);u&&u.length&&typeof u[1]<"u"&&(i.width=u[1]),h&&h.length&&typeof h[1]<"u"&&(i.height=h[1]),d&&d.length&&typeof d[1]<"u"&&(i.scale=d[1]),f&&f.length&&typeof f[1]<"u"&&(i.minimum=f[1]),p&&p.length&&typeof p[1]<"u"&&(i.maximum=p[1]),v&&v.length&&typeof v[1]<"u"&&(i.scalable=v[1])}return a=Jy(t||{},i),t&&(a.width&&s.push("width="+a.width),a.height&&s.push("height="+a.height),a.scale&&s.push("initial-scale="+a.scale),a.scalable==="no"?(s.push("minimum-scale="+a.scale),s.push("maximum-scale="+a.scale),s.push("user-scalable="+a.scalable)):(a.scalable&&s.push("user-scalable="+a.scalable),a.minimum&&s.push("minimum-scale="+a.minimum),a.maximum&&s.push("minimum-scale="+a.maximum)),e||(e=this.document.createElement("meta"),e.setAttribute("name","viewport"),this.document.querySelector("head").appendChild(e)),e.setAttribute("content",s.join(", ")),this.window.scrollTo(0,0)),a}expand(){this.emit(Bt.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>"u"?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let t=this.textWidth(),e=this.textHeight();(t!=this._size.width||e!=this._size.height)&&(this._size={width:t,height:e},this.onResize&&this.onResize(this._size),this.emit(Bt.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let t=this.content;t.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",t.style.transitionDuration="0.001ms",t.style.transitionTimingFunction="linear",t.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}mediaQueryListeners(){for(var t=this.document.styleSheets,e=(function(u){u.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}).bind(this),i=0;i<t.length;i+=1){var s;try{s=t[i].cssRules}catch{return}if(!s)return;for(var a=0;a<s.length;a+=1)if(s[a].media){var o=this.window.matchMedia(s[a].media.mediaText);o.addListener(e)}}}resizeObservers(){this.observer=new ResizeObserver(t=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(e=>{this.resizeCheck()});let t={attributes:!0,childList:!0,characterData:!0,subtree:!0};this.observer.observe(this.document,t)}imageLoadListeners(){for(var t=this.document.querySelectorAll("img"),e,i=0;i<t.length;i++)e=t[i],typeof e.naturalWidth<"u"&&e.naturalWidth===0&&(e.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then((function(){this.resizeCheck()}).bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(t,e){var i,s={left:0,top:0};if(!this.document)return s;if(this.epubcfi.isCfiString(t)){let a=new Te(t).toRange(this.document,e);if(a){try{if(!a.endContainer||a.startContainer==a.endContainer&&a.startOffset==a.endOffset){let o=a.startContainer.textContent.indexOf(" ",a.startOffset);o==-1&&(o=a.startContainer.textContent.length),a.setEnd(a.startContainer,o)}}catch(o){console.error("setting end offset to start container length failed",o)}if(a.startContainer.nodeType===Node.ELEMENT_NODE)i=a.startContainer.getBoundingClientRect(),s.left=i.left,s.top=i.top;else if(G0){let o=a.startContainer,u=new Range;try{o.nodeType===Tw?i=o.getBoundingClientRect():a.startOffset+2<o.length?(u.setStart(o,a.startOffset),u.setEnd(o,a.startOffset+2),i=u.getBoundingClientRect()):a.startOffset-2>0?(u.setStart(o,a.startOffset-2),u.setEnd(o,a.startOffset),i=u.getBoundingClientRect()):i=o.parentNode.getBoundingClientRect()}catch(h){console.error(h,h.stack)}}else i=a.getBoundingClientRect()}}else if(typeof t=="string"&&t.indexOf("#")>-1){let a=t.substring(t.indexOf("#")+1),o=this.document.getElementById(a);if(o)if(G0){let u=new Range;u.selectNode(o),i=u.getBoundingClientRect()}else i=o.getBoundingClientRect()}return i&&(s.left=i.left,s.top=i.top),s}addStylesheet(t){return new Promise((function(e,i){var s,a=!1;if(!this.document){e(!1);return}if(s=this.document.querySelector("link[href='"+t+"']"),s){e(!0);return}s=this.document.createElement("link"),s.type="text/css",s.rel="stylesheet",s.href=t,s.onload=s.onreadystatechange=function(){!a&&(!this.readyState||this.readyState=="complete")&&(a=!0,setTimeout(()=>{e(!0)},1))},this.document.head.appendChild(s)}).bind(this))}_getStylesheetNode(t){var e;return t="epubjs-inserted-css-"+(t||""),this.document?(e=this.document.getElementById(t),e||(e=this.document.createElement("style"),e.id=t,this.document.head.appendChild(e)),e):!1}addStylesheetCss(t,e){if(!this.document||!t)return!1;var i;return i=this._getStylesheetNode(e),i.innerHTML=t,!0}addStylesheetRules(t,e){var i;if(!(!this.document||!t||t.length===0))if(i=this._getStylesheetNode(e).sheet,Object.prototype.toString.call(t)==="[object Array]")for(var s=0,a=t.length;s<a;s++){var o=1,u=t[s],h=t[s][0],d="";Object.prototype.toString.call(u[1][0])==="[object Array]"&&(u=u[1],o=0);for(var f=u.length;o<f;o++){var p=u[o];d+=p[0]+":"+p[1]+(p[2]?" !important":"")+`;
`}i.insertRule(h+"{"+d+"}",i.cssRules.length)}else Object.keys(t).forEach(A=>{const C=t[A];if(Array.isArray(C))C.forEach(w=>{const _=Object.keys(w).map(x=>`${x}:${w[x]}`).join(";");i.insertRule(`${A}{${_}}`,i.cssRules.length)});else{const b=Object.keys(C).map(_=>`${_}:${C[_]}`).join(";");i.insertRule(`${A}{${b}}`,i.cssRules.length)}})}addScript(t){return new Promise((function(e,i){var s,a=!1;if(!this.document){e(!1);return}s=this.document.createElement("script"),s.type="text/javascript",s.async=!0,s.src=t,s.onload=s.onreadystatechange=function(){!a&&(!this.readyState||this.readyState=="complete")&&(a=!0,setTimeout(function(){e(!0)},1))},this.document.head.appendChild(s)}).bind(this))}addClass(t){var e;this.document&&(e=this.content||this.document.body,e&&e.classList.add(t))}removeClass(t){var e;this.document&&(e=this.content||this.document.body,e&&e.classList.remove(t))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),Ru.forEach(function(t){this.document.addEventListener(t,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(Ru.forEach(function(t){this.document.removeEventListener(t,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(t){this.emit(t.type,t)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(t){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout((function(){var e=this.window.getSelection();this.triggerSelectedEvent(e)}).bind(this),250)}triggerSelectedEvent(t){var e,i;t&&t.rangeCount>0&&(e=t.getRangeAt(0),e.collapsed||(i=new Te(e,this.cfiBase).toString(),this.emit(Bt.CONTENTS.SELECTED,i),this.emit(Bt.CONTENTS.SELECTED_RANGE,e)))}range(t,e){var i=new Te(t);return i.toRange(this.document,e)}cfiFromRange(t,e){return new Te(t,this.cfiBase,e).toString()}cfiFromNode(t,e){return new Te(t,this.cfiBase,e).toString()}map(t){var e=new Pu(t);return e.section()}size(t,e){var i={scale:1,scalable:"no"};this.layoutStyle("scrolling"),t>=0&&(this.width(t),i.width=t,this.css("padding","0 "+t/12+"px")),e>=0&&(this.height(e),i.height=e),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(i)}columns(t,e,i,s,a){let o=xa("column-axis"),u=xa("column-gap"),h=xa("column-width"),d=xa("column-fill"),p=this.writingMode().indexOf("vertical")===0?"vertical":"horizontal";this.layoutStyle("paginated"),a==="rtl"&&p==="horizontal"&&this.direction(a),this.width(t),this.height(e),this.viewport({width:t,height:e,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),p==="vertical"?(this.css("padding-top",s/2+"px",!0),this.css("padding-bottom",s/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px"),this.css(o,"vertical")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",s/2+"px",!0),this.css("padding-right",s/2+"px",!0),this.css(o,"horizontal")),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(d,"auto"),this.css(u,s+"px"),this.css(h,i+"px"),this.css("-webkit-line-box-contain","block glyphs replaced")}scaler(t,e,i){var s="scale("+t+")",a="";this.css("transform-origin","top left"),(e>=0||i>=0)&&(a=" translate("+(e||0)+"px, "+(i||0)+"px )"),this.css("transform",s+a)}fit(t,e,i){var s=this.viewport(),a=parseInt(s.width),o=parseInt(s.height),u=t/a,h=e/o,d=u<h?u:h;if(this.layoutStyle("paginated"),this.width(a),this.height(o),this.overflow("hidden"),this.scaler(d,0,0),this.css("background-size",a*d+"px "+o*d+"px"),this.css("background-color","transparent"),i&&i.properties.includes("page-spread-left")){var f=t-a*d;this.css("margin-left",f+"px")}}direction(t){this.documentElement&&(this.documentElement.style.direction=t)}mapPage(t,e,i,s,a){var o=new Pu(e,a);return o.page(this,t,i,s)}linksHandler(){vw(this.content,t=>{this.emit(Bt.CONTENTS.LINK_CLICKED,t)})}writingMode(t){let e=xa("writing-mode");return t&&this.documentElement&&(this.documentElement.style[e]=t),this.window.getComputedStyle(this.documentElement)[e]||""}layoutStyle(t){return t&&(this._layoutStyle=t,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}epubReadingSystem(t,e){return navigator.epubReadingSystem={name:t,version:e,layoutStyle:this.layoutStyle(),hasFeature:function(i){switch(i){case"dom-manipulation":return!0;case"layout-changes":return!0;case"touch-events":return!0;case"mouse-events":return!0;case"keyboard-events":return!0;case"spine-scripting":return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}}os(Yf.prototype);class Dw{constructor(t){this.rendition=t,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(t,e,i,s,a,o){let u=encodeURI(e+t),d=new Te(e).spinePos,f=new cb({type:t,cfiRange:e,data:i,sectionIndex:d,cb:s,className:a,styles:o});return this._annotations[u]=f,d in this._annotationsBySectionIndex?this._annotationsBySectionIndex[d].push(u):this._annotationsBySectionIndex[d]=[u],this.rendition.views().forEach(v=>{f.sectionIndex===v.index&&f.attach(v)}),f}remove(t,e){let i=encodeURI(t+e);if(i in this._annotations){let s=this._annotations[i];if(e&&s.type!==e)return;this.rendition.views().forEach(o=>{this._removeFromAnnotationBySectionIndex(s.sectionIndex,i),s.sectionIndex===o.index&&s.detach(o)}),delete this._annotations[i]}}_removeFromAnnotationBySectionIndex(t,e){this._annotationsBySectionIndex[t]=this._annotationsAt(t).filter(i=>i!==e)}_annotationsAt(t){return this._annotationsBySectionIndex[t]}highlight(t,e,i,s,a){return this.add("highlight",t,e,i,s,a)}underline(t,e,i,s,a){return this.add("underline",t,e,i,s,a)}mark(t,e,i){return this.add("mark",t,e,i)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(t){let e=t.index;e in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[e].forEach(s=>{this._annotations[s].attach(t)})}clear(t){let e=t.index;e in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[e].forEach(s=>{this._annotations[s].detach(t)})}show(){}hide(){}}class cb{constructor({type:t,cfiRange:e,data:i,sectionIndex:s,cb:a,className:o,styles:u}){this.type=t,this.cfiRange=e,this.data=i,this.sectionIndex=s,this.mark=void 0,this.cb=a,this.className=o,this.styles=u}update(t){this.data=t}attach(t){let{cfiRange:e,data:i,type:s,mark:a,cb:o,className:u,styles:h}=this,d;return s==="highlight"?d=t.highlight(e,i,o,u,h):s==="underline"?d=t.underline(e,i,o,u,h):s==="mark"&&(d=t.mark(e,i,o)),this.mark=d,this.emit(Bt.ANNOTATION.ATTACH,d),d}detach(t){let{cfiRange:e,type:i}=this,s;return t&&(i==="highlight"?s=t.unhighlight(e):i==="underline"?s=t.ununderline(e):i==="mark"&&(s=t.unmark(e))),this.mark=void 0,this.emit(Bt.ANNOTATION.DETACH,s),s}text(){}}os(cb.prototype);var jn={},Fo={},V0;function Rw(){if(V0)return Fo;V0=1,Object.defineProperty(Fo,"__esModule",{value:!0}),Fo.createElement=g;function g(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}return Fo.default={createElement:g},Fo}var _a={},X0;function Nw(){if(X0)return _a;X0=1,Object.defineProperty(_a,"__esModule",{value:!0}),_a.proxyMouse=g,_a.clone=t,_a.default={proxyMouse:g};function g(i,s){function a(d){for(var f=s.length-1;f>=0;f--){var p=s[f],v=d.clientX,A=d.clientY;if(d.touches&&d.touches.length&&(v=d.touches[0].clientX,A=d.touches[0].clientY),!!e(p,i,v,A)){p.dispatchEvent(t(d));break}}}if(i.nodeName==="iframe"||i.nodeName==="IFRAME")try{this.target=i.contentDocument}catch{this.target=i}else this.target=i;for(var o=["mouseup","mousedown","click","touchstart"],u=0;u<o.length;u++){var h=o[u];this.target.addEventListener(h,function(d){return a(d)},!1)}}function t(i){var s=Object.assign({},i,{bubbles:!1});try{return new MouseEvent(i.type,s)}catch{var a=document.createEvent("MouseEvents");return a.initMouseEvent(i.type,!1,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,s.relatedTarget),a}}function e(i,s,a,o){var u=s.getBoundingClientRect();function h(A,C,w){var b=A.top-u.top,_=A.left-u.left,x=b+A.height,D=_+A.width;return b<=w&&_<=C&&x>w&&D>C}var d=i.getBoundingClientRect();if(!h(d,a,o))return!1;for(var f=i.getClientRects(),p=0,v=f.length;p<v;p++)if(h(f[p],a,o))return!0;return!1}return _a}var Y0;function Ow(){if(Y0)return jn;Y0=1,Object.defineProperty(jn,"__esModule",{value:!0}),jn.Underline=jn.Highlight=jn.Mark=jn.Pane=void 0;var g=function w(b,_,x){b===null&&(b=Function.prototype);var D=Object.getOwnPropertyDescriptor(b,_);if(D===void 0){var M=Object.getPrototypeOf(b);return M===null?void 0:w(M,_,x)}else{if("value"in D)return D.value;var T=D.get;return T===void 0?void 0:T.call(x)}},t=(function(){function w(b,_){for(var x=0;x<_.length;x++){var D=_[x];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(b,D.key,D)}}return function(b,_,x){return _&&w(b.prototype,_),x&&w(b,x),b}})(),e=Rw(),i=o(e),s=Nw(),a=o(s);function o(w){return w&&w.__esModule?w:{default:w}}function u(w,b){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:w}function h(w,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);w.prototype=Object.create(b&&b.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(w,b):w.__proto__=b)}function d(w,b){if(!(w instanceof b))throw new TypeError("Cannot call a class as a function")}jn.Pane=(function(){function w(b){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;d(this,w),this.target=b,this.element=i.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),a.default.proxyMouse(this.target,this.marks),this.container=_,this.container.appendChild(this.element),this.render()}return t(w,[{key:"addMark",value:function(_){var x=i.default.createElement("g");return this.element.appendChild(x),_.bind(x,this.container),this.marks.push(_),_.render(),_}},{key:"removeMark",value:function(_){var x=this.marks.indexOf(_);if(x!==-1){var D=_.unbind();this.element.removeChild(D),this.marks.splice(x,1)}}},{key:"render",value:function(){A(this.element,v(this.target,this.container));var _=!0,x=!1,D=void 0;try{for(var M=this.marks[Symbol.iterator](),T;!(_=(T=M.next()).done);_=!0){var O=T.value;O.render()}}catch(k){x=!0,D=k}finally{try{!_&&M.return&&M.return()}finally{if(x)throw D}}}}]),w})();var f=jn.Mark=(function(){function w(){d(this,w),this.element=null}return t(w,[{key:"bind",value:function(_,x){this.element=_,this.container=x}},{key:"unbind",value:function(){var _=this.element;return this.element=null,_}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(_){this.element&&this.element.dispatchEvent(_)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var _=[],x=this.element.firstChild;x;)_.push(x.getBoundingClientRect()),x=x.nextSibling;return _}},{key:"filteredRanges",value:function(){var _=Array.from(this.range.getClientRects());return _.filter(function(x){for(var D=0;D<_.length;D++){if(_[D]===x)return!0;var M=C(_[D],x);if(M)return!1}return!0})}}]),w})(),p=jn.Highlight=(function(w){h(b,w);function b(_,x,D,M){d(this,b);var T=u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return T.range=_,T.className=x,T.data=D||{},T.attributes=M||{},T}return t(b,[{key:"bind",value:function(x,D){g(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"bind",this).call(this,x,D);for(var M in this.data)this.data.hasOwnProperty(M)&&(this.element.dataset[M]=this.data[M]);for(var M in this.attributes)this.attributes.hasOwnProperty(M)&&this.element.setAttribute(M,this.attributes[M]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var x=this.element.ownerDocument.createDocumentFragment(),D=this.filteredRanges(),M=this.element.getBoundingClientRect(),T=this.container.getBoundingClientRect(),O=0,k=D.length;O<k;O++){var z=D[O],B=i.default.createElement("rect");B.setAttribute("x",z.left-M.left+T.left),B.setAttribute("y",z.top-M.top+T.top),B.setAttribute("height",z.height),B.setAttribute("width",z.width),x.appendChild(B)}this.element.appendChild(x)}}]),b})(f);jn.Underline=(function(w){h(b,w);function b(_,x,D,M){return d(this,b),u(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,_,x,D,M))}return t(b,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var x=this.element.ownerDocument.createDocumentFragment(),D=this.filteredRanges(),M=this.element.getBoundingClientRect(),T=this.container.getBoundingClientRect(),O=0,k=D.length;O<k;O++){var z=D[O],B=i.default.createElement("rect");B.setAttribute("x",z.left-M.left+T.left),B.setAttribute("y",z.top-M.top+T.top),B.setAttribute("height",z.height),B.setAttribute("width",z.width),B.setAttribute("fill","none");var H=i.default.createElement("line");H.setAttribute("x1",z.left-M.left+T.left),H.setAttribute("x2",z.left-M.left+T.left+z.width),H.setAttribute("y1",z.top-M.top+T.top+z.height-1),H.setAttribute("y2",z.top-M.top+T.top+z.height-1),H.setAttribute("stroke-width",1),H.setAttribute("stroke","black"),H.setAttribute("stroke-linecap","square"),x.appendChild(B),x.appendChild(H)}this.element.appendChild(x)}}]),b})(p);function v(w,b){var _=b.getBoundingClientRect(),x=w.getBoundingClientRect();return{top:x.top-_.top,left:x.left-_.left,height:w.scrollHeight,width:w.scrollWidth}}function A(w,b){w.style.setProperty("top",b.top+"px","important"),w.style.setProperty("left",b.left+"px","important"),w.style.setProperty("height",b.height+"px","important"),w.style.setProperty("width",b.width+"px","important")}function C(w,b){return b.right<=w.right&&b.left>=w.left&&b.top>=w.top&&b.bottom<=w.bottom}return jn}var Su=Ow();class db{constructor(t,e){this.settings=Hi({ignoreClass:"",axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},e||{}),this.id="epubjs-view-"+Ku(),this.section=t,this.index=t.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new Te,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(t){var e=document.createElement("div");return e.classList.add("epub-view"),e.style.height="0px",e.style.width="0px",e.style.overflow="hidden",e.style.position="relative",e.style.display="block",t&&t=="horizontal"?e.style.flex="none":e.style.flex="initial",e}create(){return this.iframe?this.iframe:(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.sandbox="allow-same-origin",this.settings.allowScriptedContent&&(this.iframe.sandbox+=" allow-scripts"),this.settings.allowPopups&&(this.iframe.sandbox+=" allow-popups"),this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=Du(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write"),this.iframe)}render(t,e){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(t)),this.sectionRender.then((function(i){return this.load(i)}).bind(this)).then((function(){let i=this.contents.writingMode(),s;return this.settings.flow==="scrolled"?s=i.indexOf("vertical")===0?"horizontal":"vertical":s=i.indexOf("vertical")===0?"vertical":"horizontal",i.indexOf("vertical")===0&&this.settings.flow==="paginated"&&(this.layout.delta=this.layout.height),this.setAxis(s),this.emit(Bt.VIEWS.AXIS,s),this.setWritingMode(i),this.emit(Bt.VIEWS.WRITING_MODE,i),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((a,o)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+"px"),a()})}).bind(this),(function(i){return this.emit(Bt.VIEWS.LOAD_ERROR,i),new Promise((s,a)=>{a(i)})}).bind(this)).then((function(){this.emit(Bt.VIEWS.RENDERED,this.section)}).bind(this))}reset(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(t,e){var i=t||this.settings.width,s=e||this.settings.height;this.layout.name==="pre-paginated"?this.lock("both",i,s):this.settings.axis==="horizontal"?this.lock("height",i,s):this.lock("width",i,s),this.settings.width=i,this.settings.height=s}lock(t,e,i){var s=Lu(this.element),a;this.iframe?a=Lu(this.iframe):a={width:0,height:0},t=="width"&&di(e)&&(this.lockedWidth=e-s.width-a.width),t=="height"&&di(i)&&(this.lockedHeight=i-s.height-a.height),t==="both"&&di(e)&&di(i)&&(this.lockedWidth=e-s.width-a.width,this.lockedHeight=i-s.height-a.height),this.displayed&&this.iframe&&this.expand()}expand(t){var e=this.lockedWidth,i=this.lockedHeight,s;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name==="pre-paginated"?(e=this.layout.columnWidth,i=this.layout.height):this.settings.axis==="horizontal"?(e=this.contents.textWidth(),e%this.layout.pageWidth>0&&(e=Math.ceil(e/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(s=e/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name==="reflowable"&&s%2>0&&(e+=this.layout.pageWidth))):this.settings.axis==="vertical"&&(i=this.contents.textHeight(),this.settings.flow==="paginated"&&i%this.layout.height>0&&(i=Math.ceil(i/this.layout.height)*this.layout.height)),(this._needsReframe||e!=this._width||i!=this._height)&&this.reframe(e,i),this._expanding=!1)}reframe(t,e){var i;di(t)&&(this.element.style.width=t+"px",this.iframe.style.width=t+"px",this._width=t),di(e)&&(this.element.style.height=e+"px",this.iframe.style.height=e+"px",this._height=e);let s=this.prevBounds?t-this.prevBounds.width:t,a=this.prevBounds?e-this.prevBounds.height:e;i={width:t,height:e,widthDelta:s,heightDelta:a},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let o;for(let u in this.marks)this.marks.hasOwnProperty(u)&&(o=this.marks[u],this.placeMark(o.element,o.range))}),this.onResize(this,i),this.emit(Bt.VIEWS.RESIZED,i),this.prevBounds=i,this.elementBounds=Du(this.element)}load(t){var e=new Ce,i=e.promise;if(!this.iframe)return e.reject(new Error("No Iframe Available")),i;if(this.iframe.onload=(function(a){this.onLoad(a,e)}).bind(this),this.settings.method==="blobUrl")this.blobUrl=Iu(t,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method==="srcdoc")this.iframe.srcdoc=t,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return e.reject(new Error("No Document Available")),i;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var s=this;MSApp.execUnsafeLocalFunction(function(){s.iframe.contentDocument.write(t)})}else this.iframe.contentDocument.write(t);this.iframe.contentDocument.close()}return i}onLoad(t,e){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new Yf(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var i=this.document.querySelector("link[rel='canonical']");i?i.setAttribute("href",this.section.canonical):(i=this.document.createElement("link"),i.setAttribute("rel","canonical"),i.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(i)),this.contents.on(Bt.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on(Bt.CONTENTS.RESIZE,s=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),e.resolve(this.contents)}setLayout(t){this.layout=t,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(t){this.settings.axis=t,t=="horizontal"?this.element.style.flex="none":this.element.style.flex="initial",this.size()}setWritingMode(t){this.writingMode=t}addListeners(){}removeListeners(t){}display(t){var e=new Ce;return this.displayed?e.resolve(this):this.render(t).then((function(){this.emit(Bt.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,e.resolve(this)}).bind(this),function(i){e.reject(i,this)}),e.promise}show(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(Bt.VIEWS.SHOWN,this)}hide(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(Bt.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(t){this.iframe.getBoundingClientRect();var e=this.contents.locationOf(t,this.settings.ignoreClass);return{left:e.left,top:e.top}}onDisplayed(t){}onResize(t,e){}bounds(t){return(t||!this.elementBounds)&&(this.elementBounds=Du(this.element)),this.elementBounds}highlight(t,e={},i,s="epubjs-hl",a={}){if(!this.contents)return;const o=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},a);let u=this.contents.range(t),h=()=>{this.emit(Bt.VIEWS.MARK_CLICKED,t,e)};e.epubcfi=t,this.pane||(this.pane=new Su.Pane(this.iframe,this.element));let d=new Su.Highlight(u,s,e,o),f=this.pane.addMark(d);return this.highlights[t]={mark:f,element:f.element,listeners:[h,i]},f.element.setAttribute("ref",s),f.element.addEventListener("click",h),f.element.addEventListener("touchstart",h),i&&(f.element.addEventListener("click",i),f.element.addEventListener("touchstart",i)),f}underline(t,e={},i,s="epubjs-ul",a={}){if(!this.contents)return;const o=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},a);let u=this.contents.range(t),h=()=>{this.emit(Bt.VIEWS.MARK_CLICKED,t,e)};e.epubcfi=t,this.pane||(this.pane=new Su.Pane(this.iframe,this.element));let d=new Su.Underline(u,s,e,o),f=this.pane.addMark(d);return this.underlines[t]={mark:f,element:f.element,listeners:[h,i]},f.element.setAttribute("ref",s),f.element.addEventListener("click",h),f.element.addEventListener("touchstart",h),i&&(f.element.addEventListener("click",i),f.element.addEventListener("touchstart",i)),f}mark(t,e={},i){if(!this.contents)return;if(t in this.marks)return this.marks[t];let s=this.contents.range(t);if(!s)return;let a=s.commonAncestorContainer,o=a.nodeType===1?a:a.parentNode,u=d=>{this.emit(Bt.VIEWS.MARK_CLICKED,t,e)};s.collapsed&&a.nodeType===1?(s=new Range,s.selectNodeContents(a)):s.collapsed&&(s=new Range,s.selectNodeContents(o));let h=this.document.createElement("a");return h.setAttribute("ref","epubjs-mk"),h.style.position="absolute",h.dataset.epubcfi=t,e&&Object.keys(e).forEach(d=>{h.dataset[d]=e[d]}),i&&(h.addEventListener("click",i),h.addEventListener("touchstart",i)),h.addEventListener("click",u),h.addEventListener("touchstart",u),this.placeMark(h,s),this.element.appendChild(h),this.marks[t]={element:h,range:s,listeners:[u,i]},o}placeMark(t,e){let i,s,a;if(this.layout.name==="pre-paginated"||this.settings.axis!=="horizontal"){let u=e.getBoundingClientRect();i=u.top,s=u.right}else{let u=e.getClientRects(),h;for(var o=0;o!=u.length;o++)h=u[o],(!a||h.left<a)&&(a=h.left,s=Math.ceil(a/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,i=h.top)}t.style.top=`${i}px`,t.style.left=`${s}px`}unhighlight(t){let e;t in this.highlights&&(e=this.highlights[t],this.pane.removeMark(e.mark),e.listeners.forEach(i=>{i&&(e.element.removeEventListener("click",i),e.element.removeEventListener("touchstart",i))}),delete this.highlights[t])}ununderline(t){let e;t in this.underlines&&(e=this.underlines[t],this.pane.removeMark(e.mark),e.listeners.forEach(i=>{i&&(e.element.removeEventListener("click",i),e.element.removeEventListener("touchstart",i))}),delete this.underlines[t])}unmark(t){let e;t in this.marks&&(e=this.marks[t],this.element.removeChild(e.element),e.listeners.forEach(i=>{i&&(e.element.removeEventListener("click",i),e.element.removeEventListener("touchstart",i))}),delete this.marks[t])}destroy(){for(let t in this.highlights)this.unhighlight(t);for(let t in this.underlines)this.ununderline(t);for(let t in this.marks)this.unmark(t);this.blobUrl&&ib(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&(this.pane.element.remove(),this.pane=void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}os(db.prototype);function kw(){var g="reverse",t=Mw();return document.body.appendChild(t),t.scrollLeft>0?g="default":typeof Element<"u"&&Element.prototype.scrollIntoView?(t.children[0].children[1].scrollIntoView(),t.scrollLeft<0&&(g="negative")):(t.scrollLeft=1,t.scrollLeft===0&&(g="negative")),document.body.removeChild(t),g}function Mw(){var g=document.createElement("div");g.dir="rtl",g.style.position="fixed",g.style.width="1px",g.style.height="1px",g.style.top="0px",g.style.left="0px",g.style.overflow="hidden";var t=document.createElement("div");t.style.width="2px";var e=document.createElement("span");e.style.width="1px",e.style.display="inline-block";var i=document.createElement("span");return i.style.width="1px",i.style.display="inline-block",t.appendChild(e),t.appendChild(i),g.appendChild(t),g}var jd,W0;function Wf(){if(W0)return jd;W0=1;function g(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}return jd=g,jd}var qd,Z0;function Lw(){if(Z0)return qd;Z0=1;var g=typeof Bn=="object"&&Bn&&Bn.Object===Object&&Bn;return qd=g,qd}var Gd,K0;function fb(){if(K0)return Gd;K0=1;var g=Lw(),t=typeof self=="object"&&self&&self.Object===Object&&self,e=g||t||Function("return this")();return Gd=e,Gd}var Vd,$0;function Bw(){if($0)return Vd;$0=1;var g=fb(),t=function(){return g.Date.now()};return Vd=t,Vd}var Xd,Q0;function Iw(){if(Q0)return Xd;Q0=1;var g=/\s/;function t(e){for(var i=e.length;i--&&g.test(e.charAt(i)););return i}return Xd=t,Xd}var Yd,J0;function zw(){if(J0)return Yd;J0=1;var g=Iw(),t=/^\s+/;function e(i){return i&&i.slice(0,g(i)+1).replace(t,"")}return Yd=e,Yd}var Wd,ty;function pb(){if(ty)return Wd;ty=1;var g=fb(),t=g.Symbol;return Wd=t,Wd}var Zd,ey;function Fw(){if(ey)return Zd;ey=1;var g=pb(),t=Object.prototype,e=t.hasOwnProperty,i=t.toString,s=g?g.toStringTag:void 0;function a(o){var u=e.call(o,s),h=o[s];try{o[s]=void 0;var d=!0}catch{}var f=i.call(o);return d&&(u?o[s]=h:delete o[s]),f}return Zd=a,Zd}var Kd,iy;function Pw(){if(iy)return Kd;iy=1;var g=Object.prototype,t=g.toString;function e(i){return t.call(i)}return Kd=e,Kd}var $d,ny;function Uw(){if(ny)return $d;ny=1;var g=pb(),t=Fw(),e=Pw(),i="[object Null]",s="[object Undefined]",a=g?g.toStringTag:void 0;function o(u){return u==null?u===void 0?s:i:a&&a in Object(u)?t(u):e(u)}return $d=o,$d}var Qd,sy;function Hw(){if(sy)return Qd;sy=1;function g(t){return t!=null&&typeof t=="object"}return Qd=g,Qd}var Jd,ry;function jw(){if(ry)return Jd;ry=1;var g=Uw(),t=Hw(),e="[object Symbol]";function i(s){return typeof s=="symbol"||t(s)&&g(s)==e}return Jd=i,Jd}var tf,ay;function qw(){if(ay)return tf;ay=1;var g=zw(),t=Wf(),e=jw(),i=NaN,s=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,o=/^0o[0-7]+$/i,u=parseInt;function h(d){if(typeof d=="number")return d;if(e(d))return i;if(t(d)){var f=typeof d.valueOf=="function"?d.valueOf():d;d=t(f)?f+"":f}if(typeof d!="string")return d===0?d:+d;d=g(d);var p=a.test(d);return p||o.test(d)?u(d.slice(2),p?2:8):s.test(d)?i:+d}return tf=h,tf}var ef,oy;function gb(){if(oy)return ef;oy=1;var g=Wf(),t=Bw(),e=qw(),i="Expected a function",s=Math.max,a=Math.min;function o(u,h,d){var f,p,v,A,C,w,b=0,_=!1,x=!1,D=!0;if(typeof u!="function")throw new TypeError(i);h=e(h)||0,g(d)&&(_=!!d.leading,x="maxWait"in d,v=x?s(e(d.maxWait)||0,h):v,D="trailing"in d?!!d.trailing:D);function M(rt){var ft=f,mt=p;return f=p=void 0,b=rt,A=u.apply(mt,ft),A}function T(rt){return b=rt,C=setTimeout(z,h),_?M(rt):A}function O(rt){var ft=rt-w,mt=rt-b,G=h-ft;return x?a(G,v-mt):G}function k(rt){var ft=rt-w,mt=rt-b;return w===void 0||ft>=h||ft<0||x&&mt>=v}function z(){var rt=t();if(k(rt))return B(rt);C=setTimeout(z,O(rt))}function B(rt){return C=void 0,D&&f?M(rt):(f=p=void 0,A)}function H(){C!==void 0&&clearTimeout(C),b=0,f=w=p=C=void 0}function V(){return C===void 0?A:B(t())}function Z(){var rt=t(),ft=k(rt);if(f=arguments,p=this,w=rt,ft){if(C===void 0)return T(w);if(x)return clearTimeout(C),C=setTimeout(z,h),M(w)}return C===void 0&&(C=setTimeout(z,h)),A}return Z.cancel=H,Z.flush=V,Z}return ef=o,ef}var nf,ly;function Gw(){if(ly)return nf;ly=1;var g=gb(),t=Wf(),e="Expected a function";function i(s,a,o){var u=!0,h=!0;if(typeof s!="function")throw new TypeError(e);return t(o)&&(u="leading"in o?!!o.leading:u,h="trailing"in o?!!o.trailing:h),g(s,a,{leading:u,maxWait:a,trailing:h})}return nf=i,nf}var Vw=Gw();const Xw=ur(Vw);class Yw{constructor(t){this.settings=t||{},this.id="epubjs-container-"+Ku(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(t){let e=t.height,i=t.width,s=t.overflow||!1,a=t.axis||"vertical",o=t.direction;Hi(this.settings,t),t.height&&di(t.height)&&(e=t.height+"px"),t.width&&di(t.width)&&(i=t.width+"px");let u=document.createElement("div");return u.id=this.id,u.classList.add("epub-container"),u.style.wordSpacing="0",u.style.lineHeight="0",u.style.verticalAlign="top",u.style.position="relative",a==="horizontal"&&(u.style.display="flex",u.style.flexDirection="row",u.style.flexWrap="nowrap"),i&&(u.style.width=i),e&&(u.style.height=e),s&&(s==="scroll"&&a==="vertical"?(u.style["overflow-y"]=s,u.style["overflow-x"]="hidden"):s==="scroll"&&a==="horizontal"?(u.style["overflow-y"]="hidden",u.style["overflow-x"]=s):u.style.overflow=s),o&&(u.dir=o,u.style.direction=o),o&&this.settings.fullsize&&(document.body.style.direction=o),u}wrap(t){var e=document.createElement("div");return e.style.visibility="hidden",e.style.overflow="hidden",e.style.width="0",e.style.height="0",e.appendChild(t),e}getElement(t){var e;if($y(t)?e=t:typeof t=="string"&&(e=document.getElementById(t)),!e)throw new Error("Not an Element");return e}attachTo(t){var e=this.getElement(t),i;if(e)return this.settings.hidden?i=this.wrapper:i=this.container,e.appendChild(i),this.element=e,e}getContainer(){return this.container}onResize(t){(!di(this.settings.width)||!di(this.settings.height))&&(this.resizeFunc=Xw(t,50),window.addEventListener("resize",this.resizeFunc,!1))}onOrientationChange(t){this.orientationChangeFunc=t,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}size(t,e){var i;let s=t||this.settings.width,a=e||this.settings.height;t===null?(i=this.element.getBoundingClientRect(),i.width&&(t=Math.floor(i.width),this.container.style.width=t+"px")):di(t)?this.container.style.width=t+"px":this.container.style.width=t,e===null?(i=i||this.element.getBoundingClientRect(),i.height&&(e=i.height,this.container.style.height=e+"px")):di(e)?this.container.style.height=e+"px":this.container.style.height=e,di(t)||(t=this.container.clientWidth),di(e)||(e=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};let o=Bu(),u=window.getComputedStyle(document.body),h={left:parseFloat(u["padding-left"])||0,right:parseFloat(u["padding-right"])||0,top:parseFloat(u["padding-top"])||0,bottom:parseFloat(u["padding-bottom"])||0};return s||(t=o.width-h.left-h.right),(this.settings.fullsize&&!a||!a)&&(e=o.height-h.top-h.bottom),{width:t-this.containerPadding.left-this.containerPadding.right,height:e-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let t;return this.container.style.overflow!=="visible"&&(t=this.container&&this.container.getBoundingClientRect()),!t||!t.width||!t.height?Bu():t}getSheet(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet}addStyleRules(t,e){var i="#"+this.id+" ",s="";this.sheet||(this.sheet=this.getSheet()),e.forEach(function(a){for(var o in a)a.hasOwnProperty(o)&&(s+=o+":"+a[o]+";")}),this.sheet.insertRule(i+t+" {"+s+"}",0)}axis(t){t==="horizontal"?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=t}direction(t){this.container&&(this.container.dir=t,this.container.style.direction=t),this.settings.fullsize&&(document.body.style.direction=t),this.settings.dir=t}overflow(t){this.container&&(t==="scroll"&&this.settings.axis==="vertical"?(this.container.style["overflow-y"]=t,this.container.style["overflow-x"]="hidden"):t==="scroll"&&this.settings.axis==="horizontal"?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=t):this.container.style.overflow=t),this.settings.overflow=t}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}class Ww{constructor(t){this.container=t,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(t){return this._views.indexOf(t)}slice(){return this._views.slice.apply(this._views,arguments)}get(t){return this._views[t]}append(t){return this._views.push(t),this.container&&this.container.appendChild(t.element),this.length++,t}prepend(t){return this._views.unshift(t),this.container&&this.container.insertBefore(t.element,this.container.firstChild),this.length++,t}insert(t,e){return this._views.splice(e,0,t),this.container&&(e<this.container.children.length?this.container.insertBefore(t.element,this.container.children[e]):this.container.appendChild(t.element)),this.length++,t}remove(t){var e=this._views.indexOf(t);e>-1&&this._views.splice(e,1),this.destroy(t),this.length--}destroy(t){t.displayed&&t.destroy(),this.container&&this.container.removeChild(t.element),t=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var t,e=this.length;if(this.length){for(var i=0;i<e;i++)t=this._views[i],this.destroy(t);this._views=[],this.length=0}}find(t){for(var e,i=this.length,s=0;s<i;s++)if(e=this._views[s],e.displayed&&e.section.index==t.index)return e}displayed(){for(var t=[],e,i=this.length,s=0;s<i;s++)e=this._views[s],e.displayed&&t.push(e);return t}show(){for(var t,e=this.length,i=0;i<e;i++)t=this._views[i],t.displayed&&t.show();this.hidden=!1}hide(){for(var t,e=this.length,i=0;i<e;i++)t=this._views[i],t.displayed&&t.hide();this.hidden=!0}}class Uu{constructor(t){this.name="default",this.optsSettings=t.settings,this.View=t.view,this.request=t.request,this.renditionQueue=t.queue,this.q=new Xf(this),this.settings=Hi(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),Hi(this.settings,t.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(t,e){let i=t.tagName;typeof this.settings.fullsize>"u"&&i&&(i.toLowerCase()=="body"||i.toLowerCase()=="html")&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=e,this.settings.rtlScrollType=kw(),this.stage=new Yw({width:e.width,height:e.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(t),this.container=this.stage.getContainer(),this.views=new Ww(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var t;window.addEventListener("unload",(function(e){this.destroy()}).bind(this)),this.settings.fullsize?t=window:t=this.container,this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll)}removeEventListeners(){var t;this.settings.fullsize?t=window:t=this.container,t.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(t){let{orientation:e}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout((function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(Bt.MANAGERS.ORIENTATION_CHANGE,e)}).bind(this),500)}onResized(t){this.resize()}resize(t,e,i){let s=this.stage.size(t,e);if(this.winBounds=Bu(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===s.width&&this._stageSize.height===s.height||(this._stageSize=s,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(Bt.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},i))}createView(t,e){return new this.View(t,Hi(this.viewSettings,{forceRight:e}))}handleNextPrePaginated(t,e,i){let s;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1){if(t||e.index===0)return;if(s=e.next(),s&&!s.properties.includes("page-spread-left"))return i.call(this,s)}}display(t,e){var i=new Ce,s=i.promise;(e===t.href||di(e))&&(e=void 0);var a=this.views.find(t);if(a&&t&&this.layout.name!=="pre-paginated"){let u=a.offset();if(this.settings.direction==="ltr")this.scrollTo(u.left,u.top,!0);else{let h=a.width();this.scrollTo(u.left+h,u.top,!0)}if(e){let h=a.locationOf(e),d=a.width();this.moveTo(h,d)}return i.resolve(),s}this.clear();let o=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&t.properties.includes("page-spread-right")&&(o=!0),this.add(t,o).then((function(u){if(e){let h=u.locationOf(e),d=u.width();this.moveTo(h,d)}}).bind(this),u=>{i.reject(u)}).then((function(){return this.handleNextPrePaginated(o,t,this.add)}).bind(this)).then((function(){this.views.show(),i.resolve()}).bind(this)),s}afterDisplayed(t){this.emit(Bt.MANAGERS.ADDED,t)}afterResized(t){this.emit(Bt.MANAGERS.RESIZE,t.section)}moveTo(t,e){var i=0,s=0;this.isPaginated?(i=Math.floor(t.left/this.layout.delta)*this.layout.delta,i+this.layout.delta>this.container.scrollWidth&&(i=this.container.scrollWidth-this.layout.delta),s=Math.floor(t.top/this.layout.delta)*this.layout.delta,s+this.layout.delta>this.container.scrollHeight&&(s=this.container.scrollHeight-this.layout.delta)):s=t.top,this.settings.direction==="rtl"&&(i=i+this.layout.delta,i=i-e),this.scrollTo(i,s,!0)}add(t,e){var i=this.createView(t,e);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Bt.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on(Bt.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}append(t,e){var i=this.createView(t,e);return this.views.append(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Bt.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on(Bt.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}prepend(t,e){var i=this.createView(t,e);return i.on(Bt.VIEWS.RESIZED,s=>{this.counter(s)}),this.views.prepend(i),i.onDisplayed=this.afterDisplayed.bind(this),i.onResize=this.afterResized.bind(this),i.on(Bt.VIEWS.AXIS,s=>{this.updateAxis(s)}),i.on(Bt.VIEWS.WRITING_MODE,s=>{this.updateWritingMode(s)}),i.display(this.request)}counter(t){this.settings.axis==="vertical"?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}next(){var t,e;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,e=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,e<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(e=this.container.scrollLeft,e>0?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next()):(e=this.container.scrollLeft+this.layout.delta*-1,e>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):t=this.views.last().section.next())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):t=this.views.last().section.next()):t=this.views.last().section.next(),t)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&t.properties.includes("page-spread-right")&&(s=!0),this.append(t,s).then((function(){return this.handleNextPrePaginated(s,t,this.append)}).bind(this),a=>a).then((function(){!this.isPaginated&&this.settings.axis==="horizontal"&&this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}).bind(this))}}prev(){var t,e;let i=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"&&(!i||i==="ltr")?(this.scrollLeft=this.container.scrollLeft,e=this.container.scrollLeft,e>0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):this.isPaginated&&this.settings.axis==="horizontal"&&i==="rtl"?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType==="default"?(e=this.container.scrollLeft+this.container.offsetWidth,e<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev()):(e=this.container.scrollLeft,e<0?this.scrollBy(-this.layout.delta,0,!0):t=this.views.first().section.prev())):this.isPaginated&&this.settings.axis==="vertical"?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):t=this.views.first().section.prev()):t=this.views.first().section.prev(),t)){this.clear(),this.updateLayout();let s=!1;return this.layout.name==="pre-paginated"&&this.layout.divisor===2&&typeof t.prev()!="object"&&(s=!0),this.prepend(t,s).then((function(){var a;if(this.layout.name==="pre-paginated"&&this.layout.divisor>1&&(a=t.prev(),a))return this.prepend(a)}).bind(this),a=>a).then((function(){this.isPaginated&&this.settings.axis==="horizontal"&&(this.settings.direction==="rtl"?this.settings.rtlScrollType==="default"?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}).bind(this))}}current(){var t=this.visible();return t.length?t[t.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis==="horizontal"?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let t=this.visible(),e=this.container.getBoundingClientRect(),i=e.height<window.innerHeight?e.height:window.innerHeight,s=e.width<window.innerWidth?e.width:window.innerWidth,a=this.settings.axis==="vertical";this.settings.direction;let o=0,u=0;return this.settings.fullsize&&(o=a?window.scrollY:window.scrollX),t.map(d=>{let{index:f,href:p}=d.section,v=d.position(),A=d.width(),C=d.height(),w,b,_,x;a?(w=o+e.top-v.top+u,b=w+i-u,x=this.layout.count(C,i).pages,_=i):(w=o+e.left-v.left+u,b=w+s-u,x=this.layout.count(A,s).pages,_=s);let D=Math.ceil(w/_),M=[],T=Math.ceil(b/_);if(this.settings.direction==="rtl"&&!a){let z=D;D=x-T,T=x-z}M=[];for(var O=D;O<=T;O++){let z=O+1;M.push(z)}let k=this.mapping.page(d.contents,d.section.cfiBase,w,b);return{index:f,href:p,pages:M,totalPages:x,mapping:k}})}paginatedLocation(){let t=this.visible(),e=this.container.getBoundingClientRect(),i=0,s=0;return this.settings.fullsize&&(i=window.scrollX),t.map(o=>{let{index:u,href:h}=o.section,d,f=o.position(),p=o.width(),v,A,C;this.settings.direction==="rtl"?(d=e.right-i,C=Math.min(Math.abs(d-f.left),this.layout.width)-s,A=f.width-(f.right-d)-s,v=A-C):(d=e.left+i,C=Math.min(f.right-d,this.layout.width)-s,v=d-f.left+s,A=v+C),s+=C;let w=this.mapping.page(o.contents,o.section.cfiBase,v,A),b=this.layout.count(p).pages,_=Math.floor(v/this.layout.pageWidth),x=[],D=Math.floor(A/this.layout.pageWidth);if(_<0&&(_=0,D=D+1),this.settings.direction==="rtl"){let T=_;_=b-D,D=b-T}for(var M=_+1;M<=D;M++){let T=M;x.push(T)}return{index:u,href:h,pages:x,totalPages:b,mapping:w}})}isVisible(t,e,i,s){var a=t.position(),o=s||this.bounds();return this.settings.axis==="horizontal"&&a.right>o.left-e&&a.left<o.right+i?!0:this.settings.axis==="vertical"&&a.bottom>o.top-e&&a.top<o.bottom+i}visible(){for(var t=this.bounds(),e=this.views.displayed(),i=e.length,s=[],a,o,u=0;u<i;u++)o=e[u],a=this.isVisible(o,0,0,t),a===!0&&s.push(o);return s}scrollBy(t,e,i){let s=this.settings.direction==="rtl"?-1:1;i&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(t*s,e*s):(t&&(this.container.scrollLeft+=t*s),e&&(this.container.scrollTop+=e)),this.scrolled=!0}scrollTo(t,e,i){i&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(t,e):(this.container.scrollLeft=t,this.container.scrollTop=e),this.scrolled=!0}onScroll(){let t,e;this.settings.fullsize?(t=window.scrollY,e=window.scrollX):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:(this.emit(Bt.MANAGERS.SCROLL,{top:t,left:e}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.emit(Bt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),20))}bounds(){var t;return t=this.stage.bounds(),t}applyLayout(t){this.layout=t,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name==="pre-paginated"&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(t){this.viewSettings.layout=t,this.mapping=new Pu(t.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(e){e&&e.setLayout(t)})}updateWritingMode(t){this.writingMode=t}updateAxis(t,e){!e&&t===this.settings.axis||(this.settings.axis=t,this.stage&&this.stage.axis(t),this.viewSettings.axis=t,this.mapping&&(this.mapping=new Pu(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&(t==="vertical"?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}updateFlow(t,e="auto"){let i=t==="paginated"||t==="auto";this.isPaginated=i,t==="scrolled-doc"||t==="scrolled-continuous"||t==="scrolled"?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=t,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=i?"hidden":e,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var t=[];return this.views&&this.views.forEach(function(e){const i=e&&e.contents;i&&t.push(i)}),t}direction(t="ltr"){this.settings.direction=t,this.stage&&this.stage.direction(t),this.viewSettings.direction=t,this.updateLayout()}isRendered(){return this.rendered}}os(Uu.prototype);const Zw={easeInCubic:function(g){return Math.pow(g,3)}};class xf{constructor(t,e){this.settings=Hi({duration:80,minVelocity:.2,minDistance:10,easing:Zw.easeInCubic},e||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(t)}setup(t){this.manager=t,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis==="vertical",!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow="hidden"}enableScroll(){this.element.style.overflow=""}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(Bt.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(Bt.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(t){let e=t.contents;["touchstart","touchmove","touchend"].forEach(i=>{e.on(i,s=>this.triggerViewEvent(s,e))})}triggerViewEvent(t,e){this.emit(t.type,t,e)}onScroll(t){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(t){this.resizeCanceler=!0}onTouchStart(t){let{screenX:e,screenY:i}=t.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=e,this.startTouchY=i,this.startTime=this.now()),this.endTouchX=e,this.endTouchY=i,this.endTime=this.now()}onTouchMove(t){let{screenX:e,screenY:i}=t.touches[0],s=Math.abs(i-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&s<10&&(this.element.scrollLeft-=e-this.endTouchX),this.endTouchX=e,this.endTouchY=i,this.endTime=this.now()}onTouchEnd(t){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let e=this.wasSwiped();e!==0?this.snap(e):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let t=this.layout.pageWidth*this.layout.divisor,e=this.endTouchX-this.startTouchX,i=Math.abs(e),s=this.endTime-this.startTime,a=e/s,o=this.settings.minVelocity;if(i<=this.settings.minDistance||i>=t)return 0;if(a>o)return-1;if(a<-o)return 1}needsSnap(){let t=this.scrollLeft,e=this.layout.pageWidth*this.layout.divisor;return t%e!==0}snap(t=0){let e=this.scrollLeft,i=this.layout.pageWidth*this.layout.divisor,s=Math.round(e/i)*i;return t&&(s+=t*i),this.smoothScrollTo(s)}smoothScrollTo(t){const e=new Ce,i=this.scrollLeft,s=this.now(),a=this.settings.duration,o=this.settings.easing;this.snapping=!0;function u(){const h=this.now(),d=Math.min(1,(h-s)/a);if(o(d),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,e.resolve();return}d<1?(window.requestAnimationFrame(u.bind(this)),this.scrollTo(i+(t-i)*d,0)):(this.scrollTo(t,0),this.snapping=!1,e.resolve())}return u.call(this),e.promise}scrollTo(t=0,e=0){this.fullsize?window.scroll(t,e):(this.scroller.scrollLeft=t,this.scroller.scrollTop=e)}now(){return"now"in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}os(xf.prototype);var Kw=gb();const $w=ur(Kw);class Qw extends Uu{constructor(t){super(t),this.name="continuous",this.settings=Hi(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),Hi(this.settings,t.settings||{}),t.settings.gap!="undefined"&&t.settings.gap===0&&(this.settings.gap=t.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(t,e){return Uu.prototype.display.call(this,t,e).then((function(){return this.fill()}).bind(this))}fill(t){var e=t||new Ce;return this.q.enqueue(()=>this.check()).then(i=>{i?this.fill(e):e.resolve()}),e.promise}moveTo(t){var e=0,i=0;this.isPaginated?(e=Math.floor(t.left/this.layout.delta)*this.layout.delta,e+this.settings.offsetDelta):(i=t.top,t.top+this.settings.offsetDelta),(e>0||i>0)&&this.scrollBy(e,i,!0)}afterResized(t){this.emit(Bt.MANAGERS.RESIZE,t.section)}removeShownListeners(t){t.onDisplayed=function(){}}add(t){var e=this.createView(t);return this.views.append(e),e.on(Bt.VIEWS.RESIZED,i=>{e.expanded=!0}),e.on(Bt.VIEWS.AXIS,i=>{this.updateAxis(i)}),e.on(Bt.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),e.onDisplayed=this.afterDisplayed.bind(this),e.onResize=this.afterResized.bind(this),e.display(this.request)}append(t){var e=this.createView(t);return e.on(Bt.VIEWS.RESIZED,i=>{e.expanded=!0}),e.on(Bt.VIEWS.AXIS,i=>{this.updateAxis(i)}),e.on(Bt.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.append(e),e.onDisplayed=this.afterDisplayed.bind(this),e}prepend(t){var e=this.createView(t);return e.on(Bt.VIEWS.RESIZED,i=>{this.counter(i),e.expanded=!0}),e.on(Bt.VIEWS.AXIS,i=>{this.updateAxis(i)}),e.on(Bt.VIEWS.WRITING_MODE,i=>{this.updateWritingMode(i)}),this.views.prepend(e),e.onDisplayed=this.afterDisplayed.bind(this),e}counter(t){this.settings.axis==="vertical"?this.scrollBy(0,t.heightDelta,!0):this.scrollBy(t.widthDelta,0,!0)}update(t){for(var e=this.bounds(),i=this.views.all(),s=i.length,a=typeof t<"u"?t:this.settings.offset||0,o,u,h=new Ce,d=[],f=0;f<s;f++)if(u=i[f],o=this.isVisible(u,a,a,e),o===!0)if(u.displayed)u.show();else{let p=u.display(this.request).then(function(v){v.show()},v=>{u.hide()});d.push(p)}else this.q.enqueue(u.destroy.bind(u)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout((function(){this.q.enqueue(this.trim.bind(this))}).bind(this),250);return d.length?Promise.all(d).catch(p=>{h.reject(p)}):(h.resolve(),h.promise)}check(t,e){var i=new Ce,s=[],a=this.settings.axis==="horizontal",o=this.settings.offset||0;t&&a&&(o=t),e&&!a&&(o=e);var u=this._bounds;let h=a?this.scrollLeft:this.scrollTop,d=a?Math.floor(u.width):u.height,f=a?this.container.scrollWidth:this.container.scrollHeight,p=this.writingMode&&this.writingMode.indexOf("vertical")===0?"vertical":"horizontal",v=this.settings.rtlScrollType,A=this.settings.direction==="rtl";this.settings.fullsize?(a&&A&&v==="negative"||!a&&A&&v==="default")&&(h=h*-1):(A&&v==="default"&&p==="horizontal"&&(h=f-d-h),A&&v==="negative"&&p==="horizontal"&&(h=h*-1));let C=()=>{let D=this.views.first(),M=D&&D.section.prev();M&&s.push(this.prepend(M))},w=()=>{let D=this.views.last(),M=D&&D.section.next();M&&s.push(this.append(M))},b=h+d+o,_=h-o;b>=f&&w(),_<0&&C();let x=s.map(D=>D.display(this.request));return s.length?Promise.all(x).then(()=>this.check()).then(()=>this.update(o),D=>D):(this.q.enqueue((function(){this.update()}).bind(this)),i.resolve(!1),i.promise)}trim(){for(var t=new Ce,e=this.views.displayed(),i=e[0],s=e[e.length-1],a=this.views.indexOf(i),o=this.views.indexOf(s),u=this.views.slice(0,a),h=this.views.slice(o+1),d=0;d<u.length-1;d++)this.erase(u[d],u);for(var f=1;f<h.length;f++)this.erase(h[f]);return t.resolve(),t.promise}erase(t,e){var i,s;this.settings.fullsize?(i=window.scrollY,s=window.scrollX):(i=this.container.scrollTop,s=this.container.scrollLeft);var a=t.bounds();this.views.remove(t),e&&(this.settings.axis==="vertical"?this.scrollTo(0,i-a.height,!0):this.settings.direction==="rtl"?this.settings.fullsize?this.scrollTo(s+Math.floor(a.width),0,!0):this.scrollTo(s,0,!0):this.scrollTo(s-Math.floor(a.width),0,!0))}addEventListeners(t){window.addEventListener("unload",(function(e){this.ignore=!0,this.destroy()}).bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new xf(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}addScrollListeners(){var t;this.tick=qf;let e=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(t=window,this.scrollTop=window.scrollY*e,this.scrollLeft=window.scrollX*e):(t=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),t.addEventListener("scroll",this._onScroll),this._scrolled=$w(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){var t;this.settings.fullsize?t=window:t=this.container,t.removeEventListener("scroll",this._onScroll),this._onScroll=void 0}onScroll(){let t,e,i=this.settings.direction==="rtl"&&this.settings.rtlScrollType==="default"?-1:1;this.settings.fullsize?(t=window.scrollY*i,e=window.scrollX*i):(t=this.container.scrollTop,e=this.container.scrollLeft),this.scrollTop=t,this.scrollLeft=e,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(t-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(e-this.prevScrollLeft),this.prevScrollTop=t,this.prevScrollLeft=e,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}).bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue((function(){return this.check()}).bind(this)),this.emit(Bt.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout((function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(Bt.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}).bind(this),this.settings.afterScrolledTimeout)}next(){let t=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(t,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}prev(){let t=this.layout.props.name==="pre-paginated"&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis==="horizontal"?this.scrollBy(-t,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue((function(){return this.check()}).bind(this)))}updateFlow(t){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(t,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new xf(this,this.settings.snap&&typeof this.settings.snap=="object"&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}}class Zf{constructor(t,e){this.settings=Hi(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:"ltr",allowScriptedContent:!1,allowPopups:!1}),Hi(this.settings,e),typeof this.settings.manager=="object"&&(this.manager=this.settings.manager),this.book=t,this.hooks={},this.hooks.display=new Xn(this),this.hooks.serialize=new Xn(this),this.hooks.content=new Xn(this),this.hooks.unloaded=new Xn(this),this.hooks.layout=new Xn(this),this.hooks.render=new Xn(this),this.hooks.show=new Xn(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new xw(this),this.annotations=new Dw(this),this.epubcfi=new Te,this.q=new Xf(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new Ce,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(t){this.manager=t}requireManager(t){var e;return typeof t=="string"&&t==="default"?e=Uu:typeof t=="string"&&t==="continuous"?e=Qw:e=t,e}requireView(t){var e;return typeof t=="string"&&t==="iframe"?e=db:e=t,e}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout==="pre-paginated"||this.book.displayOptions.fixedLayout==="true")&&(this.settings.layout="pre-paginated"),this.book.package.metadata.spread){case"none":this.settings.spread="none";break;case"both":this.settings.spread=!0;break}this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(Bt.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(Bt.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(Bt.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(Bt.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(Bt.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(Bt.RENDITION.STARTED),this.starting.resolve()}attachTo(t){return this.q.enqueue((function(){this.manager.render(t,{width:this.settings.width,height:this.settings.height}),this.emit(Bt.RENDITION.ATTACHED)}).bind(this))}display(t){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,t)}_display(t){if(this.book){this.epubcfi.isCfiString(t);var e=new Ce,i=e.promise,s;return this.displaying=e,this.book.locations.length()&&Qy(t)&&(t=this.book.locations.cfiFromPercentage(parseFloat(t))),s=this.book.spine.get(t),s?(this.manager.display(s,t).then(()=>{e.resolve(s),this.displaying=void 0,this.emit(Bt.RENDITION.DISPLAYED,s),this.reportLocation()},a=>{this.emit(Bt.RENDITION.DISPLAY_ERROR,a)}),i):(e.reject(new Error("No Section Found")),i)}}afterDisplayed(t){t.on(Bt.VIEWS.MARK_CLICKED,(e,i)=>this.triggerMarkEvent(e,i,t.contents)),this.hooks.render.trigger(t,this).then(()=>{t.contents?this.hooks.content.trigger(t.contents,this).then(()=>{this.emit(Bt.RENDITION.RENDERED,t.section,t)}):this.emit(Bt.RENDITION.RENDERED,t.section,t)})}afterRemoved(t){this.hooks.unloaded.trigger(t,this).then(()=>{this.emit(Bt.RENDITION.REMOVED,t.section,t)})}onResized(t,e){this.emit(Bt.RENDITION.RESIZED,{width:t.width,height:t.height},e),this.location&&this.location.start&&this.display(e||this.location.start.cfi)}onOrientationChange(t){this.emit(Bt.RENDITION.ORIENTATION_CHANGE,t)}moveTo(t){this.manager.moveTo(t)}resize(t,e,i){t&&(this.settings.width=t),e&&(this.settings.height=e),this.manager.resize(t,e,i)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(t){var e,i=this.settings.layout||t.layout||"reflowable",s=this.settings.spread||t.spread||"auto",a=this.settings.orientation||t.orientation||"auto",o=this.settings.flow||t.flow||"auto",u=t.viewport||"",h=this.settings.minSpreadWidth||t.minSpreadWidth||800,d=this.settings.direction||t.direction||"ltr";return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height>0),e={layout:i,spread:s,orientation:a,flow:o,viewport:u,minSpreadWidth:h,direction:d},e}flow(t){var e=t;(t==="scrolled"||t==="scrolled-doc"||t==="scrolled-continuous")&&(e="scrolled"),(t==="auto"||t==="paginated")&&(e="paginated"),this.settings.flow=t,this._layout&&this._layout.flow(e),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(e),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(t){return t&&(this._layout=new ub(t),this._layout.spread(t.spread,this.settings.minSpreadWidth),this._layout.on(Bt.LAYOUT.UPDATED,(e,i)=>{this.emit(Bt.RENDITION.LAYOUT,e,i)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(t,e){this.settings.spread=t,e&&(this.settings.minSpreadWidth=e),this._layout&&this._layout.spread(t,e),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(t){this.settings.direction=t||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue((function(){requestAnimationFrame((function(){var i=this.manager.currentLocation();if(i&&i.then&&typeof i.then=="function")i.then((function(s){let a=this.located(s);!a||!a.start||!a.end||(this.location=a,this.emit(Bt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Bt.RENDITION.RELOCATED,this.location))}).bind(this));else if(i){let s=this.located(i);if(!s||!s.start||!s.end)return;this.location=s,this.emit(Bt.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(Bt.RENDITION.RELOCATED,this.location)}}).bind(this))}).bind(this))}currentLocation(){var t=this.manager.currentLocation();if(t&&t.then&&typeof t.then=="function")t.then((function(e){return this.located(e)}).bind(this));else if(t)return this.located(t)}located(t){if(!t.length)return{};let e=t[0],i=t[t.length-1],s={start:{index:e.index,href:e.href,cfi:e.mapping.start,displayed:{page:e.pages[0]||1,total:e.totalPages}},end:{index:i.index,href:i.href,cfi:i.mapping.end,displayed:{page:i.pages[i.pages.length-1]||1,total:i.totalPages}}},a=this.book.locations.locationFromCfi(e.mapping.start),o=this.book.locations.locationFromCfi(i.mapping.end);a!=null&&(s.start.location=a,s.start.percentage=this.book.locations.percentageFromLocation(a)),o!=null&&(s.end.location=o,s.end.percentage=this.book.locations.percentageFromLocation(o));let u=this.book.pageList.pageFromCfi(e.mapping.start),h=this.book.pageList.pageFromCfi(i.mapping.end);return u!=-1&&(s.start.page=u),h!=-1&&(s.end.page=h),i.index===this.book.spine.last().index&&s.end.displayed.page>=s.end.displayed.total&&(s.atEnd=!0),e.index===this.book.spine.first().index&&s.start.displayed.page===1&&(s.atStart=!0),s}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(t){Ru.forEach(e=>{t.on(e,i=>this.triggerViewEvent(i,t))}),t.on(Bt.CONTENTS.SELECTED,e=>this.triggerSelectedEvent(e,t))}triggerViewEvent(t,e){this.emit(t.type,t,e)}triggerSelectedEvent(t,e){this.emit(Bt.RENDITION.SELECTED,t,e)}triggerMarkEvent(t,e,i){this.emit(Bt.RENDITION.MARK_CLICKED,t,e,i)}getRange(t,e){var i=new Te(t),s=this.manager.visible().filter(function(a){if(i.spinePos===a.index)return!0});if(s.length)return s[0].contents.range(i,e)}adjustImages(t){if(this._layout.name==="pre-paginated")return new Promise(function(a){a()});let e=t.window.getComputedStyle(t.content,null),i=(t.content.offsetHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)))*.95,s=parseFloat(e.paddingLeft)+parseFloat(e.paddingRight);return t.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":i+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-s+"px":"100%")+"!important","max-height":i+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise(function(a,o){setTimeout(function(){a()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(t){t&&t.on(Bt.CONTENTS.LINK_CLICKED,e=>{let i=this.book.path.relative(e);this.display(i)})}injectStylesheet(t,e){let i=t.createElement("link");i.setAttribute("type","text/css"),i.setAttribute("rel","stylesheet"),i.setAttribute("href",this.settings.stylesheet),t.getElementsByTagName("head")[0].appendChild(i)}injectScript(t,e){let i=t.createElement("script");i.setAttribute("type","text/javascript"),i.setAttribute("src",this.settings.script),i.textContent=" ",t.getElementsByTagName("head")[0].appendChild(i)}injectIdentifier(t,e){let i=this.book.packaging.metadata.identifier,s=t.createElement("meta");s.setAttribute("name","dc.relation.ispartof"),i&&s.setAttribute("content",i),t.getElementsByTagName("head")[0].appendChild(s)}}os(Zf.prototype);function ar(g){throw new Error('Could not dynamically require "'+g+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sf={exports:{}};var uy;function Jw(){return uy||(uy=1,(function(g,t){(function(e){g.exports=e()})(function(){return(function e(i,s,a){function o(d,f){if(!s[d]){if(!i[d]){var p=typeof ar=="function"&&ar;if(!f&&p)return p(d,!0);if(u)return u(d,!0);var v=new Error("Cannot find module '"+d+"'");throw v.code="MODULE_NOT_FOUND",v}var A=s[d]={exports:{}};i[d][0].call(A.exports,function(C){var w=i[d][1][C];return o(w||C)},A,A.exports,e,i,s,a)}return s[d].exports}for(var u=typeof ar=="function"&&ar,h=0;h<a.length;h++)o(a[h]);return o})({1:[function(e,i,s){var a=e("./utils"),o=e("./support"),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(h){for(var d=[],f,p,v,A,C,w,b,_=0,x=h.length,D=x,M=a.getTypeOf(h)!=="string";_<h.length;)D=x-_,M?(f=h[_++],p=_<x?h[_++]:0,v=_<x?h[_++]:0):(f=h.charCodeAt(_++),p=_<x?h.charCodeAt(_++):0,v=_<x?h.charCodeAt(_++):0),A=f>>2,C=(f&3)<<4|p>>4,w=D>1?(p&15)<<2|v>>6:64,b=D>2?v&63:64,d.push(u.charAt(A)+u.charAt(C)+u.charAt(w)+u.charAt(b));return d.join("")},s.decode=function(h){var d,f,p,v,A,C,w,b=0,_=0,x="data:";if(h.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");h=h.replace(/[^A-Za-z0-9+/=]/g,"");var D=h.length*3/4;if(h.charAt(h.length-1)===u.charAt(64)&&D--,h.charAt(h.length-2)===u.charAt(64)&&D--,D%1!==0)throw new Error("Invalid base64 input, bad content length.");var M;for(o.uint8array?M=new Uint8Array(D|0):M=new Array(D|0);b<h.length;)v=u.indexOf(h.charAt(b++)),A=u.indexOf(h.charAt(b++)),C=u.indexOf(h.charAt(b++)),w=u.indexOf(h.charAt(b++)),d=v<<2|A>>4,f=(A&15)<<4|C>>2,p=(C&3)<<6|w,M[_++]=d,C!==64&&(M[_++]=f),w!==64&&(M[_++]=p);return M}},{"./support":30,"./utils":32}],2:[function(e,i,s){var a=e("./external"),o=e("./stream/DataWorker"),u=e("./stream/Crc32Probe"),h=e("./stream/DataLengthProbe");function d(f,p,v,A,C){this.compressedSize=f,this.uncompressedSize=p,this.crc32=v,this.compression=A,this.compressedContent=C}d.prototype={getContentWorker:function(){var f=new o(a.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new h("data_length")),p=this;return f.on("end",function(){if(this.streamInfo.data_length!==p.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),f},getCompressedWorker:function(){return new o(a.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},d.createWorkerFrom=function(f,p,v){return f.pipe(new u).pipe(new h("uncompressedSize")).pipe(p.compressWorker(v)).pipe(new h("compressedSize")).withStreamInfo("compression",p)},i.exports=d},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,i,s){var a=e("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new a("STORE compression")},uncompressWorker:function(){return new a("STORE decompression")}},s.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,i,s){var a=e("./utils");function o(){for(var f,p=[],v=0;v<256;v++){f=v;for(var A=0;A<8;A++)f=f&1?3988292384^f>>>1:f>>>1;p[v]=f}return p}var u=o();function h(f,p,v,A){var C=u,w=A+v;f=f^-1;for(var b=A;b<w;b++)f=f>>>8^C[(f^p[b])&255];return f^-1}function d(f,p,v,A){var C=u,w=A+v;f=f^-1;for(var b=A;b<w;b++)f=f>>>8^C[(f^p.charCodeAt(b))&255];return f^-1}i.exports=function(p,v){if(typeof p>"u"||!p.length)return 0;var A=a.getTypeOf(p)!=="string";return A?h(v|0,p,p.length,0):d(v|0,p,p.length,0)}},{"./utils":32}],5:[function(e,i,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(e,i,s){var a=null;typeof Promise<"u"?a=Promise:a=e("lie"),i.exports={Promise:a}},{lie:37}],7:[function(e,i,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",o=e("pako"),u=e("./utils"),h=e("./stream/GenericWorker"),d=a?"uint8array":"array";s.magic="\b\0";function f(p,v){h.call(this,"FlateWorker/"+p),this._pako=null,this._pakoAction=p,this._pakoOptions=v,this.meta={}}u.inherits(f,h),f.prototype.processChunk=function(p){this.meta=p.meta,this._pako===null&&this._createPako(),this._pako.push(u.transformTo(d,p.data),!1)},f.prototype.flush=function(){h.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},f.prototype.cleanUp=function(){h.prototype.cleanUp.call(this),this._pako=null},f.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var p=this;this._pako.onData=function(v){p.push({data:v,meta:p.meta})}},s.compressWorker=function(p){return new f("Deflate",p)},s.uncompressWorker=function(){return new f("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,i,s){var a=e("../utils"),o=e("../stream/GenericWorker"),u=e("../utf8"),h=e("../crc32"),d=e("../signature"),f=function(_,x){var D="",M;for(M=0;M<x;M++)D+=String.fromCharCode(_&255),_=_>>>8;return D},p=function(_,x){var D=_;return _||(D=x?16893:33204),(D&65535)<<16},v=function(_){return(_||0)&63},A=function(_,x,D,M,T,O){var k=_.file,z=_.compression,B=O!==u.utf8encode,H=a.transformTo("string",O(k.name)),V=a.transformTo("string",u.utf8encode(k.name)),Z=k.comment,rt=a.transformTo("string",O(Z)),ft=a.transformTo("string",u.utf8encode(Z)),mt=V.length!==k.name.length,G=ft.length!==Z.length,W,st,bt="",Nt="",j="",$=k.dir,gt=k.date,yt={crc32:0,compressedSize:0,uncompressedSize:0};(!x||D)&&(yt.crc32=_.crc32,yt.compressedSize=_.compressedSize,yt.uncompressedSize=_.uncompressedSize);var Dt=0;x&&(Dt|=8),!B&&(mt||G)&&(Dt|=2048);var zt=0,kt=0;$&&(zt|=16),T==="UNIX"?(kt=798,zt|=p(k.unixPermissions,$)):(kt=20,zt|=v(k.dosPermissions)),W=gt.getUTCHours(),W=W<<6,W=W|gt.getUTCMinutes(),W=W<<5,W=W|gt.getUTCSeconds()/2,st=gt.getUTCFullYear()-1980,st=st<<4,st=st|gt.getUTCMonth()+1,st=st<<5,st=st|gt.getUTCDate(),mt&&(Nt=f(1,1)+f(h(H),4)+V,bt+="up"+f(Nt.length,2)+Nt),G&&(j=f(1,1)+f(h(rt),4)+ft,bt+="uc"+f(j.length,2)+j);var Lt="";Lt+=`
\0`,Lt+=f(Dt,2),Lt+=z.magic,Lt+=f(W,2),Lt+=f(st,2),Lt+=f(yt.crc32,4),Lt+=f(yt.compressedSize,4),Lt+=f(yt.uncompressedSize,4),Lt+=f(H.length,2),Lt+=f(bt.length,2);var Gt=d.LOCAL_FILE_HEADER+Lt+H+bt,ye=d.CENTRAL_FILE_HEADER+f(kt,2)+Lt+f(rt.length,2)+"\0\0\0\0"+f(zt,4)+f(M,4)+H+bt+rt;return{fileRecord:Gt,dirRecord:ye}},C=function(_,x,D,M,T){var O="",k=a.transformTo("string",T(M));return O=d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+f(_,2)+f(_,2)+f(x,4)+f(D,4)+f(k.length,2)+k,O},w=function(_){var x="";return x=d.DATA_DESCRIPTOR+f(_.crc32,4)+f(_.compressedSize,4)+f(_.uncompressedSize,4),x};function b(_,x,D,M){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=x,this.zipPlatform=D,this.encodeFileName=M,this.streamFiles=_,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(b,o),b.prototype.push=function(_){var x=_.meta.percent||0,D=this.entriesCount,M=this._sources.length;this.accumulate?this.contentBuffer.push(_):(this.bytesWritten+=_.data.length,o.prototype.push.call(this,{data:_.data,meta:{currentFile:this.currentFile,percent:D?(x+100*(D-M-1))/D:100}}))},b.prototype.openedSource=function(_){this.currentSourceOffset=this.bytesWritten,this.currentFile=_.file.name;var x=this.streamFiles&&!_.file.dir;if(x){var D=A(_,x,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:D.fileRecord,meta:{percent:0}})}else this.accumulate=!0},b.prototype.closedSource=function(_){this.accumulate=!1;var x=this.streamFiles&&!_.file.dir,D=A(_,x,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(D.dirRecord),x)this.push({data:w(_),meta:{percent:100}});else for(this.push({data:D.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},b.prototype.flush=function(){for(var _=this.bytesWritten,x=0;x<this.dirRecords.length;x++)this.push({data:this.dirRecords[x],meta:{percent:100}});var D=this.bytesWritten-_,M=C(this.dirRecords.length,D,_,this.zipComment,this.encodeFileName);this.push({data:M,meta:{percent:100}})},b.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},b.prototype.registerPrevious=function(_){this._sources.push(_);var x=this;return _.on("data",function(D){x.processChunk(D)}),_.on("end",function(){x.closedSource(x.previous.streamInfo),x._sources.length?x.prepareNextSource():x.end()}),_.on("error",function(D){x.error(D)}),this},b.prototype.resume=function(){if(!o.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},b.prototype.error=function(_){var x=this._sources;if(!o.prototype.error.call(this,_))return!1;for(var D=0;D<x.length;D++)try{x[D].error(_)}catch{}return!0},b.prototype.lock=function(){o.prototype.lock.call(this);for(var _=this._sources,x=0;x<_.length;x++)_[x].lock()},i.exports=b},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,i,s){var a=e("../compressions"),o=e("./ZipFileWorker"),u=function(h,d){var f=h||d,p=a[f];if(!p)throw new Error(f+" is not a valid compression method !");return p};s.generateWorker=function(h,d,f){var p=new o(d.streamFiles,f,d.platform,d.encodeFileName),v=0;try{h.forEach(function(A,C){v++;var w=u(C.options.compression,d.compression),b=C.options.compressionOptions||d.compressionOptions||{},_=C.dir,x=C.date;C._compressWorker(w,b).withStreamInfo("file",{name:A,dir:_,date:x,comment:C.comment||"",unixPermissions:C.unixPermissions,dosPermissions:C.dosPermissions}).pipe(p)}),p.entriesCount=v}catch(A){p.error(A)}return p}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,i,s){function a(){if(!(this instanceof a))return new a;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new a;for(var u in this)typeof this[u]!="function"&&(o[u]=this[u]);return o}}a.prototype=e("./object"),a.prototype.loadAsync=e("./load"),a.support=e("./support"),a.defaults=e("./defaults"),a.version="3.10.1",a.loadAsync=function(o,u){return new a().loadAsync(o,u)},a.external=e("./external"),i.exports=a},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,i,s){var a=e("./utils"),o=e("./external"),u=e("./utf8"),h=e("./zipEntries"),d=e("./stream/Crc32Probe"),f=e("./nodejsUtils");function p(v){return new o.Promise(function(A,C){var w=v.decompressed.getContentWorker().pipe(new d);w.on("error",function(b){C(b)}).on("end",function(){w.streamInfo.crc32!==v.decompressed.crc32?C(new Error("Corrupted zip : CRC32 mismatch")):A()}).resume()})}i.exports=function(v,A){var C=this;return A=a.extend(A||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:u.utf8decode}),f.isNode&&f.isStream(v)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):a.prepareContent("the loaded zip file",v,!0,A.optimizedBinaryString,A.base64).then(function(w){var b=new h(A);return b.load(w),b}).then(function(b){var _=[o.Promise.resolve(b)],x=b.files;if(A.checkCRC32)for(var D=0;D<x.length;D++)_.push(p(x[D]));return o.Promise.all(_)}).then(function(b){for(var _=b.shift(),x=_.files,D=0;D<x.length;D++){var M=x[D],T=M.fileNameStr,O=a.resolve(M.fileNameStr);C.file(O,M.decompressed,{binary:!0,optimizedBinaryString:!0,date:M.date,dir:M.dir,comment:M.fileCommentStr.length?M.fileCommentStr:null,unixPermissions:M.unixPermissions,dosPermissions:M.dosPermissions,createFolders:A.createFolders}),M.dir||(C.file(O).unsafeOriginalName=T)}return _.zipComment.length&&(C.comment=_.zipComment),C})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,i,s){var a=e("../utils"),o=e("../stream/GenericWorker");function u(h,d){o.call(this,"Nodejs stream input adapter for "+h),this._upstreamEnded=!1,this._bindStream(d)}a.inherits(u,o),u.prototype._bindStream=function(h){var d=this;this._stream=h,h.pause(),h.on("data",function(f){d.push({data:f,meta:{percent:0}})}).on("error",function(f){d.isPaused?this.generatedError=f:d.error(f)}).on("end",function(){d.isPaused?d._upstreamEnded=!0:d.end()})},u.prototype.pause=function(){return o.prototype.pause.call(this)?(this._stream.pause(),!0):!1},u.prototype.resume=function(){return o.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},i.exports=u},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,i,s){var a=e("readable-stream").Readable,o=e("../utils");o.inherits(u,a);function u(h,d,f){a.call(this,d),this._helper=h;var p=this;h.on("data",function(v,A){p.push(v)||p._helper.pause(),f&&f(A)}).on("error",function(v){p.emit("error",v)}).on("end",function(){p.push(null)})}u.prototype._read=function(){this._helper.resume()},i.exports=u},{"../utils":32,"readable-stream":16}],14:[function(e,i,s){i.exports={isNode:typeof Buffer<"u",newBufferFrom:function(a,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(a,o);if(typeof a=="number")throw new Error('The "data" argument must not be a number');return new Buffer(a,o)},allocBuffer:function(a){if(Buffer.alloc)return Buffer.alloc(a);var o=new Buffer(a);return o.fill(0),o},isBuffer:function(a){return Buffer.isBuffer(a)},isStream:function(a){return a&&typeof a.on=="function"&&typeof a.pause=="function"&&typeof a.resume=="function"}}},{}],15:[function(e,i,s){var a=e("./utf8"),o=e("./utils"),u=e("./stream/GenericWorker"),h=e("./stream/StreamHelper"),d=e("./defaults"),f=e("./compressedObject"),p=e("./zipObject"),v=e("./generate"),A=e("./nodejsUtils"),C=e("./nodejs/NodejsStreamInputAdapter"),w=function(T,O,k){var z=o.getTypeOf(O),B,H=o.extend(k||{},d);H.date=H.date||new Date,H.compression!==null&&(H.compression=H.compression.toUpperCase()),typeof H.unixPermissions=="string"&&(H.unixPermissions=parseInt(H.unixPermissions,8)),H.unixPermissions&&H.unixPermissions&16384&&(H.dir=!0),H.dosPermissions&&H.dosPermissions&16&&(H.dir=!0),H.dir&&(T=_(T)),H.createFolders&&(B=b(T))&&x.call(this,B,!0);var V=z==="string"&&H.binary===!1&&H.base64===!1;(!k||typeof k.binary>"u")&&(H.binary=!V);var Z=O instanceof f&&O.uncompressedSize===0;(Z||H.dir||!O||O.length===0)&&(H.base64=!1,H.binary=!0,O="",H.compression="STORE",z="string");var rt=null;O instanceof f||O instanceof u?rt=O:A.isNode&&A.isStream(O)?rt=new C(T,O):rt=o.prepareContent(T,O,H.binary,H.optimizedBinaryString,H.base64);var ft=new p(T,rt,H);this.files[T]=ft},b=function(T){T.slice(-1)==="/"&&(T=T.substring(0,T.length-1));var O=T.lastIndexOf("/");return O>0?T.substring(0,O):""},_=function(T){return T.slice(-1)!=="/"&&(T+="/"),T},x=function(T,O){return O=typeof O<"u"?O:d.createFolders,T=_(T),this.files[T]||w.call(this,T,null,{dir:!0,createFolders:O}),this.files[T]};function D(T){return Object.prototype.toString.call(T)==="[object RegExp]"}var M={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(T){var O,k,z;for(O in this.files)z=this.files[O],k=O.slice(this.root.length,O.length),k&&O.slice(0,this.root.length)===this.root&&T(k,z)},filter:function(T){var O=[];return this.forEach(function(k,z){T(k,z)&&O.push(z)}),O},file:function(T,O,k){if(arguments.length===1)if(D(T)){var z=T;return this.filter(function(H,V){return!V.dir&&z.test(H)})}else{var B=this.files[this.root+T];return B&&!B.dir?B:null}else T=this.root+T,w.call(this,T,O,k);return this},folder:function(T){if(!T)return this;if(D(T))return this.filter(function(B,H){return H.dir&&T.test(B)});var O=this.root+T,k=x.call(this,O),z=this.clone();return z.root=k.name,z},remove:function(T){T=this.root+T;var O=this.files[T];if(O||(T.slice(-1)!=="/"&&(T+="/"),O=this.files[T]),O&&!O.dir)delete this.files[T];else for(var k=this.filter(function(B,H){return H.name.slice(0,T.length)===T}),z=0;z<k.length;z++)delete this.files[k[z].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(T){var O,k={};try{if(k=o.extend(T||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode}),k.type=k.type.toLowerCase(),k.compression=k.compression.toUpperCase(),k.type==="binarystring"&&(k.type="string"),!k.type)throw new Error("No output type specified.");o.checkSupport(k.type),(k.platform==="darwin"||k.platform==="freebsd"||k.platform==="linux"||k.platform==="sunos")&&(k.platform="UNIX"),k.platform==="win32"&&(k.platform="DOS");var z=k.comment||this.comment||"";O=v.generateWorker(this,k,z)}catch(B){O=new u("error"),O.error(B)}return new h(O,k.type||"string",k.mimeType)},generateAsync:function(T,O){return this.generateInternalStream(T).accumulate(O)},generateNodeStream:function(T,O){return T=T||{},T.type||(T.type="nodebuffer"),this.generateInternalStream(T).toNodejsStream(O)}};i.exports=M},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,i,s){i.exports=e("stream")},{stream:void 0}],17:[function(e,i,s){var a=e("./DataReader"),o=e("../utils");function u(h){a.call(this,h);for(var d=0;d<this.data.length;d++)h[d]=h[d]&255}o.inherits(u,a),u.prototype.byteAt=function(h){return this.data[this.zero+h]},u.prototype.lastIndexOfSignature=function(h){for(var d=h.charCodeAt(0),f=h.charCodeAt(1),p=h.charCodeAt(2),v=h.charCodeAt(3),A=this.length-4;A>=0;--A)if(this.data[A]===d&&this.data[A+1]===f&&this.data[A+2]===p&&this.data[A+3]===v)return A-this.zero;return-1},u.prototype.readAndCheckSignature=function(h){var d=h.charCodeAt(0),f=h.charCodeAt(1),p=h.charCodeAt(2),v=h.charCodeAt(3),A=this.readData(4);return d===A[0]&&f===A[1]&&p===A[2]&&v===A[3]},u.prototype.readData=function(h){if(this.checkOffset(h),h===0)return[];var d=this.data.slice(this.zero+this.index,this.zero+this.index+h);return this.index+=h,d},i.exports=u},{"../utils":32,"./DataReader":18}],18:[function(e,i,s){var a=e("../utils");function o(u){this.data=u,this.length=u.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(u){this.checkIndex(this.index+u)},checkIndex:function(u){if(this.length<this.zero+u||u<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+u+"). Corrupted zip ?")},setIndex:function(u){this.checkIndex(u),this.index=u},skip:function(u){this.setIndex(this.index+u)},byteAt:function(){},readInt:function(u){var h=0,d;for(this.checkOffset(u),d=this.index+u-1;d>=this.index;d--)h=(h<<8)+this.byteAt(d);return this.index+=u,h},readString:function(u){return a.transformTo("string",this.readData(u))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var u=this.readInt(4);return new Date(Date.UTC((u>>25&127)+1980,(u>>21&15)-1,u>>16&31,u>>11&31,u>>5&63,(u&31)<<1))}},i.exports=o},{"../utils":32}],19:[function(e,i,s){var a=e("./Uint8ArrayReader"),o=e("../utils");function u(h){a.call(this,h)}o.inherits(u,a),u.prototype.readData=function(h){this.checkOffset(h);var d=this.data.slice(this.zero+this.index,this.zero+this.index+h);return this.index+=h,d},i.exports=u},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,i,s){var a=e("./DataReader"),o=e("../utils");function u(h){a.call(this,h)}o.inherits(u,a),u.prototype.byteAt=function(h){return this.data.charCodeAt(this.zero+h)},u.prototype.lastIndexOfSignature=function(h){return this.data.lastIndexOf(h)-this.zero},u.prototype.readAndCheckSignature=function(h){var d=this.readData(4);return h===d},u.prototype.readData=function(h){this.checkOffset(h);var d=this.data.slice(this.zero+this.index,this.zero+this.index+h);return this.index+=h,d},i.exports=u},{"../utils":32,"./DataReader":18}],21:[function(e,i,s){var a=e("./ArrayReader"),o=e("../utils");function u(h){a.call(this,h)}o.inherits(u,a),u.prototype.readData=function(h){if(this.checkOffset(h),h===0)return new Uint8Array(0);var d=this.data.subarray(this.zero+this.index,this.zero+this.index+h);return this.index+=h,d},i.exports=u},{"../utils":32,"./ArrayReader":17}],22:[function(e,i,s){var a=e("../utils"),o=e("../support"),u=e("./ArrayReader"),h=e("./StringReader"),d=e("./NodeBufferReader"),f=e("./Uint8ArrayReader");i.exports=function(p){var v=a.getTypeOf(p);return a.checkSupport(v),v==="string"&&!o.uint8array?new h(p):v==="nodebuffer"?new d(p):o.uint8array?new f(a.transformTo("uint8array",p)):new u(a.transformTo("array",p))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,i,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,i,s){var a=e("./GenericWorker"),o=e("../utils");function u(h){a.call(this,"ConvertWorker to "+h),this.destType=h}o.inherits(u,a),u.prototype.processChunk=function(h){this.push({data:o.transformTo(this.destType,h.data),meta:h.meta})},i.exports=u},{"../utils":32,"./GenericWorker":28}],25:[function(e,i,s){var a=e("./GenericWorker"),o=e("../crc32"),u=e("../utils");function h(){a.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}u.inherits(h,a),h.prototype.processChunk=function(d){this.streamInfo.crc32=o(d.data,this.streamInfo.crc32||0),this.push(d)},i.exports=h},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,i,s){var a=e("../utils"),o=e("./GenericWorker");function u(h){o.call(this,"DataLengthProbe for "+h),this.propName=h,this.withStreamInfo(h,0)}a.inherits(u,o),u.prototype.processChunk=function(h){if(h){var d=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=d+h.data.length}o.prototype.processChunk.call(this,h)},i.exports=u},{"../utils":32,"./GenericWorker":28}],27:[function(e,i,s){var a=e("../utils"),o=e("./GenericWorker"),u=16*1024;function h(d){o.call(this,"DataWorker");var f=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,d.then(function(p){f.dataIsReady=!0,f.data=p,f.max=p&&p.length||0,f.type=a.getTypeOf(p),f.isPaused||f._tickAndRepeat()},function(p){f.error(p)})}a.inherits(h,o),h.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},h.prototype.resume=function(){return o.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,a.delay(this._tickAndRepeat,[],this)),!0):!1},h.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(a.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},h.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var d=u,f=null,p=Math.min(this.max,this.index+d);if(this.index>=this.max)return this.end();switch(this.type){case"string":f=this.data.substring(this.index,p);break;case"uint8array":f=this.data.subarray(this.index,p);break;case"array":case"nodebuffer":f=this.data.slice(this.index,p);break}return this.index=p,this.push({data:f,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=h},{"../utils":32,"./GenericWorker":28}],28:[function(e,i,s){function a(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}a.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return this.isFinished?!1:(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,u){return this._listeners[o].push(u),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,u){if(this._listeners[o])for(var h=0;h<this._listeners[o].length;h++)this._listeners[o][h].call(this,u)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var u=this;return o.on("data",function(h){u.processChunk(h)}),o.on("end",function(){u.end()}),o.on("error",function(h){u.error(h)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var o=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,u){return this.extraStreamInfo[o]=u,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},i.exports=a},{}],29:[function(e,i,s){var a=e("../utils"),o=e("./ConvertWorker"),u=e("./GenericWorker"),h=e("../base64"),d=e("../support"),f=e("../external"),p=null;if(d.nodestream)try{p=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function v(b,_,x){switch(b){case"blob":return a.newBlob(a.transformTo("arraybuffer",_),x);case"base64":return h.encode(_);default:return a.transformTo(b,_)}}function A(b,_){var x,D=0,M=null,T=0;for(x=0;x<_.length;x++)T+=_[x].length;switch(b){case"string":return _.join("");case"array":return Array.prototype.concat.apply([],_);case"uint8array":for(M=new Uint8Array(T),x=0;x<_.length;x++)M.set(_[x],D),D+=_[x].length;return M;case"nodebuffer":return Buffer.concat(_);default:throw new Error("concat : unsupported type '"+b+"'")}}function C(b,_){return new f.Promise(function(x,D){var M=[],T=b._internalType,O=b._outputType,k=b._mimeType;b.on("data",function(z,B){M.push(z),_&&_(B)}).on("error",function(z){M=[],D(z)}).on("end",function(){try{var z=v(O,A(T,M),k);x(z)}catch(B){D(B)}M=[]}).resume()})}function w(b,_,x){var D=_;switch(_){case"blob":case"arraybuffer":D="uint8array";break;case"base64":D="string";break}try{this._internalType=D,this._outputType=_,this._mimeType=x,a.checkSupport(D),this._worker=b.pipe(new o(D)),b.lock()}catch(M){this._worker=new u("error"),this._worker.error(M)}}w.prototype={accumulate:function(b){return C(this,b)},on:function(b,_){var x=this;return b==="data"?this._worker.on(b,function(D){_.call(x,D.data,D.meta)}):this._worker.on(b,function(){a.delay(_,arguments,x)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(b){if(a.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new p(this,{objectMode:this._outputType!=="nodebuffer"},b)}},i.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,i,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof Buffer<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var a=new ArrayBuffer(0);try{s.blob=new Blob([a],{type:"application/zip"}).size===0}catch{try{var o=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,u=new o;u.append(a),s.blob=u.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!e("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(e,i,s){for(var a=e("./utils"),o=e("./support"),u=e("./nodejsUtils"),h=e("./stream/GenericWorker"),d=new Array(256),f=0;f<256;f++)d[f]=f>=252?6:f>=248?5:f>=240?4:f>=224?3:f>=192?2:1;d[254]=d[254]=1;var p=function(b){var _,x,D,M,T,O=b.length,k=0;for(M=0;M<O;M++)x=b.charCodeAt(M),(x&64512)===55296&&M+1<O&&(D=b.charCodeAt(M+1),(D&64512)===56320&&(x=65536+(x-55296<<10)+(D-56320),M++)),k+=x<128?1:x<2048?2:x<65536?3:4;for(o.uint8array?_=new Uint8Array(k):_=new Array(k),T=0,M=0;T<k;M++)x=b.charCodeAt(M),(x&64512)===55296&&M+1<O&&(D=b.charCodeAt(M+1),(D&64512)===56320&&(x=65536+(x-55296<<10)+(D-56320),M++)),x<128?_[T++]=x:x<2048?(_[T++]=192|x>>>6,_[T++]=128|x&63):x<65536?(_[T++]=224|x>>>12,_[T++]=128|x>>>6&63,_[T++]=128|x&63):(_[T++]=240|x>>>18,_[T++]=128|x>>>12&63,_[T++]=128|x>>>6&63,_[T++]=128|x&63);return _},v=function(b,_){var x;for(_=_||b.length,_>b.length&&(_=b.length),x=_-1;x>=0&&(b[x]&192)===128;)x--;return x<0||x===0?_:x+d[b[x]]>_?x:_},A=function(b){var _,x,D,M,T=b.length,O=new Array(T*2);for(x=0,_=0;_<T;){if(D=b[_++],D<128){O[x++]=D;continue}if(M=d[D],M>4){O[x++]=65533,_+=M-1;continue}for(D&=M===2?31:M===3?15:7;M>1&&_<T;)D=D<<6|b[_++]&63,M--;if(M>1){O[x++]=65533;continue}D<65536?O[x++]=D:(D-=65536,O[x++]=55296|D>>10&1023,O[x++]=56320|D&1023)}return O.length!==x&&(O.subarray?O=O.subarray(0,x):O.length=x),a.applyFromCharCode(O)};s.utf8encode=function(_){return o.nodebuffer?u.newBufferFrom(_,"utf-8"):p(_)},s.utf8decode=function(_){return o.nodebuffer?a.transformTo("nodebuffer",_).toString("utf-8"):(_=a.transformTo(o.uint8array?"uint8array":"array",_),A(_))};function C(){h.call(this,"utf-8 decode"),this.leftOver=null}a.inherits(C,h),C.prototype.processChunk=function(b){var _=a.transformTo(o.uint8array?"uint8array":"array",b.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var x=_;_=new Uint8Array(x.length+this.leftOver.length),_.set(this.leftOver,0),_.set(x,this.leftOver.length)}else _=this.leftOver.concat(_);this.leftOver=null}var D=v(_),M=_;D!==_.length&&(o.uint8array?(M=_.subarray(0,D),this.leftOver=_.subarray(D,_.length)):(M=_.slice(0,D),this.leftOver=_.slice(D,_.length))),this.push({data:s.utf8decode(M),meta:b.meta})},C.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=C;function w(){h.call(this,"utf-8 encode")}a.inherits(w,h),w.prototype.processChunk=function(b){this.push({data:s.utf8encode(b.data),meta:b.meta})},s.Utf8EncodeWorker=w},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,i,s){var a=e("./support"),o=e("./base64"),u=e("./nodejsUtils"),h=e("./external");e("setimmediate");function d(b){var _=null;return a.uint8array?_=new Uint8Array(b.length):_=new Array(b.length),p(b,_)}s.newBlob=function(b,_){s.checkSupport("blob");try{return new Blob([b],{type:_})}catch{try{var x=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,D=new x;return D.append(b),D.getBlob(_)}catch{throw new Error("Bug : can't construct the Blob.")}}};function f(b){return b}function p(b,_){for(var x=0;x<b.length;++x)_[x]=b.charCodeAt(x)&255;return _}var v={stringifyByChunk:function(b,_,x){var D=[],M=0,T=b.length;if(T<=x)return String.fromCharCode.apply(null,b);for(;M<T;)_==="array"||_==="nodebuffer"?D.push(String.fromCharCode.apply(null,b.slice(M,Math.min(M+x,T)))):D.push(String.fromCharCode.apply(null,b.subarray(M,Math.min(M+x,T)))),M+=x;return D.join("")},stringifyByChar:function(b){for(var _="",x=0;x<b.length;x++)_+=String.fromCharCode(b[x]);return _},applyCanBeUsed:{uint8array:(function(){try{return a.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return a.nodebuffer&&String.fromCharCode.apply(null,u.allocBuffer(1)).length===1}catch{return!1}})()}};function A(b){var _=65536,x=s.getTypeOf(b),D=!0;if(x==="uint8array"?D=v.applyCanBeUsed.uint8array:x==="nodebuffer"&&(D=v.applyCanBeUsed.nodebuffer),D)for(;_>1;)try{return v.stringifyByChunk(b,x,_)}catch{_=Math.floor(_/2)}return v.stringifyByChar(b)}s.applyFromCharCode=A;function C(b,_){for(var x=0;x<b.length;x++)_[x]=b[x];return _}var w={};w.string={string:f,array:function(b){return p(b,new Array(b.length))},arraybuffer:function(b){return w.string.uint8array(b).buffer},uint8array:function(b){return p(b,new Uint8Array(b.length))},nodebuffer:function(b){return p(b,u.allocBuffer(b.length))}},w.array={string:A,array:f,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return u.newBufferFrom(b)}},w.arraybuffer={string:function(b){return A(new Uint8Array(b))},array:function(b){return C(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:f,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return u.newBufferFrom(new Uint8Array(b))}},w.uint8array={string:A,array:function(b){return C(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:f,nodebuffer:function(b){return u.newBufferFrom(b)}},w.nodebuffer={string:A,array:function(b){return C(b,new Array(b.length))},arraybuffer:function(b){return w.nodebuffer.uint8array(b).buffer},uint8array:function(b){return C(b,new Uint8Array(b.length))},nodebuffer:f},s.transformTo=function(b,_){if(_||(_=""),!b)return _;s.checkSupport(b);var x=s.getTypeOf(_),D=w[x][b](_);return D},s.resolve=function(b){for(var _=b.split("/"),x=[],D=0;D<_.length;D++){var M=_[D];M==="."||M===""&&D!==0&&D!==_.length-1||(M===".."?x.pop():x.push(M))}return x.join("/")},s.getTypeOf=function(b){if(typeof b=="string")return"string";if(Object.prototype.toString.call(b)==="[object Array]")return"array";if(a.nodebuffer&&u.isBuffer(b))return"nodebuffer";if(a.uint8array&&b instanceof Uint8Array)return"uint8array";if(a.arraybuffer&&b instanceof ArrayBuffer)return"arraybuffer"},s.checkSupport=function(b){var _=a[b.toLowerCase()];if(!_)throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var _="",x,D;for(D=0;D<(b||"").length;D++)x=b.charCodeAt(D),_+="\\x"+(x<16?"0":"")+x.toString(16).toUpperCase();return _},s.delay=function(b,_,x){setImmediate(function(){b.apply(x||null,_||[])})},s.inherits=function(b,_){var x=function(){};x.prototype=_.prototype,b.prototype=new x},s.extend=function(){var b={},_,x;for(_=0;_<arguments.length;_++)for(x in arguments[_])Object.prototype.hasOwnProperty.call(arguments[_],x)&&typeof b[x]>"u"&&(b[x]=arguments[_][x]);return b},s.prepareContent=function(b,_,x,D,M){var T=h.Promise.resolve(_).then(function(O){var k=a.blob&&(O instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(O))!==-1);return k&&typeof FileReader<"u"?new h.Promise(function(z,B){var H=new FileReader;H.onload=function(V){z(V.target.result)},H.onerror=function(V){B(V.target.error)},H.readAsArrayBuffer(O)}):O});return T.then(function(O){var k=s.getTypeOf(O);return k?(k==="arraybuffer"?O=s.transformTo("uint8array",O):k==="string"&&(M?O=o.decode(O):x&&D!==!0&&(O=d(O))),O):h.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,i,s){var a=e("./reader/readerFor"),o=e("./utils"),u=e("./signature"),h=e("./zipEntry"),d=e("./support");function f(p){this.files=[],this.loadOptions=p}f.prototype={checkSignature:function(p){if(!this.reader.readAndCheckSignature(p)){this.reader.index-=4;var v=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(v)+", expected "+o.pretty(p)+")")}},isSignature:function(p,v){var A=this.reader.index;this.reader.setIndex(p);var C=this.reader.readString(4),w=C===v;return this.reader.setIndex(A),w},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var p=this.reader.readData(this.zipCommentLength),v=d.uint8array?"uint8array":"array",A=o.transformTo(v,p);this.zipComment=this.loadOptions.decodeFileName(A)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var p=this.zip64EndOfCentralSize-44,v=0,A,C,w;v<p;)A=this.reader.readInt(2),C=this.reader.readInt(4),w=this.reader.readData(C),this.zip64ExtensibleData[A]={id:A,length:C,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var p,v;for(p=0;p<this.files.length;p++)v=this.files[p],this.reader.setIndex(v.localHeaderOffset),this.checkSignature(u.LOCAL_FILE_HEADER),v.readLocalPart(this.reader),v.handleUTF8(),v.processAttributes()},readCentralDir:function(){var p;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(u.CENTRAL_FILE_HEADER);)p=new h({zip64:this.zip64},this.loadOptions),p.readCentralPart(this.reader),this.files.push(p);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var p=this.reader.lastIndexOfSignature(u.CENTRAL_DIRECTORY_END);if(p<0){var v=!this.isSignature(0,u.LOCAL_FILE_HEADER);throw v?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(p);var A=p;if(this.checkSignature(u.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,p=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),p<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(p),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,u.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(u.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var C=this.centralDirOffset+this.centralDirSize;this.zip64&&(C+=20,C+=12+this.zip64EndOfCentralSize);var w=A-C;if(w>0)this.isSignature(A,u.CENTRAL_FILE_HEADER)||(this.reader.zero=w);else if(w<0)throw new Error("Corrupted zip: missing "+Math.abs(w)+" bytes.")},prepareReader:function(p){this.reader=a(p)},load:function(p){this.prepareReader(p),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=f},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,i,s){var a=e("./reader/readerFor"),o=e("./utils"),u=e("./compressedObject"),h=e("./crc32"),d=e("./utf8"),f=e("./compressions"),p=e("./support"),v=0,A=3,C=function(b){for(var _ in f)if(Object.prototype.hasOwnProperty.call(f,_)&&f[_].magic===b)return f[_];return null};function w(b,_){this.options=b,this.loadOptions=_}w.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(b){var _,x;if(b.skip(22),this.fileNameLength=b.readInt(2),x=b.readInt(2),this.fileName=b.readData(this.fileNameLength),b.skip(x),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(_=C(this.compressionMethod),_===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new u(this.compressedSize,this.uncompressedSize,this.crc32,_,b.readData(this.compressedSize))},readCentralPart:function(b){this.versionMadeBy=b.readInt(2),b.skip(2),this.bitFlag=b.readInt(2),this.compressionMethod=b.readString(2),this.date=b.readDate(),this.crc32=b.readInt(4),this.compressedSize=b.readInt(4),this.uncompressedSize=b.readInt(4);var _=b.readInt(2);if(this.extraFieldsLength=b.readInt(2),this.fileCommentLength=b.readInt(2),this.diskNumberStart=b.readInt(2),this.internalFileAttributes=b.readInt(2),this.externalFileAttributes=b.readInt(4),this.localHeaderOffset=b.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");b.skip(_),this.readExtraFields(b),this.parseZIP64ExtraField(b),this.fileComment=b.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var b=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),b===v&&(this.dosPermissions=this.externalFileAttributes&63),b===A&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var b=a(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=b.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=b.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=b.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=b.readInt(4))}},readExtraFields:function(b){var _=b.index+this.extraFieldsLength,x,D,M;for(this.extraFields||(this.extraFields={});b.index+4<_;)x=b.readInt(2),D=b.readInt(2),M=b.readData(D),this.extraFields[x]={id:x,length:D,value:M};b.setIndex(_)},handleUTF8:function(){var b=p.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=d.utf8decode(this.fileName),this.fileCommentStr=d.utf8decode(this.fileComment);else{var _=this.findExtraFieldUnicodePath();if(_!==null)this.fileNameStr=_;else{var x=o.transformTo(b,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(x)}var D=this.findExtraFieldUnicodeComment();if(D!==null)this.fileCommentStr=D;else{var M=o.transformTo(b,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(M)}}},findExtraFieldUnicodePath:function(){var b=this.extraFields[28789];if(b){var _=a(b.value);return _.readInt(1)!==1||h(this.fileName)!==_.readInt(4)?null:d.utf8decode(_.readData(b.length-5))}return null},findExtraFieldUnicodeComment:function(){var b=this.extraFields[25461];if(b){var _=a(b.value);return _.readInt(1)!==1||h(this.fileComment)!==_.readInt(4)?null:d.utf8decode(_.readData(b.length-5))}return null}},i.exports=w},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,i,s){var a=e("./stream/StreamHelper"),o=e("./stream/DataWorker"),u=e("./utf8"),h=e("./compressedObject"),d=e("./stream/GenericWorker"),f=function(C,w,b){this.name=C,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=w,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}};f.prototype={internalStream:function(C){var w=null,b="string";try{if(!C)throw new Error("No output type specified.");b=C.toLowerCase();var _=b==="string"||b==="text";(b==="binarystring"||b==="text")&&(b="string"),w=this._decompressWorker();var x=!this._dataBinary;x&&!_&&(w=w.pipe(new u.Utf8EncodeWorker)),!x&&_&&(w=w.pipe(new u.Utf8DecodeWorker))}catch(D){w=new d("error"),w.error(D)}return new a(w,b,"")},async:function(C,w){return this.internalStream(C).accumulate(w)},nodeStream:function(C,w){return this.internalStream(C||"nodebuffer").toNodejsStream(w)},_compressWorker:function(C,w){if(this._data instanceof h&&this._data.compression.magic===C.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new u.Utf8EncodeWorker)),h.createWorkerFrom(b,C,w)},_decompressWorker:function(){return this._data instanceof h?this._data.getContentWorker():this._data instanceof d?this._data:new o(this._data)}};for(var p=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],v=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},A=0;A<p.length;A++)f.prototype[p[A]]=v;i.exports=f},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,i,s){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,u;if(o){var h=0,d=new o(C),f=a.document.createTextNode("");d.observe(f,{characterData:!0}),u=function(){f.data=h=++h%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var p=new a.MessageChannel;p.port1.onmessage=C,u=function(){p.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?u=function(){var b=a.document.createElement("script");b.onreadystatechange=function(){C(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:u=function(){setTimeout(C,0)};var v,A=[];function C(){v=!0;for(var b,_,x=A.length;x;){for(_=A,A=[],b=-1;++b<x;)_[b]();x=A.length}v=!1}i.exports=w;function w(b){A.push(b)===1&&!v&&u()}}).call(this,typeof Bn<"u"?Bn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,i,s){var a=e("immediate");function o(){}var u={},h=["REJECTED"],d=["FULFILLED"],f=["PENDING"];i.exports=p;function p(T){if(typeof T!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,T!==o&&w(this,T)}p.prototype.finally=function(T){if(typeof T!="function")return this;var O=this.constructor;return this.then(k,z);function k(B){function H(){return B}return O.resolve(T()).then(H)}function z(B){function H(){throw B}return O.resolve(T()).then(H)}},p.prototype.catch=function(T){return this.then(null,T)},p.prototype.then=function(T,O){if(typeof T!="function"&&this.state===d||typeof O!="function"&&this.state===h)return this;var k=new this.constructor(o);if(this.state!==f){var z=this.state===d?T:O;A(k,z,this.outcome)}else this.queue.push(new v(k,T,O));return k};function v(T,O,k){this.promise=T,typeof O=="function"&&(this.onFulfilled=O,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}v.prototype.callFulfilled=function(T){u.resolve(this.promise,T)},v.prototype.otherCallFulfilled=function(T){A(this.promise,this.onFulfilled,T)},v.prototype.callRejected=function(T){u.reject(this.promise,T)},v.prototype.otherCallRejected=function(T){A(this.promise,this.onRejected,T)};function A(T,O,k){a(function(){var z;try{z=O(k)}catch(B){return u.reject(T,B)}z===T?u.reject(T,new TypeError("Cannot resolve promise with itself")):u.resolve(T,z)})}u.resolve=function(T,O){var k=b(C,O);if(k.status==="error")return u.reject(T,k.value);var z=k.value;if(z)w(T,z);else{T.state=d,T.outcome=O;for(var B=-1,H=T.queue.length;++B<H;)T.queue[B].callFulfilled(O)}return T},u.reject=function(T,O){T.state=h,T.outcome=O;for(var k=-1,z=T.queue.length;++k<z;)T.queue[k].callRejected(O);return T};function C(T){var O=T&&T.then;if(T&&(typeof T=="object"||typeof T=="function")&&typeof O=="function")return function(){O.apply(T,arguments)}}function w(T,O){var k=!1;function z(Z){k||(k=!0,u.reject(T,Z))}function B(Z){k||(k=!0,u.resolve(T,Z))}function H(){O(B,z)}var V=b(H);V.status==="error"&&z(V.value)}function b(T,O){var k={};try{k.value=T(O),k.status="success"}catch(z){k.status="error",k.value=z}return k}p.resolve=_;function _(T){return T instanceof this?T:u.resolve(new this(o),T)}p.reject=x;function x(T){var O=new this(o);return u.reject(O,T)}p.all=D;function D(T){var O=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=T.length,z=!1;if(!k)return this.resolve([]);for(var B=new Array(k),H=0,V=-1,Z=new this(o);++V<k;)rt(T[V],V);return Z;function rt(ft,mt){O.resolve(ft).then(G,function(W){z||(z=!0,u.reject(Z,W))});function G(W){B[mt]=W,++H===k&&!z&&(z=!0,u.resolve(Z,B))}}}p.race=M;function M(T){var O=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=T.length,z=!1;if(!k)return this.resolve([]);for(var B=-1,H=new this(o);++B<k;)V(T[B]);return H;function V(Z){O.resolve(Z).then(function(rt){z||(z=!0,u.resolve(H,rt))},function(rt){z||(z=!0,u.reject(H,rt))})}}},{immediate:36}],38:[function(e,i,s){var a=e("./lib/utils/common").assign,o=e("./lib/deflate"),u=e("./lib/inflate"),h=e("./lib/zlib/constants"),d={};a(d,o,u,h),i.exports=d},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,i,s){var a=e("./zlib/deflate"),o=e("./utils/common"),u=e("./utils/strings"),h=e("./zlib/messages"),d=e("./zlib/zstream"),f=Object.prototype.toString,p=0,v=4,A=0,C=1,w=2,b=-1,_=0,x=8;function D(k){if(!(this instanceof D))return new D(k);this.options=o.assign({level:b,method:x,chunkSize:16384,windowBits:15,memLevel:8,strategy:_,to:""},k||{});var z=this.options;z.raw&&z.windowBits>0?z.windowBits=-z.windowBits:z.gzip&&z.windowBits>0&&z.windowBits<16&&(z.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new d,this.strm.avail_out=0;var B=a.deflateInit2(this.strm,z.level,z.method,z.windowBits,z.memLevel,z.strategy);if(B!==A)throw new Error(h[B]);if(z.header&&a.deflateSetHeader(this.strm,z.header),z.dictionary){var H;if(typeof z.dictionary=="string"?H=u.string2buf(z.dictionary):f.call(z.dictionary)==="[object ArrayBuffer]"?H=new Uint8Array(z.dictionary):H=z.dictionary,B=a.deflateSetDictionary(this.strm,H),B!==A)throw new Error(h[B]);this._dict_set=!0}}D.prototype.push=function(k,z){var B=this.strm,H=this.options.chunkSize,V,Z;if(this.ended)return!1;Z=z===~~z?z:z===!0?v:p,typeof k=="string"?B.input=u.string2buf(k):f.call(k)==="[object ArrayBuffer]"?B.input=new Uint8Array(k):B.input=k,B.next_in=0,B.avail_in=B.input.length;do{if(B.avail_out===0&&(B.output=new o.Buf8(H),B.next_out=0,B.avail_out=H),V=a.deflate(B,Z),V!==C&&V!==A)return this.onEnd(V),this.ended=!0,!1;(B.avail_out===0||B.avail_in===0&&(Z===v||Z===w))&&(this.options.to==="string"?this.onData(u.buf2binstring(o.shrinkBuf(B.output,B.next_out))):this.onData(o.shrinkBuf(B.output,B.next_out)))}while((B.avail_in>0||B.avail_out===0)&&V!==C);return Z===v?(V=a.deflateEnd(this.strm),this.onEnd(V),this.ended=!0,V===A):(Z===w&&(this.onEnd(A),B.avail_out=0),!0)},D.prototype.onData=function(k){this.chunks.push(k)},D.prototype.onEnd=function(k){k===A&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=k,this.msg=this.strm.msg};function M(k,z){var B=new D(z);if(B.push(k,!0),B.err)throw B.msg||h[B.err];return B.result}function T(k,z){return z=z||{},z.raw=!0,M(k,z)}function O(k,z){return z=z||{},z.gzip=!0,M(k,z)}s.Deflate=D,s.deflate=M,s.deflateRaw=T,s.gzip=O},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,i,s){var a=e("./zlib/inflate"),o=e("./utils/common"),u=e("./utils/strings"),h=e("./zlib/constants"),d=e("./zlib/messages"),f=e("./zlib/zstream"),p=e("./zlib/gzheader"),v=Object.prototype.toString;function A(b){if(!(this instanceof A))return new A(b);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},b||{});var _=this.options;_.raw&&_.windowBits>=0&&_.windowBits<16&&(_.windowBits=-_.windowBits,_.windowBits===0&&(_.windowBits=-15)),_.windowBits>=0&&_.windowBits<16&&!(b&&b.windowBits)&&(_.windowBits+=32),_.windowBits>15&&_.windowBits<48&&(_.windowBits&15)===0&&(_.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new f,this.strm.avail_out=0;var x=a.inflateInit2(this.strm,_.windowBits);if(x!==h.Z_OK)throw new Error(d[x]);this.header=new p,a.inflateGetHeader(this.strm,this.header)}A.prototype.push=function(b,_){var x=this.strm,D=this.options.chunkSize,M=this.options.dictionary,T,O,k,z,B,H,V=!1;if(this.ended)return!1;O=_===~~_?_:_===!0?h.Z_FINISH:h.Z_NO_FLUSH,typeof b=="string"?x.input=u.binstring2buf(b):v.call(b)==="[object ArrayBuffer]"?x.input=new Uint8Array(b):x.input=b,x.next_in=0,x.avail_in=x.input.length;do{if(x.avail_out===0&&(x.output=new o.Buf8(D),x.next_out=0,x.avail_out=D),T=a.inflate(x,h.Z_NO_FLUSH),T===h.Z_NEED_DICT&&M&&(typeof M=="string"?H=u.string2buf(M):v.call(M)==="[object ArrayBuffer]"?H=new Uint8Array(M):H=M,T=a.inflateSetDictionary(this.strm,H)),T===h.Z_BUF_ERROR&&V===!0&&(T=h.Z_OK,V=!1),T!==h.Z_STREAM_END&&T!==h.Z_OK)return this.onEnd(T),this.ended=!0,!1;x.next_out&&(x.avail_out===0||T===h.Z_STREAM_END||x.avail_in===0&&(O===h.Z_FINISH||O===h.Z_SYNC_FLUSH))&&(this.options.to==="string"?(k=u.utf8border(x.output,x.next_out),z=x.next_out-k,B=u.buf2string(x.output,k),x.next_out=z,x.avail_out=D-z,z&&o.arraySet(x.output,x.output,k,z,0),this.onData(B)):this.onData(o.shrinkBuf(x.output,x.next_out))),x.avail_in===0&&x.avail_out===0&&(V=!0)}while((x.avail_in>0||x.avail_out===0)&&T!==h.Z_STREAM_END);return T===h.Z_STREAM_END&&(O=h.Z_FINISH),O===h.Z_FINISH?(T=a.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===h.Z_OK):(O===h.Z_SYNC_FLUSH&&(this.onEnd(h.Z_OK),x.avail_out=0),!0)},A.prototype.onData=function(b){this.chunks.push(b)},A.prototype.onEnd=function(b){b===h.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg};function C(b,_){var x=new A(_);if(x.push(b,!0),x.err)throw x.msg||d[x.err];return x.result}function w(b,_){return _=_||{},_.raw=!0,C(b,_)}s.Inflate=A,s.inflate=C,s.inflateRaw=w,s.ungzip=C},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,i,s){var a=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(h){for(var d=Array.prototype.slice.call(arguments,1);d.length;){var f=d.shift();if(f){if(typeof f!="object")throw new TypeError(f+"must be non-object");for(var p in f)f.hasOwnProperty(p)&&(h[p]=f[p])}}return h},s.shrinkBuf=function(h,d){return h.length===d?h:h.subarray?h.subarray(0,d):(h.length=d,h)};var o={arraySet:function(h,d,f,p,v){if(d.subarray&&h.subarray){h.set(d.subarray(f,f+p),v);return}for(var A=0;A<p;A++)h[v+A]=d[f+A]},flattenChunks:function(h){var d,f,p,v,A,C;for(p=0,d=0,f=h.length;d<f;d++)p+=h[d].length;for(C=new Uint8Array(p),v=0,d=0,f=h.length;d<f;d++)A=h[d],C.set(A,v),v+=A.length;return C}},u={arraySet:function(h,d,f,p,v){for(var A=0;A<p;A++)h[v+A]=d[f+A]},flattenChunks:function(h){return[].concat.apply([],h)}};s.setTyped=function(h){h?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,u))},s.setTyped(a)},{}],42:[function(e,i,s){var a=e("./common"),o=!0,u=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{u=!1}for(var h=new a.Buf8(256),d=0;d<256;d++)h[d]=d>=252?6:d>=248?5:d>=240?4:d>=224?3:d>=192?2:1;h[254]=h[254]=1,s.string2buf=function(p){var v,A,C,w,b,_=p.length,x=0;for(w=0;w<_;w++)A=p.charCodeAt(w),(A&64512)===55296&&w+1<_&&(C=p.charCodeAt(w+1),(C&64512)===56320&&(A=65536+(A-55296<<10)+(C-56320),w++)),x+=A<128?1:A<2048?2:A<65536?3:4;for(v=new a.Buf8(x),b=0,w=0;b<x;w++)A=p.charCodeAt(w),(A&64512)===55296&&w+1<_&&(C=p.charCodeAt(w+1),(C&64512)===56320&&(A=65536+(A-55296<<10)+(C-56320),w++)),A<128?v[b++]=A:A<2048?(v[b++]=192|A>>>6,v[b++]=128|A&63):A<65536?(v[b++]=224|A>>>12,v[b++]=128|A>>>6&63,v[b++]=128|A&63):(v[b++]=240|A>>>18,v[b++]=128|A>>>12&63,v[b++]=128|A>>>6&63,v[b++]=128|A&63);return v};function f(p,v){if(v<65537&&(p.subarray&&u||!p.subarray&&o))return String.fromCharCode.apply(null,a.shrinkBuf(p,v));for(var A="",C=0;C<v;C++)A+=String.fromCharCode(p[C]);return A}s.buf2binstring=function(p){return f(p,p.length)},s.binstring2buf=function(p){for(var v=new a.Buf8(p.length),A=0,C=v.length;A<C;A++)v[A]=p.charCodeAt(A);return v},s.buf2string=function(p,v){var A,C,w,b,_=v||p.length,x=new Array(_*2);for(C=0,A=0;A<_;){if(w=p[A++],w<128){x[C++]=w;continue}if(b=h[w],b>4){x[C++]=65533,A+=b-1;continue}for(w&=b===2?31:b===3?15:7;b>1&&A<_;)w=w<<6|p[A++]&63,b--;if(b>1){x[C++]=65533;continue}w<65536?x[C++]=w:(w-=65536,x[C++]=55296|w>>10&1023,x[C++]=56320|w&1023)}return f(x,C)},s.utf8border=function(p,v){var A;for(v=v||p.length,v>p.length&&(v=p.length),A=v-1;A>=0&&(p[A]&192)===128;)A--;return A<0||A===0?v:A+h[p[A]]>v?A:v}},{"./common":41}],43:[function(e,i,s){function a(o,u,h,d){for(var f=o&65535|0,p=o>>>16&65535|0,v=0;h!==0;){v=h>2e3?2e3:h,h-=v;do f=f+u[d++]|0,p=p+f|0;while(--v);f%=65521,p%=65521}return f|p<<16|0}i.exports=a},{}],44:[function(e,i,s){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,i,s){function a(){for(var h,d=[],f=0;f<256;f++){h=f;for(var p=0;p<8;p++)h=h&1?3988292384^h>>>1:h>>>1;d[f]=h}return d}var o=a();function u(h,d,f,p){var v=o,A=p+f;h^=-1;for(var C=p;C<A;C++)h=h>>>8^v[(h^d[C])&255];return h^-1}i.exports=u},{}],46:[function(e,i,s){var a=e("../utils/common"),o=e("./trees"),u=e("./adler32"),h=e("./crc32"),d=e("./messages"),f=0,p=1,v=3,A=4,C=5,w=0,b=1,_=-2,x=-3,D=-5,M=-1,T=1,O=2,k=3,z=4,B=0,H=2,V=8,Z=9,rt=15,ft=8,mt=29,G=256,W=G+1+mt,st=30,bt=19,Nt=2*W+1,j=15,$=3,gt=258,yt=gt+$+1,Dt=32,zt=42,kt=69,Lt=73,Gt=91,ye=103,Yt=113,ee=666,ie=1,ne=2,Re=3,be=4,fe=3;function Ve(S,it){return S.msg=d[it],it}function Je(S){return(S<<1)-(S>4?9:0)}function Ke(S){for(var it=S.length;--it>=0;)S[it]=0}function Wt(S){var it=S.state,lt=it.pending;lt>S.avail_out&&(lt=S.avail_out),lt!==0&&(a.arraySet(S.output,it.pending_buf,it.pending_out,lt,S.next_out),S.next_out+=lt,it.pending_out+=lt,S.total_out+=lt,S.avail_out-=lt,it.pending-=lt,it.pending===0&&(it.pending_out=0))}function Jt(S,it){o._tr_flush_block(S,S.block_start>=0?S.block_start:-1,S.strstart-S.block_start,it),S.block_start=S.strstart,Wt(S.strm)}function Kt(S,it){S.pending_buf[S.pending++]=it}function De(S,it){S.pending_buf[S.pending++]=it>>>8&255,S.pending_buf[S.pending++]=it&255}function Wi(S,it,lt,L){var Y=S.avail_in;return Y>L&&(Y=L),Y===0?0:(S.avail_in-=Y,a.arraySet(it,S.input,S.next_in,Y,lt),S.state.wrap===1?S.adler=u(S.adler,it,Y,lt):S.state.wrap===2&&(S.adler=h(S.adler,it,Y,lt)),S.next_in+=Y,S.total_in+=Y,Y)}function Di(S,it){var lt=S.max_chain_length,L=S.strstart,Y,ut,Ft=S.prev_length,Ot=S.nice_match,Mt=S.strstart>S.w_size-yt?S.strstart-(S.w_size-yt):0,$t=S.window,Ze=S.w_mask,we=S.prev,se=S.strstart+gt,Qt=$t[L+Ft-1],de=$t[L+Ft];S.prev_length>=S.good_match&&(lt>>=2),Ot>S.lookahead&&(Ot=S.lookahead);do if(Y=it,!($t[Y+Ft]!==de||$t[Y+Ft-1]!==Qt||$t[Y]!==$t[L]||$t[++Y]!==$t[L+1])){L+=2,Y++;do;while($t[++L]===$t[++Y]&&$t[++L]===$t[++Y]&&$t[++L]===$t[++Y]&&$t[++L]===$t[++Y]&&$t[++L]===$t[++Y]&&$t[++L]===$t[++Y]&&$t[++L]===$t[++Y]&&$t[++L]===$t[++Y]&&L<se);if(ut=gt-(se-L),L=se-gt,ut>Ft){if(S.match_start=it,Ft=ut,ut>=Ot)break;Qt=$t[L+Ft-1],de=$t[L+Ft]}}while((it=we[it&Ze])>Mt&&--lt!==0);return Ft<=S.lookahead?Ft:S.lookahead}function si(S){var it=S.w_size,lt,L,Y,ut,Ft;do{if(ut=S.window_size-S.lookahead-S.strstart,S.strstart>=it+(it-yt)){a.arraySet(S.window,S.window,it,it,0),S.match_start-=it,S.strstart-=it,S.block_start-=it,L=S.hash_size,lt=L;do Y=S.head[--lt],S.head[lt]=Y>=it?Y-it:0;while(--L);L=it,lt=L;do Y=S.prev[--lt],S.prev[lt]=Y>=it?Y-it:0;while(--L);ut+=it}if(S.strm.avail_in===0)break;if(L=Wi(S.strm,S.window,S.strstart+S.lookahead,ut),S.lookahead+=L,S.lookahead+S.insert>=$)for(Ft=S.strstart-S.insert,S.ins_h=S.window[Ft],S.ins_h=(S.ins_h<<S.hash_shift^S.window[Ft+1])&S.hash_mask;S.insert&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[Ft+$-1])&S.hash_mask,S.prev[Ft&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=Ft,Ft++,S.insert--,!(S.lookahead+S.insert<$)););}while(S.lookahead<yt&&S.strm.avail_in!==0)}function ki(S,it){var lt=65535;for(lt>S.pending_buf_size-5&&(lt=S.pending_buf_size-5);;){if(S.lookahead<=1){if(si(S),S.lookahead===0&&it===f)return ie;if(S.lookahead===0)break}S.strstart+=S.lookahead,S.lookahead=0;var L=S.block_start+lt;if((S.strstart===0||S.strstart>=L)&&(S.lookahead=S.strstart-L,S.strstart=L,Jt(S,!1),S.strm.avail_out===0)||S.strstart-S.block_start>=S.w_size-yt&&(Jt(S,!1),S.strm.avail_out===0))return ie}return S.insert=0,it===A?(Jt(S,!0),S.strm.avail_out===0?Re:be):(S.strstart>S.block_start&&(Jt(S,!1),S.strm.avail_out===0),ie)}function ji(S,it){for(var lt,L;;){if(S.lookahead<yt){if(si(S),S.lookahead<yt&&it===f)return ie;if(S.lookahead===0)break}if(lt=0,S.lookahead>=$&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+$-1])&S.hash_mask,lt=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),lt!==0&&S.strstart-lt<=S.w_size-yt&&(S.match_length=Di(S,lt)),S.match_length>=$)if(L=o._tr_tally(S,S.strstart-S.match_start,S.match_length-$),S.lookahead-=S.match_length,S.match_length<=S.max_lazy_match&&S.lookahead>=$){S.match_length--;do S.strstart++,S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+$-1])&S.hash_mask,lt=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart;while(--S.match_length!==0);S.strstart++}else S.strstart+=S.match_length,S.match_length=0,S.ins_h=S.window[S.strstart],S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+1])&S.hash_mask;else L=o._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++;if(L&&(Jt(S,!1),S.strm.avail_out===0))return ie}return S.insert=S.strstart<$-1?S.strstart:$-1,it===A?(Jt(S,!0),S.strm.avail_out===0?Re:be):S.last_lit&&(Jt(S,!1),S.strm.avail_out===0)?ie:ne}function fi(S,it){for(var lt,L,Y;;){if(S.lookahead<yt){if(si(S),S.lookahead<yt&&it===f)return ie;if(S.lookahead===0)break}if(lt=0,S.lookahead>=$&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+$-1])&S.hash_mask,lt=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart),S.prev_length=S.match_length,S.prev_match=S.match_start,S.match_length=$-1,lt!==0&&S.prev_length<S.max_lazy_match&&S.strstart-lt<=S.w_size-yt&&(S.match_length=Di(S,lt),S.match_length<=5&&(S.strategy===T||S.match_length===$&&S.strstart-S.match_start>4096)&&(S.match_length=$-1)),S.prev_length>=$&&S.match_length<=S.prev_length){Y=S.strstart+S.lookahead-$,L=o._tr_tally(S,S.strstart-1-S.prev_match,S.prev_length-$),S.lookahead-=S.prev_length-1,S.prev_length-=2;do++S.strstart<=Y&&(S.ins_h=(S.ins_h<<S.hash_shift^S.window[S.strstart+$-1])&S.hash_mask,lt=S.prev[S.strstart&S.w_mask]=S.head[S.ins_h],S.head[S.ins_h]=S.strstart);while(--S.prev_length!==0);if(S.match_available=0,S.match_length=$-1,S.strstart++,L&&(Jt(S,!1),S.strm.avail_out===0))return ie}else if(S.match_available){if(L=o._tr_tally(S,0,S.window[S.strstart-1]),L&&Jt(S,!1),S.strstart++,S.lookahead--,S.strm.avail_out===0)return ie}else S.match_available=1,S.strstart++,S.lookahead--}return S.match_available&&(L=o._tr_tally(S,0,S.window[S.strstart-1]),S.match_available=0),S.insert=S.strstart<$-1?S.strstart:$-1,it===A?(Jt(S,!0),S.strm.avail_out===0?Re:be):S.last_lit&&(Jt(S,!1),S.strm.avail_out===0)?ie:ne}function qi(S,it){for(var lt,L,Y,ut,Ft=S.window;;){if(S.lookahead<=gt){if(si(S),S.lookahead<=gt&&it===f)return ie;if(S.lookahead===0)break}if(S.match_length=0,S.lookahead>=$&&S.strstart>0&&(Y=S.strstart-1,L=Ft[Y],L===Ft[++Y]&&L===Ft[++Y]&&L===Ft[++Y])){ut=S.strstart+gt;do;while(L===Ft[++Y]&&L===Ft[++Y]&&L===Ft[++Y]&&L===Ft[++Y]&&L===Ft[++Y]&&L===Ft[++Y]&&L===Ft[++Y]&&L===Ft[++Y]&&Y<ut);S.match_length=gt-(ut-Y),S.match_length>S.lookahead&&(S.match_length=S.lookahead)}if(S.match_length>=$?(lt=o._tr_tally(S,1,S.match_length-$),S.lookahead-=S.match_length,S.strstart+=S.match_length,S.match_length=0):(lt=o._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++),lt&&(Jt(S,!1),S.strm.avail_out===0))return ie}return S.insert=0,it===A?(Jt(S,!0),S.strm.avail_out===0?Re:be):S.last_lit&&(Jt(S,!1),S.strm.avail_out===0)?ie:ne}function Mi(S,it){for(var lt;;){if(S.lookahead===0&&(si(S),S.lookahead===0)){if(it===f)return ie;break}if(S.match_length=0,lt=o._tr_tally(S,0,S.window[S.strstart]),S.lookahead--,S.strstart++,lt&&(Jt(S,!1),S.strm.avail_out===0))return ie}return S.insert=0,it===A?(Jt(S,!0),S.strm.avail_out===0?Re:be):S.last_lit&&(Jt(S,!1),S.strm.avail_out===0)?ie:ne}function Pe(S,it,lt,L,Y){this.good_length=S,this.max_lazy=it,this.nice_length=lt,this.max_chain=L,this.func=Y}var Me;Me=[new Pe(0,0,0,0,ki),new Pe(4,4,8,4,ji),new Pe(4,5,16,8,ji),new Pe(4,6,32,32,ji),new Pe(4,4,16,16,fi),new Pe(8,16,32,32,fi),new Pe(8,16,128,128,fi),new Pe(8,32,128,256,fi),new Pe(32,128,258,1024,fi),new Pe(32,258,258,4096,fi)];function yi(S){S.window_size=2*S.w_size,Ke(S.head),S.max_lazy_match=Me[S.level].max_lazy,S.good_match=Me[S.level].good_length,S.nice_match=Me[S.level].nice_length,S.max_chain_length=Me[S.level].max_chain,S.strstart=0,S.block_start=0,S.lookahead=0,S.insert=0,S.match_length=S.prev_length=$-1,S.match_available=0,S.ins_h=0}function U(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=V,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(Nt*2),this.dyn_dtree=new a.Buf16((2*st+1)*2),this.bl_tree=new a.Buf16((2*bt+1)*2),Ke(this.dyn_ltree),Ke(this.dyn_dtree),Ke(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(j+1),this.heap=new a.Buf16(2*W+1),Ke(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*W+1),Ke(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Et(S){var it;return!S||!S.state?Ve(S,_):(S.total_in=S.total_out=0,S.data_type=H,it=S.state,it.pending=0,it.pending_out=0,it.wrap<0&&(it.wrap=-it.wrap),it.status=it.wrap?zt:Yt,S.adler=it.wrap===2?0:1,it.last_flush=f,o._tr_init(it),w)}function Ct(S){var it=Et(S);return it===w&&yi(S.state),it}function It(S,it){return!S||!S.state||S.state.wrap!==2?_:(S.state.gzhead=it,w)}function Q(S,it,lt,L,Y,ut){if(!S)return _;var Ft=1;if(it===M&&(it=6),L<0?(Ft=0,L=-L):L>15&&(Ft=2,L-=16),Y<1||Y>Z||lt!==V||L<8||L>15||it<0||it>9||ut<0||ut>z)return Ve(S,_);L===8&&(L=9);var Ot=new U;return S.state=Ot,Ot.strm=S,Ot.wrap=Ft,Ot.gzhead=null,Ot.w_bits=L,Ot.w_size=1<<Ot.w_bits,Ot.w_mask=Ot.w_size-1,Ot.hash_bits=Y+7,Ot.hash_size=1<<Ot.hash_bits,Ot.hash_mask=Ot.hash_size-1,Ot.hash_shift=~~((Ot.hash_bits+$-1)/$),Ot.window=new a.Buf8(Ot.w_size*2),Ot.head=new a.Buf16(Ot.hash_size),Ot.prev=new a.Buf16(Ot.w_size),Ot.lit_bufsize=1<<Y+6,Ot.pending_buf_size=Ot.lit_bufsize*4,Ot.pending_buf=new a.Buf8(Ot.pending_buf_size),Ot.d_buf=1*Ot.lit_bufsize,Ot.l_buf=3*Ot.lit_bufsize,Ot.level=it,Ot.strategy=ut,Ot.method=lt,Ct(S)}function N(S,it){return Q(S,it,V,rt,ft,B)}function E(S,it){var lt,L,Y,ut;if(!S||!S.state||it>C||it<0)return S?Ve(S,_):_;if(L=S.state,!S.output||!S.input&&S.avail_in!==0||L.status===ee&&it!==A)return Ve(S,S.avail_out===0?D:_);if(L.strm=S,lt=L.last_flush,L.last_flush=it,L.status===zt)if(L.wrap===2)S.adler=0,Kt(L,31),Kt(L,139),Kt(L,8),L.gzhead?(Kt(L,(L.gzhead.text?1:0)+(L.gzhead.hcrc?2:0)+(L.gzhead.extra?4:0)+(L.gzhead.name?8:0)+(L.gzhead.comment?16:0)),Kt(L,L.gzhead.time&255),Kt(L,L.gzhead.time>>8&255),Kt(L,L.gzhead.time>>16&255),Kt(L,L.gzhead.time>>24&255),Kt(L,L.level===9?2:L.strategy>=O||L.level<2?4:0),Kt(L,L.gzhead.os&255),L.gzhead.extra&&L.gzhead.extra.length&&(Kt(L,L.gzhead.extra.length&255),Kt(L,L.gzhead.extra.length>>8&255)),L.gzhead.hcrc&&(S.adler=h(S.adler,L.pending_buf,L.pending,0)),L.gzindex=0,L.status=kt):(Kt(L,0),Kt(L,0),Kt(L,0),Kt(L,0),Kt(L,0),Kt(L,L.level===9?2:L.strategy>=O||L.level<2?4:0),Kt(L,fe),L.status=Yt);else{var Ft=V+(L.w_bits-8<<4)<<8,Ot=-1;L.strategy>=O||L.level<2?Ot=0:L.level<6?Ot=1:L.level===6?Ot=2:Ot=3,Ft|=Ot<<6,L.strstart!==0&&(Ft|=Dt),Ft+=31-Ft%31,L.status=Yt,De(L,Ft),L.strstart!==0&&(De(L,S.adler>>>16),De(L,S.adler&65535)),S.adler=1}if(L.status===kt)if(L.gzhead.extra){for(Y=L.pending;L.gzindex<(L.gzhead.extra.length&65535)&&!(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>Y&&(S.adler=h(S.adler,L.pending_buf,L.pending-Y,Y)),Wt(S),Y=L.pending,L.pending===L.pending_buf_size));)Kt(L,L.gzhead.extra[L.gzindex]&255),L.gzindex++;L.gzhead.hcrc&&L.pending>Y&&(S.adler=h(S.adler,L.pending_buf,L.pending-Y,Y)),L.gzindex===L.gzhead.extra.length&&(L.gzindex=0,L.status=Lt)}else L.status=Lt;if(L.status===Lt)if(L.gzhead.name){Y=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>Y&&(S.adler=h(S.adler,L.pending_buf,L.pending-Y,Y)),Wt(S),Y=L.pending,L.pending===L.pending_buf_size)){ut=1;break}L.gzindex<L.gzhead.name.length?ut=L.gzhead.name.charCodeAt(L.gzindex++)&255:ut=0,Kt(L,ut)}while(ut!==0);L.gzhead.hcrc&&L.pending>Y&&(S.adler=h(S.adler,L.pending_buf,L.pending-Y,Y)),ut===0&&(L.gzindex=0,L.status=Gt)}else L.status=Gt;if(L.status===Gt)if(L.gzhead.comment){Y=L.pending;do{if(L.pending===L.pending_buf_size&&(L.gzhead.hcrc&&L.pending>Y&&(S.adler=h(S.adler,L.pending_buf,L.pending-Y,Y)),Wt(S),Y=L.pending,L.pending===L.pending_buf_size)){ut=1;break}L.gzindex<L.gzhead.comment.length?ut=L.gzhead.comment.charCodeAt(L.gzindex++)&255:ut=0,Kt(L,ut)}while(ut!==0);L.gzhead.hcrc&&L.pending>Y&&(S.adler=h(S.adler,L.pending_buf,L.pending-Y,Y)),ut===0&&(L.status=ye)}else L.status=ye;if(L.status===ye&&(L.gzhead.hcrc?(L.pending+2>L.pending_buf_size&&Wt(S),L.pending+2<=L.pending_buf_size&&(Kt(L,S.adler&255),Kt(L,S.adler>>8&255),S.adler=0,L.status=Yt)):L.status=Yt),L.pending!==0){if(Wt(S),S.avail_out===0)return L.last_flush=-1,w}else if(S.avail_in===0&&Je(it)<=Je(lt)&&it!==A)return Ve(S,D);if(L.status===ee&&S.avail_in!==0)return Ve(S,D);if(S.avail_in!==0||L.lookahead!==0||it!==f&&L.status!==ee){var Mt=L.strategy===O?Mi(L,it):L.strategy===k?qi(L,it):Me[L.level].func(L,it);if((Mt===Re||Mt===be)&&(L.status=ee),Mt===ie||Mt===Re)return S.avail_out===0&&(L.last_flush=-1),w;if(Mt===ne&&(it===p?o._tr_align(L):it!==C&&(o._tr_stored_block(L,0,0,!1),it===v&&(Ke(L.head),L.lookahead===0&&(L.strstart=0,L.block_start=0,L.insert=0))),Wt(S),S.avail_out===0))return L.last_flush=-1,w}return it!==A?w:L.wrap<=0?b:(L.wrap===2?(Kt(L,S.adler&255),Kt(L,S.adler>>8&255),Kt(L,S.adler>>16&255),Kt(L,S.adler>>24&255),Kt(L,S.total_in&255),Kt(L,S.total_in>>8&255),Kt(L,S.total_in>>16&255),Kt(L,S.total_in>>24&255)):(De(L,S.adler>>>16),De(L,S.adler&65535)),Wt(S),L.wrap>0&&(L.wrap=-L.wrap),L.pending!==0?w:b)}function F(S){var it;return!S||!S.state?_:(it=S.state.status,it!==zt&&it!==kt&&it!==Lt&&it!==Gt&&it!==ye&&it!==Yt&&it!==ee?Ve(S,_):(S.state=null,it===Yt?Ve(S,x):w))}function tt(S,it){var lt=it.length,L,Y,ut,Ft,Ot,Mt,$t,Ze;if(!S||!S.state||(L=S.state,Ft=L.wrap,Ft===2||Ft===1&&L.status!==zt||L.lookahead))return _;for(Ft===1&&(S.adler=u(S.adler,it,lt,0)),L.wrap=0,lt>=L.w_size&&(Ft===0&&(Ke(L.head),L.strstart=0,L.block_start=0,L.insert=0),Ze=new a.Buf8(L.w_size),a.arraySet(Ze,it,lt-L.w_size,L.w_size,0),it=Ze,lt=L.w_size),Ot=S.avail_in,Mt=S.next_in,$t=S.input,S.avail_in=lt,S.next_in=0,S.input=it,si(L);L.lookahead>=$;){Y=L.strstart,ut=L.lookahead-($-1);do L.ins_h=(L.ins_h<<L.hash_shift^L.window[Y+$-1])&L.hash_mask,L.prev[Y&L.w_mask]=L.head[L.ins_h],L.head[L.ins_h]=Y,Y++;while(--ut);L.strstart=Y,L.lookahead=$-1,si(L)}return L.strstart+=L.lookahead,L.block_start=L.strstart,L.insert=L.lookahead,L.lookahead=0,L.match_length=L.prev_length=$-1,L.match_available=0,S.next_in=Mt,S.input=$t,S.avail_in=Ot,L.wrap=Ft,w}s.deflateInit=N,s.deflateInit2=Q,s.deflateReset=Ct,s.deflateResetKeep=Et,s.deflateSetHeader=It,s.deflate=E,s.deflateEnd=F,s.deflateSetDictionary=tt,s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,i,s){function a(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}i.exports=a},{}],48:[function(e,i,s){var a=30,o=12;i.exports=function(h,d){var f,p,v,A,C,w,b,_,x,D,M,T,O,k,z,B,H,V,Z,rt,ft,mt,G,W,st;f=h.state,p=h.next_in,W=h.input,v=p+(h.avail_in-5),A=h.next_out,st=h.output,C=A-(d-h.avail_out),w=A+(h.avail_out-257),b=f.dmax,_=f.wsize,x=f.whave,D=f.wnext,M=f.window,T=f.hold,O=f.bits,k=f.lencode,z=f.distcode,B=(1<<f.lenbits)-1,H=(1<<f.distbits)-1;t:do{O<15&&(T+=W[p++]<<O,O+=8,T+=W[p++]<<O,O+=8),V=k[T&B];e:for(;;){if(Z=V>>>24,T>>>=Z,O-=Z,Z=V>>>16&255,Z===0)st[A++]=V&65535;else if(Z&16){rt=V&65535,Z&=15,Z&&(O<Z&&(T+=W[p++]<<O,O+=8),rt+=T&(1<<Z)-1,T>>>=Z,O-=Z),O<15&&(T+=W[p++]<<O,O+=8,T+=W[p++]<<O,O+=8),V=z[T&H];i:for(;;){if(Z=V>>>24,T>>>=Z,O-=Z,Z=V>>>16&255,Z&16){if(ft=V&65535,Z&=15,O<Z&&(T+=W[p++]<<O,O+=8,O<Z&&(T+=W[p++]<<O,O+=8)),ft+=T&(1<<Z)-1,ft>b){h.msg="invalid distance too far back",f.mode=a;break t}if(T>>>=Z,O-=Z,Z=A-C,ft>Z){if(Z=ft-Z,Z>x&&f.sane){h.msg="invalid distance too far back",f.mode=a;break t}if(mt=0,G=M,D===0){if(mt+=_-Z,Z<rt){rt-=Z;do st[A++]=M[mt++];while(--Z);mt=A-ft,G=st}}else if(D<Z){if(mt+=_+D-Z,Z-=D,Z<rt){rt-=Z;do st[A++]=M[mt++];while(--Z);if(mt=0,D<rt){Z=D,rt-=Z;do st[A++]=M[mt++];while(--Z);mt=A-ft,G=st}}}else if(mt+=D-Z,Z<rt){rt-=Z;do st[A++]=M[mt++];while(--Z);mt=A-ft,G=st}for(;rt>2;)st[A++]=G[mt++],st[A++]=G[mt++],st[A++]=G[mt++],rt-=3;rt&&(st[A++]=G[mt++],rt>1&&(st[A++]=G[mt++]))}else{mt=A-ft;do st[A++]=st[mt++],st[A++]=st[mt++],st[A++]=st[mt++],rt-=3;while(rt>2);rt&&(st[A++]=st[mt++],rt>1&&(st[A++]=st[mt++]))}}else if((Z&64)===0){V=z[(V&65535)+(T&(1<<Z)-1)];continue i}else{h.msg="invalid distance code",f.mode=a;break t}break}}else if((Z&64)===0){V=k[(V&65535)+(T&(1<<Z)-1)];continue e}else if(Z&32){f.mode=o;break t}else{h.msg="invalid literal/length code",f.mode=a;break t}break}}while(p<v&&A<w);rt=O>>3,p-=rt,O-=rt<<3,T&=(1<<O)-1,h.next_in=p,h.next_out=A,h.avail_in=p<v?5+(v-p):5-(p-v),h.avail_out=A<w?257+(w-A):257-(A-w),f.hold=T,f.bits=O}},{}],49:[function(e,i,s){var a=e("../utils/common"),o=e("./adler32"),u=e("./crc32"),h=e("./inffast"),d=e("./inftrees"),f=0,p=1,v=2,A=4,C=5,w=6,b=0,_=1,x=2,D=-2,M=-3,T=-4,O=-5,k=8,z=1,B=2,H=3,V=4,Z=5,rt=6,ft=7,mt=8,G=9,W=10,st=11,bt=12,Nt=13,j=14,$=15,gt=16,yt=17,Dt=18,zt=19,kt=20,Lt=21,Gt=22,ye=23,Yt=24,ee=25,ie=26,ne=27,Re=28,be=29,fe=30,Ve=31,Je=32,Ke=852,Wt=592,Jt=15,Kt=Jt;function De(Q){return(Q>>>24&255)+(Q>>>8&65280)+((Q&65280)<<8)+((Q&255)<<24)}function Wi(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new a.Buf16(320),this.work=new a.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Di(Q){var N;return!Q||!Q.state?D:(N=Q.state,Q.total_in=Q.total_out=N.total=0,Q.msg="",N.wrap&&(Q.adler=N.wrap&1),N.mode=z,N.last=0,N.havedict=0,N.dmax=32768,N.head=null,N.hold=0,N.bits=0,N.lencode=N.lendyn=new a.Buf32(Ke),N.distcode=N.distdyn=new a.Buf32(Wt),N.sane=1,N.back=-1,b)}function si(Q){var N;return!Q||!Q.state?D:(N=Q.state,N.wsize=0,N.whave=0,N.wnext=0,Di(Q))}function ki(Q,N){var E,F;return!Q||!Q.state||(F=Q.state,N<0?(E=0,N=-N):(E=(N>>4)+1,N<48&&(N&=15)),N&&(N<8||N>15))?D:(F.window!==null&&F.wbits!==N&&(F.window=null),F.wrap=E,F.wbits=N,si(Q))}function ji(Q,N){var E,F;return Q?(F=new Wi,Q.state=F,F.window=null,E=ki(Q,N),E!==b&&(Q.state=null),E):D}function fi(Q){return ji(Q,Kt)}var qi=!0,Mi,Pe;function Me(Q){if(qi){var N;for(Mi=new a.Buf32(512),Pe=new a.Buf32(32),N=0;N<144;)Q.lens[N++]=8;for(;N<256;)Q.lens[N++]=9;for(;N<280;)Q.lens[N++]=7;for(;N<288;)Q.lens[N++]=8;for(d(p,Q.lens,0,288,Mi,0,Q.work,{bits:9}),N=0;N<32;)Q.lens[N++]=5;d(v,Q.lens,0,32,Pe,0,Q.work,{bits:5}),qi=!1}Q.lencode=Mi,Q.lenbits=9,Q.distcode=Pe,Q.distbits=5}function yi(Q,N,E,F){var tt,S=Q.state;return S.window===null&&(S.wsize=1<<S.wbits,S.wnext=0,S.whave=0,S.window=new a.Buf8(S.wsize)),F>=S.wsize?(a.arraySet(S.window,N,E-S.wsize,S.wsize,0),S.wnext=0,S.whave=S.wsize):(tt=S.wsize-S.wnext,tt>F&&(tt=F),a.arraySet(S.window,N,E-F,tt,S.wnext),F-=tt,F?(a.arraySet(S.window,N,E-F,F,0),S.wnext=F,S.whave=S.wsize):(S.wnext+=tt,S.wnext===S.wsize&&(S.wnext=0),S.whave<S.wsize&&(S.whave+=tt))),0}function U(Q,N){var E,F,tt,S,it,lt,L,Y,ut,Ft,Ot,Mt,$t,Ze,we=0,se,Qt,de,pe,Gi,Yn,ti,Vi,li=new a.Buf8(4),Li,Xi,zn=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!Q||!Q.state||!Q.output||!Q.input&&Q.avail_in!==0)return D;E=Q.state,E.mode===bt&&(E.mode=Nt),it=Q.next_out,tt=Q.output,L=Q.avail_out,S=Q.next_in,F=Q.input,lt=Q.avail_in,Y=E.hold,ut=E.bits,Ft=lt,Ot=L,Vi=b;t:for(;;)switch(E.mode){case z:if(E.wrap===0){E.mode=Nt;break}for(;ut<16;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(E.wrap&2&&Y===35615){E.check=0,li[0]=Y&255,li[1]=Y>>>8&255,E.check=u(E.check,li,2,0),Y=0,ut=0,E.mode=B;break}if(E.flags=0,E.head&&(E.head.done=!1),!(E.wrap&1)||(((Y&255)<<8)+(Y>>8))%31){Q.msg="incorrect header check",E.mode=fe;break}if((Y&15)!==k){Q.msg="unknown compression method",E.mode=fe;break}if(Y>>>=4,ut-=4,ti=(Y&15)+8,E.wbits===0)E.wbits=ti;else if(ti>E.wbits){Q.msg="invalid window size",E.mode=fe;break}E.dmax=1<<ti,Q.adler=E.check=1,E.mode=Y&512?W:bt,Y=0,ut=0;break;case B:for(;ut<16;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(E.flags=Y,(E.flags&255)!==k){Q.msg="unknown compression method",E.mode=fe;break}if(E.flags&57344){Q.msg="unknown header flags set",E.mode=fe;break}E.head&&(E.head.text=Y>>8&1),E.flags&512&&(li[0]=Y&255,li[1]=Y>>>8&255,E.check=u(E.check,li,2,0)),Y=0,ut=0,E.mode=H;case H:for(;ut<32;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}E.head&&(E.head.time=Y),E.flags&512&&(li[0]=Y&255,li[1]=Y>>>8&255,li[2]=Y>>>16&255,li[3]=Y>>>24&255,E.check=u(E.check,li,4,0)),Y=0,ut=0,E.mode=V;case V:for(;ut<16;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}E.head&&(E.head.xflags=Y&255,E.head.os=Y>>8),E.flags&512&&(li[0]=Y&255,li[1]=Y>>>8&255,E.check=u(E.check,li,2,0)),Y=0,ut=0,E.mode=Z;case Z:if(E.flags&1024){for(;ut<16;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}E.length=Y,E.head&&(E.head.extra_len=Y),E.flags&512&&(li[0]=Y&255,li[1]=Y>>>8&255,E.check=u(E.check,li,2,0)),Y=0,ut=0}else E.head&&(E.head.extra=null);E.mode=rt;case rt:if(E.flags&1024&&(Mt=E.length,Mt>lt&&(Mt=lt),Mt&&(E.head&&(ti=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),a.arraySet(E.head.extra,F,S,Mt,ti)),E.flags&512&&(E.check=u(E.check,F,Mt,S)),lt-=Mt,S+=Mt,E.length-=Mt),E.length))break t;E.length=0,E.mode=ft;case ft:if(E.flags&2048){if(lt===0)break t;Mt=0;do ti=F[S+Mt++],E.head&&ti&&E.length<65536&&(E.head.name+=String.fromCharCode(ti));while(ti&&Mt<lt);if(E.flags&512&&(E.check=u(E.check,F,Mt,S)),lt-=Mt,S+=Mt,ti)break t}else E.head&&(E.head.name=null);E.length=0,E.mode=mt;case mt:if(E.flags&4096){if(lt===0)break t;Mt=0;do ti=F[S+Mt++],E.head&&ti&&E.length<65536&&(E.head.comment+=String.fromCharCode(ti));while(ti&&Mt<lt);if(E.flags&512&&(E.check=u(E.check,F,Mt,S)),lt-=Mt,S+=Mt,ti)break t}else E.head&&(E.head.comment=null);E.mode=G;case G:if(E.flags&512){for(;ut<16;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(Y!==(E.check&65535)){Q.msg="header crc mismatch",E.mode=fe;break}Y=0,ut=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),Q.adler=E.check=0,E.mode=bt;break;case W:for(;ut<32;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}Q.adler=E.check=De(Y),Y=0,ut=0,E.mode=st;case st:if(E.havedict===0)return Q.next_out=it,Q.avail_out=L,Q.next_in=S,Q.avail_in=lt,E.hold=Y,E.bits=ut,x;Q.adler=E.check=1,E.mode=bt;case bt:if(N===C||N===w)break t;case Nt:if(E.last){Y>>>=ut&7,ut-=ut&7,E.mode=ne;break}for(;ut<3;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}switch(E.last=Y&1,Y>>>=1,ut-=1,Y&3){case 0:E.mode=j;break;case 1:if(Me(E),E.mode=kt,N===w){Y>>>=2,ut-=2;break t}break;case 2:E.mode=yt;break;case 3:Q.msg="invalid block type",E.mode=fe}Y>>>=2,ut-=2;break;case j:for(Y>>>=ut&7,ut-=ut&7;ut<32;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if((Y&65535)!==(Y>>>16^65535)){Q.msg="invalid stored block lengths",E.mode=fe;break}if(E.length=Y&65535,Y=0,ut=0,E.mode=$,N===w)break t;case $:E.mode=gt;case gt:if(Mt=E.length,Mt){if(Mt>lt&&(Mt=lt),Mt>L&&(Mt=L),Mt===0)break t;a.arraySet(tt,F,S,Mt,it),lt-=Mt,S+=Mt,L-=Mt,it+=Mt,E.length-=Mt;break}E.mode=bt;break;case yt:for(;ut<14;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(E.nlen=(Y&31)+257,Y>>>=5,ut-=5,E.ndist=(Y&31)+1,Y>>>=5,ut-=5,E.ncode=(Y&15)+4,Y>>>=4,ut-=4,E.nlen>286||E.ndist>30){Q.msg="too many length or distance symbols",E.mode=fe;break}E.have=0,E.mode=Dt;case Dt:for(;E.have<E.ncode;){for(;ut<3;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}E.lens[zn[E.have++]]=Y&7,Y>>>=3,ut-=3}for(;E.have<19;)E.lens[zn[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,Li={bits:E.lenbits},Vi=d(f,E.lens,0,19,E.lencode,0,E.work,Li),E.lenbits=Li.bits,Vi){Q.msg="invalid code lengths set",E.mode=fe;break}E.have=0,E.mode=zt;case zt:for(;E.have<E.nlen+E.ndist;){for(;we=E.lencode[Y&(1<<E.lenbits)-1],se=we>>>24,Qt=we>>>16&255,de=we&65535,!(se<=ut);){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(de<16)Y>>>=se,ut-=se,E.lens[E.have++]=de;else{if(de===16){for(Xi=se+2;ut<Xi;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(Y>>>=se,ut-=se,E.have===0){Q.msg="invalid bit length repeat",E.mode=fe;break}ti=E.lens[E.have-1],Mt=3+(Y&3),Y>>>=2,ut-=2}else if(de===17){for(Xi=se+3;ut<Xi;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}Y>>>=se,ut-=se,ti=0,Mt=3+(Y&7),Y>>>=3,ut-=3}else{for(Xi=se+7;ut<Xi;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}Y>>>=se,ut-=se,ti=0,Mt=11+(Y&127),Y>>>=7,ut-=7}if(E.have+Mt>E.nlen+E.ndist){Q.msg="invalid bit length repeat",E.mode=fe;break}for(;Mt--;)E.lens[E.have++]=ti}}if(E.mode===fe)break;if(E.lens[256]===0){Q.msg="invalid code -- missing end-of-block",E.mode=fe;break}if(E.lenbits=9,Li={bits:E.lenbits},Vi=d(p,E.lens,0,E.nlen,E.lencode,0,E.work,Li),E.lenbits=Li.bits,Vi){Q.msg="invalid literal/lengths set",E.mode=fe;break}if(E.distbits=6,E.distcode=E.distdyn,Li={bits:E.distbits},Vi=d(v,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,Li),E.distbits=Li.bits,Vi){Q.msg="invalid distances set",E.mode=fe;break}if(E.mode=kt,N===w)break t;case kt:E.mode=Lt;case Lt:if(lt>=6&&L>=258){Q.next_out=it,Q.avail_out=L,Q.next_in=S,Q.avail_in=lt,E.hold=Y,E.bits=ut,h(Q,Ot),it=Q.next_out,tt=Q.output,L=Q.avail_out,S=Q.next_in,F=Q.input,lt=Q.avail_in,Y=E.hold,ut=E.bits,E.mode===bt&&(E.back=-1);break}for(E.back=0;we=E.lencode[Y&(1<<E.lenbits)-1],se=we>>>24,Qt=we>>>16&255,de=we&65535,!(se<=ut);){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(Qt&&(Qt&240)===0){for(pe=se,Gi=Qt,Yn=de;we=E.lencode[Yn+((Y&(1<<pe+Gi)-1)>>pe)],se=we>>>24,Qt=we>>>16&255,de=we&65535,!(pe+se<=ut);){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}Y>>>=pe,ut-=pe,E.back+=pe}if(Y>>>=se,ut-=se,E.back+=se,E.length=de,Qt===0){E.mode=ie;break}if(Qt&32){E.back=-1,E.mode=bt;break}if(Qt&64){Q.msg="invalid literal/length code",E.mode=fe;break}E.extra=Qt&15,E.mode=Gt;case Gt:if(E.extra){for(Xi=E.extra;ut<Xi;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}E.length+=Y&(1<<E.extra)-1,Y>>>=E.extra,ut-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=ye;case ye:for(;we=E.distcode[Y&(1<<E.distbits)-1],se=we>>>24,Qt=we>>>16&255,de=we&65535,!(se<=ut);){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if((Qt&240)===0){for(pe=se,Gi=Qt,Yn=de;we=E.distcode[Yn+((Y&(1<<pe+Gi)-1)>>pe)],se=we>>>24,Qt=we>>>16&255,de=we&65535,!(pe+se<=ut);){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}Y>>>=pe,ut-=pe,E.back+=pe}if(Y>>>=se,ut-=se,E.back+=se,Qt&64){Q.msg="invalid distance code",E.mode=fe;break}E.offset=de,E.extra=Qt&15,E.mode=Yt;case Yt:if(E.extra){for(Xi=E.extra;ut<Xi;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}E.offset+=Y&(1<<E.extra)-1,Y>>>=E.extra,ut-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){Q.msg="invalid distance too far back",E.mode=fe;break}E.mode=ee;case ee:if(L===0)break t;if(Mt=Ot-L,E.offset>Mt){if(Mt=E.offset-Mt,Mt>E.whave&&E.sane){Q.msg="invalid distance too far back",E.mode=fe;break}Mt>E.wnext?(Mt-=E.wnext,$t=E.wsize-Mt):$t=E.wnext-Mt,Mt>E.length&&(Mt=E.length),Ze=E.window}else Ze=tt,$t=it-E.offset,Mt=E.length;Mt>L&&(Mt=L),L-=Mt,E.length-=Mt;do tt[it++]=Ze[$t++];while(--Mt);E.length===0&&(E.mode=Lt);break;case ie:if(L===0)break t;tt[it++]=E.length,L--,E.mode=Lt;break;case ne:if(E.wrap){for(;ut<32;){if(lt===0)break t;lt--,Y|=F[S++]<<ut,ut+=8}if(Ot-=L,Q.total_out+=Ot,E.total+=Ot,Ot&&(Q.adler=E.check=E.flags?u(E.check,tt,Ot,it-Ot):o(E.check,tt,Ot,it-Ot)),Ot=L,(E.flags?Y:De(Y))!==E.check){Q.msg="incorrect data check",E.mode=fe;break}Y=0,ut=0}E.mode=Re;case Re:if(E.wrap&&E.flags){for(;ut<32;){if(lt===0)break t;lt--,Y+=F[S++]<<ut,ut+=8}if(Y!==(E.total&4294967295)){Q.msg="incorrect length check",E.mode=fe;break}Y=0,ut=0}E.mode=be;case be:Vi=_;break t;case fe:Vi=M;break t;case Ve:return T;case Je:default:return D}return Q.next_out=it,Q.avail_out=L,Q.next_in=S,Q.avail_in=lt,E.hold=Y,E.bits=ut,(E.wsize||Ot!==Q.avail_out&&E.mode<fe&&(E.mode<ne||N!==A))&&yi(Q,Q.output,Q.next_out,Ot-Q.avail_out),Ft-=Q.avail_in,Ot-=Q.avail_out,Q.total_in+=Ft,Q.total_out+=Ot,E.total+=Ot,E.wrap&&Ot&&(Q.adler=E.check=E.flags?u(E.check,tt,Ot,Q.next_out-Ot):o(E.check,tt,Ot,Q.next_out-Ot)),Q.data_type=E.bits+(E.last?64:0)+(E.mode===bt?128:0)+(E.mode===kt||E.mode===$?256:0),(Ft===0&&Ot===0||N===A)&&Vi===b&&(Vi=O),Vi}function Et(Q){if(!Q||!Q.state)return D;var N=Q.state;return N.window&&(N.window=null),Q.state=null,b}function Ct(Q,N){var E;return!Q||!Q.state||(E=Q.state,(E.wrap&2)===0)?D:(E.head=N,N.done=!1,b)}function It(Q,N){var E=N.length,F,tt,S;return!Q||!Q.state||(F=Q.state,F.wrap!==0&&F.mode!==st)?D:F.mode===st&&(tt=1,tt=o(tt,N,E,0),tt!==F.check)?M:(S=yi(Q,N,E,E),S?(F.mode=Ve,T):(F.havedict=1,b))}s.inflateReset=si,s.inflateReset2=ki,s.inflateResetKeep=Di,s.inflateInit=fi,s.inflateInit2=ji,s.inflate=U,s.inflateEnd=Et,s.inflateGetHeader=Ct,s.inflateSetDictionary=It,s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,i,s){var a=e("../utils/common"),o=15,u=852,h=592,d=0,f=1,p=2,v=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],A=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(_,x,D,M,T,O,k,z){var B=z.bits,H=0,V=0,Z=0,rt=0,ft=0,mt=0,G=0,W=0,st=0,bt=0,Nt,j,$,gt,yt,Dt=null,zt=0,kt,Lt=new a.Buf16(o+1),Gt=new a.Buf16(o+1),ye=null,Yt=0,ee,ie,ne;for(H=0;H<=o;H++)Lt[H]=0;for(V=0;V<M;V++)Lt[x[D+V]]++;for(ft=B,rt=o;rt>=1&&Lt[rt]===0;rt--);if(ft>rt&&(ft=rt),rt===0)return T[O++]=1<<24|64<<16|0,T[O++]=1<<24|64<<16|0,z.bits=1,0;for(Z=1;Z<rt&&Lt[Z]===0;Z++);for(ft<Z&&(ft=Z),W=1,H=1;H<=o;H++)if(W<<=1,W-=Lt[H],W<0)return-1;if(W>0&&(_===d||rt!==1))return-1;for(Gt[1]=0,H=1;H<o;H++)Gt[H+1]=Gt[H]+Lt[H];for(V=0;V<M;V++)x[D+V]!==0&&(k[Gt[x[D+V]]++]=V);if(_===d?(Dt=ye=k,kt=19):_===f?(Dt=v,zt-=257,ye=A,Yt-=257,kt=256):(Dt=C,ye=w,kt=-1),bt=0,V=0,H=Z,yt=O,mt=ft,G=0,$=-1,st=1<<ft,gt=st-1,_===f&&st>u||_===p&&st>h)return 1;for(;;){ee=H-G,k[V]<kt?(ie=0,ne=k[V]):k[V]>kt?(ie=ye[Yt+k[V]],ne=Dt[zt+k[V]]):(ie=96,ne=0),Nt=1<<H-G,j=1<<mt,Z=j;do j-=Nt,T[yt+(bt>>G)+j]=ee<<24|ie<<16|ne|0;while(j!==0);for(Nt=1<<H-1;bt&Nt;)Nt>>=1;if(Nt!==0?(bt&=Nt-1,bt+=Nt):bt=0,V++,--Lt[H]===0){if(H===rt)break;H=x[D+k[V]]}if(H>ft&&(bt&gt)!==$){for(G===0&&(G=ft),yt+=Z,mt=H-G,W=1<<mt;mt+G<rt&&(W-=Lt[mt+G],!(W<=0));)mt++,W<<=1;if(st+=1<<mt,_===f&&st>u||_===p&&st>h)return 1;$=bt&gt,T[$]=ft<<24|mt<<16|yt-O|0}}return bt!==0&&(T[yt+bt]=H-G<<24|64<<16|0),z.bits=ft,0}},{"../utils/common":41}],51:[function(e,i,s){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,i,s){var a=e("../utils/common"),o=4,u=0,h=1,d=2;function f(U){for(var Et=U.length;--Et>=0;)U[Et]=0}var p=0,v=1,A=2,C=3,w=258,b=29,_=256,x=_+1+b,D=30,M=19,T=2*x+1,O=15,k=16,z=7,B=256,H=16,V=17,Z=18,rt=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ft=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],mt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=512,st=new Array((x+2)*2);f(st);var bt=new Array(D*2);f(bt);var Nt=new Array(W);f(Nt);var j=new Array(w-C+1);f(j);var $=new Array(b);f($);var gt=new Array(D);f(gt);function yt(U,Et,Ct,It,Q){this.static_tree=U,this.extra_bits=Et,this.extra_base=Ct,this.elems=It,this.max_length=Q,this.has_stree=U&&U.length}var Dt,zt,kt;function Lt(U,Et){this.dyn_tree=U,this.max_code=0,this.stat_desc=Et}function Gt(U){return U<256?Nt[U]:Nt[256+(U>>>7)]}function ye(U,Et){U.pending_buf[U.pending++]=Et&255,U.pending_buf[U.pending++]=Et>>>8&255}function Yt(U,Et,Ct){U.bi_valid>k-Ct?(U.bi_buf|=Et<<U.bi_valid&65535,ye(U,U.bi_buf),U.bi_buf=Et>>k-U.bi_valid,U.bi_valid+=Ct-k):(U.bi_buf|=Et<<U.bi_valid&65535,U.bi_valid+=Ct)}function ee(U,Et,Ct){Yt(U,Ct[Et*2],Ct[Et*2+1])}function ie(U,Et){var Ct=0;do Ct|=U&1,U>>>=1,Ct<<=1;while(--Et>0);return Ct>>>1}function ne(U){U.bi_valid===16?(ye(U,U.bi_buf),U.bi_buf=0,U.bi_valid=0):U.bi_valid>=8&&(U.pending_buf[U.pending++]=U.bi_buf&255,U.bi_buf>>=8,U.bi_valid-=8)}function Re(U,Et){var Ct=Et.dyn_tree,It=Et.max_code,Q=Et.stat_desc.static_tree,N=Et.stat_desc.has_stree,E=Et.stat_desc.extra_bits,F=Et.stat_desc.extra_base,tt=Et.stat_desc.max_length,S,it,lt,L,Y,ut,Ft=0;for(L=0;L<=O;L++)U.bl_count[L]=0;for(Ct[U.heap[U.heap_max]*2+1]=0,S=U.heap_max+1;S<T;S++)it=U.heap[S],L=Ct[Ct[it*2+1]*2+1]+1,L>tt&&(L=tt,Ft++),Ct[it*2+1]=L,!(it>It)&&(U.bl_count[L]++,Y=0,it>=F&&(Y=E[it-F]),ut=Ct[it*2],U.opt_len+=ut*(L+Y),N&&(U.static_len+=ut*(Q[it*2+1]+Y)));if(Ft!==0){do{for(L=tt-1;U.bl_count[L]===0;)L--;U.bl_count[L]--,U.bl_count[L+1]+=2,U.bl_count[tt]--,Ft-=2}while(Ft>0);for(L=tt;L!==0;L--)for(it=U.bl_count[L];it!==0;)lt=U.heap[--S],!(lt>It)&&(Ct[lt*2+1]!==L&&(U.opt_len+=(L-Ct[lt*2+1])*Ct[lt*2],Ct[lt*2+1]=L),it--)}}function be(U,Et,Ct){var It=new Array(O+1),Q=0,N,E;for(N=1;N<=O;N++)It[N]=Q=Q+Ct[N-1]<<1;for(E=0;E<=Et;E++){var F=U[E*2+1];F!==0&&(U[E*2]=ie(It[F]++,F))}}function fe(){var U,Et,Ct,It,Q,N=new Array(O+1);for(Ct=0,It=0;It<b-1;It++)for($[It]=Ct,U=0;U<1<<rt[It];U++)j[Ct++]=It;for(j[Ct-1]=It,Q=0,It=0;It<16;It++)for(gt[It]=Q,U=0;U<1<<ft[It];U++)Nt[Q++]=It;for(Q>>=7;It<D;It++)for(gt[It]=Q<<7,U=0;U<1<<ft[It]-7;U++)Nt[256+Q++]=It;for(Et=0;Et<=O;Et++)N[Et]=0;for(U=0;U<=143;)st[U*2+1]=8,U++,N[8]++;for(;U<=255;)st[U*2+1]=9,U++,N[9]++;for(;U<=279;)st[U*2+1]=7,U++,N[7]++;for(;U<=287;)st[U*2+1]=8,U++,N[8]++;for(be(st,x+1,N),U=0;U<D;U++)bt[U*2+1]=5,bt[U*2]=ie(U,5);Dt=new yt(st,rt,_+1,x,O),zt=new yt(bt,ft,0,D,O),kt=new yt(new Array(0),mt,0,M,z)}function Ve(U){var Et;for(Et=0;Et<x;Et++)U.dyn_ltree[Et*2]=0;for(Et=0;Et<D;Et++)U.dyn_dtree[Et*2]=0;for(Et=0;Et<M;Et++)U.bl_tree[Et*2]=0;U.dyn_ltree[B*2]=1,U.opt_len=U.static_len=0,U.last_lit=U.matches=0}function Je(U){U.bi_valid>8?ye(U,U.bi_buf):U.bi_valid>0&&(U.pending_buf[U.pending++]=U.bi_buf),U.bi_buf=0,U.bi_valid=0}function Ke(U,Et,Ct,It){Je(U),ye(U,Ct),ye(U,~Ct),a.arraySet(U.pending_buf,U.window,Et,Ct,U.pending),U.pending+=Ct}function Wt(U,Et,Ct,It){var Q=Et*2,N=Ct*2;return U[Q]<U[N]||U[Q]===U[N]&&It[Et]<=It[Ct]}function Jt(U,Et,Ct){for(var It=U.heap[Ct],Q=Ct<<1;Q<=U.heap_len&&(Q<U.heap_len&&Wt(Et,U.heap[Q+1],U.heap[Q],U.depth)&&Q++,!Wt(Et,It,U.heap[Q],U.depth));)U.heap[Ct]=U.heap[Q],Ct=Q,Q<<=1;U.heap[Ct]=It}function Kt(U,Et,Ct){var It,Q,N=0,E,F;if(U.last_lit!==0)do It=U.pending_buf[U.d_buf+N*2]<<8|U.pending_buf[U.d_buf+N*2+1],Q=U.pending_buf[U.l_buf+N],N++,It===0?ee(U,Q,Et):(E=j[Q],ee(U,E+_+1,Et),F=rt[E],F!==0&&(Q-=$[E],Yt(U,Q,F)),It--,E=Gt(It),ee(U,E,Ct),F=ft[E],F!==0&&(It-=gt[E],Yt(U,It,F)));while(N<U.last_lit);ee(U,B,Et)}function De(U,Et){var Ct=Et.dyn_tree,It=Et.stat_desc.static_tree,Q=Et.stat_desc.has_stree,N=Et.stat_desc.elems,E,F,tt=-1,S;for(U.heap_len=0,U.heap_max=T,E=0;E<N;E++)Ct[E*2]!==0?(U.heap[++U.heap_len]=tt=E,U.depth[E]=0):Ct[E*2+1]=0;for(;U.heap_len<2;)S=U.heap[++U.heap_len]=tt<2?++tt:0,Ct[S*2]=1,U.depth[S]=0,U.opt_len--,Q&&(U.static_len-=It[S*2+1]);for(Et.max_code=tt,E=U.heap_len>>1;E>=1;E--)Jt(U,Ct,E);S=N;do E=U.heap[1],U.heap[1]=U.heap[U.heap_len--],Jt(U,Ct,1),F=U.heap[1],U.heap[--U.heap_max]=E,U.heap[--U.heap_max]=F,Ct[S*2]=Ct[E*2]+Ct[F*2],U.depth[S]=(U.depth[E]>=U.depth[F]?U.depth[E]:U.depth[F])+1,Ct[E*2+1]=Ct[F*2+1]=S,U.heap[1]=S++,Jt(U,Ct,1);while(U.heap_len>=2);U.heap[--U.heap_max]=U.heap[1],Re(U,Et),be(Ct,tt,U.bl_count)}function Wi(U,Et,Ct){var It,Q=-1,N,E=Et[1],F=0,tt=7,S=4;for(E===0&&(tt=138,S=3),Et[(Ct+1)*2+1]=65535,It=0;It<=Ct;It++)N=E,E=Et[(It+1)*2+1],!(++F<tt&&N===E)&&(F<S?U.bl_tree[N*2]+=F:N!==0?(N!==Q&&U.bl_tree[N*2]++,U.bl_tree[H*2]++):F<=10?U.bl_tree[V*2]++:U.bl_tree[Z*2]++,F=0,Q=N,E===0?(tt=138,S=3):N===E?(tt=6,S=3):(tt=7,S=4))}function Di(U,Et,Ct){var It,Q=-1,N,E=Et[1],F=0,tt=7,S=4;for(E===0&&(tt=138,S=3),It=0;It<=Ct;It++)if(N=E,E=Et[(It+1)*2+1],!(++F<tt&&N===E)){if(F<S)do ee(U,N,U.bl_tree);while(--F!==0);else N!==0?(N!==Q&&(ee(U,N,U.bl_tree),F--),ee(U,H,U.bl_tree),Yt(U,F-3,2)):F<=10?(ee(U,V,U.bl_tree),Yt(U,F-3,3)):(ee(U,Z,U.bl_tree),Yt(U,F-11,7));F=0,Q=N,E===0?(tt=138,S=3):N===E?(tt=6,S=3):(tt=7,S=4)}}function si(U){var Et;for(Wi(U,U.dyn_ltree,U.l_desc.max_code),Wi(U,U.dyn_dtree,U.d_desc.max_code),De(U,U.bl_desc),Et=M-1;Et>=3&&U.bl_tree[G[Et]*2+1]===0;Et--);return U.opt_len+=3*(Et+1)+5+5+4,Et}function ki(U,Et,Ct,It){var Q;for(Yt(U,Et-257,5),Yt(U,Ct-1,5),Yt(U,It-4,4),Q=0;Q<It;Q++)Yt(U,U.bl_tree[G[Q]*2+1],3);Di(U,U.dyn_ltree,Et-1),Di(U,U.dyn_dtree,Ct-1)}function ji(U){var Et=4093624447,Ct;for(Ct=0;Ct<=31;Ct++,Et>>>=1)if(Et&1&&U.dyn_ltree[Ct*2]!==0)return u;if(U.dyn_ltree[18]!==0||U.dyn_ltree[20]!==0||U.dyn_ltree[26]!==0)return h;for(Ct=32;Ct<_;Ct++)if(U.dyn_ltree[Ct*2]!==0)return h;return u}var fi=!1;function qi(U){fi||(fe(),fi=!0),U.l_desc=new Lt(U.dyn_ltree,Dt),U.d_desc=new Lt(U.dyn_dtree,zt),U.bl_desc=new Lt(U.bl_tree,kt),U.bi_buf=0,U.bi_valid=0,Ve(U)}function Mi(U,Et,Ct,It){Yt(U,(p<<1)+(It?1:0),3),Ke(U,Et,Ct)}function Pe(U){Yt(U,v<<1,3),ee(U,B,st),ne(U)}function Me(U,Et,Ct,It){var Q,N,E=0;U.level>0?(U.strm.data_type===d&&(U.strm.data_type=ji(U)),De(U,U.l_desc),De(U,U.d_desc),E=si(U),Q=U.opt_len+3+7>>>3,N=U.static_len+3+7>>>3,N<=Q&&(Q=N)):Q=N=Ct+5,Ct+4<=Q&&Et!==-1?Mi(U,Et,Ct,It):U.strategy===o||N===Q?(Yt(U,(v<<1)+(It?1:0),3),Kt(U,st,bt)):(Yt(U,(A<<1)+(It?1:0),3),ki(U,U.l_desc.max_code+1,U.d_desc.max_code+1,E+1),Kt(U,U.dyn_ltree,U.dyn_dtree)),Ve(U),It&&Je(U)}function yi(U,Et,Ct){return U.pending_buf[U.d_buf+U.last_lit*2]=Et>>>8&255,U.pending_buf[U.d_buf+U.last_lit*2+1]=Et&255,U.pending_buf[U.l_buf+U.last_lit]=Ct&255,U.last_lit++,Et===0?U.dyn_ltree[Ct*2]++:(U.matches++,Et--,U.dyn_ltree[(j[Ct]+_+1)*2]++,U.dyn_dtree[Gt(Et)*2]++),U.last_lit===U.lit_bufsize-1}s._tr_init=qi,s._tr_stored_block=Mi,s._tr_flush_block=Me,s._tr_tally=yi,s._tr_align=Pe},{"../utils/common":41}],53:[function(e,i,s){function a(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}i.exports=a},{}],54:[function(e,i,s){(function(a){(function(o,u){if(o.setImmediate)return;var h=1,d={},f=!1,p=o.document,v;function A(z){typeof z!="function"&&(z=new Function(""+z));for(var B=new Array(arguments.length-1),H=0;H<B.length;H++)B[H]=arguments[H+1];var V={callback:z,args:B};return d[h]=V,v(h),h++}function C(z){delete d[z]}function w(z){var B=z.callback,H=z.args;switch(H.length){case 0:B();break;case 1:B(H[0]);break;case 2:B(H[0],H[1]);break;case 3:B(H[0],H[1],H[2]);break;default:B.apply(u,H);break}}function b(z){if(f)setTimeout(b,0,z);else{var B=d[z];if(B){f=!0;try{w(B)}finally{C(z),f=!1}}}}function _(){v=function(z){process.nextTick(function(){b(z)})}}function x(){if(o.postMessage&&!o.importScripts){var z=!0,B=o.onmessage;return o.onmessage=function(){z=!1},o.postMessage("","*"),o.onmessage=B,z}}function D(){var z="setImmediate$"+Math.random()+"$",B=function(H){H.source===o&&typeof H.data=="string"&&H.data.indexOf(z)===0&&b(+H.data.slice(z.length))};o.addEventListener?o.addEventListener("message",B,!1):o.attachEvent("onmessage",B),v=function(H){o.postMessage(z+H,"*")}}function M(){var z=new MessageChannel;z.port1.onmessage=function(B){var H=B.data;b(H)},v=function(B){z.port2.postMessage(B)}}function T(){var z=p.documentElement;v=function(B){var H=p.createElement("script");H.onreadystatechange=function(){b(B),H.onreadystatechange=null,z.removeChild(H),H=null},z.appendChild(H)}}function O(){v=function(z){setTimeout(b,0,z)}}var k=Object.getPrototypeOf&&Object.getPrototypeOf(o);k=k&&k.setTimeout?k:o,{}.toString.call(o.process)==="[object process]"?_():x()?D():o.MessageChannel?M():p&&"onreadystatechange"in p.createElement("script")?T():O(),k.setImmediate=A,k.clearImmediate=C})(typeof self>"u"?typeof a>"u"?this:a:self)}).call(this,typeof Bn<"u"?Bn:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(sf)),sf.exports}var tE=Jw();const eE=ur(tE);class iE{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new eE}catch{throw new Error("JSZip lib not loaded")}}open(t,e){return this.zip.loadAsync(t,{base64:e})}openUrl(t,e){return Zo(t,"binary").then((function(i){return this.zip.loadAsync(i,{base64:e})}).bind(this))}request(t,e){var i=new Ce,s,a=new Ns(t);return e||(e=a.extension),e=="blob"?s=this.getBlob(t):s=this.getText(t),s?s.then((function(o){let u=this.handleResponse(o,e);i.resolve(u)}).bind(this)):i.reject({message:"File not found in the epub: "+t,stack:new Error().stack}),i.promise}handleResponse(t,e){var i;return e=="json"?i=JSON.parse(t):Wo(e)?i=rs(t,"text/xml"):e=="xhtml"?i=rs(t,"application/xhtml+xml"):e=="html"||e=="htm"?i=rs(t,"text/html"):i=t,i}getBlob(t,e){var i=window.decodeURIComponent(t.substr(1)),s=this.zip.file(i);if(s)return e=e||Ba.lookup(s.name),s.async("uint8array").then(function(a){return new Blob([a],{type:e})})}getText(t,e){var i=window.decodeURIComponent(t.substr(1)),s=this.zip.file(i);if(s)return s.async("string").then(function(a){return a})}getBase64(t,e){var i=window.decodeURIComponent(t.substr(1)),s=this.zip.file(i);if(s)return e=e||Ba.lookup(s.name),s.async("base64").then(function(a){return"data:"+e+";base64,"+a})}createUrl(t,e){var i=new Ce,s=window.URL||window.webkitURL||window.mozURL,a,o,u=e&&e.base64;return t in this.urlCache?(i.resolve(this.urlCache[t]),i.promise):(u?(o=this.getBase64(t),o&&o.then((function(h){this.urlCache[t]=h,i.resolve(h)}).bind(this))):(o=this.getBlob(t),o&&o.then((function(h){a=s.createObjectURL(h),this.urlCache[t]=a,i.resolve(a)}).bind(this))),o||i.reject({message:"File not found in the epub: "+t,stack:new Error().stack}),i.promise)}revokeUrl(t){var e=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[t];i&&e.revokeObjectURL(i)}destroy(){var t=window.URL||window.webkitURL||window.mozURL;for(let e in this.urlCache)t.revokeObjectURL(e);this.zip=void 0,this.urlCache={}}}var rf={exports:{}};var hy;function nE(){return hy||(hy=1,(function(g,t){(function(e){g.exports=e()})(function(){return(function e(i,s,a){function o(d,f){if(!s[d]){if(!i[d]){var p=typeof ar=="function"&&ar;if(!f&&p)return p(d,!0);if(u)return u(d,!0);var v=new Error("Cannot find module '"+d+"'");throw v.code="MODULE_NOT_FOUND",v}var A=s[d]={exports:{}};i[d][0].call(A.exports,function(C){var w=i[d][1][C];return o(w||C)},A,A.exports,e,i,s,a)}return s[d].exports}for(var u=typeof ar=="function"&&ar,h=0;h<a.length;h++)o(a[h]);return o})({1:[function(e,i,s){(function(a){var o=a.MutationObserver||a.WebKitMutationObserver,u;if(o){var h=0,d=new o(C),f=a.document.createTextNode("");d.observe(f,{characterData:!0}),u=function(){f.data=h=++h%2}}else if(!a.setImmediate&&typeof a.MessageChannel<"u"){var p=new a.MessageChannel;p.port1.onmessage=C,u=function(){p.port2.postMessage(0)}}else"document"in a&&"onreadystatechange"in a.document.createElement("script")?u=function(){var b=a.document.createElement("script");b.onreadystatechange=function(){C(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},a.document.documentElement.appendChild(b)}:u=function(){setTimeout(C,0)};var v,A=[];function C(){v=!0;for(var b,_,x=A.length;x;){for(_=A,A=[],b=-1;++b<x;)_[b]();x=A.length}v=!1}i.exports=w;function w(b){A.push(b)===1&&!v&&u()}}).call(this,typeof Bn<"u"?Bn:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(e,i,s){var a=e(1);function o(){}var u={},h=["REJECTED"],d=["FULFILLED"],f=["PENDING"];i.exports=p;function p(T){if(typeof T!="function")throw new TypeError("resolver must be a function");this.state=f,this.queue=[],this.outcome=void 0,T!==o&&w(this,T)}p.prototype.catch=function(T){return this.then(null,T)},p.prototype.then=function(T,O){if(typeof T!="function"&&this.state===d||typeof O!="function"&&this.state===h)return this;var k=new this.constructor(o);if(this.state!==f){var z=this.state===d?T:O;A(k,z,this.outcome)}else this.queue.push(new v(k,T,O));return k};function v(T,O,k){this.promise=T,typeof O=="function"&&(this.onFulfilled=O,this.callFulfilled=this.otherCallFulfilled),typeof k=="function"&&(this.onRejected=k,this.callRejected=this.otherCallRejected)}v.prototype.callFulfilled=function(T){u.resolve(this.promise,T)},v.prototype.otherCallFulfilled=function(T){A(this.promise,this.onFulfilled,T)},v.prototype.callRejected=function(T){u.reject(this.promise,T)},v.prototype.otherCallRejected=function(T){A(this.promise,this.onRejected,T)};function A(T,O,k){a(function(){var z;try{z=O(k)}catch(B){return u.reject(T,B)}z===T?u.reject(T,new TypeError("Cannot resolve promise with itself")):u.resolve(T,z)})}u.resolve=function(T,O){var k=b(C,O);if(k.status==="error")return u.reject(T,k.value);var z=k.value;if(z)w(T,z);else{T.state=d,T.outcome=O;for(var B=-1,H=T.queue.length;++B<H;)T.queue[B].callFulfilled(O)}return T},u.reject=function(T,O){T.state=h,T.outcome=O;for(var k=-1,z=T.queue.length;++k<z;)T.queue[k].callRejected(O);return T};function C(T){var O=T&&T.then;if(T&&(typeof T=="object"||typeof T=="function")&&typeof O=="function")return function(){O.apply(T,arguments)}}function w(T,O){var k=!1;function z(Z){k||(k=!0,u.reject(T,Z))}function B(Z){k||(k=!0,u.resolve(T,Z))}function H(){O(B,z)}var V=b(H);V.status==="error"&&z(V.value)}function b(T,O){var k={};try{k.value=T(O),k.status="success"}catch(z){k.status="error",k.value=z}return k}p.resolve=_;function _(T){return T instanceof this?T:u.resolve(new this(o),T)}p.reject=x;function x(T){var O=new this(o);return u.reject(O,T)}p.all=D;function D(T){var O=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=T.length,z=!1;if(!k)return this.resolve([]);for(var B=new Array(k),H=0,V=-1,Z=new this(o);++V<k;)rt(T[V],V);return Z;function rt(ft,mt){O.resolve(ft).then(G,function(W){z||(z=!0,u.reject(Z,W))});function G(W){B[mt]=W,++H===k&&!z&&(z=!0,u.resolve(Z,B))}}}p.race=M;function M(T){var O=this;if(Object.prototype.toString.call(T)!=="[object Array]")return this.reject(new TypeError("must be an array"));var k=T.length,z=!1;if(!k)return this.resolve([]);for(var B=-1,H=new this(o);++B<k;)V(T[B]);return H;function V(Z){O.resolve(Z).then(function(rt){z||(z=!0,u.resolve(H,rt))},function(rt){z||(z=!0,u.reject(H,rt))})}}},{1:1}],3:[function(e,i,s){(function(a){typeof a.Promise!="function"&&(a.Promise=e(2))}).call(this,typeof Bn<"u"?Bn:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(e,i,s){var a=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(P){return typeof P}:function(P){return P&&typeof Symbol=="function"&&P.constructor===Symbol&&P!==Symbol.prototype?"symbol":typeof P};function o(P,K){if(!(P instanceof K))throw new TypeError("Cannot call a class as a function")}function u(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var h=u();function d(){try{if(!h||!h.open)return!1;var P=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),K=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!P||K)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function f(P,K){P=P||[],K=K||{};try{return new Blob(P,K)}catch(et){if(et.name!=="TypeError")throw et;for(var q=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,nt=new q,ot=0;ot<P.length;ot+=1)nt.append(P[ot]);return nt.getBlob(K.type)}}typeof Promise>"u"&&e(3);var p=Promise;function v(P,K){K&&P.then(function(q){K(null,q)},function(q){K(q)})}function A(P,K,q){typeof K=="function"&&P.then(K),typeof q=="function"&&P.catch(q)}function C(P){return typeof P!="string"&&(console.warn(P+" used as a key, but it is not a string."),P=String(P)),P}function w(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var b="local-forage-detect-blob-support",_=void 0,x={},D=Object.prototype.toString,M="readonly",T="readwrite";function O(P){for(var K=P.length,q=new ArrayBuffer(K),nt=new Uint8Array(q),ot=0;ot<K;ot++)nt[ot]=P.charCodeAt(ot);return q}function k(P){return new p(function(K){var q=P.transaction(b,T),nt=f([""]);q.objectStore(b).put(nt,"key"),q.onabort=function(ot){ot.preventDefault(),ot.stopPropagation(),K(!1)},q.oncomplete=function(){var ot=navigator.userAgent.match(/Chrome\/(\d+)/),et=navigator.userAgent.match(/Edge\//);K(et||!ot||parseInt(ot[1],10)>=43)}}).catch(function(){return!1})}function z(P){return typeof _=="boolean"?p.resolve(_):k(P).then(function(K){return _=K,_})}function B(P){var K=x[P.name],q={};q.promise=new p(function(nt,ot){q.resolve=nt,q.reject=ot}),K.deferredOperations.push(q),K.dbReady?K.dbReady=K.dbReady.then(function(){return q.promise}):K.dbReady=q.promise}function H(P){var K=x[P.name],q=K.deferredOperations.pop();if(q)return q.resolve(),q.promise}function V(P,K){var q=x[P.name],nt=q.deferredOperations.pop();if(nt)return nt.reject(K),nt.promise}function Z(P,K){return new p(function(q,nt){if(x[P.name]=x[P.name]||$(),P.db)if(K)B(P),P.db.close();else return q(P.db);var ot=[P.name];K&&ot.push(P.version);var et=h.open.apply(h,ot);K&&(et.onupgradeneeded=function(At){var St=et.result;try{St.createObjectStore(P.storeName),At.oldVersion<=1&&St.createObjectStore(b)}catch(Tt){if(Tt.name==="ConstraintError")console.warn('The database "'+P.name+'" has been upgraded from version '+At.oldVersion+" to version "+At.newVersion+', but the storage "'+P.storeName+'" already exists.');else throw Tt}}),et.onerror=function(At){At.preventDefault(),nt(et.error)},et.onsuccess=function(){var At=et.result;At.onversionchange=function(St){St.target.close()},q(At),H(P)}})}function rt(P){return Z(P,!1)}function ft(P){return Z(P,!0)}function mt(P,K){if(!P.db)return!0;var q=!P.db.objectStoreNames.contains(P.storeName),nt=P.version<P.db.version,ot=P.version>P.db.version;if(nt&&(P.version!==K&&console.warn('The database "'+P.name+`" can't be downgraded from version `+P.db.version+" to version "+P.version+"."),P.version=P.db.version),ot||q){if(q){var et=P.db.version+1;et>P.version&&(P.version=et)}return!0}return!1}function G(P){return new p(function(K,q){var nt=new FileReader;nt.onerror=q,nt.onloadend=function(ot){var et=btoa(ot.target.result||"");K({__local_forage_encoded_blob:!0,data:et,type:P.type})},nt.readAsBinaryString(P)})}function W(P){var K=O(atob(P.data));return f([K],{type:P.type})}function st(P){return P&&P.__local_forage_encoded_blob}function bt(P){var K=this,q=K._initReady().then(function(){var nt=x[K._dbInfo.name];if(nt&&nt.dbReady)return nt.dbReady});return A(q,P,P),q}function Nt(P){B(P);for(var K=x[P.name],q=K.forages,nt=0;nt<q.length;nt++){var ot=q[nt];ot._dbInfo.db&&(ot._dbInfo.db.close(),ot._dbInfo.db=null)}return P.db=null,rt(P).then(function(et){return P.db=et,mt(P)?ft(P):et}).then(function(et){P.db=K.db=et;for(var At=0;At<q.length;At++)q[At]._dbInfo.db=et}).catch(function(et){throw V(P,et),et})}function j(P,K,q,nt){nt===void 0&&(nt=1);try{var ot=P.db.transaction(P.storeName,K);q(null,ot)}catch(et){if(nt>0&&(!P.db||et.name==="InvalidStateError"||et.name==="NotFoundError"))return p.resolve().then(function(){if(!P.db||et.name==="NotFoundError"&&!P.db.objectStoreNames.contains(P.storeName)&&P.version<=P.db.version)return P.db&&(P.version=P.db.version+1),ft(P)}).then(function(){return Nt(P).then(function(){j(P,K,q,nt-1)})}).catch(q);q(et)}}function $(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function gt(P){var K=this,q={db:null};if(P)for(var nt in P)q[nt]=P[nt];var ot=x[q.name];ot||(ot=$(),x[q.name]=ot),ot.forages.push(K),K._initReady||(K._initReady=K.ready,K.ready=bt);var et=[];function At(){return p.resolve()}for(var St=0;St<ot.forages.length;St++){var Tt=ot.forages[St];Tt!==K&&et.push(Tt._initReady().catch(At))}var xt=ot.forages.slice(0);return p.all(et).then(function(){return q.db=ot.db,rt(q)}).then(function(Rt){return q.db=Rt,mt(q,K._defaultConfig.version)?ft(q):Rt}).then(function(Rt){q.db=ot.db=Rt,K._dbInfo=q;for(var jt=0;jt<xt.length;jt++){var ue=xt[jt];ue!==K&&(ue._dbInfo.db=q.db,ue._dbInfo.version=q.version)}})}function yt(P,K){var q=this;P=C(P);var nt=new p(function(ot,et){q.ready().then(function(){j(q._dbInfo,M,function(At,St){if(At)return et(At);try{var Tt=St.objectStore(q._dbInfo.storeName),xt=Tt.get(P);xt.onsuccess=function(){var Rt=xt.result;Rt===void 0&&(Rt=null),st(Rt)&&(Rt=W(Rt)),ot(Rt)},xt.onerror=function(){et(xt.error)}}catch(Rt){et(Rt)}})}).catch(et)});return v(nt,K),nt}function Dt(P,K){var q=this,nt=new p(function(ot,et){q.ready().then(function(){j(q._dbInfo,M,function(At,St){if(At)return et(At);try{var Tt=St.objectStore(q._dbInfo.storeName),xt=Tt.openCursor(),Rt=1;xt.onsuccess=function(){var jt=xt.result;if(jt){var ue=jt.value;st(ue)&&(ue=W(ue));var ge=P(ue,jt.key,Rt++);ge!==void 0?ot(ge):jt.continue()}else ot()},xt.onerror=function(){et(xt.error)}}catch(jt){et(jt)}})}).catch(et)});return v(nt,K),nt}function zt(P,K,q){var nt=this;P=C(P);var ot=new p(function(et,At){var St;nt.ready().then(function(){return St=nt._dbInfo,D.call(K)==="[object Blob]"?z(St.db).then(function(Tt){return Tt?K:G(K)}):K}).then(function(Tt){j(nt._dbInfo,T,function(xt,Rt){if(xt)return At(xt);try{var jt=Rt.objectStore(nt._dbInfo.storeName);Tt===null&&(Tt=void 0);var ue=jt.put(Tt,P);Rt.oncomplete=function(){Tt===void 0&&(Tt=null),et(Tt)},Rt.onabort=Rt.onerror=function(){var ge=ue.error?ue.error:ue.transaction.error;At(ge)}}catch(ge){At(ge)}})}).catch(At)});return v(ot,q),ot}function kt(P,K){var q=this;P=C(P);var nt=new p(function(ot,et){q.ready().then(function(){j(q._dbInfo,T,function(At,St){if(At)return et(At);try{var Tt=St.objectStore(q._dbInfo.storeName),xt=Tt.delete(P);St.oncomplete=function(){ot()},St.onerror=function(){et(xt.error)},St.onabort=function(){var Rt=xt.error?xt.error:xt.transaction.error;et(Rt)}}catch(Rt){et(Rt)}})}).catch(et)});return v(nt,K),nt}function Lt(P){var K=this,q=new p(function(nt,ot){K.ready().then(function(){j(K._dbInfo,T,function(et,At){if(et)return ot(et);try{var St=At.objectStore(K._dbInfo.storeName),Tt=St.clear();At.oncomplete=function(){nt()},At.onabort=At.onerror=function(){var xt=Tt.error?Tt.error:Tt.transaction.error;ot(xt)}}catch(xt){ot(xt)}})}).catch(ot)});return v(q,P),q}function Gt(P){var K=this,q=new p(function(nt,ot){K.ready().then(function(){j(K._dbInfo,M,function(et,At){if(et)return ot(et);try{var St=At.objectStore(K._dbInfo.storeName),Tt=St.count();Tt.onsuccess=function(){nt(Tt.result)},Tt.onerror=function(){ot(Tt.error)}}catch(xt){ot(xt)}})}).catch(ot)});return v(q,P),q}function ye(P,K){var q=this,nt=new p(function(ot,et){if(P<0){ot(null);return}q.ready().then(function(){j(q._dbInfo,M,function(At,St){if(At)return et(At);try{var Tt=St.objectStore(q._dbInfo.storeName),xt=!1,Rt=Tt.openKeyCursor();Rt.onsuccess=function(){var jt=Rt.result;if(!jt){ot(null);return}P===0||xt?ot(jt.key):(xt=!0,jt.advance(P))},Rt.onerror=function(){et(Rt.error)}}catch(jt){et(jt)}})}).catch(et)});return v(nt,K),nt}function Yt(P){var K=this,q=new p(function(nt,ot){K.ready().then(function(){j(K._dbInfo,M,function(et,At){if(et)return ot(et);try{var St=At.objectStore(K._dbInfo.storeName),Tt=St.openKeyCursor(),xt=[];Tt.onsuccess=function(){var Rt=Tt.result;if(!Rt){nt(xt);return}xt.push(Rt.key),Rt.continue()},Tt.onerror=function(){ot(Tt.error)}}catch(Rt){ot(Rt)}})}).catch(ot)});return v(q,P),q}function ee(P,K){K=w.apply(this,arguments);var q=this.config();P=typeof P!="function"&&P||{},P.name||(P.name=P.name||q.name,P.storeName=P.storeName||q.storeName);var nt=this,ot;if(!P.name)ot=p.reject("Invalid arguments");else{var et=P.name===q.name&&nt._dbInfo.db,At=et?p.resolve(nt._dbInfo.db):rt(P).then(function(St){var Tt=x[P.name],xt=Tt.forages;Tt.db=St;for(var Rt=0;Rt<xt.length;Rt++)xt[Rt]._dbInfo.db=St;return St});P.storeName?ot=At.then(function(St){if(St.objectStoreNames.contains(P.storeName)){var Tt=St.version+1;B(P);var xt=x[P.name],Rt=xt.forages;St.close();for(var jt=0;jt<Rt.length;jt++){var ue=Rt[jt];ue._dbInfo.db=null,ue._dbInfo.version=Tt}var ge=new p(function(Ne,ri){var Ue=h.open(P.name,Tt);Ue.onerror=function(Ji){var Ms=Ue.result;Ms.close(),ri(Ji)},Ue.onupgradeneeded=function(){var Ji=Ue.result;Ji.deleteObjectStore(P.storeName)},Ue.onsuccess=function(){var Ji=Ue.result;Ji.close(),Ne(Ji)}});return ge.then(function(Ne){xt.db=Ne;for(var ri=0;ri<Rt.length;ri++){var Ue=Rt[ri];Ue._dbInfo.db=Ne,H(Ue._dbInfo)}}).catch(function(Ne){throw(V(P,Ne)||p.resolve()).catch(function(){}),Ne})}}):ot=At.then(function(St){B(P);var Tt=x[P.name],xt=Tt.forages;St.close();for(var Rt=0;Rt<xt.length;Rt++){var jt=xt[Rt];jt._dbInfo.db=null}var ue=new p(function(ge,Ne){var ri=h.deleteDatabase(P.name);ri.onerror=function(){var Ue=ri.result;Ue&&Ue.close(),Ne(ri.error)},ri.onblocked=function(){console.warn('dropInstance blocked for database "'+P.name+'" until all open connections are closed')},ri.onsuccess=function(){var Ue=ri.result;Ue&&Ue.close(),ge(Ue)}});return ue.then(function(ge){Tt.db=ge;for(var Ne=0;Ne<xt.length;Ne++){var ri=xt[Ne];H(ri._dbInfo)}}).catch(function(ge){throw(V(P,ge)||p.resolve()).catch(function(){}),ge})})}return v(ot,K),ot}var ie={_driver:"asyncStorage",_initStorage:gt,_support:d(),iterate:Dt,getItem:yt,setItem:zt,removeItem:kt,clear:Lt,length:Gt,key:ye,keys:Yt,dropInstance:ee};function ne(){return typeof openDatabase=="function"}var Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",be="~~local_forage_type~",fe=/^~~local_forage_type~([^~]+)~/,Ve="__lfsc__:",Je=Ve.length,Ke="arbf",Wt="blob",Jt="si08",Kt="ui08",De="uic8",Wi="si16",Di="si32",si="ur16",ki="ui32",ji="fl32",fi="fl64",qi=Je+Ke.length,Mi=Object.prototype.toString;function Pe(P){var K=P.length*.75,q=P.length,nt,ot=0,et,At,St,Tt;P[P.length-1]==="="&&(K--,P[P.length-2]==="="&&K--);var xt=new ArrayBuffer(K),Rt=new Uint8Array(xt);for(nt=0;nt<q;nt+=4)et=Re.indexOf(P[nt]),At=Re.indexOf(P[nt+1]),St=Re.indexOf(P[nt+2]),Tt=Re.indexOf(P[nt+3]),Rt[ot++]=et<<2|At>>4,Rt[ot++]=(At&15)<<4|St>>2,Rt[ot++]=(St&3)<<6|Tt&63;return xt}function Me(P){var K=new Uint8Array(P),q="",nt;for(nt=0;nt<K.length;nt+=3)q+=Re[K[nt]>>2],q+=Re[(K[nt]&3)<<4|K[nt+1]>>4],q+=Re[(K[nt+1]&15)<<2|K[nt+2]>>6],q+=Re[K[nt+2]&63];return K.length%3===2?q=q.substring(0,q.length-1)+"=":K.length%3===1&&(q=q.substring(0,q.length-2)+"=="),q}function yi(P,K){var q="";if(P&&(q=Mi.call(P)),P&&(q==="[object ArrayBuffer]"||P.buffer&&Mi.call(P.buffer)==="[object ArrayBuffer]")){var nt,ot=Ve;P instanceof ArrayBuffer?(nt=P,ot+=Ke):(nt=P.buffer,q==="[object Int8Array]"?ot+=Jt:q==="[object Uint8Array]"?ot+=Kt:q==="[object Uint8ClampedArray]"?ot+=De:q==="[object Int16Array]"?ot+=Wi:q==="[object Uint16Array]"?ot+=si:q==="[object Int32Array]"?ot+=Di:q==="[object Uint32Array]"?ot+=ki:q==="[object Float32Array]"?ot+=ji:q==="[object Float64Array]"?ot+=fi:K(new Error("Failed to get type for BinaryArray"))),K(ot+Me(nt))}else if(q==="[object Blob]"){var et=new FileReader;et.onload=function(){var At=be+P.type+"~"+Me(this.result);K(Ve+Wt+At)},et.readAsArrayBuffer(P)}else try{K(JSON.stringify(P))}catch(At){console.error("Couldn't convert value into a JSON string: ",P),K(null,At)}}function U(P){if(P.substring(0,Je)!==Ve)return JSON.parse(P);var K=P.substring(qi),q=P.substring(Je,qi),nt;if(q===Wt&&fe.test(K)){var ot=K.match(fe);nt=ot[1],K=K.substring(ot[0].length)}var et=Pe(K);switch(q){case Ke:return et;case Wt:return f([et],{type:nt});case Jt:return new Int8Array(et);case Kt:return new Uint8Array(et);case De:return new Uint8ClampedArray(et);case Wi:return new Int16Array(et);case si:return new Uint16Array(et);case Di:return new Int32Array(et);case ki:return new Uint32Array(et);case ji:return new Float32Array(et);case fi:return new Float64Array(et);default:throw new Error("Unkown type: "+q)}}var Et={serialize:yi,deserialize:U,stringToBuffer:Pe,bufferToString:Me};function Ct(P,K,q,nt){P.executeSql("CREATE TABLE IF NOT EXISTS "+K.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],q,nt)}function It(P){var K=this,q={db:null};if(P)for(var nt in P)q[nt]=typeof P[nt]!="string"?P[nt].toString():P[nt];var ot=new p(function(et,At){try{q.db=openDatabase(q.name,String(q.version),q.description,q.size)}catch(St){return At(St)}q.db.transaction(function(St){Ct(St,q,function(){K._dbInfo=q,et()},function(Tt,xt){At(xt)})},At)});return q.serializer=Et,ot}function Q(P,K,q,nt,ot,et){P.executeSql(q,nt,ot,function(At,St){St.code===St.SYNTAX_ERR?At.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[K.storeName],function(Tt,xt){xt.rows.length?et(Tt,St):Ct(Tt,K,function(){Tt.executeSql(q,nt,ot,et)},et)},et):et(At,St)},et)}function N(P,K){var q=this;P=C(P);var nt=new p(function(ot,et){q.ready().then(function(){var At=q._dbInfo;At.db.transaction(function(St){Q(St,At,"SELECT * FROM "+At.storeName+" WHERE key = ? LIMIT 1",[P],function(Tt,xt){var Rt=xt.rows.length?xt.rows.item(0).value:null;Rt&&(Rt=At.serializer.deserialize(Rt)),ot(Rt)},function(Tt,xt){et(xt)})})}).catch(et)});return v(nt,K),nt}function E(P,K){var q=this,nt=new p(function(ot,et){q.ready().then(function(){var At=q._dbInfo;At.db.transaction(function(St){Q(St,At,"SELECT * FROM "+At.storeName,[],function(Tt,xt){for(var Rt=xt.rows,jt=Rt.length,ue=0;ue<jt;ue++){var ge=Rt.item(ue),Ne=ge.value;if(Ne&&(Ne=At.serializer.deserialize(Ne)),Ne=P(Ne,ge.key,ue+1),Ne!==void 0){ot(Ne);return}}ot()},function(Tt,xt){et(xt)})})}).catch(et)});return v(nt,K),nt}function F(P,K,q,nt){var ot=this;P=C(P);var et=new p(function(At,St){ot.ready().then(function(){K===void 0&&(K=null);var Tt=K,xt=ot._dbInfo;xt.serializer.serialize(K,function(Rt,jt){jt?St(jt):xt.db.transaction(function(ue){Q(ue,xt,"INSERT OR REPLACE INTO "+xt.storeName+" (key, value) VALUES (?, ?)",[P,Rt],function(){At(Tt)},function(ge,Ne){St(Ne)})},function(ue){if(ue.code===ue.QUOTA_ERR){if(nt>0){At(F.apply(ot,[P,Tt,q,nt-1]));return}St(ue)}})})}).catch(St)});return v(et,q),et}function tt(P,K,q){return F.apply(this,[P,K,q,1])}function S(P,K){var q=this;P=C(P);var nt=new p(function(ot,et){q.ready().then(function(){var At=q._dbInfo;At.db.transaction(function(St){Q(St,At,"DELETE FROM "+At.storeName+" WHERE key = ?",[P],function(){ot()},function(Tt,xt){et(xt)})})}).catch(et)});return v(nt,K),nt}function it(P){var K=this,q=new p(function(nt,ot){K.ready().then(function(){var et=K._dbInfo;et.db.transaction(function(At){Q(At,et,"DELETE FROM "+et.storeName,[],function(){nt()},function(St,Tt){ot(Tt)})})}).catch(ot)});return v(q,P),q}function lt(P){var K=this,q=new p(function(nt,ot){K.ready().then(function(){var et=K._dbInfo;et.db.transaction(function(At){Q(At,et,"SELECT COUNT(key) as c FROM "+et.storeName,[],function(St,Tt){var xt=Tt.rows.item(0).c;nt(xt)},function(St,Tt){ot(Tt)})})}).catch(ot)});return v(q,P),q}function L(P,K){var q=this,nt=new p(function(ot,et){q.ready().then(function(){var At=q._dbInfo;At.db.transaction(function(St){Q(St,At,"SELECT key FROM "+At.storeName+" WHERE id = ? LIMIT 1",[P+1],function(Tt,xt){var Rt=xt.rows.length?xt.rows.item(0).key:null;ot(Rt)},function(Tt,xt){et(xt)})})}).catch(et)});return v(nt,K),nt}function Y(P){var K=this,q=new p(function(nt,ot){K.ready().then(function(){var et=K._dbInfo;et.db.transaction(function(At){Q(At,et,"SELECT key FROM "+et.storeName,[],function(St,Tt){for(var xt=[],Rt=0;Rt<Tt.rows.length;Rt++)xt.push(Tt.rows.item(Rt).key);nt(xt)},function(St,Tt){ot(Tt)})})}).catch(ot)});return v(q,P),q}function ut(P){return new p(function(K,q){P.transaction(function(nt){nt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(ot,et){for(var At=[],St=0;St<et.rows.length;St++)At.push(et.rows.item(St).name);K({db:P,storeNames:At})},function(ot,et){q(et)})},function(nt){q(nt)})})}function Ft(P,K){K=w.apply(this,arguments);var q=this.config();P=typeof P!="function"&&P||{},P.name||(P.name=P.name||q.name,P.storeName=P.storeName||q.storeName);var nt=this,ot;return P.name?ot=new p(function(et){var At;P.name===q.name?At=nt._dbInfo.db:At=openDatabase(P.name,"","",0),P.storeName?et({db:At,storeNames:[P.storeName]}):et(ut(At))}).then(function(et){return new p(function(At,St){et.db.transaction(function(Tt){function xt(ge){return new p(function(Ne,ri){Tt.executeSql("DROP TABLE IF EXISTS "+ge,[],function(){Ne()},function(Ue,Ji){ri(Ji)})})}for(var Rt=[],jt=0,ue=et.storeNames.length;jt<ue;jt++)Rt.push(xt(et.storeNames[jt]));p.all(Rt).then(function(){At()}).catch(function(ge){St(ge)})},function(Tt){St(Tt)})})}):ot=p.reject("Invalid arguments"),v(ot,K),ot}var Ot={_driver:"webSQLStorage",_initStorage:It,_support:ne(),iterate:E,getItem:N,setItem:tt,removeItem:S,clear:it,length:lt,key:L,keys:Y,dropInstance:Ft};function Mt(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function $t(P,K){var q=P.name+"/";return P.storeName!==K.storeName&&(q+=P.storeName+"/"),q}function Ze(){var P="_localforage_support_test";try{return localStorage.setItem(P,!0),localStorage.removeItem(P),!1}catch{return!0}}function we(){return!Ze()||localStorage.length>0}function se(P){var K=this,q={};if(P)for(var nt in P)q[nt]=P[nt];return q.keyPrefix=$t(P,K._defaultConfig),we()?(K._dbInfo=q,q.serializer=Et,p.resolve()):p.reject()}function Qt(P){var K=this,q=K.ready().then(function(){for(var nt=K._dbInfo.keyPrefix,ot=localStorage.length-1;ot>=0;ot--){var et=localStorage.key(ot);et.indexOf(nt)===0&&localStorage.removeItem(et)}});return v(q,P),q}function de(P,K){var q=this;P=C(P);var nt=q.ready().then(function(){var ot=q._dbInfo,et=localStorage.getItem(ot.keyPrefix+P);return et&&(et=ot.serializer.deserialize(et)),et});return v(nt,K),nt}function pe(P,K){var q=this,nt=q.ready().then(function(){for(var ot=q._dbInfo,et=ot.keyPrefix,At=et.length,St=localStorage.length,Tt=1,xt=0;xt<St;xt++){var Rt=localStorage.key(xt);if(Rt.indexOf(et)===0){var jt=localStorage.getItem(Rt);if(jt&&(jt=ot.serializer.deserialize(jt)),jt=P(jt,Rt.substring(At),Tt++),jt!==void 0)return jt}}});return v(nt,K),nt}function Gi(P,K){var q=this,nt=q.ready().then(function(){var ot=q._dbInfo,et;try{et=localStorage.key(P)}catch{et=null}return et&&(et=et.substring(ot.keyPrefix.length)),et});return v(nt,K),nt}function Yn(P){var K=this,q=K.ready().then(function(){for(var nt=K._dbInfo,ot=localStorage.length,et=[],At=0;At<ot;At++){var St=localStorage.key(At);St.indexOf(nt.keyPrefix)===0&&et.push(St.substring(nt.keyPrefix.length))}return et});return v(q,P),q}function ti(P){var K=this,q=K.keys().then(function(nt){return nt.length});return v(q,P),q}function Vi(P,K){var q=this;P=C(P);var nt=q.ready().then(function(){var ot=q._dbInfo;localStorage.removeItem(ot.keyPrefix+P)});return v(nt,K),nt}function li(P,K,q){var nt=this;P=C(P);var ot=nt.ready().then(function(){K===void 0&&(K=null);var et=K;return new p(function(At,St){var Tt=nt._dbInfo;Tt.serializer.serialize(K,function(xt,Rt){if(Rt)St(Rt);else try{localStorage.setItem(Tt.keyPrefix+P,xt),At(et)}catch(jt){(jt.name==="QuotaExceededError"||jt.name==="NS_ERROR_DOM_QUOTA_REACHED")&&St(jt),St(jt)}})})});return v(ot,q),ot}function Li(P,K){if(K=w.apply(this,arguments),P=typeof P!="function"&&P||{},!P.name){var q=this.config();P.name=P.name||q.name,P.storeName=P.storeName||q.storeName}var nt=this,ot;return P.name?ot=new p(function(et){P.storeName?et($t(P,nt._defaultConfig)):et(P.name+"/")}).then(function(et){for(var At=localStorage.length-1;At>=0;At--){var St=localStorage.key(At);St.indexOf(et)===0&&localStorage.removeItem(St)}}):ot=p.reject("Invalid arguments"),v(ot,K),ot}var Xi={_driver:"localStorageWrapper",_initStorage:se,_support:Mt(),iterate:pe,getItem:de,setItem:li,removeItem:Vi,clear:Qt,length:ti,key:Gi,keys:Yn,dropInstance:Li},zn=function(K,q){return K===q||typeof K=="number"&&typeof q=="number"&&isNaN(K)&&isNaN(q)},Os=function(K,q){for(var nt=K.length,ot=0;ot<nt;){if(zn(K[ot],q))return!0;ot++}return!1},ks=Array.isArray||function(P){return Object.prototype.toString.call(P)==="[object Array]"},_n={},pi={},ls={INDEXEDDB:ie,WEBSQL:Ot,LOCALSTORAGE:Xi},nl=[ls.INDEXEDDB._driver,ls.WEBSQL._driver,ls.LOCALSTORAGE._driver],wn=["dropInstance"],Wn=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(wn),Qu={description:"",driver:nl.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function sl(P,K){P[K]=function(){var q=arguments;return P.ready().then(function(){return P[K].apply(P,q)})}}function Br(){for(var P=1;P<arguments.length;P++){var K=arguments[P];if(K)for(var q in K)K.hasOwnProperty(q)&&(ks(K[q])?arguments[0][q]=K[q].slice():arguments[0][q]=K[q])}return arguments[0]}var Ju=(function(){function P(K){o(this,P);for(var q in ls)if(ls.hasOwnProperty(q)){var nt=ls[q],ot=nt._driver;this[q]=ot,_n[ot]||this.defineDriver(nt)}this._defaultConfig=Br({},Qu),this._config=Br({},this._defaultConfig,K),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return P.prototype.config=function(q){if((typeof q>"u"?"undefined":a(q))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var nt in q){if(nt==="storeName"&&(q[nt]=q[nt].replace(/\W/g,"_")),nt==="version"&&typeof q[nt]!="number")return new Error("Database version must be a number.");this._config[nt]=q[nt]}return"driver"in q&&q.driver?this.setDriver(this._config.driver):!0}else return typeof q=="string"?this._config[q]:this._config},P.prototype.defineDriver=function(q,nt,ot){var et=new p(function(At,St){try{var Tt=q._driver,xt=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!q._driver){St(xt);return}for(var Rt=Wn.concat("_initStorage"),jt=0,ue=Rt.length;jt<ue;jt++){var ge=Rt[jt],Ne=!Os(wn,ge);if((Ne||q[ge])&&typeof q[ge]!="function"){St(xt);return}}var ri=function(){for(var Ms=function(Fr){return function(){var Fn=new Error("Method "+Fr+" is not implemented by the current driver"),Pr=p.reject(Fn);return v(Pr,arguments[arguments.length-1]),Pr}},zr=0,Pa=wn.length;zr<Pa;zr++){var Ua=wn[zr];q[Ua]||(q[Ua]=Ms(Ua))}};ri();var Ue=function(Ms){_n[Tt]&&console.info("Redefining LocalForage driver: "+Tt),_n[Tt]=q,pi[Tt]=Ms,At()};"_support"in q?q._support&&typeof q._support=="function"?q._support().then(Ue,St):Ue(!!q._support):Ue(!0)}catch(Ji){St(Ji)}});return A(et,nt,ot),et},P.prototype.driver=function(){return this._driver||null},P.prototype.getDriver=function(q,nt,ot){var et=_n[q]?p.resolve(_n[q]):p.reject(new Error("Driver not found."));return A(et,nt,ot),et},P.prototype.getSerializer=function(q){var nt=p.resolve(Et);return A(nt,q),nt},P.prototype.ready=function(q){var nt=this,ot=nt._driverSet.then(function(){return nt._ready===null&&(nt._ready=nt._initDriver()),nt._ready});return A(ot,q,q),ot},P.prototype.setDriver=function(q,nt,ot){var et=this;ks(q)||(q=[q]);var At=this._getSupportedDrivers(q);function St(){et._config.driver=et.driver()}function Tt(jt){return et._extend(jt),St(),et._ready=et._initStorage(et._config),et._ready}function xt(jt){return function(){var ue=0;function ge(){for(;ue<jt.length;){var Ne=jt[ue];return ue++,et._dbInfo=null,et._ready=null,et.getDriver(Ne).then(Tt).catch(ge)}St();var ri=new Error("No available storage method found.");return et._driverSet=p.reject(ri),et._driverSet}return ge()}}var Rt=this._driverSet!==null?this._driverSet.catch(function(){return p.resolve()}):p.resolve();return this._driverSet=Rt.then(function(){var jt=At[0];return et._dbInfo=null,et._ready=null,et.getDriver(jt).then(function(ue){et._driver=ue._driver,St(),et._wrapLibraryMethodsWithReady(),et._initDriver=xt(At)})}).catch(function(){St();var jt=new Error("No available storage method found.");return et._driverSet=p.reject(jt),et._driverSet}),A(this._driverSet,nt,ot),this._driverSet},P.prototype.supports=function(q){return!!pi[q]},P.prototype._extend=function(q){Br(this,q)},P.prototype._getSupportedDrivers=function(q){for(var nt=[],ot=0,et=q.length;ot<et;ot++){var At=q[ot];this.supports(At)&&nt.push(At)}return nt},P.prototype._wrapLibraryMethodsWithReady=function(){for(var q=0,nt=Wn.length;q<nt;q++)sl(this,Wn[q])},P.prototype.createInstance=function(q){return new P(q)},P})(),Ir=new Ju;i.exports=Ir},{3:3}]},{},[4])(4)})})(rf)),rf.exports}var sE=nE();const cy=ur(sE);class mb{constructor(t,e,i){this.urlCache={},this.storage=void 0,this.name=t,this.requester=e||Zo,this.resolver=i,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let t;typeof cy>"u"&&(t=cy),this.storage=t.createInstance({name:this.name})}catch{throw new Error("localForage lib not loaded")}}addListeners(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}removeListeners(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}status(t){let e=navigator.onLine;this.online=e,e?this.emit("online",this):this.emit("offline",this)}add(t,e){let i=t.resources.map(s=>{let{href:a}=s,o=this.resolver(a),u=window.encodeURIComponent(o);return this.storage.getItem(u).then(h=>!h||e?this.requester(o,"binary").then(d=>this.storage.setItem(u,d)):h)});return Promise.all(i)}put(t,e,i){let s=window.encodeURIComponent(t);return this.storage.getItem(s).then(a=>a||this.requester(t,"binary",e,i).then(o=>this.storage.setItem(s,o)))}request(t,e,i,s){return this.online?this.requester(t,e,i,s).then(a=>(this.put(t),a)):this.retrieve(t,e)}retrieve(t,e){new Ce;var i,s=new Ns(t);return e||(e=s.extension),e=="blob"?i=this.getBlob(t):i=this.getText(t),i.then(a=>{var o=new Ce,u;return a?(u=this.handleResponse(a,e),o.resolve(u)):o.reject({message:"File not found in storage: "+t,stack:new Error().stack}),o.promise})}handleResponse(t,e){var i;return e=="json"?i=JSON.parse(t):Wo(e)?i=rs(t,"text/xml"):e=="xhtml"?i=rs(t,"application/xhtml+xml"):e=="html"||e=="htm"?i=rs(t,"text/html"):i=t,i}getBlob(t,e){let i=window.encodeURIComponent(t);return this.storage.getItem(i).then(function(s){if(s)return e=e||Ba.lookup(t),new Blob([s],{type:e})})}getText(t,e){let i=window.encodeURIComponent(t);return e=e||Ba.lookup(t),this.storage.getItem(i).then(function(s){var a=new Ce,o=new FileReader,u;if(s)return u=new Blob([s],{type:e}),o.addEventListener("loadend",()=>{a.resolve(o.result)}),o.readAsText(u,e),a.promise})}getBase64(t,e){let i=window.encodeURIComponent(t);return e=e||Ba.lookup(t),this.storage.getItem(i).then(s=>{var a=new Ce,o=new FileReader,u;if(s)return u=new Blob([s],{type:e}),o.addEventListener("loadend",()=>{a.resolve(o.result)}),o.readAsDataURL(u,e),a.promise})}createUrl(t,e){var i=new Ce,s=window.URL||window.webkitURL||window.mozURL,a,o,u=e&&e.base64;return t in this.urlCache?(i.resolve(this.urlCache[t]),i.promise):(u?(o=this.getBase64(t),o&&o.then((function(h){this.urlCache[t]=h,i.resolve(h)}).bind(this))):(o=this.getBlob(t),o&&o.then((function(h){a=s.createObjectURL(h),this.urlCache[t]=a,i.resolve(a)}).bind(this))),o||i.reject({message:"File not found in storage: "+t,stack:new Error().stack}),i.promise)}revokeUrl(t){var e=window.URL||window.webkitURL||window.mozURL,i=this.urlCache[t];i&&e.revokeObjectURL(i)}destroy(){var t=window.URL||window.webkitURL||window.mozURL;for(let e in this.urlCache)t.revokeObjectURL(e);this.urlCache={},this.removeListeners()}}os(mb.prototype);class af{constructor(t){this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",t&&this.parse(t)}parse(t){if(!t)return this;const e=Ye(t,"display_options");return e?(Rs(e,"option").forEach(s=>{let a="";switch(s.childNodes.length&&(a=s.childNodes[0].nodeValue),s.attributes.name.value){case"interactive":this.interactive=a;break;case"fixed-layout":this.fixedLayout=a;break;case"open-to-spread":this.openToSpread=a;break;case"orientation-lock":this.orientationLock=a;break}}),this):this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}const dy="META-INF/container.xml",rE="META-INF/com.apple.ibooks.display-options.xml",qn={BINARY:"binary",BASE64:"base64",EPUB:"epub",OPF:"opf",MANIFEST:"json",DIRECTORY:"directory"};class Kf{constructor(t,e){typeof e>"u"&&typeof t!="string"&&!(t instanceof Blob)&&!(t instanceof ArrayBuffer)&&(e=t,t=void 0),this.settings=Hi(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),Hi(this.settings,e),this.opening=new Ce,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new Ce,spine:new Ce,metadata:new Ce,cover:new Ce,navigation:new Ce,pageList:new Ce,resources:new Ce,displayOptions:new Ce},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||Zo,this.spine=new bw,this.locations=new lb(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),t&&this.open(t,this.settings.openAs).catch(i=>{var s=new Error("Cannot load book at "+t);this.emit(Bt.BOOK.OPEN_FAILED,s)})}open(t,e){var i,s=e||this.determineType(t);return s===qn.BINARY?(this.archived=!0,this.url=new Gn("/",""),i=this.openEpub(t)):s===qn.BASE64?(this.archived=!0,this.url=new Gn("/",""),i=this.openEpub(t,s)):s===qn.EPUB?(this.archived=!0,this.url=new Gn("/",""),i=this.request(t,"binary",this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):s==qn.OPF?(this.url=new Gn(t),i=this.openPackaging(this.url.Path.toString())):s==qn.MANIFEST?(this.url=new Gn(t),i=this.openManifest(this.url.Path.toString())):(this.url=new Gn(t),i=this.openContainer(dy).then(this.openPackaging.bind(this))),i}openEpub(t,e){return this.unarchive(t,e||this.settings.encoding).then(()=>this.openContainer(dy)).then(i=>this.openPackaging(i))}openContainer(t){return this.load(t).then(e=>(this.container=new Aw(e),this.resolve(this.container.packagePath)))}openPackaging(t){return this.path=new Ns(t),this.load(t).then(e=>(this.packaging=new q0(e),this.unpack(this.packaging)))}openManifest(t){return this.path=new Ns(t),this.load(t).then(e=>(this.packaging=new q0,this.packaging.load(e),this.unpack(this.packaging)))}load(t){var e=this.resolve(t);return this.archived?this.archive.request(e):this.request(e,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(t,e){if(t){var i=t,s=t.indexOf("://")>-1;return s?t:(this.path&&(i=this.path.resolve(t)),e!=!1&&this.url&&(i=this.url.resolve(i)),i)}}canonical(t){var e=t;return t?(this.settings.canonical?e=this.settings.canonical(t):e=this.resolve(t,!0),e):""}determineType(t){var e,i,s;if(this.settings.encoding==="base64")return qn.BASE64;if(typeof t!="string")return qn.BINARY;if(e=new Gn(t),i=e.path(),s=i.extension,s&&(s=s.replace(/\?.*$/,"")),!s)return qn.DIRECTORY;if(s==="epub")return qn.EPUB;if(s==="opf")return qn.OPF;if(s==="json")return qn.MANIFEST}unpack(t){this.package=t,this.packaging.metadata.layout===""?this.load(this.url.resolve(rE)).then(e=>{this.displayOptions=new af(e),this.loading.displayOptions.resolve(this.displayOptions)}).catch(e=>{this.displayOptions=new af,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new af,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new Sw(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!="none"?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(e=>{console.error(e)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(t){let e=t.navPath||t.ncxPath,i=t.toc;return i?new Promise((s,a)=>{this.navigation=new Ud(i),t.pageList&&(this.pageList=new Hd(t.pageList)),s(this.navigation)}):e?this.load(e,"xml").then(s=>(this.navigation=new Ud(s),this.pageList=new Hd(s),this.navigation)):new Promise((s,a)=>{this.navigation=new Ud,this.pageList=new Hd,s(this.navigation)})}section(t){return this.spine.get(t)}renderTo(t,e){return this.rendition=new Zf(this,e),this.rendition.attachTo(t),this.rendition}setRequestCredentials(t){this.settings.requestCredentials=t}setRequestHeaders(t){this.settings.requestHeaders=t}unarchive(t,e){return this.archive=new iE,this.archive.open(t,e)}store(t){let e=this.settings.replacements&&this.settings.replacements!=="none",i=this.url,s=this.settings.requestMethod||Zo.bind(this);return this.storage=new mb(t,s,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let a=(o,u)=>{u.output=this.resources.substitute(o,u.url)};this.resources.settings.replacements=e||"blobUrl",this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on("offline",()=>{this.url=new Gn("/",""),this.spine.hooks.serialize.register(a)}),this.storage.on("online",()=>{this.url=i,this.spine.hooks.serialize.deregister(a)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((t,e)=>{e.output=this.resources.substitute(t,e.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(t){var e=new Te(t),i=this.spine.get(e.spinePos),s=this.load.bind(this);return i?i.load(s).then(function(a){var o=e.toRange(i.document);return o}):new Promise((a,o)=>{o("CFI could not be found")})}key(t){var e=t||this.packaging.metadata.identifier||this.url.filename;return`epubjs:${$u}:${e}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}os(Kf.prototype);function Lr(g,t){return new Kf(g,t)}Lr.VERSION=$u;typeof global<"u"&&(global.EPUBJS_VERSION=$u);Lr.Book=Kf;Lr.Rendition=Zf;Lr.Contents=Yf;Lr.CFI=Te;Lr.utils=cw;La.workerSrc=L_;function aE(){const[g,t]=ln.useState("dark"),[e,i]=ln.useState(""),[s,a]=ln.useState([]),[o,u]=ln.useState(0),[h,d]=ln.useState([]),[f,p]=ln.useState(200),[v,A]=ln.useState(!1),[C,w]=ln.useState("stream"),b=ln.useRef(null),[_,x]=ln.useState(!0);ln.useEffect(()=>{document.documentElement.setAttribute("data-theme",g)},[g]),ln.useEffect(()=>{if(!v)return;const T=6e4/f,O=setInterval(()=>{u(k=>Math.min(k+1,s.length-1))},T);return()=>clearInterval(O)},[v,f,s.length]),ln.useEffect(()=>{C==="page"&&b.current?.scrollIntoView({behavior:"smooth",block:"center"})},[o,C]);function D(T,O=!0){i(T);const k=T.replace(/\s+/g," ").trim().split(" ").filter(Boolean);a(k),u(0),O&&d([])}async function M(T){const O=T.target.files?.[0];if(O){if(O.name.endsWith(".txt")&&D(await O.text()),O.name.endsWith(".pdf")){const k=await O.arrayBuffer(),z=await Iy({data:k}).promise;let B="";for(let H=1;H<=z.numPages;H++){const Z=await(await z.getPage(H)).getTextContent();B+=Z.items.map(rt=>rt.str).join(" ")+" "}D(B)}if(O.name.endsWith(".epub")){const k=await O.arrayBuffer(),z=Lr(k);await z.ready;let B=[],H=[],V=0;for(const Z of z.spine.items){const rt=await z.load(Z.href);if(!(rt instanceof Document))continue;const ft=rt.body?.textContent||"",mt=ft.split(/\s+/).filter(Boolean);H.push({title:rt.querySelector("h1,h2,h3")?.textContent||Z.href||"Chapter",wordStart:V}),V+=mt.length,B.push(ft)}d(H),D(B.join(" "),!1)}}}return te.jsxs("div",{className:"app",style:{display:"flex",gap:20},children:[te.jsx(L1,{words:s,currentIndex:o,chapters:h,wpm:f,onJump:u}),te.jsxs("main",{style:{flex:1},children:[te.jsx("button",{onClick:()=>t(T=>T==="dark"?"light":"dark"),children:g==="dark"?" Light Mode":" Dark Mode"}),te.jsx("h1",{children:"Focus Reader"}),te.jsxs("button",{onClick:()=>w(T=>T==="stream"?"page":"stream"),children:["Switch to ",C==="stream"?"Page":"Stream"," Mode"]}),te.jsx("textarea",{className:"input textarea",placeholder:"Paste text here",value:e,onChange:T=>D(T.target.value)}),te.jsx("input",{className:"input",type:"file",accept:".txt,.pdf,.epub",onChange:M}),C==="stream"&&te.jsx(M1,{prev:s[o-1],current:s[o],next:s[o+1],orpEnabled:_}),C==="page"&&te.jsx("div",{className:"page-container",children:s.map((T,O)=>te.jsx("span",{ref:O===o?b:null,onClick:()=>u(O),className:`page-word ${O===o?"active":""}`,children:T+" "},O))}),te.jsxs("div",{style:{marginTop:20},children:[te.jsxs("button",{onClick:()=>x(T=>!T),children:["ORP ",_?"On":"Off"]}),te.jsx("input",{type:"range",min:1,max:1e3,value:f,onChange:T=>p(Number(T.target.value))}),te.jsxs("span",{children:[" ",f," WPM"]}),te.jsx("button",{onClick:()=>A(T=>!T),children:v?" Pause":" Play"})]})]})]})}N1.createRoot(document.getElementById("root")).render(te.jsx(w1.StrictMode,{children:te.jsx(aE,{})}));
